/*! For license information please see 3359.6879e105.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).xss={})}(this,(function(e){"use strict";var t=function(){return t=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var o in t=arguments[a])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},t.apply(this,arguments)};function a(e,t,a){if(a||2===arguments.length)for(var r,o=0,n=t.length;o<n;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}var r=/[^a-zA-Z0-9\\_:.-]/gim,o=/</g,n=/>/g,i=/&#([a-zA-Z0-9]*);?/gim,s=/&quot;/g,l=/&colon;?/gim,d=/&newline;?/gim,c=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,u=/u\s*r\s*l\s*\(.*/gi,p=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,_=/"/g,f=function(e){return e.replace(o,"&lt;").replace(n,"&gt;")},v={indexOf:function(e,t){var a,r;for(a=0,r=e.length;a<r;a++)if(e[a]===t)return a;return-1},forEach:function(e,t,a){var r,o;for(r=0,o=e.length;r<o;r++)t.call(a,e[r],r,e)},some:function(e,t,a){var r,o;for(r=0,o=e.length;r<o;r++)if(t.call(a,e[r],r,e))return!0;return!1},trim:function(e){return e.replace(/(^\s*)|(\s*$)/g,"")},isArray:function(e){return e instanceof Array},includes:function(e,t){if("string"==typeof e)return-1!==e.indexOf(t);for(var a=0;a<e.length;a++)if(e[a]===t)return!0;return!1},spaceIndex:function(e){var t=/\s|\n|\t/.exec(e);return t?t.index:-1},uniq:function(e){for(var t={},a=[],r=0;r<e.length;r++)t[e[r]]||(a.push(e[r]),t[e[r]]=!0);return a},from:function(e){for(var t=[],a=0;a<e.length;a++)t.push(e[a]);return t},keys:function(e){var t=[];for(var a in e)t.push(a);return t}};function h(e){return null==e}function m(e){var t,a=v.spaceIndex(e);return t=-1===a?e.slice(1,-1):e.slice(1,a+1),"/"===(t=v.trim(t).toLowerCase()).slice(0,1)&&(t=t.slice(1)),"/"===t.slice(-1)&&(t=t.slice(0,-1)),t}function g(e,t){for(;t<e.length;t++){var a=e[t];if(" "!==a)return"="===a?t:-1}return-1}function S(e,t){for(;t>0;t--){var a=e[t];if(" "!==a)return"="===a?t:-1}return-1}function T(e){return function(e){return'"'===e[0]&&'"'===e[e.length-1]||"'"===e[0]&&"'"===e[e.length-1]}(e)?e.substr(1,e.length-2):e}function I(e,t){for(;t<e.length;t++){var a=e[t];if(" "!==a)return"'"===a||'"'===a?t:-1}return-1}function E(e){var t,a,r,o,n,i,s,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d="",c=0;for(e=function(e){e=e.replace(/rn/g,"n");for(var t="",a=0;a<e.length;a++){var r=e.charCodeAt(a);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t}(e);c<e.length;)o=(t=e.charCodeAt(c++))>>2,n=(3&t)<<4|(a=e.charCodeAt(c++))>>4,i=(15&a)<<2|(r=e.charCodeAt(c++))>>6,s=63&r,isNaN(a)?i=s=64:isNaN(r)&&(s=64),d=d+l.charAt(o)+l.charAt(n)+l.charAt(i)+l.charAt(s);return d}function y(e){var t,a,r,o,n,i,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="",d=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");d<e.length;)t=s.indexOf(e.charAt(d++))<<2|(o=s.indexOf(e.charAt(d++)))>>4,a=(15&o)<<4|(n=s.indexOf(e.charAt(d++)))>>2,r=(3&n)<<6|(i=s.indexOf(e.charAt(d++))),l+=String.fromCharCode(t),64!==n&&(l+=String.fromCharCode(a)),64!==i&&(l+=String.fromCharCode(r));return l=function(e){for(var t="",a=0,r=0,o=0,n=0;a<e.length;)(r=e.charCodeAt(a))<128?(t+=String.fromCharCode(r),a++):r>191&&r<224?(n=e.charCodeAt(a+1),t+=String.fromCharCode((31&r)<<6|63&n),a+=2):(n=e.charCodeAt(a+1),o=e.charCodeAt(a+2),t+=String.fromCharCode((15&r)<<12|(63&n)<<6|63&o),a+=3);return t}(l),l}function k(e){return"</"===e.slice(0,2)}function A(e,t,a){var r="",o=0,n=!1,i=!1,s=0,l=e.length,d="",c="";e:for(s=0;s<l;s++){var u=e.charAt(s);if(!1===n){if("<"===u){n=s;continue}}else if(!1===i){if("<"===u){r+=a(e.slice(o,s)),n=s,o=s;continue}if(">"===u||s===l-1){r+=a(e.slice(o,n)),d=m(c=e.slice(n,s+1)),r+=t(n,r.length,d,c,k(c)),o=s+1,n=!1;continue}if('"'===u||"'"===u)for(var p=1,_=e.charAt(s-p);""===_.trim()||"="===_;){if("="===_){i=u;continue e}_=e.charAt(s-++p)}}else if(u===i){i=!1;continue}}return o<l&&(r+=a(e.substr(o))),r}function R(e,t){var a=0,o=0,n=[],i=!1,s=e.length;function l(e,a){if(!((e=(e=v.trim(e)).replace(r,"").toLowerCase()).length<1)){var o=t(e,a||"");o&&n.push(o)}}for(var d=0;d<s;d++){var c=e.charAt(d),u=void 0;if(!1!==i||"="!==c)if(!1===i||d!==o){if(/\s|\n|\t/.test(c)){if(e=e.replace(/\s|\n|\t/g," "),!1===i){if(-1===(u=g(e,d))){l(v.trim(e.slice(a,d))),i=!1,a=d+1;continue}d=u-1;continue}if(-1===(u=S(e,d-1))){l(i,T(v.trim(e.slice(a,d)))),i=!1,a=d+1;continue}}}else{if(-1===(u=e.indexOf(c,d+1)))break;l(i,v.trim(e.slice(o+1,u))),i=!1,a=(d=u)+1}else i=e.slice(a,d),a=d+1,o='"'===e.charAt(a)||"'"===e.charAt(a)?a:I(e,d+1)}return a<e.length&&(!1===i?l(e.slice(a)):l(i,T(v.trim(e.slice(a))))),v.trim(n.join(" "))}function N(e,t,a){if(a=function(e){return function(e){for(var t="",a=0,r=e.length;a<r;a++)t+=e.charCodeAt(a)<32?" ":e.charAt(a);return v.trim(t)}(e=function(e){return e.replace(l,":").replace(d," ")}(e=function(e){return e.replace(i,(function(e,t){return"x"===t[0]||"X"===t[0]?String.fromCharCode(parseInt(t.substr(1),16)):String.fromCharCode(parseInt(t,10))}))}(e=function(e){return e.replace(s,'"')}(e))))}(a),"href"===t||"src"===t){if("#"===(a=v.trim(a)))return"#";if("http://"!==a.substr(0,7)&&"https://"!==a.substr(0,8)&&"mailto:"!==a.substr(0,7)&&"tel:"!==a.substr(0,4)&&"data:image/"!==a.substr(0,11)&&"ftp://"!==a.substr(0,6)&&"./"!==a.substr(0,2)&&"../"!==a.substr(0,3)&&"#"!==a[0]&&"/"!==a[0])return""}else if("background"===t){if(c.lastIndex=0,c.test(a))return""}else if("style"===t){if(p.lastIndex=0,p.test(a))return"";if(u.lastIndex=0,u.test(a)&&(c.lastIndex=0,c.test(a)))return""}return function(e){return e=function(e){return e.replace(_,"&quot;")}(e),f(e)}(a)}var P=function(e){return"string"==typeof e?e.replace(/'/g,'"').replace('=""',"").replace(/\s+/g,"").toLowerCase():""},C=function(){function e(e){var t=function(e){var t={};for(var a in e)t[a]=e[a];return t}(e||{});t.stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=function(){return""}),t.whiteList={},t.onTag=function(){},t.onTagAttr=function(){},t.onIgnoreTag=function(){},t.onIgnoreTagAttr=function(){},t.safeAttrValue=N,t.escapeHtml=f,this.options=Object.assign(t,e)}return e.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t=this.options,a=t.whiteList,r=t.onTag,o=t.onIgnoreTag,n=t.onTagAttr,i=t.onIgnoreTagAttr,s=t.safeAttrValue,l=t.escapeHtml;t.stripBlankChar&&(e=function(e){var t=e.split("");return(t=t.filter((function(e){var t=e.charCodeAt(0);return!(127===t||t<=31&&10!==t&&13!==t)}))).join("")}(e)),t.allowCommentTag||(e=function(e){for(var t="",a=0;a<e.length;){var r=e.indexOf("\x3c!--",a);if(-1===r){t+=e.slice(a);break}t+=e.slice(a,r);var o=e.indexOf("--\x3e",r);if(-1===o)break;a=o+3}return t}(e));var d=!1;t.stripIgnoreTagBody&&(d=function(e,t){"function"!=typeof t&&(t=function(){});var a=!Array.isArray(e),r=[],o=!1;return{onIgnoreTag:function(n,i,s){if(function(t){return!!a||-1!==v.indexOf(e,t)}(n)){if(s.isClosing){var l="[/removed]",d=s.position+10;return r.push([!1!==o?o:s.position,d]),o=!1,l}return o||(o=s.position),"[removed]"}return t(n,i,s)},remove:function(e){var t="",a=0;return v.forEach(r,(function(r){t+=e.slice(a,r[0]),a=r[1]})),t+=e.slice(a)}}}(t.stripIgnoreTagBody,o),o=d.onIgnoreTag);var c=A(e,(function(e,t,d,c,u){var p={sourcePosition:e,position:t,isClosing:u,isWhite:Object.prototype.hasOwnProperty.call(a,d)},_=r(d,c,p);if(!h(_))return _;if(p.isWhite){if(p.isClosing)return"</".concat(d,">");var f=function(e){var t=v.spaceIndex(e);if(-1===t)return{html:"",closing:"/"===e[e.length-2]};var a="/"===(e=v.trim(e.slice(t+1,-1)))[e.length-1];return a&&(e=v.trim(e.slice(0,-1))),{html:e,closing:a}}(c),m=a[d],g=R(f.html,(function(e,t){var a=-1!==v.indexOf(m,e),r=n(d,e,t,a);return h(r)?a?(t=s(d,e,t,null))?"".concat(e,'="').concat(t,'"'):e:h(r=i(d,e,t,a))?void 0:r:r}));return c="<".concat(d),g&&(c+=" ".concat(g)),f.closing&&(c+=" /"),c+">"}return h(_=o(d,c,p))?l(c):_}),l);return d&&(c=d.remove(c)),c},e}(),b=!0,O=function(e){return e&&e.Math==Math&&e},w=O("object"==typeof globalThis&&globalThis)||O("object"==typeof window&&window)||O("object"==typeof self&&self)||O("object"==typeof global&&global)||Function("return this")();try{!0!==(b=!!(b=String(b)).startsWith("<%=")||JSON.parse(b))&&"true"!==b||(w=new Function("\nvar _checkXSS = function (it) {\n  return it && it.Math == Math && it;\n};\nreturn _checkXSS(typeof globalThis === 'object' && globalThis) ||\n_checkXSS(typeof window === 'object' && window) ||\n_checkXSS(typeof self === 'object' && self) ||\n_checkXSS(typeof global === 'object' && global) ||\nFunction('return this')();\n")())}catch(e){console.log(e)}var L=new(function(){function e(){var e=this;this.batchData=[],this.uniqKeys=new Set,this.timeout=2e3,this.lock=!1,this.getSlardarBid=function(){var t,a,r="cc_web";if(!v.includes(r,"bid"))return r;if(e.config&&e.config.bid)return e.config.bid;var o=w;if(o&&o._xssBid)return o._xssBid;if(o&&o.slardar&&"function"==typeof o.slardar.config){var n=(o.slardar.config()||{}).bid;if(n)return n}if(o&&o.Slardar&&"function"==typeof o.Slardar.config){var i=(o.Slardar.config()||{}).bid;if(i)return i}return(null===(a=null===(t=null==o?void 0:o.Slardar)||void 0===t?void 0:t._baseParams)||void 0===a?void 0:a.bid)||"argus"},this.getConfigRegion=function(){var t;return v.includes("va","region")?e.config&&e.config.region?e.config.region:((null===(t=null==w?void 0:w.gfdatav1)||void 0===t?void 0:t.region)||"cn").toLowerCase():"va"},this.gerReportUrl=function(){var t={cn:y("aHR0cHM6Ly9tb24uemlqaWVhcGkuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),boe:y("aHR0cHM6Ly9tb24uemlqaWVhcGkuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),ttp:y("aHR0cHM6Ly9tb24udXMudGlrdG9rdi5jb20vbW9uaXRvcl9icm93c2VyL2NvbGxlY3QvYmF0Y2gvc2VjdXJpdHkvP2JpZD0="),va:y("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),maliva:y("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),sg:y("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),boei18n:y("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9")}[e.getConfigRegion()];if(t)return t+e.getSlardarBid()}}return e.prototype.setConfig=function(e){this.config=e},e.prototype.upload=function(){var e=this;if(!this.config||!this.config.isCloseReport){var t=!1;t=String(t);try{if(!0===(t=!t.startsWith("<%=")&&JSON.parse(t))||"true"===t)return}catch(e){console.log(e)}var a=this.gerReportUrl();!this.lock&&a&&0!==this.batchData.length&&(this.lock=!0,setTimeout((function(){var t=e.batchData.slice(0,100);e.batchData=e.batchData.slice(100),w.fetch(a,{method:"post",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).catch((function(e){console.warn("xss defense report error",e)})),e.lock=!1,e.upload()}),this.timeout))}},e.prototype.generateKey=function(e){return e.collectKey?[e.collectMode,e.collectKey].join("___"):""},e.prototype.push=function(e){this.batchData.push(e),this.upload()},e.prototype.report=function(e){var t,a=this.generateKey(e);if(w.fetch&&e.collectKey){var r=(null===(t=null===window||void 0===window?void 0:window.location)||void 0===t?void 0:t.href)||"SSR";e.documentUrl=r;var o={age:Math.floor(Date.now()),type:"xss",url:r,body:e,"user-agent":""};"enforce"===e.disposition&&"SSR"!==r||(o.url=a),"SSR"===r&&(o.url="SSR___".concat(o.url),o.body.ssr=!0),this.push(o)}},e}());function F(e,t){return L.setConfig(t),new C(t).process(e)}var U=function(e){return-1===(e=(e=(e=(e=e.replace(/&colon;/gi,":")).replace(/&tab;/gi,"")).replace(/&newline;/gi,"")).replace(/(\t|\n|\r)/g,"")).indexOf("&#")?e.trim().toLowerCase():e.trim().replace(/&#(?:(x)([0-9a-f]+)|([0-9]+));?/gi,(function(e,t,a,r){return String.fromCharCode(t?parseInt(a,16):parseInt(r))})).replace(/(\t|\n|\r)/g,"").toLowerCase()};function D(e,t){if(void 0===e&&(e=""),"string"!=typeof e)return!0;if(e=U(e),v.includes(e,"base64")&&!function(e){if(""===e||""===e.trim())return!0;try{return!v.includes(e,"data:text/html;base64")}catch(e){return!0}}(e))return t&&t("data:text/html;base64"),!1;var a=["expression(","behavior:","view-source:"];if(v.some(a,(function(t){return-1!==e.indexOf(t)})))return v.forEach(a,(function(a){-1!==e.indexOf(a)&&t&&t(a)})),!1;var r=["data:application","data:javascript","data:text/html","data:texthtml"];if(v.some(r,(function(t){return-1!==e.indexOf(t)})))return v.forEach(r,(function(a){-1!==e.indexOf(a)&&t&&t(a)})),!1;if(e.indexOf("javascript:")>0)return t&&t("javascript:"),!1;if(/^javascript:/i.test(e)){var o=e.slice(11).replace(/\s/g,"").trim();return!!v.some(["void","void(0)","void0","false","undefined",";"],(function(e){return e===o}))||(t&&t("javascript:"),!1)}return!0}var x=function(e,t){var a,r,o=!1;if(o=String(o),"string"!=typeof e)return e;if(a=e,r=Number(-1),"NaN"!==a.toString()&&-1!==r&&a.length>=r)return e;if(D(e,t))return e;try{if(!0===(o=!o.startsWith("<%=")&&JSON.parse(o))||"true"===o){var n=new URL(e);return n.origin+n.pathname}}catch(e){return console.log(e),"#"}return"#"};function M(e,t,r){if(void 0===e&&(e=""),void 0===t&&(t=[]),"string"!=typeof e)return!0;if(!D(e=U(e)))return!1;var o=function(e){var t=e.match(/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/)||[];return{url:t[0],scheme:t[1],slash:t[2],host:t[3],port:t[4],path:t[5],query:t[6],hash:t[7]}}(e),n=o.scheme,i=o.host;return r?Boolean(r(e)):!(!n||!i)&&(!v.includes(["http","https","file"],n)||("object"==typeof window&&window&&(t=a(a([],t,!0),[location.host],!1)),v.some(t,(function(e){return!!(e instanceof RegExp&&e.test(i))||e===i}))))}var B=M,j=M,H=function(e,t){for(var a={},r=0,o=v.keys(e);r<o.length;r++){var n=o[r];Array.isArray(e[n])?a[n]=v.from(e[n]):a[n]=H({},e[n])}for(var i=0,s=v.keys(t);i<s.length;i++)(n=s[i])in e?Array.isArray(e[n])?a[n]=e[n].concat(t[n]):a[n]=H(e[n],t[n]):Array.isArray(t[n])?a[n]=v.from(t[n]):a[n]=H({},t[n]);return a},G={blackList:{a:["folder"],meta:["content"],iframe:["srcdoc"],input:["pattern"],vmlframe:["xmlns"]},blackTags:["script","xml","embed","isindex","object","base","set","handler","animate","payload","import"],blackAttrs:["charset","ns","namespace","formaction","xlink:href","xmlns:xlink","handler","repeat","repeat-start","repeat-end"],blackAttrRegExps:[/^on/],filterList:{param:["value"],video:["poster"],form:["action"]},filterAttrs:["href","src","background","style","dynsrc","lowsrc","content"]};try{var V={};V.blackAttrRegExps&&(V.blackAttrRegExps=V.blackAttrRegExps.map((function(e){return new RegExp(e.toString().slice(1,e.toString().length-1))})));var z="merge";v.includes(z,"override")&&(G=V),v.includes(z,"merge")&&(G=H(G,V))}catch(e){console.log(e)}var Y,W={mode:"black",whiteList:{},blackConfig:G,collect:null,initCollect:function(){W.collect={blackList:{},blackTags:[],blackAttrs:[],blackAttrRegExps:[],filterAttrs:[],filterList:{},filterProtocol:[]}},removeCollect:function(){var e=function(e){for(var t=0,a=function(a){Array.isArray(e[a])?0===e[a].length?delete e[a]:(e[a]=v.from(v.uniq(e[a])),t+=e[a].length):0===v.keys(e[a]).length?delete e[a]:v.keys(e[a]).forEach((function(r){e[a][r]=v.from(v.uniq(e[a][r])),t+=e[a][r].length}))},r=0,o=v.keys(e);r<o.length;r++)a(o[r]);return{count:t,ret:e}}(W.collect),t=e.count,a=e.ret;return W.collect=null,{collectKey:0===t?null:JSON.stringify(a),collectMode:"black"}},onIgnoreTag:function(e,t){var a;if(!v.includes(G.blackTags,e)){var r=A(t,(function(e,t,a,r,o){if(-1!==a.indexOf("/"))return f(r);if(o)return"</".concat(a,">");var n=function(e){var t,a=(t=/\s|\n|\t/.exec(e))?t.index:-1;if(-1===a)return{html:"",closing:"/"===e[e.length-2]};var r="/"===(e=e.slice(a+1,-1).trim())[e.length-1];return r&&(e=e.slice(0,-1).trim()),{html:e,closing:r}}(r),i=R(n.html,(function(e,t){var r,o=0;if(G.blackList[a]&&v.includes(G.blackList[a],e)&&(W.collect.blackList[a]=W.collect.blackList[a]||[],W.collect.blackList[a].push(e),o++),G.blackAttrRegExps.length&&G.blackAttrRegExps.some((function(t){return t.test(e)}))&&v.forEach(G.blackAttrRegExps,(function(t){t.test(e)&&(W.collect.blackAttrRegExps.push("".concat(t.toString(),"->").concat(e)),o++)})),G.blackAttrs.length&&v.includes(G.blackAttrs,e)&&(G.blackAttrs.push(e),o++),!o){if(G.filterList&&G.filterList[a]&&v.includes(G.filterList[a],e)){var n=x(t,(function(e){var t;null===(t=W.collect)||void 0===t||t.filterProtocol.push(e)}));return n!==t&&(W.collect.filterList[a]=W.collect.filterList[a]||[],W.collect.filterList[a].push(e)),t?"".concat(e,"='").concat(n,"'"):e}return G.filterAttrs&&v.includes(G.filterAttrs,e)?(n=x(t,(function(e){var t;null===(t=W.collect)||void 0===t||t.filterProtocol.push(e)})),n!==t&&(null===(r=W.collect)||void 0===r||r.filterAttrs.push(e)),t?"".concat(e,"='").concat(n,"'"):e):t?"".concat(e,"='").concat(t,"'"):e}}));return r="<".concat(a),i&&(r+=" ".concat(i)),n.closing&&(r+=" /"),r+">"}),f);return r}null===(a=W.collect)||void 0===a||a.blackTags.push(e)}},K=function(e){var t=e.reportOnly,a=void 0===t||t,r=e.block;return a&&"all"===a?"report":("string"==typeof a&&("true"===a&&(a=!0),"false"===a&&(a=!1)),r?"enforce":a?"report":"enforce")},q=function(e){return function(a,r,o){if(!a||"string"!=typeof a)return a;var n=r;e===F&&(n=W).initCollect();var i=e(a,n);if(P(i)===P(a))return a;if(!o)return i;var s=o.logType,l=K(o),d=n.removeCollect();return L.report(t(t({type:s,disposition:l},d),{sourceText:E(a.replace(/'/g,'"')),filterText:E(i.replace(/'/g,'"'))})),"enforce"===l?i:a}},J=q((function(e,t){return void 0===t&&(t={}),t&&t.whiteList||(t.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}),new C(t).process(e)})),X=q(F),$=(Y=x,function(e,t,a){var r=[],o=Y(e,(function(e){r.push(e)}));if(o===e)return e;r=v.from(v.uniq(r));var n=t||a||{};if(!n)return o;var i=n.logType,s=K(a);return L.report({type:i,disposition:s,collectKey:r.join("___"),collectData:JSON.stringify(r),collectMode:"black",sourceText:E(e),filterText:E(o)}),"enforce"===s?o:e}),Z=w._xssProject||{},Q=w.xssNamespace||{},ee="3.0.30",te={FilterXSS:C,version:ee,webpackPluginVersion:"3.0.39",reportOnly:"all",filterXSS:J,_filterXSS:X,filterUrl:$,BlackConfig:W,project:Z,setProjectName:function(e){Z[e]=this,w._xssProjectName=e}};Q.cc_web_editor_smart_toolbox=te,w.xssNamespace=Q,w.Math&&!w.Math.xssNamespace&&(w.Math.xssNamespace=Q),Z[ee]=te,w.globalThis=w,w.getFilterXss=function(){return void 0!==this._xssProjectName?this._xssProject[this._xssProjectName]:te},w.xss=te,w.isSafeUrl=B,w.isSafeDomain=j,w.isSafeProtocol=D,w._xssProject=Z,w._xssProjectName&&(Z[w._xssProjectName]=te);var ae=te.setProjectName.bind(te);e.BlackConfig=W,e.FilterXSS=C,e._filterXSS=X,e.filterUrl=$,e.filterXSS=J,e.isSafeDomain=j,e.isSafeProtocol=D,e.isSafeUrl=B,e.project=Z,e.setProjectName=ae,e.setXssNamespace=function(e){var t=e.appId,a=e.bid,r=e.region,o=e.isCloseReport;Q[t]=te;var n=W;n.bid=a,n.region=r,n.enabled=!0,n.isCloseReport=o},e.xssNamespace=Q,Object.defineProperty(e,"__esModule",{value:!0})})),(window.webpackChunksmart_toolbox=window.webpackChunksmart_toolbox||[]).push([[3359],{11909:function(e,t,a){a.d(t,{E:function(){return r}});var r=(e=>(e.Month="month",e.Year="year",e))(r||{})},18139:function(e,t,a){a.d(t,{DU:function(){return n},Ub:function(){return o},c:function(){return i}});var r=a(11909),o=(e=>(e.CAPACITY_INSUFFICIENT="CAPACITY_INSUFFICIENT",e.CAPACITY_INSUFFICIENT_WITH_BUY="CAPACITY_INSUFFICIENT_WITH_BUY",e.CAPACITY_BUY="CAPACITY_BUY",e.UPLOAD_FULL_SPACE_RESOLVE="UPLOAD_FULL_SPACE_RESOLVE",e.VIP_BUY="VIP_BUY",e.MANAGEMENT="MANAGEMENT",e))(o||{});const n={[r.E.Month]:"web_cash_and_pay_text_month",[r.E.Year]:"web_cash_and_pay_text_year"};var i=(e=>(e.UpgradeToPro="upgrade_to_pro",e.profileIconUpgrade="profile_icon_upgrade",e.spaceUpgrade="space_upgrade",e.spaceLimitUpgrade="space_limit_upgrade",e.removeWatermarkUpgrade="remove_watermark_upgrade",e.allowDownloadUpgrade="allow_download_upgrade",e.editUpgradeToUnlock="edit_upgrade_to_unlock",e.exportUpgradeToPro="export_upgrade_to_pro",e.notification="notification",e))(i||{})},56464:function(e,t,a){a.d(t,{C5:function(){return n},Ib:function(){return s},NZ:function(){return i},ij:function(){return o},vN:function(){return l}});var r=a(62289);a(89934);function o(e){return[r.O.modalWorkspace,r.O.uploadShare].includes(e)}function n(e){return[r.O.detailPage,r.O.sharePage,r.O.embedPage,r.O.workspace,r.O.sharedLinks,r.O.receivedLinks,r.O.modalWorkspace,r.O.uploadShare,r.O.smartTool].includes(e)}function i(e,t){return t||"smart_tool_page"===e?{editor:r.O.videoEditor,template_editor:r.O.templateEditor,picture_edit:r.O.graphicEditor,smart_tool_page:r.O.smartTool}[e]:r.O.taskList}function s(e){return![r.O.detailPage,r.O.sharePage,r.O.embedPage,r.O.workspace,r.O.sharedLinks,r.O.taskList,r.O.receivedLinks,r.O.modalWorkspace,r.O.uploadShare,r.O.smartTool].includes(e)}function l(e){return e===r.O.smartTools}},65450:function(e,t,a){a(43666),a(13398),a(78436),a(63724),a(87025),a(98634);var r=a(77024),o=a(420),n=a(36096),i=a(38e3),s=a(14148),l=a(67308),d=a(62289),c=a(53919),u=a(37814),p=a(66696),_=a(58519),f=a(4271),v=a(45505),h=a(24110),m=a(62281),g=a(91093),S=a(69912),T=(a(89934),a(57691)),I=(a(80218),a(45475),a(46538),a(30395)),E=a.n(I),y=(a(85333),a(87176)),k=(a(13819),a(9932),a(33102),a(8608),a(81324),a(11444)),A=a(42579),R=a.n(A),N=(a(78790),a(91485),a(3501)),P=a(9837),C=(a(14936),a(97834)),b=(a(77746),a(46645)),O=a(66279),w=(a(69628),a(6321),a(63609),a(60591)),L=a(95904),F=a(4663),U=(a(57069),a(16081)),D=(a(47881),a(68742));Object.defineProperty;const{COMMENT:x}=m.E,{GROUP:M}=(x.Err_NoCommentPermission,s.F2.t("web_sharereview_toast_no_comment_permission",{},"The operation failed, the sharer has turned off the comment permission"),x.Err_CommentPublishFailed,s.F2.t("web_sharereview_toast_comment_fail",{},"Failed to post a comment"),x.Err_CommentPublishFailedDuplication,s.F2.t("web_sharereview_toast_comment_repeat",{},"Failed to post comment, duplicate comment"),x.Err_CommentPublishingProhibited,s.F2.t("web_sharereview_toast_prohibit_comment",{},"Do not post comments"),x.Err_CommentPublishFailedRateLimit,s.F2.t("web_sharereview_toast_frequency_limit",{},"Failed to post comment, frequency limit reached"),x.Err_CommentPublishFailedRiskControl,s.F2.t("web_sharereview_toast_risk_controlled",{},"Failed to post a comment, was controlled by wind"),x.Err_CommentDeletionFailed,s.F2.t("web_sharereview_toast_delete_comment_fail",{},"Failed to delete comment"),x.Err_DeletionFailedNoPermission,s.F2.t("web_sharereview_toast_comment_without_permission",{},"Delete failed, no permission"),x.Err_CommentListFetchFailed,s.F2.t("web_sharereview_toast_get_list_fail",{},"Failed to get list of comments"),m.E),B=(M.INVITATION_LINK_REFRESH_TOO_FAST,M.USER_NOT_IN_GROUP,M.CREATE_GROUP_TOO_FAST,M.EXCEEDED_CREATE_GROUPS_MAX_LIMIT,M.EXCEEDED_USER_GROUPS_MAX_LIMIT,M.INVITATION_LINK_EXPIRED,M.ADD_GROUP_TOO_FAST,M.EXCEEDED_GROUP_MEMBERS_MAX_LIMIT,M.REPEAT_ADD_GROUP,M.INVITATION_LINK_ERROR,M.SHARE_LINK_EXPIRED,M.GROUP_APPLY_LIMIT,M.SAME_GROUP_APPLY_LIMIT,M.GROUP_APPLY_PENDING,M.GROUP_APPLY_NOT_ALLOW,M.GROUP_APPLY_PASSED,M.GROUP_MEMBER_FULL,M.APPLY_APPROVE_NO_AUTH,M.NOT_IN_GROUP,M.APPROVAL_PROCESSED,M.APPROVAL_EXPIRED,{video:[".mp4",".mov",".m4v",".flv",".mkv",".avi",".webm",".wmv",".rm",".rmvb",".3gp",".m2ts",".mt2s",".m2t",".mxf",".mpg",".mpeg",".mpe",".ts"],audio:[".mp3",".flac",".m4a",".wav",".aac",".oga",".ogg",".wma",".amr",".aif",".aiff",".ac3",".mpa",".ape",".mac",".mp2",".acc"],image:[".jpeg",".jpg",".png",".gif",".heif",".heic"]});var j=(e=>(e[e.null=0]="null",e[e.Image=1]="Image",e[e.Video=2]="Video",e))(j||{}),H=(e=>(e[e.null=0]="null",e[e.GoogleDrive=1]="GoogleDrive",e))(H||{}),G=(e=>(e[e.Pending=1]="Pending",e[e.Running=2]="Running",e[e.Success=3]="Success",e[e.Fail=4]="Fail",e[e.Abnormal=5]="Abnormal",e))(G||{}),V=(e=>(e[e.QuitWithoutBegin=-4]="QuitWithoutBegin",e[e.Cancel=-3]="Cancel",e[e.ExpandInsufficient=-2]="ExpandInsufficient",e[e.Fail=-1]="Fail",e[e.Finish=0]="Finish",e[e.Uploading=1]="Uploading",e[e.Exist=2]="Exist",e))(V||{});const z={baseURL:"/lv/v1/asset_auto_sync",method:"POST",headers:{loc:m.P.CHANNEL,lan:s.Ay.language||m.P.LAN,pf:m.P.APP_PF,appvr:m.P.VERSION,tdid:"","sign-ver":1,"app-sdk-version":m.P.APP_SDK_VERSION}},Y=m.b.createAxios(z);Y.interceptors.request.use((e=>{const{pf:t,appvr:a,tdid:r}=z.headers;return Object.assign(e.headers,(0,m.c)({url:`${e.baseURL}${e.url}`,pf:t,appvr:a,tdid:r})),e})),Y.interceptors.response.use((e=>{if(200===e.status){const t=e.data;return"0"===t.ret?Promise.resolve(t):Promise.reject(e)}return Promise.reject(e)}));const W={async createTaskRunnerConfig(e){const t={task_meta:{id:e.id,is_on:e.isOn,type:e.type,source_info:e.sourceInfo?JSON.stringify({folder_id:e.sourceInfo.folderId,folder_name:e.sourceInfo.folderName}):void 0,destination_info:JSON.stringify({workspace_id:e.destinationInfo.workspaceId}),file_type:e.fileType,run_plan:e.runPlan?{local_timezone:e.runPlan.localTimezone,tz_offset_hours:e.runPlan.tzOffsetHours,local_hour:e.runPlan.localHour}:void 0}},a=await Y({url:"/upsert_task",data:t});return{...a,data:{taskMeta:{id:a.data.task_meta.id,isOn:a.data.task_meta.is_on,type:a.data.task_meta.type,sourceInfo:a.data.task_meta.source_info?JSON.parse(a.data.task_meta.source_info):void 0,destinationInfo:a.data.task_meta.destination_info?JSON.parse(a.data.task_meta.destination_info):void 0,fileType:a.data.task_meta.file_type,runPlan:a.data.task_meta.run_plan?{localTimezone:a.data.task_meta.run_plan.local_timezone,tzOffsetHours:a.data.task_meta.run_plan.tz_offset_hours,localHour:a.data.task_meta.run_plan.local_hour}:void 0}}}},async updateTaskRunnerConfig(e){const t={task_meta:{id:e.id,is_on:e.isOn,type:e.type,source_info:JSON.stringify(e.sourceInfo),destination_info:JSON.stringify(e.destinationInfo),file_type:e.fileType,run_plan:e.runPlan?{local_timezone:e.runPlan.localTimezone,tz_offset_hours:e.runPlan.tzOffsetHours,local_hour:e.runPlan.localHour}:void 0}};return await Y({url:"/upsert_task",data:(0,O.A)(t,b.A)})},async closeTaskRunner(e){const t={task_meta:{id:e.id,is_on:!1}};return await Y({url:"/upsert_task",data:t})},async getTaskRunnerConfig(){var e,t,a;const r=await Y({url:"/get_task"});try{const o=null!=(t=null==(e=r.data)?void 0:e.task_meta)&&t.source_info?JSON.parse(r.data.task_meta.source_info):void 0;return{...r,data:{taskMeta:r.data.task_meta?{id:r.data.task_meta.id,isOn:r.data.task_meta.is_on,type:r.data.task_meta.type,sourceInfo:o?{folderId:o.folder_id,folderName:o.folder_name}:void 0,destinationInfo:null!=(a=r.data.task_meta)&&a.destination_info?JSON.parse(r.data.task_meta.destination_info):void 0,fileType:r.data.task_meta.file_type,runPlan:r.data.task_meta.run_plan&&r.data.task_meta.run_plan.local_timezone?{localTimezone:r.data.task_meta.run_plan.local_timezone,tzOffsetHours:r.data.task_meta.run_plan.tz_offset_hours,localHour:r.data.task_meta.run_plan.local_hour}:void 0}:void 0}}}catch(o){throw m.s.error("FileSnc-Api/get_task",o,{res:JSON.stringify(r)}),o}},async getTasks(e){const t={with_workspace:e.workspaceId,only_running:e.status===G.Running},a=await Y({url:"/get_instance",data:t}),r=e=>{if(!e)return{sizeSum:0,files:[]};const t=JSON.parse(e)??{};return{sizeSum:t.size_sum??0,files:(t.file_list??[]).map((e=>({fileId:e.file_id,name:e.name,size:e.size,url:e.url,md5:e.md5})))}},o=e=>{const t=JSON.parse(e);return{destinationInfo:{workspaceId:JSON.parse(t.destination_info).workspace_id},error:{code:t.error_code,msg:t.error_message}}};try{return{...a,data:{tasks:(a.data.instances??[]).filter((e=>e.extra)).map((e=>({id:e.id,taskId:e.task_id,callType:e.call_type,assetsInfo:r(e.assets_info),extra:o(e.extra),taskType:e.task_type,status:e.status,createAt:e.create_at?1e3*e.create_at:e.create_at,finishAt:e.finish_at?1e3*e.finish_at:e.finish_at})))}}}catch(n){throw console.error("error",n),m.s.error("FileSnc-Api-/get_task",n,{res:JSON.stringify(a)}),n}},async getFilesProgressByTaskId(e){const t={instance_id:e.taskId},a=await Y({url:"/get_progress",data:t});try{return{...a,data:{taskId:String(e.taskId),files:(a.data.results??[]).map((e=>({fileId:String(e.FileID),progress:e.Progress,status:e.Status,metadata:e.Metadata,finishAt:e.FinishAt})))}}}catch(r){throw m.s.error("FileSnc-Api-/get_progress",r,{res:JSON.stringify(a)}),r}},async cancelTask(e){const t={instance_id:e.taskId};return await Y({url:"/file/cancel_upload",data:t})},async retryTask(e){const t={instance_id:e.taskId};return await Y({url:"/retry_instance",data:t})},async immediateTask(e){const t={task_id:e.taskId};return await Y({url:"/execute",data:t})}};var K=(e=>(e.SHOW="show",e.CONFIRM="confirm",e.CANCEL="cancel",e.OPEN="open",e.CLOSE="close",e))(K||{});let q=Date.now();function J(e,t){const a=e.reduce(((e,t)=>{var a;return e[null==(a=null==t?void 0:t.base_info)?void 0:a.id]=t,e}),{}),r=Date.now()-q>3e6;return q=r?Date.now():q,t.forEach((e=>{var t,o,n,i,s,l,d,c;const u=a[null==(t=null==e?void 0:e.base_info)?void 0:t.id];null!=e&&e.base_info&&(e.base_info.cover_url=u&&!r?null==(o=null==u?void 0:u.base_info)?void 0:o.cover_url:null==(n=null==e?void 0:e.base_info)?void 0:n.cover_url),null!=e&&e.render_info&&(e.render_info.progress=u?Math.max((null==(i=null==u?void 0:u.render_info)?void 0:i.progress)??0,null==(s=null==e?void 0:e.render_info)?void 0:s.progress):null==e?void 0:e.render_info.progress),null!=e&&e.share_info&&(e.share_info.progress=u?Math.max((null==(l=null==u?void 0:u.share_info)?void 0:l.progress)??0,null==(d=null==e?void 0:e.share_info)?void 0:d.progress):null==(c=null==e?void 0:e.share_info)?void 0:c.progress)})),t}function X(e){return e.map((e=>(0,u.A)(e,(e=>null!=e))))}(0,p.O)({id:"filmTaskListMachine",context:{showEntrance:!1,cursor:0,hasMore:!1,underwayAndFailList:[],successList:[]},initial:"close",invoke:[{id:"asyncTaskActor",src:v.L},{id:"getTaskList",src:"getTaskList"}],states:{close:{on:{OPEN:{target:"open"},NOTICE:[{actions:["fetchSuccessOrFailTaskList"],cond:"shouldNotice"},{actions:["updateTaskListAndListCount"],cond:"shouldAssignUpdateTaskListAndListCount"}],NOTICE_PROGRESS:[{actions:["updateTaskListProgress"]}],NOTICE_SUCCESS:{actions:["updateUnderwayAndFailFilmTaskListFromFetch","sendSuccessTaskNotification","sendFailTaskNotification"]},NOTICE_FAIL:{}}},open:{entry:["reportTaskListPopup"],initial:"ready",states:{ready:{}},on:{CLOSE:{target:"close"}}}},on:{NOTICE:{actions:["updateTaskListAndListCount"],cond:"shouldAssignUpdateTaskListAndListCount"},RETRY:{actions:["retryFilmTaskAndFetchFilmTaskList","resetTaskProgress","saveRetryTask"]},RETRY_FAIL:{actions:["saveShowModalType"]},CLEAR_SHOW_MODAL_TYPE:{actions:["clearShowModalType"]},CANCEL:{actions:["cancelFilmTaskAndFetchFilmTaskList"]},CANCEL_SUCCESS:{actions:["removeFilmTaskFromExportingAndFailList","updateIsCancelBefore"]},CANCEL_FAIL:{},DELETE:{actions:["deleteFilmTaskAndFetchFilmTaskList"]},DELETE_SUCCESS:{actions:["removeFilmTaskFromExportingAndFailList","updateIsCancelBefore"]},DELETE_FAIL:{}}},{services:{getTaskList:e=>t=>{let a,r=3e3,o=[],n={},i=!0;const s=(e,t)=>{if(!t)return;const a=o.findIndex((e=>e.render_task_id===t));"number"==typeof a&&a>=0&&o.length>a&&(o[a].progress=e)};const l=async(e=!1)=>{const[a]=await(0,h.a)(Promise.all([f.p.getTaskList({status:[v.l.Success],cursor:0,count:5}),f.p.getTaskList({status:[v.l.Underway,v.l.Fail],cursor:0,count:100})]));if(a){const l=a[1].data.common_tasks;(e=>{const a=e.map((e=>e.render_info)).filter((e=>!(!e||(null==e?void 0:e.render_task_status)!==v.o.Underway)));o=o.map((e=>{var r;const{instance:i}=e,l=null==(r=a.find((t=>(null==t?void 0:t.render_task_id)===(null==e?void 0:e.render_task_id))))?void 0:r.progress;if(l&&100===l)return{render_task_id:e.render_task_id,instance:i,progress:100};{const a=Math.floor((new Date).getTime()/1e3);return e.expect_finish_time&&a>e.expect_finish_time?{render_task_id:e.render_task_id,instance:i,progress:99}:(i.setOption({initProgress:0,maxProgress:99,createTime:Number(e.create_time??0),expectFinishTime:Number(e.expect_finish_time??0),callback:a=>{s(a,null==e?void 0:e.render_task_id),t(Object.assign(n,{mockInstanceList:o}))}}),{render_task_id:e.render_task_id,instance:i,progress:e.progress,create_time:Number(e.create_time??0),expect_finish_time:Number(e.expect_finish_time??0)})}})),o=[...(0,c.A)(a,o,"render_task_id").map((e=>{const a=new g.L;return a.setOption({initProgress:0,maxProgress:99,createTime:Number((null==e?void 0:e.create_time)??0),expectFinishTime:Number((null==e?void 0:e.expect_finish_time)??0),callback:a=>{s(a,null==e?void 0:e.render_task_id),t(Object.assign(n,{mockInstanceList:o}))}}),{render_task_id:(null==e?void 0:e.render_task_id)??"0",instance:a,progress:(null==e?void 0:e.progress)??0,create_time:Number((null==e?void 0:e.create_time)??0),expect_finish_time:Number((null==e?void 0:e.expect_finish_time)??0)}})),...o]})(l);const d=a[1].data.interval;d&&(r=1e3*d),i=!0,l.some((e=>{var t,a;return(null==(t=e.base_info)?void 0:t.status)===v.l.Underway&&(null==(a=e.base_info)?void 0:a.task_type)===v.k.Long2Short}))&&(r=3e3,i=!1);const u={type:"NOTICE",successData:a[0].data.common_tasks,underwayAndFailData:l,isFirstTime:e};n={type:"NOTICE_PROGRESS"},t(u)}};return l(!0),S.W.getInstance({isBoe:!!e.isBoe}).auth(e.uid).then((e=>{e.registerMessageCb(S.a.TaskListRefresh,(()=>{console.log(`TASK_LIST: from WebsocketMessageMethods.TaskListRefresh ${S.a.TaskListRefresh} enableWebsocket: ${i}`),i&&l()}))})),function e(){a=setTimeout((async()=>{await l(),e()}),r)}(),()=>{a&&clearTimeout(a)}}},actions:{updateTaskListAndListCount:(0,_.kp)({underwayAndFailList:({underwayAndFailList:e},t)=>J(e,t.underwayAndFailData),successList:({successList:e},t)=>J(e,t.successData),showEntrance:(e,t)=>{var a,r;return(null==(a=t.underwayAndFailData)?void 0:a.length)>0||(null==(r=t.successData)?void 0:r.length)>0}}),updateTaskListProgress:(0,_.kp)({mockInstanceList:({mockInstanceList:e},t)=>(null==t?void 0:t.mockInstanceList)??e}),updateUnderwayAndFailFilmTaskListFromFetch:(0,_.kp)({underwayAndFailList:({underwayAndFailList:e},t)=>J(e,t.data.underwayAndFailList)}),retryFilmTaskAndFetchFilmTaskList:(0,_.tN)((({retryTaskInfo:e},t)=>({type:"ADD_TASK",exec:async()=>{var a,r,o,n,i,s;const{task:l,changeUserRetry:c}=t,u=(0,v.r)().getConfig().header,p={header:u,client_ip:"",params:{scenario:"custom",is_pwa:(0,d.i)()?1:0,pwa_from:(0,d.w)(),open_from_pwa:(0,d.e)()?1:0},user:{user_id:null==t?void 0:t.uid,user_is_login:!0,user_unique_id:null==t?void 0:t.uid,web_id:u.custom.web_id}};c&&((null==(a=null==e?void 0:e.share_info)?void 0:a.platform)===v.i.Tiktok?await d.t.shareToTikTok({share_id:null==e?void 0:e.share_info.share_id,distinguish_account:!1,custom_info:JSON.stringify(p)}):(null==(r=null==e?void 0:e.share_info)?void 0:r.platform)===v.i.Ttam?await d.t.shareToTtam({share_id:null==e?void 0:e.share_info.share_id,custom_info:JSON.stringify(p)}):(null==(o=null==e?void 0:e.share_info)?void 0:o.platform)===v.i.Youtube&&await d.t.shareToYouTube({share_id:null==e?void 0:e.share_info.share_id,custom_info:JSON.stringify(p)})),(null==(n=l.base_info)?void 0:n.task_type)===v.k.Export&&null!=(i=null==l?void 0:l.render_info)&&i.render_task_id&&await v.a.retryRenderTask({task_id:l.render_info.render_task_id}),(null==(s=l.base_info)?void 0:s.task_type)===v.k.Share&&l.share_info&&(l.share_info.platform===v.i.Tiktok?await d.t.shareToTikTok({share_id:l.share_info.share_id,distinguish_account:!0,custom_info:JSON.stringify(p)}):l.share_info.platform===v.i.Ttam?await d.t.shareToTtam({share_id:l.share_info.share_id,custom_info:JSON.stringify(p)}):l.share_info.platform===v.i.Youtube&&await d.t.shareToYouTube({share_id:l.share_info.share_id,custom_info:JSON.stringify(p)}))},successType:"",failType:"RETRY_FAIL"})),{to:"asyncTaskActor"}),cancelFilmTaskAndFetchFilmTaskList:(0,_.tN)((({onServerError:e},t)=>({type:"ADD_TASK",exec:async()=>{var a,r,o,n;const{task:i}=t;let s;if((null==(a=i.base_info)?void 0:a.task_type)===v.k.Export&&null!=(r=null==i?void 0:i.render_info)&&r.render_task_id){const[,e]=await(0,h.a)(v.a.cancelRenderTask({task_id:i.render_info.render_task_id}));s=e}if((null==(o=i.base_info)?void 0:o.task_type)===v.k.Share&&i.share_info&&[v.i.Tiktok,v.i.Ttam,v.i.Youtube,v.i.Facebook].includes(i.share_info.platform)){const[,e]=await(0,h.a)(d.t.cancelUploadTask({id:i.share_info.share_id}));s=e}if(s)throw null==e||e(Number(null==(n=null==s?void 0:s.data)?void 0:n.ret)),s;return{id:i.base_info.id,status:i.base_info.status}},successType:"CANCEL_SUCCESS",failType:"CANCEL_FAIL"})),{to:"asyncTaskActor"}),deleteFilmTaskAndFetchFilmTaskList:(0,_.tN)((({onServerError:e},t)=>({type:"ADD_TASK",exec:async()=>{var a,r,o,n,i;const{task:s}=t;let l;if((null==(a=s.base_info)?void 0:a.task_type)!==v.k.Long2Short||null==(r=null==s?void 0:s.base_info)||!r.id)throw l=new Error("task type error or no id exist"),l;{const[,e]=await(0,h.a)(f.p.deleteRenderTask({task_id:null==(o=null==s?void 0:s.base_info)?void 0:o.id,task_type:null==(n=s.base_info)?void 0:n.task_type}));l=e}if(l)throw null==e||e(Number(null==(i=null==l?void 0:l.data)?void 0:i.ret)),l;return{id:s.base_info.id,status:s.base_info.status}},successType:"DELETE_SUCCESS",failType:"DELETE_FAIL"})),{to:"asyncTaskActor"}),fetchSuccessOrFailTaskList:(0,_.tN)((({underwayAndFailList:e},t)=>({type:"ADD_TASK",exec:async()=>{const a=t.underwayAndFailData,r=new Set(a.map((e=>{var t;return null==(t=null==e?void 0:e.base_info)?void 0:t.id}))),o=e.reduce(((e,t)=>{var a;return e[null==(a=null==t?void 0:t.base_info)?void 0:a.id]=t,e}),{}),n=e.filter((e=>{var t;return!r.has(null==(t=null==e?void 0:e.base_info)?void 0:t.id)}));let i=[];if(n.length>0){const{data:{common_tasks:e}}=await f.p.batchGetTask({task_ids:n.map((e=>{var t;return null==(t=null==e?void 0:e.base_info)?void 0:t.id}))});i=n.map((t=>{const a=e.find((e=>{var a,r;return(null==(a=e.base_info)?void 0:a.id)===(null==(r=null==t?void 0:t.base_info)?void 0:r.id)}));return a?(function(e){var t;const{file_id:a,file_workspace_id:r,video_name:o,format:n}=e.base_info,i=null==(t=e.render_info)?void 0:t.render_task_id;if((0,m.g)().getTikTokReflowTaskList().includes(i)){if(!(0,m.g)().getReflowFlag())return;const t=e.base_info;t.fileId=a,t.workspaceId=r,t.type=`video/${n}`,t.title=o,(0,m.r)(t)}}(a),{...a}):null})).filter((e=>null!==e))}const s=a.filter((e=>{var t,a,r;const n=o[null==(t=null==e?void 0:e.base_info)?void 0:t.id];return(null==(a=null==n?void 0:n.base_info)?void 0:a.status)===v.l.Underway&&(null==(r=null==e?void 0:e.base_info)?void 0:r.status)===v.l.Fail}));return{underwayAndFailList:a,successList:i,failList:s}},successType:"NOTICE_SUCCESS",failType:"NOTICE_FAIL"})),{to:"asyncTaskActor"}),sendSuccessTaskNotification:({successListCallback:e},t)=>{null==e||e(t.data.successList)},sendFailTaskNotification:({failListCallback:e},t)=>{null==e||e(t.data.failList)},removeFilmTaskFromExportingAndFailList:(0,_.kp)({underwayAndFailList:({underwayAndFailList:e},t)=>e.filter((e=>{var a;return(null==(a=null==e?void 0:e.base_info)?void 0:a.id)!==t.data.id}))}),resetTaskProgress:(0,_.kp)({underwayAndFailList:({underwayAndFailList:e},t)=>e.map((e=>{var a,r,o;const n=(null==(r=null==(a=t.task)?void 0:a.base_info)?void 0:r.id)===(null==(o=null==e?void 0:e.base_info)?void 0:o.id);return n&&null!=e&&e.share_info?{...e,base_info:{...e.base_info,status:v.l.Underway},share_info:{...null==e?void 0:e.share_info,status:v.m.Underway,progress:0}}:n&&null!=e&&e.render_info?{...e,base_info:{...e.base_info,status:v.l.Underway},render_info:{...null==e?void 0:e.render_info,status:v.o.Underway,progress:0}}:e}))}),saveRetryTask:(0,_.kp)({retryTaskInfo:({retryTaskInfo:e},t)=>{const{task:a,changeUserRetry:r}=t;return r?e:a}}),clearShowModalType:(0,_.kp)({showModalType:()=>{}}),saveShowModalType:(0,_.kp)({showModalType:({showModalType:e},t)=>{var a,r;const o=null==(r=null==(a=null==t?void 0:t.data)?void 0:a.data)?void 0:r.ret;return"200925"===o?2:"200922"===o?1:"201705"===o?4:e}}),reportTaskListPopup:({exportReporter:e})=>{null==e||e.reportTaskListPopup({action:K.SHOW})}},guards:{shouldNotice:({underwayAndFailList:e},t)=>{const{underwayAndFailData:a,isFirstTime:r}=t;if(r)return!1;const o=a.reduce(((e,t)=>{var a;return e[null==(a=null==t?void 0:t.base_info)?void 0:a.id]=t,e}),{});return e.some((e=>{var t,a,r;const n=o[null==(t=null==e?void 0:e.base_info)?void 0:t.id];return!n||(null==(a=null==e?void 0:e.base_info)?void 0:a.status)===v.l.Underway&&(null==(r=null==n?void 0:n.base_info)?void 0:r.status)===v.l.Fail}))},shouldAssignUpdateTaskListAndListCount:({successList:e,underwayAndFailList:t},a)=>{try{if(JSON.stringify(X(e))===JSON.stringify(X(a.successData))&&JSON.stringify(X(t))===JSON.stringify(X(a.underwayAndFailData)))return!1}catch(r){return m.s.error("shouldAssignUpdateTaskListAndListCount",r),!0}return!0}}});const $={tasksStack:"_tasksStack_2vz98_1",tasksStackList:"_tasksStackList_2vz98_5",taskSeeMore:"_taskSeeMore_2vz98_9",tasksStackHeader:"_tasksStackHeader_2vz98_19",tasksStackHeaderIcon:"_tasksStackHeaderIcon_2vz98_34",tasksStackHeaderName:"_tasksStackHeaderName_2vz98_44",taskList:"_taskList_2vz98_50",taskGroup:"_taskGroup_2vz98_57",taskGroupTitle:"_taskGroupTitle_2vz98_60",taskGroupTitleName:"_taskGroupTitleName_2vz98_72",taskGroupTitleAction:"_taskGroupTitleAction_2vz98_75",task:"_task_2vz98_1",taskCover:"_taskCover_2vz98_90",taskCoverImage:"_taskCoverImage_2vz98_102",taskCoverImage_Normal:"_taskCoverImage_Normal_2vz98_111",taskCoverFile:"_taskCoverFile_2vz98_114",taskName:"_taskName_2vz98_120",taskDetail:"_taskDetail_2vz98_127",taskDetailMore:"_taskDetailMore_2vz98_132",taskDetailError:"_taskDetailError_2vz98_136",taskDetailErrorAction:"_taskDetailErrorAction_2vz98_141",taskDetailErrorMessage:"_taskDetailErrorMessage_2vz98_153",taskDetailErrorMessageText:"_taskDetailErrorMessageText_2vz98_162",taskInfo:"_taskInfo_2vz98_165",taskInfoItem:"_taskInfoItem_2vz98_172",taskInfoDivider:"_taskInfoDivider_2vz98_184",taskCompleteTime:"_taskCompleteTime_2vz98_191",taskContent:"_taskContent_2vz98_199",taskContentTransferRate:"_taskContentTransferRate_2vz98_208",taskAction:"_taskAction_2vz98_216",taskActionItem:"_taskActionItem_2vz98_233",taskActionTooltip:"_taskActionTooltip_2vz98_250",nothing:"_nothing_2vz98_254",nothingIcon:"_nothingIcon_2vz98_260",nothingText:"_nothingText_2vz98_263"},Z=e=>(0,i.jsxs)("div",{className:$.nothing,children:[(0,i.jsx)("div",{className:$.nothingIcon,children:(0,i.jsx)(T.BY9,{size:40})}),(0,i.jsx)("div",{className:$.nothingText,children:e.text})]}),Q="_contentTooltip_kraj2_1",ee="_content_kraj2_1",te="_lineClamp_kraj2_11",ae=({content:e,contentClassName:t,contentStyle:a,tooltipContent:r,tooltipClassName:o,forceTooltip:s,lines:d,onTooltipVisibleChange:c,getPopupContainer:u=(()=>document.body),position:p,explainContent:_})=>{const f=(0,l.useRef)(null),[v,h]=(0,l.useState)(0),[m,g]=(0,l.useState)(!0);(0,l.useEffect)((()=>{if(0===v&&f.current){const{scrollHeight:e,clientHeight:t,scrollWidth:a,clientWidth:r}=f.current;e>t||a>r?(h(1),g(!1)):h(2)}}),[]);const S=(0,i.jsxs)(i.Fragment,{children:[(s||!m)&&(r??e),_]}),T=!s&&m&&!_;return(0,i.jsx)(n.A,{className:E()(Q,o),content:S,disabled:T,onVisibleChange:c,position:p,getPopupContainer:u,children:(0,i.jsx)("div",{className:E()(ee,te,t),style:{WebkitLineClamp:d,cursor:T?"default":"pointer",...a},ref:f,children:e})})},re=e=>{const t={size:"32px"},[a]=Object.entries(B).find((([,t])=>t.some((t=>e.name.endsWith(t)))))??[];let r=(0,i.jsx)(T.aBx,{...t});switch(a){case"video":r=(0,i.jsx)(T.Qjn,{...t});break;case"audio":r=(0,i.jsx)(T.RMT,{...t});break;default:r=(0,i.jsx)(T.aBx,{...t})}return(0,i.jsx)("div",{className:$.taskCoverFile,children:r})},oe=e=>{const[t,a]=(0,l.useState)(!1),[r,o]=(0,l.useState)(!0);return(0,i.jsxs)("div",{children:[r||t?(0,i.jsx)(re,{name:".jpg"}):null,(0,i.jsx)("img",{className:E()($.taskCoverImage,{[$.taskCoverImage_Normal]:!r&&!t}),crossOrigin:"anonymous",src:e.src,onError:()=>{a(!0),o(!1)},onLoad:()=>{o(!1),a(!1)}})]})},ne=e=>{let t=(0,i.jsx)(k.A,{percent:100*(e.data.percent??0),showText:!1});return"fail"===e.data.status&&(t=(0,i.jsx)(k.A,{percent:100,status:"error",showText:!1})),"pending"===e.data.status&&(t=(0,i.jsx)(k.A,{percent:0,status:"error",showText:!1})),(0,i.jsx)("div",{className:"file-uploader-item-progress",children:t})},ie=e=>e.record.actions?(0,i.jsx)("div",{className:$.taskAction,"data-action-max-count":e.actionMaxCount,children:e.record.actions.map(((t,a)=>(0,i.jsx)(n.A,{className:$.taskActionTooltip,content:t.text,getPopupContainer:e.getPopupContainer,children:(0,i.jsx)("div",{className:$.taskActionItem,onClick:()=>t.handler(e.record),children:t.icon})},a)))}):null,se=e=>(0,i.jsx)("div",{className:$.taskInfo,children:e.map(((t,a)=>{const r=(0,i.jsx)("span",{className:$.taskInfoDivider},`divider${a}`),o=(0,i.jsx)(ae,{contentClassName:$.taskInfoItem,contentStyle:{width:t.width??"auto"},content:t.content},`info${a}`);return a<e.length-1?[o,r]:[o]})).flat()}),le=e=>{var t,a,r;return(0,i.jsx)("div",{className:$.taskDetailErrorMessage,children:(0,i.jsx)(ae,{content:(null==(t=e.data.error)?void 0:t.text)??s.F2.t("web_material_text_failed",{},"Failed"),tooltipContent:(null==(a=e.data.error)?void 0:a.msg)??(null==(r=e.data.error)?void 0:r.text),contentClassName:$.taskDetailErrorMessageText})})},de=e=>{var t,a;const r=null!=(t=e.record.data.error)&&t.strong?(0,i.jsxs)("div",{className:$.taskDetailError,children:[le(e.record),e.record.data.error.action?(0,i.jsx)("span",{className:$.taskDetailErrorAction,onClick:e.record.data.error.action.handler,children:e.record.data.error.action.text}):null]}):null,o=(0,i.jsxs)("div",{className:$.taskDetail,children:[e.record.infos?se(e.record.infos):null,(0,i.jsx)("div",{className:$.taskDetailMore,children:"fail"===e.record.data.status?le(e.record):"running"===e.record.data.status?(0,i.jsx)("div",{className:$.taskContentTransferRate,children:e.record.data.transferRate}):null})]});return null!=(a=e.record.data.error)&&a.strong?r:o};function ce(e){var t,a;let r=null==(t=e.record.data.icon)?void 0:t.content;return"string"==typeof r&&(r=(0,i.jsx)(oe,{src:r})),!r&&"string"==typeof e.record.data.name&&(r=(0,i.jsx)(re,{name:e.record.data.name})),(0,i.jsx)("div",{className:$.taskCover,style:{background:null==(a=e.record.data.icon)?void 0:a.backgroundColor},children:r})}function ue(e){var t;const a=(0,l.useRef)(null);return(0,i.jsxs)("div",{className:$.task,onClick:()=>{var t,a;return null==(a=(t=e.record).preview)?void 0:a.call(t,e.record)},children:[(0,i.jsx)(ce,{record:e.record}),(0,i.jsxs)("div",{className:$.taskContent,children:[(0,i.jsx)(ae,{contentClassName:$.taskName,contentStyle:{width:"100%"},content:e.record.data.name}),"success"!==e.record.data.status?ne(e.record):null,(0,i.jsx)(de,{record:e.record}),"success"===e.record.data.status?(0,i.jsx)("div",{className:$.taskCompleteTime,children:R()(e.record.data.finishAt).format("MMM DD, YYYY HH:mm:ss")}):null]}),null!=(t=e.record.actions)&&t.length?(0,i.jsx)(ie,{record:e.record,actionMaxCount:e.actionMaxCount,getPopupContainer:e=>a.current??e}):null]})}const pe=(e,t)=>(0,i.jsxs)("div",{className:$.taskGroupTitle,children:[(0,i.jsx)("div",{className:$.taskGroupTitleName,children:e.name}),e.action?(0,i.jsx)("span",{className:$.taskGroupTitleAction,onClick:()=>{var a;return null==(a=e.action)?void 0:a.handler(t)},children:e.action.text}):null]}),_e=e=>{const t=Math.max(...e.tasksGroup.map((e=>e.tasks.map((e=>{var t;return(null==(t=e.actions)?void 0:t.length)??0})))).flat());return(0,i.jsx)("div",{className:$.taskList,children:e.tasksGroup.filter((({tasks:e})=>e.length>0)).map((({group:e,tasks:a},r)=>(0,i.jsxs)("div",{className:$.taskGroup,children:[pe(e,a),a.map(((e,a)=>(0,i.jsx)(ue,{record:e,actionMaxCount:t},a)))]},r)))})},fe=e=>e?(0,i.jsxs)("div",{className:$.tasksStackHeader,children:[(0,i.jsx)("div",{className:$.tasksStackHeaderIcon,onClick:e.goBack,children:e.icon}),(0,i.jsx)("div",{className:$.tasksStackHeaderName,children:e.title})]}):null;(0,C.PA)((e=>{const t=e.dataSource.map(((e,t)=>{const a=e.tasksGroup.some((({tasks:e})=>e.length>0));return(0,i.jsxs)("div",{className:$.tasksStackList,children:[e.header?fe(e.header):null,a?(0,i.jsx)(_e,{...e}):(0,i.jsx)(Z,{text:s.F2.t("web_material_text_no_files_being",{},"Your synced files will appear here.")}),a&&0===t?(0,i.jsxs)("div",{className:$.taskSeeMore,children:[(0,i.jsx)("div",{children:s.F2.t("web_material_text_latest_display")}),(0,i.jsx)("div",{children:s.F2.t("web_material_button_see_more")})]}):null]},e.key)})),a=t[t.length-1];return(0,i.jsx)("div",{className:$.tasksStack,children:a})}));var ve=(e=>(e.Pending="pending",e.Running="running",e.Success="success",e.Fail="fail",e.Abnormal="abnormal",e.Cancel="cancel",e))(ve||{});G.Pending,ve.Pending,G.Running,ve.Running,G.Success,ve.Success,G.Fail,ve.Fail,G.Abnormal,ve.Abnormal,V.QuitWithoutBegin,ve.Fail,V.Cancel,ve.Cancel,V.ExpandInsufficient,ve.Abnormal,V.Fail,ve.Fail,V.Finish,ve.Success,V.Uploading,ve.Running,V.Exist,ve.Success;const he=l.createContext({uid:"",isBOE:!1,currentWorkspace:void 0,openFrom:void 0,ref:void 0});var me=(e=>(e[e.WorkspaceSetting=0]="WorkspaceSetting",e[e.ThirdpartyUpload=1]="ThirdpartyUpload",e[e.TaskFileSyncSetting=2]="TaskFileSyncSetting",e))(me||{}),ge=(e=>(e.AssignUserInfo="ASSIGN_USERINFO",e.AssignCurrentUpdateTime="ASSIGN_CURRENT_UPDATE_TIME",e.AssignCurrentFolder="ASSIGN_CURRENT_FOLDER",e.AssignTaskMeta="ASSIGN_TASK_META",e))(ge||{});const Se={userInfo:void 0,currentUpdateTime:void 0,currentFolder:void 0,taskMeta:void 0},Te=(e,t)=>{switch(t.type){case ge.AssignUserInfo:return{...e,userInfo:t.data};case ge.AssignCurrentUpdateTime:return{...e,currentUpdateTime:t.data};case ge.AssignCurrentFolder:return{...e,currentFolder:t.data};case ge.AssignTaskMeta:return{...e,taskMeta:t.data};default:return e}},Ie={fileSyncFolderSelector:"_fileSyncFolderSelector_1pui9_1",errorContext:"_errorContext_1pui9_19",fileSyncTrigger:"_fileSyncTrigger_1pui9_26","fileSync-selectorModal":"_fileSync-selectorModal_1pui9_31",fileSyncFolderSelectorNode:"_fileSyncFolderSelectorNode_1pui9_56",nodeCheck:"_nodeCheck_1pui9_56",nodeIcon:"_nodeIcon_1pui9_68",nodeTitle:"_nodeTitle_1pui9_74",fileSyncFolderLoading:"_fileSyncFolderLoading_1pui9_83",fileSyncFolderLoadError:"_fileSyncFolderLoadError_1pui9_92",emptyContext:"_emptyContext_1pui9_100"};var Ee=(e=>(e[e.default=0]="default",e[e.empty=1]="empty",e[e.loading=2]="loading",e[e.loadError=3]="loadError",e[e.unknowError=4]="unknowError",e))(Ee||{});const ye=e=>{const{status:t,treeData:a,current:r,loadMore:o,handleRetry:n,renderTitle:d}=e,[c,u]=(0,l.useState)(!1),p=0===t.type&&0!==(null==a?void 0:a.length)?void 0:()=>2===t.type?(0,i.jsx)(w.A,{className:Ie.fileSyncFolderLoading,animation:!0,text:{rows:4,width:["100%",240,240,240]}}):3===t.type?(0,i.jsxs)("div",{className:Ie.fileSyncFolderLoadError,children:[(0,i.jsx)("div",{className:Ie.errorContext,children:s.Ay.t("web_autosync_title_load_folders_failed",{},"Couldn\u2019t load folders. Try again.")}),(0,i.jsx)(y.A,{loading:c,icon:(0,i.jsx)(T.kZ9,{size:16}),size:"mini",onClick:async()=>{try{u(!0),await n()}finally{u(!1)}},children:s.Ay.t("web_autosync_btn_retry_load_folders",{},"Retry")})]}):null!=a&&a.length?void 0:(0,i.jsxs)("div",{className:Ie.fileSyncFolderLoadError,children:[(0,i.jsx)(T.C9R,{size:40}),(0,i.jsx)("div",{className:Ie.errorContext,children:s.Ay.t("web_autosync_text_no_folders_found",{},"No founders found")})]});return(0,i.jsxs)("div",{className:Ie.fileSyncFolderSelector,children:[(0,i.jsx)(L.A,{...e,treeCheckedStrategy:F.A.SHOW_ALL,placeholder:s.Ay.t("web_material_button_choose_folder",{},"Choose Source folder"),prefix:(0,i.jsx)(T.Z23,{size:20}),value:r,treeData:a,labelInValue:!0,treeProps:{className:Ie.fileSyncSelectorModal,icons:()=>({switcherIcon:(0,i.jsx)(T.p6c,{size:12})}),renderTitle:e=>(0,i.jsxs)("div",{className:Ie.fileSyncFolderSelectorNode,children:[(0,i.jsx)("div",{className:Ie.nodeIcon,children:(0,i.jsx)(T.XlZ,{size:16})}),(0,i.jsx)("div",{className:Ie.nodeTitle,children:(null==d?void 0:d(e))??e.title}),(0,i.jsx)("div",{className:Ie.nodeCheck,children:(0,i.jsx)(T.e6G,{size:16})})]})},loadMore:o,triggerProps:{className:Ie.fileSyncTrigger,getPopupContainer:e.getPopupContainer},dropdownRender:p,error:4===t.type,suffixIcon:(0,i.jsx)(T.go4,{size:16})}),(0,i.jsx)("div",{className:E()({errorContext:4===t.type&&t.context}),children:t.context})]})},ke="_fileSyncHeader_vag77_1",Ae="_fileSyncHeaderTitle_vag77_4",Re="_fileSyncHeaderContext_vag77_11",Ne=()=>(0,i.jsxs)("div",{className:ke,children:[(0,i.jsx)("div",{className:Ae,children:s.Ay.t("web_material_text_file",{},"File sync")}),(0,i.jsx)("div",{className:Re,children:s.Ay.t("web_material_text_file_obtain",{},"Sync files from 3rd-party platforms automatically.")})]}),Pe={fileSyncFormItemHeader:"_fileSyncFormItemHeader_1u7lx_1",fileSyncFormItemTitle:"_fileSyncFormItemTitle_1u7lx_6",fileSyncFormItemSkeleton:"_fileSyncFormItemSkeleton_1u7lx_13"};var Ce=(e=>(e[e.default=0]="default",e[e.loading=1]="loading",e))(Ce||{});const be=({title:e,subTitle:t,status:a=0,children:r})=>1===a?(0,i.jsx)(w.A,{className:Pe.fileSyncFormItemSkeleton,animation:!0,text:{rows:2,width:[148,"100%"]}}):(0,i.jsxs)("div",{className:Pe.fileSyncFormItem,children:[(0,i.jsxs)("div",{className:Pe.fileSyncFormItemHeader,children:[(0,i.jsx)("div",{className:Pe.fileSyncFormItemTitle,children:e}),t&&(0,i.jsx)("div",{children:t})]}),r]}),Oe={[d.f.Dropbox]:(0,i.jsx)(T.yP,{size:"48px"}),[d.f.GoogleDrive]:(0,i.jsx)(T.dkL,{size:"48px"})},we="_fileSyncPlatform_lrxjp_1",Le="_fileSyncPlatformIcon_lrxjp_6",Fe="_fileSyncPlatformInfo_lrxjp_13",Ue="_fileSyncPlatformInfoName_lrxjp_17",De="_fileSyncUserInfo_lrxjp_22",xe="_email_lrxjp_27",Me="_unlink_lrxjp_30",Be="_platformInfoSkeleton_lrxjp_45";var je=(e=>(e[e.default=0]="default",e[e.loading=1]="loading",e))(je||{});const He=e=>{const{platform:t,userInfo:a,checked:r,switchLoading:o=!1,status:n=0,onSwitchClick:c,unbind:u}=e,[p,_]=(0,l.useState)(!1);return(0,i.jsxs)(i.Fragment,{children:[0===n&&(0,i.jsxs)("div",{className:we,children:[(0,i.jsx)("div",{className:Le,children:Oe[t]}),(0,i.jsxs)("div",{className:Fe,children:[(0,i.jsx)("div",{className:Ue,children:s.Ay.t((0,d.h)(t))}),null!=a&&a.email?(0,i.jsxs)("div",{className:De,children:[(0,i.jsx)("div",{className:xe,children:null==a?void 0:a.email}),(0,i.jsx)("div",{className:Me,onClick:async()=>{try{_(!0),await u()}finally{_(!1)}},children:p?(0,i.jsx)(N.A,{webp:!0,size:12}):"Unlink"})]}):null]}),(0,i.jsx)("div",{onClick:c,children:(0,i.jsx)(U.A,{loading:o,checked:r})})]}),1===n&&(0,i.jsx)(w.A,{className:Be,animation:!0,text:{rows:2,width:[148,220]},image:!0})]})},Ge="_timeSelector_bki7l_1",Ve="_timeSelectorTrigger_bki7l_8",ze=D.A.Option,Ye=e=>{const{timeOptions:t}=e;return(0,i.jsx)(D.A,{...e,className:Ge,prefix:(0,i.jsx)(T.CWF,{size:20}),triggerProps:{className:Ve},suffixIcon:(0,i.jsx)(T.go4,{size:16}),children:t.map((({name:e,key:t})=>(0,i.jsx)(ze,{value:e,extra:{key:t},children:e},t)))})},We="_cloudSelector_1dvoi_1",Ke="_helpIcon_1dvoi_1",qe=D.A.Option,Je=e=>(0,i.jsx)(D.A,{...e,className:We,prefix:(0,i.jsx)(T.qN9,{size:20}),suffixIcon:(0,i.jsx)(n.A,{getPopupContainer:e.getPopupContainer,position:"top",content:s.Ay.t("web_material_text_supported",{},"Supported by default space only"),children:(0,i.jsx)(T.gqp,{className:Ke,size:16})}),children:e.cloudList.map(((e,t)=>(0,i.jsx)(qe,{value:e,children:e},t)))}),Xe=async({uid:e,isBOE:t,platform:r})=>{var o;const{default:n}=await Promise.resolve().then(a.t.bind(a,5244,23)),i=new URL("https://accounts.google.com/o/oauth2/v2/auth?prompt=consent&scope=https%3A//www.googleapis.com/auth/drive.readonly%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&access_type=offline&include_granted_scopes=true&response_type=code"),s=new URLSearchParams(i.search);return s.append("state",null==(o=(e=>n("sha256").update(e).digest("hex"))(e))?void 0:o.slice(15,47)),s.append("client_id",t?d.j:d.k),s.append("redirect_uri",`https://${window.location.host}/lv/v1/user/web/third_party_clouds_authorization/${d.R[r]}`),i.search=s.toString(),i.toString()},$e="_fileSyncSubmit_1c0w6_1",Ze="_fileSyncNow_1c0w6_11",Qe="_fileSyncForm_1c0w6_18",{THIRDPARTY_CLOUD_AUTH:et}=d.a,tt=e=>null!==e?s.Ay.t("web_material_text_eight_am",{string0:R()().hour(e).minute(0).format("HH:mm"),string1:e>12?"AM":"PM"},"{string0} {string1} every day"):s.Ay.t("web_material_button_non_auto",{},"Non-automatic backup"),at=e=>{var t,a,o,c,u;const{platform:p,taskMeta:_,userInfo:f,currentWorkspace:v,currentUpdateTime:h,currentFolder:m,getTaskMeta:g,getUserInfo:T,getFolderList:I,unbindUserInfo:E,onChangeUpdateTime:k,onChangeFolder:A,onSubmit:R,immediateTask:C,toggleConfigSwitch:b}=e,O=(0,l.useRef)(null),{openFrom:w,uid:L,isBOE:F=!1,ref:U,onShow:D,onSubmitFileSync:x,onCloseFileSync:M,onSyncNow:B,onUnbind:j}=(0,l.useContext)(he),[H,G]=(0,l.useState)([]),[V,z]=(0,l.useState)(!1),[Y,W]=(0,l.useState)(!1),[K,q]=(0,l.useState)(!1),{loading:J}=(0,P.Ay)(T,{auto:!0}),{loading:X,run:$}=(0,P.Ay)(g),{loading:Z,run:Q}=(0,P.Ay)((async(e={})=>{var t,a;try{W(!0),null==x||x({currentFolder:m,currentUpdateTime:h,currentWorkspace:v}),await R(),z(!0),q(!1),null==(t=e.onSubmit)||t.call(e)}catch(r){null==(a=e.onError)||a.call(e,r)}finally{W(!1)}})),{loading:ee,run:te}=(0,P.Ay)(C),{loading:ae,error:re}=(0,P.Ay)((async()=>{const e=await I("");G(e)}),{auto:!0,refreshDeps:[null==(t=e.userInfo)?void 0:t.email]}),oe=J?je.loading:je.default,ne=(0,l.useMemo)((()=>ae?{type:Ee.loading}:re?{type:Ee.loadError}:null!=H&&H.length?{type:Ee.default}:{type:Ee.empty}),[H,re,ae]),ie=(0,l.useMemo)((()=>{const e=new Map,t=(a,r)=>{a.forEach((a=>{var o;e.set(a.key,{...a,parentKey:r}),null!=(o=a.children)&&o.length&&t(a.children,a.key)}))};return t(H),e}),[H]),se=[{name:tt(null),key:"none"},{name:tt(0),key:"0"},{name:tt(8),key:"8"},{name:tt(12),key:"12"},{name:tt(20),key:"20"}],le=()=>[{key:"getingTaskMeta",data:!X,tooltipContent:s.Ay.t("web_share_translation_loading_text_loading",{},"Loading...")},{key:"getingUserInfo",data:!J,tooltipContent:s.Ay.t("web_share_translation_loading_text_loading",{},"Loading...")},{key:"currentWorkspace",data:v,tooltipContent:"Please choose target workspace"},{key:"currentFolder",data:m,tooltipContent:s.Ay.t("web_material_text_choose_source_folder",{},"Select a folder")},{key:"currentUpdateTime",data:h,tooltipContent:s.Ay.t("web_autosync_hover_set_sync_time",{},"Set sync time first")}].map((e=>({...e,data:!!e.data}))).filter((e=>!e.data));(0,l.useEffect)((()=>{null==D||D({currentFolder:m,currentUpdateTime:h,currentWorkspace:v})}),[]),(0,l.useEffect)((()=>{null!=f&&f.email&&$()}),[null==f?void 0:f.email]),(0,l.useEffect)((()=>{z(!(null==_||!_.isOn))}),[_]),(0,l.useImperativeHandle)(U,(()=>({submit:async()=>{await Q({onSubmit(){r.A.success(s.Ay.t("web_autosync_toast_settings_saved",{},"Settings saved"))}})},isFormChanged:V&&K})),[K,Q,V]);const de=X||J?Ce.loading:Ce.default;return(0,i.jsxs)("div",{ref:O,children:[(0,i.jsx)(Ne,{}),(0,i.jsx)(He,{userInfo:f,platform:p,status:oe,checked:V,switchLoading:Y,unbind:async()=>{null==j||j({currentFolder:m,currentUpdateTime:h,currentWorkspace:v}),await E(),z(!1)},onSwitchClick:async()=>{W(!0);try{if(V)null==M||M({currentFolder:m,currentUpdateTime:h,currentWorkspace:v}),await b(!1),z(!1);else{if(null==f||!f.email){const e=await(async(e,t)=>({[d.f.GoogleDrive]:await Xe({uid:e,isBOE:t,platform:d.f.GoogleDrive})}))(L,F);await(0,S.t)({authUrl:e[p],name:"thirdparty_cloud_storage_auth",localStorageKey:et,condition:e=>"fail"!==e}),await T()}null==x||x({currentFolder:m,currentUpdateTime:h,currentWorkspace:v}),await b(!0),z(!0)}}catch{}finally{W(!1)}}}),V&&null!=f&&f.email?(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:Qe,children:[(0,i.jsx)(be,{title:s.Ay.t("web_material_text_source_folder",{},"Select folder"),status:de,children:(0,i.jsx)(ye,{size:"large",status:ne,treeData:H,current:m?{label:m.title,value:m.key}:void 0,loadMore:async(e,t)=>{const a=e;a.key||r.A.error(s.Ay.t("web_autosync_text_unknown_error",{},"Something went wrong. Try again."));const o=await I(String(a.key));o.length||(t.isLeaf=!1),t.children=o.map((e=>({...e,title:`${t.title} / ${e.name}`}))),G([...H])},handleRetry:()=>I(""),renderTitle:e=>{var t,a;if(null!=(t=e.dataRef)&&t.key)return null==(a=ie.get(e.dataRef.key))?void 0:a.name},onChange:e=>{q(!0),A({title:e.label,key:e.value})},getPopupContainer:e=>O.current??e})}),w!==me.WorkspaceSetting&&(0,i.jsx)(be,{title:s.Ay.t("web_material_button_target_location",{},"Target location"),status:de,children:(0,i.jsx)(Je,{size:"large",getPopupContainer:e=>O.current??e,popupVisible:!1,value:`${s.Ay.t("web_material_button_name_space",{string0:null==v?void 0:v.name},"{string0} (default space)")}`,cloudList:[]})}),(0,i.jsx)(be,{title:s.Ay.t("web_material_text_auto_update",{},"Set auto sync time"),subTitle:(null==_?void 0:_.id)&&(0,i.jsx)("div",{className:Ze,onClick:async()=>{null==B||B({currentFolder:m,currentUpdateTime:h,currentWorkspace:v}),await Q(),await te()},children:ee?(0,i.jsx)(N.A,{webp:!0,size:12}):s.Ay.t("web_autosync_btn_sync_now",{},"Sync now")}),status:de,children:(0,i.jsx)(Ye,{size:"large",placeholder:s.Ay.t("web_material_button_set_auto",{},"Set time to auto sync files"),timeOptions:se,value:null==h?void 0:h.name,onChange:(e,t)=>{k(e,t),q(!0)},getPopupContainer:e=>O.current??e})})]}),de===Ce.loading?(0,i.jsx)("div",{style:{height:40,marginTop:24}}):(0,i.jsx)(n.A,{getPopupContainer:e=>O.current??e,disabled:!(null!=(a=le())&&a[0]),content:null==(c=null==(o=le())?void 0:o[0])?void 0:c.tooltipContent,children:(0,i.jsx)(y.A,{loading:Z,className:$e,size:"large",type:"primary",onClick:async()=>{await Q({onSubmit(){r.A.success(s.Ay.t("web_autosync_toast_settings_saved",{},"Settings saved"))}})},disabled:!((null==(u=le())||!u[0])&&K),children:s.Ay.t("web_material_text_synchronize_file",{},"Save settings")})})]}):null]})},rt=()=>{const e=(new Date).getTimezoneOffset(),t=Math.floor(Math.abs(e)/60);return Number((e>0?"-":"+")+t)},ot=e=>{const{className:t}=e,{currentWorkspace:a}=(0,l.useContext)(he),[o,n]=(0,l.useReducer)(Te,Se);return(0,i.jsx)("div",{className:E()("LvThirdpartyFileSync-GoogleDrive",t),children:(0,i.jsx)(at,{platform:d.f.GoogleDrive,taskMeta:o.taskMeta,userInfo:o.userInfo,currentWorkspace:a,currentUpdateTime:o.currentUpdateTime,currentFolder:o.currentFolder,getFolderList:async e=>{var t;if(null==(t=o.userInfo)||!t.email)throw new Error("not user info");try{const{data:t}=await m.f.getFileList({path:e,cursor:"",platform:d.f.GoogleDrive,querys:JSON.stringify({folder_tree_mode:!0})});return t.entries.map((e=>({key:e.id,name:e.name,title:e.name})))}catch(a){throw r.A.error(s.Ay.t("web_autosync_text_unknown_error",{},"Something went wrong. Try again.")),a}},unbindUserInfo:async()=>{await d.u.thirtpartCloudsDeauthorization({platform:d.f.GoogleDrive}),n({type:ge.AssignUserInfo,data:void 0})},onChangeUpdateTime:(e,t)=>{var a;n({type:ge.AssignCurrentUpdateTime,data:{name:e,key:null==(a=t.extra)?void 0:a.key}})},onChangeFolder:e=>{n({type:ge.AssignCurrentFolder,data:e})},onSubmit:async()=>{var e,t;if(null!=a&&a.workspace_id)try{const{data:r}=await W.createTaskRunnerConfig({isOn:!0,id:(null==(e=o.taskMeta)?void 0:e.id)??"0",type:H.GoogleDrive,sourceInfo:o.currentFolder?{folderId:o.currentFolder.key,folderName:o.currentFolder.title}:void 0,destinationInfo:{workspaceId:null==a?void 0:a.workspace_id},fileType:[j.Image],runPlan:null!=(t=o.currentUpdateTime)&&t.key?{localTimezone:Intl.DateTimeFormat().resolvedOptions().timeZone,tzOffsetHours:rt(),localHour:Number(o.currentUpdateTime.key)}:void 0});n({type:ge.AssignTaskMeta,data:r.taskMeta})}catch(i){throw r.A.error(s.Ay.t("web_autosync_text_unknown_error",{},"Something went wrong. Try again.")),i}},immediateTask:async()=>{var e;if(null==a||!a.workspace_id||null==(e=o.taskMeta)||!e.id)return;const{data:t}=await W.getTasks({workspaceId:a.workspace_id,status:G.Running});t.tasks.some((e=>e.status===G.Running))?r.A.warning(s.Ay.t("web_material_text_in_progress",{},"Files are being synced. Try again later.")):W.immediateTask({taskId:o.taskMeta.id}).then((()=>{window.dispatchEvent(new CustomEvent("TASK_OP",{detail:{type:"FileSyncExecuteNow"}})),r.A.success(s.Ay.t("web_autosync_toast_start_syncing",{},"Your folder starts syncing"))})).catch((e=>{var t;"1013"===(null==(t=e.data)?void 0:t.ret)?r.A.error(s.Ay.t("web_autosync_text_too_many_attempts",{},"Too many attempts. Try again later.")):r.A.error(s.Ay.t("web_autosync_text_unknown_error",{},"Something went wrong. Try again."))}))},getUserInfo:async()=>{const{data:e}=await m.f.userInfo({platform:d.f.GoogleDrive});n({type:ge.AssignUserInfo,data:e})},getTaskMeta:async()=>{var e,t;const{data:a}=await W.getTaskRunnerConfig();a.taskMeta&&(n({type:ge.AssignTaskMeta,data:a.taskMeta}),a.taskMeta.sourceInfo&&n({type:ge.AssignCurrentFolder,data:{title:a.taskMeta.sourceInfo.folderName,key:a.taskMeta.sourceInfo.folderId}}),n({type:ge.AssignCurrentUpdateTime,data:{name:tt((null==(e=a.taskMeta.runPlan)?void 0:e.localHour)??null),key:null!=(t=a.taskMeta.runPlan)&&t.localHour?a.taskMeta.runPlan.localHour.toString():"none"}}))},toggleConfigSwitch:async e=>{var t,r,o;if(null==a||!a.workspace_id)return;const{data:i}=await W.getTaskRunnerConfig(),{data:s}=await W.createTaskRunnerConfig({isOn:e,destinationInfo:{workspaceId:a.workspace_id},id:(null==(t=i.taskMeta)?void 0:t.id)??"0",type:H.GoogleDrive,fileType:[j.Image],runPlan:null==(r=null==i?void 0:i.taskMeta)?void 0:r.runPlan,sourceInfo:null==(o=null==i?void 0:i.taskMeta)?void 0:o.sourceInfo});s.taskMeta&&n({type:ge.AssignTaskMeta,data:s.taskMeta})}})})};(0,l.forwardRef)(((e,t)=>{const{platform:a,uid:r,isBOE:o,openFrom:n,workspaceId:s,onShow:c,onClose:u,onSubmitFileSync:p,onCloseFileSync:_,onSyncNow:v,onUnbind:h}=e,[m,g]=(0,l.useState)();return(0,l.useEffect)((()=>{s&&f.t.mGetWorkspaceInfo({workspace_ids:[s]}).then((({data:e})=>{const t=e.workspace_infos[0];t&&g(t)}))}),[s]),(0,i.jsx)(he.Provider,{value:{ref:t,uid:r,isBOE:o,openFrom:n,currentWorkspace:m,onShow:c,onClose:u,onSubmitFileSync:p,onCloseFileSync:_,onSyncNow:v,onUnbind:h},children:a===d.f.GoogleDrive&&(0,i.jsx)(ot,{})})}));o.A.TabPane},21334:function(e,t,a){a(85333),a(91485),a(78436),a(13398),a(38e3),a(67308),a(87581),a(4271),a(45475),a(62289),a(89934),a(14148),a(13819),a(9932),a(33102),a(8608),a(81324),a(77746),a(62281),a(42579),a(78790),a(30395),a(87025),a(14936),a(56464),a(45505)},62289:function(e,t,a){a.d(t,{A:function(){return Re},B:function(){return ee},C:function(){return dt},D:function(){return R},E:function(){return nt},F:function(){return lt},G:function(){return le},L:function(){return ft},O:function(){return ke},P:function(){return O},R:function(){return k},S:function(){return Ae},T:function(){return w},a:function(){return E},b:function(){return re},c:function(){return L},d:function(){return Ie},e:function(){return J},f:function(){return y},g:function(){return me},h:function(){return A},i:function(){return q},j:function(){return P},k:function(){return C},l:function(){return H},m:function(){return N},n:function(){return b},o:function(){return ne},p:function(){return ct},q:function(){return ie},r:function(){return F},s:function(){return ae},t:function(){return z},u:function(){return x},v:function(){return K},w:function(){return X},x:function(){return Z},y:function(){return $},z:function(){return se}});var r=a(37814),o=a(45505),n=a(14148),i=a(62281),s=a(80218),l=a(77746),d=a(66696),c=a(58519),u=a(95878),p=a(28437),_=(a(83002),a(85970)),f=a(24110),v=a(76398),h=a(42579),m=a.n(h),g=Object.defineProperty,S=(e,t,a)=>(((e,t,a)=>{t in e?g(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a})(e,"symbol"!=typeof t?t+"":t,a),a),T=(e,t,a)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,a)},I=(e,t,a)=>(((e,t,a)=>{if(!t.has(e))throw TypeError("Cannot "+a)})(e,t,"access private method"),a);const E={RECENT_LIST_FILE_TYPE:"RECENT_LIST_FILE_TYPE",RECENT_LIST_VIEW_TYPE:"RECENT_LIST_VIEW_TYPE",LIST_VIEW_TYPE:"LIST_VIEW_TYPE",LIST_DISPLAY_TYPE:"LIST_DISPLAY_TYPE",LIST_SORT_BY:"LIST_SORT_BY",RECYCLE_LIST_SORT_BY:"RECYCLE_LIST_SORT_BY",LIST_SORT_DIRECTION:"LIST_SORT_DIRECTION",RECYCLE_LIST_SORT_DIRECTION:"RECYCLE_LIST_SORT_DIRECTION",COOKIE_CONSENT_PROMPT_CONFIG:"COOKIE_CONSENT_PROMPT_CONFIG",THIRTPARTY_FEEDBACK:"THIRTPARTY_FEEDBACK",LV_TASK_CENTER:"LV_TASK_CENTER",THIRDPARTY_CLOUD_AUTH:"THIRDPARTY_CLOUD_AUTH",SURVEY_OPEN:"SURVEY_OPEN",CLOUD_STORAGE_PAYMENT_AND_BINDING:"CLOUD_STORAGE_PAYMENT_AND_BINDING",THIRDPARTY_SHARE_AUTH:"THIRDPARTY_SHARE_AUTH",CAPCUT_THEME:"CAPCUT_THEME",CAPCUT_TEMPLATE_VIDEO_VOLUME:"CAPCUT_TEMPLATE_VIDEO_VOLUME",GUIDE_FROM_TEAM_INVITE:"GUIDE_FROM_TEAM_INVITE",GUIDE_FROM_SIGN_UP:"GUIDE_FROM_SIGN_UP",COMPREHENSIVE_SEARCH_HISTORY:"COMPREHENSIVE_SEARCH_HISTORY",CC_WEB_IM_CONFIG:"CC_WEB_IM_CONFIG"};var y=(e=>(e.Dropbox="Dropbox",e.GoogleDrive="GoogleDrive",e.GoogleContacts="GoogleContacts",e.Shopify="Shopify",e))(y||{}),k=(e=>(e.Dropbox="dropbox",e.GoogleDrive="google_drive",e.GoogleDriveMarketPlace="google_mp",e.Shopify="shopify",e.DropboxImport="dropbox",e))(k||{});const A=e=>{switch(e){case"Dropbox":default:return"web_space_upload_dropbox";case"GoogleDrive":return"web_space_upload_googledrive"}},R="3c3o3v882blv2w7",N="dp6bpuyyzufzrg1",P="1093504901008-cmpv0g4d9k4fd1g6aas7n2bpra6mulu5.apps.googleusercontent.com",C="87571557143-3quv34dc1ier93o3h1kjjieocm0u6bo5.apps.googleusercontent.com",b="87571557143-vsqifmqmc1ou12eqamgqm6k7ducvdcu1.apps.googleusercontent.com";var O=(e=>(e.TT_USER_INFO="tt_user_info",e.YT_USER_INFO="youtube_user_info",e.FACEBOOK_USER_INFO="facebook_user_info",e))(O||{}),w=(e=>(e.CREATOR_AVARTAR_URL="creator_avatar_url",e.CREATOR_USERNAME="creator_username",e.CREATOR_NICKNAME="creator_nickname",e.PRIVACY_LEVEL_OPTIONS="privacy_level_options",e.COMMENT_DISABLED="comment_disabled",e.DUET_DISABLED="duet_disabled",e.STITCH_DISABLED="stitch_disabled",e.REMAINING_API_POST_QUOTA_24HR="remaining_api_post_quota_24hr",e.MAX_VIDEO_POST_DURATION_SEC="max_video_post_duration_sec",e))(w||{}),L=(e=>(e[e.NORMAL=0]="NORMAL",e[e.BALCK_LIST_24=1]="BALCK_LIST_24",e[e.BALCK_LIST_FOREVER=2]="BALCK_LIST_FOREVER",e[e.UNDER_AGE_13=3]="UNDER_AGE_13",e[e.UNBLOCK=4]="UNBLOCK",e))(L||{}),F=(e=>(e[e.SAME=0]="SAME",e[e.DIFFERENT=1]="DIFFERENT",e))(F||{});const U={baseURL:"/lv/v1/user",method:"POST",headers:{loc:i.P.CHANNEL,lan:n.Ay.language||i.P.LAN,pf:i.P.APP_PF,appvr:i.P.VERSION,tdid:"","sign-ver":1,"app-sdk-version":i.P.APP_SDK_VERSION},params:{}},D=i.b.createAxios(U);D.interceptors.request.use((e=>{const{pf:t,appvr:a,tdid:r}=U.headers;return Object.assign(e.headers,(0,i.c)({url:`${e.baseURL}${e.url}`,pf:t,appvr:a,tdid:r})),e})),D.interceptors.response.use((e=>{if(200===e.status){const t=e.data;return"0"===t.ret?Promise.resolve(t.data):Promise.reject(e)}return Promise.reject(e)})),(0,i.d)(D,{retries:5,resetTimeout:!0,retryDelay:1e3,isRetry:e=>{var t;return![i.E.USER_CODE.NO_LOGIN,i.E.AUTHORIZED.GOOGLE_UNAUTHORIZED].includes(Number(null==(t=null==e?void 0:e.data)?void 0:t.ret))}});const x={async getAndUpdateUserInfo(e){const t="/web/user_info";return await D({url:i.i?`${i.W}${U.baseURL}${t}`:`${window.location.origin}${U.baseURL}${t}`,data:e,[i.N]:{skipAwaitLocker:!0}})},async getUserInfo(e){return await D({url:`${window.location.origin}${U.baseURL}/web/get_user_info`,data:{uid:e,need_grade:!1},[i.N]:{skipAwaitLocker:!0}})},async updateUser(e){return await D({url:"/update",data:e})},async thirtpartCloudsDeauthorization(e){return await D({url:"/web/third_party_clouds_deauthorization",data:e})},async authorizationCheck(e){return await D.post("/web/third_party_clouds_authorization_check",e)},async getShareUserInfo(e){return await D({url:"/web/share_user_info",data:e})},async shareUserUnbind(e){return await D({url:"/web/third_party_platform_deauthorization",data:e})},async checkAgeGate(){return await D({url:"/check_age_gate",data:{}})},async confirmBirthday(e){return await D({url:"/confirm_birthday",data:e})},async updateBirthday(e){return await D({url:"/update_birthday",data:e})},getFacebookShareList(e){return D.post("/web/get_facebook_page_or_group_list",e)},async getOpenId(){return await D({baseURL:"/lv/v1",url:"/web/openid"})},async saveTTScope(e){return await D({baseURL:"/lv/v1",url:"/third_party_clouds/save_tt_scope",data:e})},async checkBindEmailPopup(){return await D({url:"/web/check_bind_email_popup"})},async edmAuthorize(e){return await D({url:"/web/edm_authorize",data:{setting_values:null!=e&&e.checked?"on":"off"}})},async getUserContacts(e){return await D({url:"/web/third_party_get_contacts",data:e})},async getAuthorizedUserInfo(e){return await D({url:"/web/authorized_user_info",data:e})},async appealForUser(e){return await D({baseURL:"/lv/v1",url:"/appeal/personal_info",data:e})}},M="1003",B="1004",j=429;function H(e){var t;const{data:a,status:r}=e;return(null==a?void 0:a.ret)===M||(null==a?void 0:a.ret)===B||r===j?(null==(t=i.s)||t.error("shark_error_msg",new Error("sharkError.sharkErrorKey"),{ret:(null==a?void 0:a.ret)||"",logId:(null==a?void 0:a.log_id)||""}),{...e,data:{ret:(null==a?void 0:a.ret)||B}}):e}const G={baseURL:"/lv/v1/share_task",method:"POST",headers:{loc:i.P.CHANNEL,lan:n.Ay.language||i.P.LAN,pf:i.P.APP_PF,appvr:i.P.VERSION,tdid:"","sign-ver":1,"app-sdk-version":i.P.APP_SDK_VERSION},params:{}},V=i.b.createAxios(G);V.interceptors.request.use((e=>{const{pf:t,appvr:a,tdid:r}=G.headers;return Object.assign(e.headers,(0,i.c)({url:`${e.baseURL}${e.url}`,pf:t,appvr:a,tdid:r})),e})),V.interceptors.response.use((e=>{const t=H(e);if(200===t.status){const e=t.data;return"0"===e.ret?Promise.resolve(e.data):Promise.reject(t)}return Promise.reject(t)}),(e=>{const t=H(e.response);return Promise.reject(t)})),(0,i.d)(V,{retries:2,resetTimeout:!0,retryDelay:1e3,isRetry:()=>!0});const z={async getShareFormInfo(e){return await V({url:"/form_info",data:e})},async shareToTikTok(e){return await V({url:"/tiktok_video_publish",data:e,[i.e]:{retries:0}})},async shareToYouTube(e){return await V({url:"/publish_video_to_youtube",data:e,[i.e]:{retries:0}})},async shareToTtam(e){return await V({url:"/publish_video_to_ttam",data:e,[i.e]:{retries:0}})},shareToFacebook(e){return V({url:"/publish_video_to_facebook",data:e,[i.e]:{retries:0}})},async getShareProgress(e){return await V({url:"/batch_get",data:e})},async cancelUploadTask(e){return await V({url:"/cancel",data:e})},async shareToThirdPartyPlatform({platform:e,...t}){return await V({url:"publish_asset_to_third_party_platform",data:{...t,platform:e}})}},Y={baseURL:"/lv/v1/cc4b",method:"POST",headers:{loc:i.P.CHANNEL,lan:i.P.LAN,pf:i.P.APP_PF,appvr:i.P.VERSION,tdid:"","sign-ver":1,"app-sdk-version":i.P.APP_SDK_VERSION},params:{}},W=i.b.createAxios(Y);W.interceptors.request.use((e=>{const{pf:t,appvr:a,tdid:r}=Y.headers;return Object.assign(e.headers,(0,i.c)({url:`${e.baseURL}${e.url}`,pf:t,appvr:a,tdid:r})),e})),W.interceptors.response.use((e=>{if(200===e.status){const t=e.data;return"0"===t.ret?Promise.resolve(t.data):Promise.reject(e)}return Promise.reject(e)})),(0,i.d)(W,{retries:2,resetTimeout:!0,retryDelay:1e3,isRetry:()=>!0});const K={latestFetchTime:0,tt4bFetchPromise:null,cachedTT4BData:void 0,async getTt4bAccounts(){return Date.now()-this.latestFetchTime<1e3?this.tt4bFetchPromise?this.tt4bFetchPromise:this.cachedTT4BData:(this.latestFetchTime=Date.now(),this.tt4bFetchPromise=new Promise((async e=>{const t=await W({url:"/get_tt4b_accounts",data:{}});return this.tt4bFetchPromise=null,this.cachedTT4BData=t,e(t)})),this.tt4bFetchPromise)},async unbindTt4bAccounts(e){return await W({url:"/unbind_tt4b_account",data:e})},async getAdvertisers(e){return await W({url:"/get_advertisers",data:e})}},q=(()=>{const e=typeof window<"u",t=t=>!!e&&window.matchMedia(t).matches;let a=t("(display-mode: standalone)");return()=>{const e=t("(display-mode: standalone)"),r=t("(display-mode: fullscreen)");return a=!!e||r&&a,a}})(),J=()=>{let e;if(q())e=!1;else if(typeof window<"u"){const t=new URL(window.location.href).searchParams;e=(null==t?void 0:t.get("open_from_pwa"))||void 0}return!!e},X=()=>{let e="not_pwa";if(typeof window<"u"&&q()){const t=new URL(window.location.href).searchParams;e=(null==t?void 0:t.get("pwa_from"))||"capcut"}return e};class ${constructor(){S(this,"reporter",(0,o.r)())}report({current_page:e,order:t=o.h.First,...a}){this.reporter.report(t===o.h.Second?"secondary_authorize_request":"share_authorize_request",{platform:(0,o.p)(a),current_page:e})}}class Z{constructor(){S(this,"reporter",(0,o.r)())}report({order:e=o.h.First,status:t,failReason:a,current_page:r,...n}){this.reporter.report(e===o.h.Second?"secondary_authorize_status":"share_authorize_status",{platform:(0,o.p)(n),status:t,fail_reason:a,current_page:r})}}const Q={PUBLIC_TO_EVERYONE:"Public",MUTUAL_FOLLOW_FRIENDS:"Friends",SELF_ONLY:"Private",FOLLOWER_OF_CREATOR:"Followers",unlisted:"unlisted",public:"public",private:"private"};class ee{constructor(){S(this,"reporter",(0,o.r)())}report({platform:e,youtubeShareType:t,facebookShareType:a,...r}){this.reporter.report("click_share_channel",{...r,platform:(0,o.p)({platform:e,youtubeShareType:t,facebookShareType:a}),format:(0,f.g)(r.format),size:Math.round(100*r.size/1024/1024)/100,video_duration:Math.floor(r.video_duration/1e3),resolution:r.resolution.toLocaleLowerCase()})}}class te{constructor(){S(this,"reporter",(0,o.r)())}report({platform:e,youtubeShareType:t,facebookShareType:a,...r}){this.reporter.report("click_share_where",{...r,platform:(0,o.p)({platform:e,youtubeShareType:t,facebookShareType:a}),share_view_range:r.share_view_range&&Q[r.share_view_range],format:(0,f.g)(r.format),size:Math.round(100*r.size/1024/1024)/100,video_duration:Math.floor(r.video_duration/1e3),resolution:r.resolution.toLocaleLowerCase()})}}class ae{constructor(){S(this,"reporter",(0,o.r)())}report(e){this.reporter.report("share_fail_popup",e)}}class re{constructor(){S(this,"reporter",(0,o.r)())}report({platform:e,youtubeShareType:t,facebookShareType:a,...r}){this.reporter.report("change_account_export_popup",{...r,platform:(0,o.p)({platform:e,youtubeShareType:t,facebookShareType:a})})}}const oe=(0,o.r)();class ne{constructor(e){S(this,"action"),S(this,"current_page"),S(this,"enter_from"),S(this,"panel_page"),S(this,"video_id"),S(this,"video_duration"),S(this,"size"),S(this,"format"),S(this,"resolution"),S(this,"share_account"),S(this,"share_caption"),S(this,"share_caption_words_cnt"),S(this,"description"),S(this,"is_cover_added"),S(this,"review_range"),S(this,"allow_download"),S(this,"video_privacy"),S(this,"auto_caption"),S(this,"source_language"),S(this,"auto_enable"),S(this,"review_allow_comment"),S(this,"password_protection"),S(this,"space_id"),S(this,"share_member_cnt"),S(this,"share_view_range"),Object.assign(this,e),this.video_duration&&(this.video_duration=Math.round(this.video_duration/1e3)),this.size&&(this.size=Math.round(this.size/1024/1024*100)/100),this.format&&(this.format=(0,f.g)(this.format))}static reportEvent(e){oe.report("share_panel",(0,v.A)(e,["action","current_page","current_page_type","enter_from","panel_page","video_id","video_duration","size","format","resolution","share_account","share_caption","share_caption_words_cnt","share_view_range","is_cover_added","description","share_member_cnt","space_id","password_protection","review_allow_comment","allow_download","video_privacy","auto_caption","source_language","auto_enable","review_range","edittype","is_smart_tool","original_edittype","tool_type","text_to_video_request_id","video_title","video_description"]))}report(){ne.reportEvent(this)}}var ie=(e=>(e.show="show",e.upload="upload",e.feedback="feedback",e.signOut="sign_out",e.watch="watch",e.copyLink="copy_link",e.retry="retry",e.saveBack="save_back",e.open="open",e.settings="settings",e.clickable="clickable",e))(ie||{}),se=(e=>(e.shareInsDetail="share_ins_detail",e.shareFbDetail="share_fb_detail",e.shareInsResult="share_ins_result",e.shareFbResult="share_fb_result",e.saveShopifyDetail="save_shopify_detail",e.saveShopifyResult="save_shopify_result",e.saveShopifyFail="save_shopify_fail",e))(se||{}),le=(e=>(e.fbPages="fb_pages",e.fbGroups="fb_groups",e.ins="ins",e.taskWindow="task_window",e.saveShopify="save_shopify",e))(le||{});const de=e=>(Number(e)/1024).toFixed(2),ce=e=>e&&(0,f.g)(e),ue=e=>null==e?void 0:e.toLocaleLowerCase(),pe=e=>Array.isArray(e)?e.filter((e=>void 0!==e)).join(","):e,_e={size:e=>pe(e.map(de)),page_id:e=>pe(e),format:e=>pe(e.map(ce)),resolution:e=>pe(e.map(ue))},fe=e=>{const t={};for(const a in e)Object.prototype.hasOwnProperty.call(_e,a)?t[a]=_e[a](e[a]):t[a]=e[a];return t};class ve{constructor(){S(this,"reporter",(0,o.r)()),S(this,"reportParams",{current_page:"picutre_edit",original_edittype:"picture_edit",edittype:"picture_edit",is_smart_tool:0}),S(this,"setParams",(e=>{const t=fe(e);this.reportParams={...this.reportParams,...t}}))}report(e={}){const t=fe(e),a={...this.reportParams,...t};this.reporter.report("export_panel",a)}getParams(){return this.reportParams}}let he;const me=()=>(he||(he=new ve),he);class ge{constructor(){S(this,"reporter",(0,o.r)())}report(e){this.reporter.report("material_save_back_status",e)}}var Se=(e=>(e.INSUFFICIENT_PERMISSIONS="insufficient_permissions",e.OVER_MAX_TT4B_ACCOUNT_SIZE="over_max_TT4b_account_size",e.SUCCESS="success",e.FAIL="fail",e.REGION_NOT_SUPPORT="region_not_support",e))(Se||{}),Te=(e=>(e[e.null=0]="null",e[e.dealing=1]="dealing",e[e.uploadSuccess=2]="uploadSuccess",e[e.shareSuccess=3]="shareSuccess",e[e.auditing=4]="auditing",e[e.auditFailed=5]="auditFailed",e[e.uploadFailed=6]="uploadFailed",e[e.publishTimeOut=8]="publishTimeOut",e))(Te||{});const Ie={TikTok:{privacy_level_options:["PUBLIC_TO_EVERYONE","MUTUAL_FOLLOW_FRIENDS","SELF_ONLY"],comment_disabled:!1,duet_disabled:!1,stitch_disabled:!1},YouTube:{email:"",picture:"",privacy_level_options:["public","unlisted","private"]}},Ee=e=>{try{return JSON.stringify(e)}catch{return""}},ye=new o.S;var ke=(e=>(e.detailPage="detailPage",e.taskList="taskList",e.receivedLinks="receivedLinks",e.sharedLinks="sharedLinks",e.workspace="workspace",e.uploadShare="uploadShare",e.modalWorkspace="modalWorkspace",e.publishCalendar="publishCalendar",e.sharePage="sharePage",e.embedPage="embedPage",e.default="default",e.graphicEditor="graphicEditor",e.videoEditor="videoEditor",e.templateEditor="templateEditor",e.smartTools="smartTools",e.smartTool="smartTool",e))(ke||{}),Ae=(e=>(e.Review="Review",e.SharePresentation="SharePresentation",e.Download="Download",e.Schedule="Schedule",e.SaveDropbox="SaveDropbox",e.ShareShopify="ShareShopify",e.EmbedShopify="EmbedShopify",e))(Ae||{});const Re=(0,d.O)({id:"LvShareExportPanelMachine",initial:"close",context:{taskId:"",spaceInfo:{workspaceId:"",spaceId:"",spaceHost:"",spaceResHost:"",spaceIdc:""},userRegion:"",fileId:"",createTime:0,expectFinishTime:0,presetProgressLimit:o.D,renderProgress:0,allowCancelRender:!1,renderPendingInfo:{errCode:0,ignoreErrCodeSet:new Set},allowCloseWindow:!0,exportType:-1,fileInfo:{fileName:"-",size:"Calculating...",coverImg:"",resolution:"-",duration:0,format:"mp4",type:o.F.FilmVideo,fileType:o.F.FilmVideo,downloadUrl:""},videoPlayInfo:{currentTime:0,duration:0,playStatus:!1,fullscreen:!1,videoInstance:null,dragging:!1},renderVideoInfo:void 0,isRequestUserBind:!1,currentPage:s.M.Editor,renderSuccessCallbacks:[],exportCancelCb:void 0,isSaveStateInit:!1,customText:void 0,customResultView:void 0,hideHeaderBtn:!1,disableCancelConfirm:!1,selectItemData:{},showVipCard:!1,exportProcessCb:void 0},invoke:[{id:"asyncTaskActor",src:o.L},{id:"importXgPlayer",src:"importXgPlayer"}],states:{open:{initial:"rendering",entry:[()=>{i.s.dataEvent("ExportModalShow"),(0,o.n)().setParam({panel_page:o.P.exporting})}],states:{save:{initial:"saving",states:{saving:{on:{CANCEL_SAVE:{target:"#LvShareExportPanelMachine.close"}}},fail:{entry:(0,c.kp)({renderProgress:0}),on:{RERTY_SAVE:{target:"saving"}}}}},rendering:{invoke:{id:"getRenderProgress",src:"getRenderProgress"},on:{GET_RENDER_PROGRESS:[{actions:[(0,c.kp)({fileId:(e,t)=>null==t?void 0:t.data.file_id,createTime:(e,t)=>parseInt(t.data.create_time??0),expectFinishTime:(e,t)=>parseInt(t.data.expect_finish_time??0),renderProgress:(e,t)=>t.data.progress??0,allowCancelRender:(e,t)=>t.data.allowCancelRender,allowCloseWindow:(e,t)=>t.data.allowCloseWindow,renderPendingInfo:({renderPendingInfo:e},t)=>Object.assign(e,{errCode:t.data.taskErrCode??0}),exportType:(e,t)=>t.data.type??-1,fileInfo:({fileInfo:e},t)=>{var a,r;const{render_task_info:o}=null==t?void 0:t.data;return Object.assign(e??{},{fileId:null==t?void 0:t.data.file_id,fileName:null!=o&&o.name?null==o?void 0:o.name:e.fileName,resolution:null!=o&&o.definition?null==o?void 0:o.definition:e.resolution,coverImg:e.coverImg?e.coverImg:null==o?void 0:o.cover_url,format:null!=o&&o.format?null==o?void 0:o.format:e.format,videoId:null!=(a=null==t?void 0:t.data)&&a.video_id?null==(r=null==t?void 0:t.data)?void 0:r.video_id:"0"})},renderVideoInfo:(e,t)=>{var a,r,o;const n=null==(r=null==(a=null==t?void 0:t.data)?void 0:a.render_task_media_meta)?void 0:r.VideoMeta;if(100===(null==(o=null==t?void 0:t.data)?void 0:o.progress)&&n)return(0,f.e)(n)},spaceInfo:({spaceInfo:e},t)=>{var a;return Object.assign(e||{},(null==(a=null==t?void 0:t.data)?void 0:a.spaceInfo)||{})}})]}],TRANSITION_RENDER_FALL_SPACE:{target:"renderFailed.fallSpace",actions:(0,c.kp)({spaceInfo:({spaceInfo:e},t)=>{var a;return Object.assign(e||{},(null==(a=null==t?void 0:t.data)?void 0:a.spaceInfo)||{})}})},TRANSITION_RENDER_SUCCESS:{actions:(0,c.kp)({fileId:(e,t)=>null==t?void 0:t.data.file_id,fileInfo:({fileInfo:e},t)=>{var a,r,o,n,i,s;return Object.assign(e||{},{resolution:null!=(r=null==(a=null==t?void 0:t.data)?void 0:a.render_task_info)&&r.definition?null==(n=null==(o=null==t?void 0:t.data)?void 0:o.render_task_info)?void 0:n.definition:e.resolution,videoId:null!=(i=null==t?void 0:t.data)&&i.video_id?null==(s=null==t?void 0:t.data)?void 0:s.video_id:"0"})},spaceInfo:({spaceInfo:e},t)=>{var a;return Object.assign(e||{},(null==(a=null==t?void 0:t.data)?void 0:a.spaceInfo)||{})}}),target:"renderSuccess"},TRANSITION_RENDER_FAILED:[{target:"renderFailed.hadCancel",actions:(0,c.kp)({spaceInfo:({spaceInfo:e},t)=>{var a;return Object.assign(e||{},(null==(a=null==t?void 0:t.data)?void 0:a.spaceInfo)||{})}}),cond:"isRequestRenderFailedHadCancel"},{target:"renderFailed.normal",actions:(0,c.kp)({errorCode:(e,t)=>null==t?void 0:t.errorCode,spaceInfo:({spaceInfo:e},t)=>{var a;return Object.assign(e||{},(null==(a=null==t?void 0:t.data)?void 0:a.spaceInfo)||{})}})}],PURE_TRANSITION_RENDER_SUCCESS:{target:"renderSuccess"},CANCEL_RENDER:{actions:["cancelRender",(0,c.kp)({cancelExportPromiseResolve:(e,{cancelExportPromiseResolve:t})=>t})]},CANCEL_RENDER_SUCCESS:{target:"#LvShareExportPanelMachine.close",actions:["cancelRenderSuccess"]},CANCEL_RENDER_FAIL:{actions:({cancelExportPromiseResolve:e})=>{null==e||e(null)}}}},renderSuccess:{initial:"requesting",entry:["initVideoInfo",e=>{var t;(0,o.n)().setParam({panel_page:null==(t=null==e?void 0:e.selectItemData)?void 0:t.payload.panelPage})},"executeExportSuccessCb"],invoke:{id:"requestVideoAndDownloadUrl",src:"requestVideoAndDownloadUrl",onDone:[{target:".requestImgSuccess",actions:(0,c.kp)({everCloudSpaceInstance:(e,t)=>t.data.everCloudSpaceInstance,isRequestUserBind:()=>!0,fileInfo:(e,t)=>{const{fileInfo:a}=t.data;return Object.assign(null!=e&&e.fileInfo?null==e?void 0:e.fileInfo:{},a)}}),cond:(e,t)=>{var a,r;return"image"===(null==(r=null==(a=t.data.fileInfo)?void 0:a.asset)?void 0:r.type)}},{target:".requestSuccess",actions:(0,c.kp)({everCloudSpaceInstance:(e,t)=>t.data.everCloudSpaceInstance,fileInfo:(e,t)=>{var a,r;const{fileInfo:o}=t.data;return o.resolution=null!=(a=null==e?void 0:e.fileInfo)&&a.resolution?null==(r=null==e?void 0:e.fileInfo)?void 0:r.resolution:o.resolution,Object.assign(null!=e&&e.fileInfo?null==e?void 0:e.fileInfo:{},o)},videoPlayInfo:(e,t)=>{const{currentVideoInfo:a}=t.data;return Object.assign(null!=e&&e.videoPlayInfo?null==e?void 0:e.videoPlayInfo:{},{currentVideoInfo:a})},isRequestUserBind:()=>!0})}],onError:{target:".requestFailed",actions:[(e,t)=>i.s.error("LvRender-requestVideoAndDownloadUrl",new Error(JSON.stringify(t)),{toGroup:"true"})]}},states:{requesting:{},requestSuccess:{tags:["renderComplete"],initial:"requestSuccessIdle",states:{requestSuccessIdle:{id:"requestSuccessIdle"},initXgVideo:{invoke:{id:"initXgVideo",src:"initXgVideo",onDone:[{target:"requestSuccessIdle"}],onError:[{target:"requestSuccessIdle"}]}}},on:{SAVE_VIDEO_INSTANCE:{actions:"saveVideoInstance"},CHANGE_DURATION:{actions:"changeDuration"},CHANGE_CURRENT_TIME:{actions:"changeCurrentTime"},UPDATE_CURRENT_TIME:{actions:"updateCurrentTime"},CHANGE_PLAY_STATUS:{actions:"changePlayStatus"},CHANGE_FULLSCREEN:{actions:"changeFullScreen"},CHANGE_WAITING_START_TIME:{actions:"changeWaitingStartTime"},CHANGE_DEFINITION:{actions:"changeDefinition"},CHANGE_VIDEO_FORMAT:{actions:["initProgress"]},CHANGE_VIDEO_FORMAT_FAIL:{actions:[]},CHANGE_DRAG_STATUS:{actions:"changeDragStatus"},INIT_XG_PLAYER:{target:".initXgVideo"}}},requestImgSuccess:{tags:["renderComplete"]},requestFailed:{entry:[()=>{(0,o.n)().setParam({panel_page:o.P.export_fail})}]}}},renderFailed:{states:{normal:{},hadCancel:{},fallSpace:{}}}},on:{RETRY_RENDER_SUCCESS:[{actions:["initProgress","saveRetryTaskId"],target:"#LvShareExportPanelMachine.open.rendering"}],RETRY_RENDER_FAIL:[{target:".renderFailed.fallSpace",actions:({fallSpaceRetryFailCallback:e})=>{null==e||e()},cond:"isRetryFallSpace"}],TRANSITION_RENDERING:{target:".rendering"},TRANSITION_RENDER_SUCCESS:{target:".renderSuccess"}}},close:{entry:["initContext"]}},on:{OPEN:{target:"open.rendering",actions:[(0,c.kp)({fileInfo:({fileInfo:e},{fileName:t,resolution:a,format:r})=>Object.assign(e,{fileName:t,resolution:a,format:r}),hideModal:(e,t)=>!!t.hideModal,renderSuccessCallbacks:({renderSuccessCallbacks:e},t)=>t.exportSuccessCb?[...e,t.exportSuccessCb]:e,customContent:(e,{customContent:t})=>t,exportCancelCb:(e,t)=>t.exportCancelCb,customText:(e,t)=>t.customText,customResultView:(e,t)=>t.customResultView,hideHeaderBtn:(e,t)=>t.hideHeaderBtn,disableCancelConfirm:(e,t)=>t.disableCancelConfirm,showVipCard:(e,t)=>t.showVipCard,allowCloseWindow:(e,t)=>t.allowCloseWindow??!0,presetProgressLimit:(e,t)=>t.presetProgressLimit??e.presetProgressLimit,precision:(e,t)=>t.precision,exportProcessCb:(e,t)=>t.exportProcessCb,customGetRenderProcessParams:(e,t)=>t.customGetRenderProcessParams,reportExtra:({reportExtra:e},t)=>Object.assign(e,null==t?void 0:t.extraData),selectItemData:({selectItemData:e},t)=>t.selectItemData?t.selectItemData:e}),"saveTaskId"]},CLOSE:{target:"close"},RETRY_RENDER:{actions:["retryRender"]},DUPLICATE_RENDER:{actions:["duplicateRender"]},SAVE_RENDER_PROGRESS:{actions:["saveRenderProgress"]},SAVE_FILEINFO:{actions:["saveFileInfo"]},SCENE_FILE_LIST_OPEN_RENDING:{target:"open.rendering",actions:["saveFileInfo","saveRenderProgress","saveTaskId","saveReportExtra","setPresetProgressLimit"]},SCENE_FILE_LIST_OPEN_RENDER_SUCCESS:{target:"open.renderSuccess",actions:["saveFileId","saveOpenModalType","saveFileInfo","saveSpaceInfo","saveReportExtra"]},SCENE_FILE_LIST_OPEN_RENDER_FAILED:[{target:"open.renderFailed.normal",actions:["saveFileInfo","saveTaskId","saveReportExtra"]}],SCENE_FILE_LIST_OPEN_RENDER_FAILED_SPACE_FULL:{target:"open.renderFailed.fallSpace",actions:["saveFileInfo","saveTaskId","saveReportExtra","saveSpaceInfo"]},SCENE_DETAIL_RETRY:{actions:["saveFileId","initProgress","changeVideoFormat"]},CHANGE_VIDEO_FORMAT_SUCCESS:[{actions:["saveRetryTaskId","saveRetryFileId"],target:"#LvShareExportPanelMachine.open.renderSuccess",cond:"isHasFileFormat"},{actions:["initProgress","saveRetryTaskId"],target:"#LvShareExportPanelMachine.open.rendering"}],SAVE_REPORT_EXTRA:{actions:["saveReportExtra"]},SAVE_SELECT_ITEM_DATA:{actions:["saveSelectItemData"]},TRANSITION_SAVING_STATE:{target:"open.save.saving",actions:(0,c.kp)({fileInfo:({fileInfo:e},{fileName:t,resolution:a,format:r,coverImg:o})=>Object.assign(e,{fileName:t||(null==e?void 0:e.fileName),resolution:a||(null==e?void 0:e.resolution),format:r||(null==e?void 0:e.format),coverImg:o||(null==e?void 0:e.coverImg)}),presetProgressLimit:(e,t)=>t.presetProgressLimit??e.presetProgressLimit,renderProgress:({presetProgressLimit:e},t)=>((null==t?void 0:t.progress)??0)*e/o.T,customText:({customText:e},t)=>t.customText??e,hideHeaderBtn:({hideHeaderBtn:e},t)=>t.hideHeaderBtn??e,disableCancelConfirm:({disableCancelConfirm:e},t)=>t.disableCancelConfirm??e,isSaveStateInit:!0,showVipCard:({showVipCard:e},t)=>t.showVipCard??e,precision:({precision:e},t)=>t.precision??e,selectItemData:({selectItemData:e},t)=>t.selectItemData?t.selectItemData:e})},TRANSITION_SAVE_SUCCESS_STATE:{target:"open.rendering",actions:(0,c.kp)({taskId:(e,{taskId:t})=>t})},TRANSITION_SAVE_FAIL_STATE:{target:"open.save.fail",actions:(0,c.kp)({errorCode:(e,{errorCode:t})=>t,errorTitle:(e,{errorTitle:t})=>t,errorMessage:(e,{errorMessage:t})=>t})},SET_SAVE_FAILED_OPERATES_CALLBACK:{actions:(0,c.kp)({saveStateOperatesCallback:(e,{callback:t})=>t})},SET_RENDER_STATE_OPERATES_CALLBACK:{actions:(0,c.kp)({renderStateOperatesCallback:(e,{callback:t})=>t})},ADD_EXPORT_CALLBACK:{actions:(0,c.kp)({renderSuccessCallbacks:({renderSuccessCallbacks:e},{callback:t})=>[...e,t]})},IGNORE_RENDERING_PROCESS_ERR:{actions:(0,c.kp)({renderPendingInfo:({renderPendingInfo:e},{errCode:t})=>(e.ignoreErrCodeSet.add(t),{errCode:0,ignoreErrCodeSet:e.ignoreErrCodeSet})})}}},{services:{importXgPlayer:async()=>{await Promise.all([a.e(3136),a.e(6590),a.e(782),a.e(1706),a.e(9978),a.e(8897),a.e(6236),a.e(1661),a.e(8730),a.e(2364),a.e(833)]).then(a.bind(a,2364)),await a.e(4836).then(a.bind(a,4836))},getRenderProgress:e=>t=>{const a=setInterval((async()=>{var a,r,n,s,l;try{const{taskId:l,renderPendingInfo:d}=e;if(d.errCode&&(null==(a=d.ignoreErrCodeSet)||!a.has(d.errCode)))return;const c="function"==typeof e.customGetRenderProcessParams?e.customGetRenderProcessParams():{},u=await o.a.batchGetRenderTask({task_ids:[l],need_task_info:!0,need_media_info:!0,force_export:!(null==(r=d.ignoreErrCodeSet)||!r.size),...c}),p=null==(s=null==(n=null==u?void 0:u.data)?void 0:n.render_task)?void 0:s[l];try{const e=null==p?void 0:p.progress,t=Number(e);isNaN(t)&&i.s.error("ExportModalExportProgress",new Error(`logid:${u.log_id},taskId:${l},progress:${e}`),{toGroup:"true"})}catch{i.s.error("ExportModalExportProgress",new Error(`logid:${u.log_id},taskId:${l}`),{toGroup:"true"})}const _=null!=p&&p.file_space_id?{spaceId:null==p?void 0:p.file_space_id,workspaceId:null==p?void 0:p.file_workspace_id,spaceHost:null==p?void 0:p.space_host,spaceResHost:null==p?void 0:p.space_res_host,spaceIdc:null==p?void 0:p.space_idc,spaceType:null==p?void 0:p.space_type}:void 0;if(p.render_ret_code&&p.render_ret_code>0)return void t({type:"TRANSITION_RENDER_FAILED",errorCode:`${p.render_ret_code}`,data:{spaceInfo:_}});if(p.status===o.R.failure)return void t({type:"TRANSITION_RENDER_FAILED",data:{spaceInfo:_}});if(p.status===o.R.success)return void t({type:"GET_RENDER_PROGRESS",data:{...p,progress:100,file_id:(null==p?void 0:p.file_id)||"",spaceInfo:_}});if(p.status===o.R.fallSpace)return void t({type:"TRANSITION_RENDER_FALL_SPACE",data:{spaceInfo:_}});if(p.status===o.R.processing)return void t({type:"GET_RENDER_PROGRESS",data:{...p,progress:null==p?void 0:p.progress,taskErrCode:Number((null==p?void 0:p.task_err_code)??0),allowCloseWindow:!(null!=p&&p.window_disable_cancel),allowCancelRender:null==p?void 0:p.allow_cancel,spaceInfo:_}})}catch(d){t({type:"TRANSITION_RENDER_FAILED",errorCode:null==(l=null==d?void 0:d.data)?void 0:l.ret})}}),3e3);return()=>clearInterval(a)},requestVideoAndDownloadUrl:async({fileId:e,fileInfo:t,renderVideoInfo:a,everCloudInstance:r,spaceInfo:n,exportType:s},l)=>{var d,c,u,p,v,h,m,g,S,T,I,E,y,k;const A=Date.now(),R=null!=(d=null==l?void 0:l.spaceInfo)&&d.workspaceId?l.spaceInfo:n;if(null!=(c=null==t?void 0:t.videoInfo)&&c.length&&null!=t&&t.downloadUrl)return{fileInfo:t};const N={};let P;const C=18===s,b=async()=>{await(null==r?void 0:r.init());const e=await(null==r?void 0:r.getSdkInstance({spaceId:null==R?void 0:R.spaceId,dcName:null==R?void 0:R.spaceIdc,netconf:{base:null==R?void 0:R.spaceHost,media:null==R?void 0:R.spaceResHost}}));return N.everCloudSpaceInstance=e,e};if(a)P=C?new f.R(a.asset):new f.b(a);else{i.s.error("RenderVideoInfo Error Undefined",new Error("RenderVideoInfo Error Undefined"),{info:Ee({fileId:e,fileInfo:t,spaceInfo:n}),level:i.L.warn});const a=await b(),[r,o]=C?await(0,f.a)(null==a?void 0:a.getAssetByFileId(e)):await(0,f.a)(null==a?void 0:a.getFileDetailWithTranscode({id:e}));console.log(o,"====getFilError===",R,l,n),o||!r?(i.s.error("LvRender-loadingResourceFail",o,{toGroup:"true",info:Ee(r),error:Ee(o),level:i.L.warn}),await(null==a?void 0:a.forceSyncPullUpdates()),P=C?await(null==a?void 0:a.getAssetByFileId(e)):await(null==a?void 0:a.getFileDetailWithTranscode({id:e}))):P=r}if(C){const e=null==(u=P.imageTranscodeInfo)?void 0:u[_.N8.ORIGIN];let t;if(null!=e&&e.preview_url){const a=N.everCloudInstance??await b(),[r,o]=await(0,f.a)(a.downloadByUrlKey({url:null==e?void 0:e.preview_url,key:null==e?void 0:e.key}).then((e=>e.done())).then((e=>((e,t)=>{const a=new Blob([e],{type:t||"image/*"});return window.URL.createObjectURL(a)})(e.buffer))));console.log(o,"====getImgUrlError===",r,P),t=r}return N.fileInfo={fileName:null==P?void 0:P.fileName,size:null==P?void 0:P.size,type:o.F.Material,downloadUrl:P.downloadUrl,asset:P,previewImageUrl:t},N}const O=null==P?void 0:P.videoInfo.map(((e,t)=>({definition:e.type,url:e.url,bitrate:1e5*t,keyValue:e.key})));let w=null==O?void 0:O[O.length-1];return null==(p=null==O?void 0:O.forEach)||p.call(O,(e=>{"origin"===e.definition&&(w=e)})),null!=w&&w.url||i.s.error("RenderVideoInfo Error Empty Url",new Error("RenderVideoInfo Error Empty Url"),{level:i.L.warn}),N.fileInfo={fileName:null==P?void 0:P.fileName,duration:null==P?void 0:P.duration,size:null==P?void 0:P.size,type:["film","video"].includes((null==P?void 0:P.type)??"")?o.F.FilmVideo:o.F.Material,fileType:["film","video"].includes((null==P?void 0:P.type)??"")?o.F.FilmVideo:o.F.Material,videoInfo:O,format:null==(v=null==P?void 0:P.asset)?void 0:v.mime,resolution:(null==(m=null==(h=null==P?void 0:P.asset)?void 0:h.meta)?void 0:m.resolution)||`${Math.min(null==(g=null==P?void 0:P.asset)?void 0:g.width,null==(S=null==P?void 0:P.asset)?void 0:S.height)}p`||"-",downloadUrl:null==(T=null==P?void 0:P.asset)?void 0:T.downloadUrl,videoId:null!=(E=null==(I=null==P?void 0:P.asset)?void 0:I.meta)&&E.web_video_id?null==(k=null==(y=null==P?void 0:P.asset)?void 0:y.meta)?void 0:k.web_video_id:t.videoId,asset:null==P?void 0:P.asset},N.currentVideoInfo=w,i.s.dataEvent("LvRender-cloudTranscodeVideo",{duration:`${Math.floor((Date.now()-A)/1e3)} s`}),N},initXgVideo:({fileInfo:e,videoPlayInfo:t,reportExtra:r})=>o=>{let n;const i="smart_tool_page"===(null==r?void 0:r.currentPage);try{(async()=>{var s,l,d;const{default:c}=await Promise.all([a.e(3136),a.e(6590),a.e(782),a.e(1706),a.e(9978),a.e(8897),a.e(6236),a.e(1661),a.e(8730),a.e(2364),a.e(833)]).then(a.bind(a,2364)),{default:u,Events:p}=await a.e(4836).then(a.bind(a,4836)),_="SHARE_MODAL_VIDEO";document.getElementById(_)&&(n=new u({id:_,url:null==(s=null==t?void 0:t.currentVideoInfo)?void 0:s.url,autoplay:!1,width:"100%",height:"100%",seekedStatus:"auto",loop:!0,controls:!1,definition:{defaultDefinition:null==(l=null==t?void 0:t.currentVideoInfo)?void 0:l.definition,list:(null==e?void 0:e.videoInfo)||[]},plugins:[c],Mp4EncryptPlayer:{keyValue:null==(d=null==t?void 0:t.currentVideoInfo)?void 0:d.keyValue,switchBitRateWay:!0,useEME:!1,disableBufferBreakCheck:!0},keyboard:{seekStep:2}}),n.lang="en",n.registerPlugin(f.C),o({type:"SAVE_VIDEO_INSTANCE",videoInstance:n}),n.on(p.LOADED_DATA,(()=>{o({type:"CHANGE_DURATION",duration:(null==n?void 0:n.duration)||0})})),n.on(p.TIME_UPDATE,(()=>{n&&(o({type:"CHANGE_DURATION",duration:n.duration||0}),o({type:"CHANGE_CURRENT_TIME",currentTime:n.currentTime>n.duration?n.duration:n.currentTime}))})),n.on(p.PLAY,(()=>{i&&ye.report({enter_from:r.enterFrom,from_page:null==r?void 0:r.fromPage,current_page:null==r?void 0:r.currentPage,resolution:e.resolution,size:Math.round(Number(e.size)/1024/1024*100)/100,format:e.format,video_duration:Math.round(Number(e.duration)/1e3),action:"play"}),o({type:"CHANGE_PLAY_STATUS",playStatus:!0,isCallback:!0})})),n.on(p.PAUSE,(()=>{i&&ye.report({enter_from:r.enterFrom,resolution:e.resolution,size:Math.round(Number(e.size)/1024/1024*100)/100,format:e.format,video_duration:Math.round(Number(e.duration)/1e3),action:"pause"}),o({type:"CHANGE_PLAY_STATUS",playStatus:!1,isCallback:!0})})),n.on(p.FULLSCREEN_CHANGE,(t=>{i&&ye.report({enter_from:r.enterFrom,resolution:e.resolution,size:Math.round(Number(e.size)/1024/1024*100)/100,format:e.format,video_duration:Math.round(Number(e.duration)/1e3),action:"full_screen"}),o({type:"CHANGE_FULLSCREEN",fullscreen:t})})),n.on(p.ERROR,(()=>{o({type:"CHANGE_PLAY_STATUS",playStatus:!1,isCallback:!0})})),n.on(p.XGLOG,(e=>{"waitingStart"===e.eventType?o({type:"CHANGE_WAITING_START_TIME",time:Date.now()}):"waitingEnd"===e.eventType&&o({type:"CHANGE_WAITING_START_TIME",time:0})})))})()}catch(s){return Promise.reject(s)}return()=>{var e;null==(e=null==n?void 0:n.destroy)||e.call(n),n=null}}},actions:{saveSpaceInfo:(0,c.kp)({spaceInfo:({spaceInfo:e},t)=>Object.assign(e||{},(null==t?void 0:t.spaceInfo)||{})}),cancelRender:(0,c.tN)((({fileInfo:e,taskId:t,cancelExportPromiseResolve:a,exportCancelCb:r})=>({type:"ADD_TASK",exec:async()=>(await o.a.cancelRenderTask({task_id:t}),null==a||a({fileInfo:e}),null==r||r(),{fileInfo:e}),successType:"CANCEL_RENDER_SUCCESS",failType:"CANCEL_RENDER_FAIL"})),{to:"asyncTaskActor"}),retryRender:(0,c.tN)((({taskId:e})=>({type:"ADD_TASK",exec:async()=>({taskId:(await o.a.retryRenderTask({task_id:e})).data.task_id}),successType:"RETRY_RENDER_SUCCESS",failType:"RETRY_RENDER_FAIL"})),{to:"asyncTaskActor"}),duplicateRender:(0,c.tN)((({taskId:e})=>({type:"ADD_TASK",exec:async()=>({taskId:(await o.a.duplicateRenderTask({task_id:e})).data.task_id}),successType:"RETRY_RENDER_SUCCESS",failType:"RETRY_RENDER_FAIL"})),{to:"asyncTaskActor"}),cancelRenderSuccess:e=>{var t;null==(t=null==e?void 0:e.retryCallback)||t.call(e)},executeExportSuccessCb:e=>{var t;null==(t=null==e?void 0:e.renderSuccessCallbacks)||t.forEach((e=>{e()}))},setPresetProgressLimit:(0,c.kp)({presetProgressLimit:(e,t)=>t.presetProgressLimit??o.D}),saveRetryTaskId:(0,c.kp)({taskId:(e,t)=>t.data.taskId}),saveRenderProgress:(0,c.kp)({renderProgress:(e,t)=>t.renderProgress}),saveFileInfo:(0,c.kp)({fileInfo:(e,t)=>t.fileInfo}),saveTaskId:(0,c.kp)({taskId:(e,t)=>t.taskId}),saveFileId:(0,c.kp)({fileId:(e,t)=>t.fileId}),saveOpenModalType:(0,c.kp)({openModalType:(e,t)=>t.openModalType}),saveVideoInstance:(0,c.kp)({videoPlayInfo:(e,t)=>({...e.videoPlayInfo,videoInstance:t.videoInstance})}),changeDuration:(0,c.kp)({videoPlayInfo:(e,t)=>({...e.videoPlayInfo,duration:t.duration})}),changeCurrentTime:(0,c.kp)({videoPlayInfo:(e,t)=>e.videoPlayInfo.dragging?e.videoPlayInfo:{...e.videoPlayInfo,currentTime:t.currentTime}}),updateCurrentTime:(0,c.kp)({videoPlayInfo:(e,t)=>{var a,r;return null==(r=null==(a=e.videoPlayInfo)?void 0:a.videoInstance)||r.seek(t.currentTime),{...e.videoPlayInfo,currentTime:t.currentTime}}}),changePlayStatus:(0,c.kp)({videoPlayInfo:(e,t)=>{var a,r,o,n;const{isCallback:i,playStatus:s}=t;return i||(s?null==(r=null==(a=e.videoPlayInfo)?void 0:a.videoInstance)||r.play():null==(n=null==(o=e.videoPlayInfo)?void 0:o.videoInstance)||n.pause()),{...e.videoPlayInfo,playStatus:i?s:e.videoPlayInfo.playStatus}}}),changeFullScreen:(0,c.kp)({videoPlayInfo:(e,t)=>({...e.videoPlayInfo,fullscreen:t.fullscreen})}),changeWaitingStartTime:(0,c.kp)({videoPlayInfo:(e,t)=>({...e.videoPlayInfo,waitingStartTime:t.time})}),changeDefinition:(0,c.kp)({videoPlayInfo:(e,t)=>{var a;return"CHANGE_DEFINITION"!==t.type?e.videoPlayInfo:(null==(a=e.videoPlayInfo.videoInstance)||a.changeDefinition(t.currentVideoInfo),{...e.videoPlayInfo,currentVideoInfo:t.currentVideoInfo})}}),initVideoInfo:(0,c.kp)({fileInfo:({fileInfo:e})=>Object.assign(e||{},{videoInfo:[]}),videoPlayInfo:({videoPlayInfo:e})=>Object.assign(e||{},{currentVideoInfo:{}})}),initContext:(0,c.kp)((({userRegion:e})=>({isSaveStateInit:!1,createTime:0,expectFinishTime:0,renderProgress:0,userRegion:e,openModalType:void 0,allowCancelRender:!0,renderPendingInfo:{errCode:0,ignoreErrCodeSet:new Set},spaceInfo:{workspaceId:"",spaceId:"",spaceHost:"",spaceResHost:"",spaceIdc:""},videoPlayInfo:{currentTime:0,playStatus:!1,fullscreen:!1,duration:0,videoInstance:null},fileInfo:()=>({fileName:"-",size:"Calculating...",coverImg:"",resolution:"-",duration:0,type:"",downloadUrl:""}),taskId:"",fileId:"",renderSuccessCallbacks:[],reportExtra:{},exportCancelCb:void 0,customText:void 0,customResultView:void 0,hideHeaderBtn:!1,disableCancelConfirm:!1}))),saveRetryFileId:(0,c.kp)({fileId:(e,t)=>{var a;return null==(a=null==t?void 0:t.data)?void 0:a.fileId}}),initProgress:(0,c.kp)({renderProgress:()=>0}),saveReportExtra:(0,c.kp)({reportExtra:(e,t)=>t.reportExtra}),saveSelectItemData:(0,c.kp)({selectItemData:(e,t)=>t.selectItemData}),changeDragStatus:(0,c.kp)({videoPlayInfo:(e,t)=>({...e.videoPlayInfo,dragging:t.dragging})})},guards:{isRetryFallSpace:(e,t)=>{var a,r;return"200406"===(null==(r=null==(a=null==t?void 0:t.data)?void 0:a.data)?void 0:r.ret)},isRequestRenderFailedHadCancel:(e,{errorCode:t})=>!(!t||"200410"!==t),isHasFileFormat:(e,t)=>{var a;return!(null==(a=null==t?void 0:t.data)||!a.fileId)}}}),Ne=(0,o.r)(),Pe=(0,o.n)(),Ce=()=>{var e,t,a;const r=(null==(e=null==Ne?void 0:Ne.getConfig())?void 0:e.header)||{};return{header:r,client_ip:"",params:{scenario:"custom",is_pwa:Number(q()),pwa_from:X(),open_from_pwa:Number(J()),current_page:null==(t=Pe.getReportParam())?void 0:t.current_page},user:{user_id:"uid",user_id_login:!0,user_unique_id:"uid",web_id:null==(a=r.custom)?void 0:a.web_id}}};var be,Oe,we,Le,Fe,Ue,De,xe;class Me{constructor({context:e,action:t,panel_page:a}){T(this,be),T(this,we),T(this,Fe),T(this,De),S(this,"context"),S(this,"panel_page"),S(this,"action"),this.context=e,this.action=t,this.panel_page=a??Pe.getReportParam().panel_page}report(){const e=this.context.businessType,t=I(this,De,xe).call(this);if(e!==o.F.Graphic)[ke.detailPage,ke.workspace].includes(this.context.openType)?new ne(t).report():Pe.report(t);else{const{action:e,share_account:a}=t;me().report({share_account:a,action:e})}}}be=new WeakSet,Oe=function(){var e;return{action:this.action,current_page:this.context.currentPage,enter_from:null==(e=this.context.reportExtra)?void 0:e.enterFrom,panel_page:this.panel_page}},we=new WeakSet,Le=function(){const{fileInfo:e}=this.context;return{video_id:e.videoId,video_duration:e.duration,size:parseFloat(e.fileSize??""),format:e.format,resolution:e.resolution}},Fe=new WeakSet,Ue=function(){const{formInfo:e,userInfo:t}=this.context,a=null==e?void 0:e.title;return{description:null==e?void 0:e.describe,share_account:null==t?void 0:t.name,share_caption:a,share_caption_words_cnt:null==a?void 0:a.length,is_cover_added:null!=e&&e.cover?"1":"0"}},De=new WeakSet,xe=function(){return{...I(this,be,Oe).call(this),...I(this,we,Le).call(this),...I(this,Fe,Ue).call(this)}};const Be=e=>z.getShareProgress({share_ids:[e]}).then((t=>{var a;return null==(a=t.share_tasks)?void 0:a[e]})),je={[o.d.GROUP]:o.i.FacebookGroup,[o.d.PAGE]:o.i.FacebookPage,[o.d.INSTAGRAM]:o.i.Ins},He=(0,d.O)({initial:"close",context:{shareType:o.d.GROUP,uploadProgress:0,reportExtra:{},fileInfo:{},businessType:o.F.FilmVideo,failReason:"",openType:ke.default},states:{close:{entry:["initContext"]},show:{id:"show",states:{unknowBind:{always:[{target:"hasBind",cond:"isBind"},{target:"hasNotBind"}]},hasNotBind:{},hasBind:{initial:"notUpload",states:{notUpload:{},uploading:{states:{preparing:{id:"preparing",entry:[(0,c.kp)({uploadProgress:0,uploadStartTime:()=>m()().unix(),randomFileSize:()=>1024*(0,u.A)(5,20)*1024})],invoke:[{id:"mockProgress",src:"mockProgress"},{id:"publishToFacebook",src:"publishToFacebook",onDone:{target:"#polling",actions:["saveShareId"]},onError:{target:"#uploadFailed",actions:[(0,c.tN)("UPLOAD_FAILED")]}}]},polling:{id:"polling",invoke:{id:"startPolling",src:"startPolling"},on:{PUBLISH_PROGRESS:[{cond:"isShareSuccess",target:"#shareSuccess",actions:[(0,p.Rm)("ShareSuccess"),"saveUploadPlatformLink",(0,c.T4)({type:"USE_SHARE_SUCCESS_CALLBACK"})]},{cond:"isUploadFailed",target:"#uploadFailed",actions:["saveUploadPlatformLink","saveFailedReason",(0,p.Rm)("UploadFailed")]}]}}}},uploaded:{states:{success:{id:"shareSuccess",on:{REPORT_COPY:{actions:[e=>{new Me({context:e,action:o.E.copy_link}).report()}]},REPORT_WATCH:{actions:[e=>{new Me({context:e,action:o.E.watch}).report()}]}}},failed:{id:"uploadFailed",on:{RETRY:{target:"#preparing",actions:[e=>{new Me({context:e,action:o.E.try_again}).report()}]}}}}},unbind:{id:"unbind",initial:"loading",states:{loading:{invoke:{src:()=>x.shareUserUnbind({platform:o.c.Facebook}),onDone:{target:"#show.hasNotBind",actions:[(0,p.Rm)("User unbind successfully."),(0,c.kp)({userInfo:()=>{}}),(0,c.T4)("USER_UNBIND_SUCCESS_CALLBACK"),(0,c.T4)({type:"REMOVE_USER_INFO",platform:o.c.Facebook})]},onError:{target:"#unbind.failed",actions:[(0,c.T4)("USER_UNBIND_FAILED_CALLBACK")]}}},failed:{}}}},on:{UPLOAD_TO_PLATFORM:{target:"#preparing",actions:["saveFormInfo",e=>{new Me({context:e,action:o.E.upload}).report()},"reporterClickShareWhere"]},UPLOAD_FAILED:[{target:"hasNotBind",actions:["saveUploadFailedErrorCode"],cond:"isUserInfoError"},{actions:["saveUploadFailedErrorCode"],cond:"isVideoTooLong"},{target:"#uploadFailed",actions:["saveUploadFailedErrorCode"]}]}}}}},on:{INIT_SERVICE:{target:"close"},SAVE_FILE_INFO:{actions:["saveFileInfo"]},SAVE_REPORT_EXTRA:{actions:["saveReportExtra"]},SAVE_SPACE_INFO:{actions:["saveSpaceInfo"]},SAVE_SHARE_TYPE:{actions:"saveShareType"},SHOW:{target:"show.hasBind"},BACK_CHOSEN_STATE:{target:"show.unknowBind",actions:[e=>{new Me({context:e,action:o.E.back}).report()}]},BACK_CHOOSE_STATE:{target:"close",actions:[()=>Pe.deleteFormData(),(0,c.T4)("CLEAR_SELECTED_PLATFORM"),e=>{new Me({context:e,action:o.E.back}).report()}]},USER_UNBIND:{target:"#unbind",actions:[(0,p.Rm)("Click\u300cSign out\u300dbutton"),(e,t)=>{var a;((null==(a=t.data)?void 0:a.report)??1)&&new Me({context:e,action:o.E.sign_out}).report()}]},INIT_USER_INFO:{cond:"hasUserInfo",target:"show.hasBind",actions:"saveUserInfo"},TRANSITION_UPLOADING:{target:"#polling",actions:["saveShareId","savePlatformLink","saveShareType"],internal:!0},TRANSITION_UPLOAD_SUCCESS:{target:"#shareSuccess",actions:["saveShareId","savePlatformLink","saveShareType"]},TRANSITION_UPLOAD_FAILED:{target:"#uploadFailed",actions:["saveShareId","savePlatformLink","saveShareType","saveFailedReason"]},REPORT_FEEDBACK:{actions:e=>{new Me({context:e,action:o.E.feedback}).report()}},CONNECT_ACCOUNT:{actions:[(0,c.T4)(((e,t)=>({type:"OPEN_AUTH_WINDOW",data:{...t.data,order:o.h.Second}}))),e=>{new Me({context:e,action:o.E.connect_ins_via_fb}).report()}]},UPDATE_PROGRESS:{actions:[(0,p.Rm)("Update progress..."),"updateProgressByTime"]}}},{guards:{hasUserInfo:(e,t)=>{var a;return!(null==(a=null==t?void 0:t.data)||!a[O.FACEBOOK_USER_INFO])},isBind:({userInfo:e})=>!(null==e||!e.name),isUploadFailed:(e,t)=>{var a;return(null==(a=t.data)?void 0:a.status)===Te.uploadFailed},isShareSuccess:(e,t)=>{var a;return(null==(a=t.data)?void 0:a.status)===Te.shareSuccess},isUserInfoError:(e,t)=>{var a,r;return(null==(r=null==(a=null==t?void 0:t.data)?void 0:a.data)?void 0:r.ret)===o.g.UPLOAD_AUTH_ERROR},isVideoTooLong:(e,t)=>{var a,r;return(null==(r=null==(a=null==t?void 0:t.data)?void 0:a.data)?void 0:r.ret)===o.g.VIDEO_DURATION_TOO_LONG}},actions:{initContext:(0,c.kp)({shareId:void 0,uploadProgress:0}),saveSpaceInfo:(0,c.kp)({workspaceId:(e,t)=>{var a;return null==(a=t.spaceInfo)?void 0:a.workspaceId}}),saveShareType:(0,c.kp)({shareType:(e,t)=>{var a;return(null==(a=t.data)?void 0:a.facebookShareType)??o.d.GROUP},businessType:(e,t)=>{var a;return(null==(a=t.data)?void 0:a.businessType)??o.F.FilmVideo}}),saveReportExtra:(0,c.kp)({currentPage:(e,t)=>t.currentPage,openType:(e,t)=>t.openType,reportExtra:(e,t)=>({...e.reportExtra,...(0,r.A)(t.reportExtra,(e=>![void 0,null].includes(e)))})}),saveFileInfo:(0,c.kp)({fileInfo:(e,t)=>t.fileInfo}),saveUserInfo:(0,c.kp)({userInfo:(e,t)=>{var a;return null==(a=null==t?void 0:t.data)?void 0:a[O.FACEBOOK_USER_INFO]}}),updateProgressByTime:(0,c.kp)({uploadProgress:(e,t)=>{var a;const{fileSize:r=Number(e.fileInfo.fileSize)||e.randomFileSize,createTime:o=e.uploadStartTime}=t.data||{},n=+`9${null==(a=r.toString())?void 0:a[r.toString().length-1]}`,i=(0,l.d)({totalSize:r,createTime:o,maxProgress:n});return Math.max(e.uploadProgress,i)}}),saveUploadFailedErrorCode:(0,c.T4)(((e,t)=>({type:"SAVE_ERROR_CODE",errorCode:t.data.data.ret}))),saveUploadPlatformLink:(0,c.kp)({platformLink:(e,t)=>{var a;return null==(a=t.data)?void 0:a.link}}),saveFailedReason:(0,c.kp)({failReason:(e,t)=>{var a;return null==(a=t.data)?void 0:a.fail_reason}}),savePlatformLink:(0,c.kp)({platformLink:(e,t)=>{var a;return null==(a=t.data)?void 0:a.platformLink}}),saveShareId:(0,c.kp)({shareId:(e,t)=>{var a;return null==(a=t.data)?void 0:a.shareId}}),saveFormInfo:(0,c.kp)({formInfo:(e,t)=>t.data}),reporterClickShareWhere:({fileInfo:e,reportExtra:t={},shareType:a,businessType:r})=>{var n,i,s,d,c,u,p;if(r===o.F.Graphic)return;const _={[o.d.GROUP]:"fb_groups",[o.d.PAGE]:"fb_pages",[o.d.INSTAGRAM]:"reels"};(new te).report({...(0,l.g)(null==e?void 0:e.asset),template_id:null==(i=null==(n=null==e?void 0:e.asset)?void 0:n.meta)?void 0:i.templateId,video_type_id:(0,l.p)(null==(d=null==(s=null==e?void 0:e.asset)?void 0:s.meta)?void 0:d.templateProducerAppId)??l.v[null==(u=null==(c=null==e?void 0:e.asset)?void 0:c.meta)?void 0:u.itemType],platform:_[a],video_id:(null==e?void 0:e.videoId)??"",current_page:t.currentPage,enter_from:t.enterFrom,resolution:String((null==e?void 0:e.resolution)??""),size:Number((null==e?void 0:e.fileSize)??0),format:(null==e?void 0:e.format)??"undefined",video_duration:(null==e?void 0:e.duration)??0,tool_type:(null==t?void 0:t.toolType)||(null==(p=(0,l.g)(null==e?void 0:e.asset))?void 0:p.tool_type),task_id:null==t?void 0:t.taskId,intelligent_request_id:null==t?void 0:t.intelligentRequestId,autocut_template_id:null==t?void 0:t.autocutTemplateId})}},services:{publishToFacebook:async({fileInfo:e,workspaceId:t,formInfo:a,businessType:r,shareType:n})=>{var i;const s=r===o.F.Graphic?{asset_id:(null==(i=null==e?void 0:e.assetIdList)?void 0:i[0])??"",asset_id_list:null==e?void 0:e.assetIdList}:{asset_id:(null==e?void 0:e.fileId)??"",asset_id_list:[(null==e?void 0:e.fileId)??""]},{share_id:l}=await z.shareToThirdPartyPlatform({platform:je[n],workspace_id:t,form_info:a,...s,share_type:r??o.F.FilmVideo,custom_info:JSON.stringify(Ce())});return{shareId:l}},mockProgress:()=>e=>{const t=setInterval((()=>{e("UPDATE_PROGRESS")}),500);return()=>clearInterval(t)},startPolling:({shareId:e})=>t=>{if(!e)throw new Error("No shareId provided!");const a=setInterval((async()=>{try{const a=await Be(e);t({type:"UPDATE_PROGRESS",data:{createTime:a.create_time}}),t({type:"PUBLISH_PROGRESS",data:a})}catch{t("UPLOAD_FAILED")}}),1e3);return()=>clearInterval(a)}}});(0,o.r)();const Ge=(0,o.n)();var Ve,ze,Ye,We,Ke,qe,Je,Xe;class $e{constructor({context:e,action:t,panel_page:a}){T(this,Ve),T(this,Ye),T(this,Ke),T(this,Je),S(this,"context"),S(this,"panel_page"),S(this,"action"),this.context=e,this.action=t,this.panel_page=a??Ge.getReportParam().panel_page}report(){const e=this.context.businessType,t=I(this,Je,Xe).call(this);if(e!==o.F.Graphic)[ke.detailPage,ke.workspace].includes(this.context.openType)?new ne(t).report():Ge.report(t);else{const{action:e,share_account:a}=t;me().report({share_account:a,action:e})}}}Ve=new WeakSet,ze=function(){var e;return{action:this.action,current_page:this.context.currentPage,enter_from:null==(e=this.context.reportExtra)?void 0:e.enterFrom,panel_page:this.panel_page}},Ye=new WeakSet,We=function(){const{fileInfo:e}=this.context;return{video_id:e.videoId,video_duration:e.duration,size:parseFloat(e.fileSize??""),format:e.format,resolution:e.resolution}},Ke=new WeakSet,qe=function(){return{share_account:""}},Je=new WeakSet,Xe=function(){return{...I(this,Ve,ze).call(this),...I(this,Ye,We).call(this),...I(this,Ke,qe).call(this)}};const Ze=(e,t)=>t&&t===s.M.SmartToolPage?s.M.SmartToolPage:e===o.F.Graphic?s.M.PictureEdit:s.M.Editor,Qe=(0,d.O)({initial:"close",context:{uploadProgress:0,reportExtra:{},fileInfo:{},businessType:o.F.FilmVideo,failReason:"",supportReplace:!1,openType:ke.default},states:{close:{entry:["initContext"]},show:{id:"show",states:{unknowBind:{always:[{target:"hasBind",cond:"isBind"},{target:"hasNotBind"}]},hasNotBind:{},hasBind:{initial:"notUpload",states:{notUpload:{},uploading:{states:{preparing:{id:"preparing",entry:[(0,c.kp)({uploadProgress:0,uploadStartTime:()=>m()().unix(),randomFileSize:()=>1024*(0,u.A)(5,20)*1024})],invoke:[{id:"mockProgress",src:"mockProgress"},{id:"publishToShopify",src:"publishToShopify",onDone:{target:"#polling",actions:["saveJobIds","reportUploadSuccess"]},onError:{target:"#uploadFailed",actions:[(0,c.tN)("UPLOAD_FAILED"),"reportUploadFail"]}}]},polling:{id:"polling",invoke:{id:"startPolling",src:"startPolling"},on:{PUBLISH_PROGRESS:[{cond:"isShareSuccess",target:"#shareSuccess",actions:[(0,p.Rm)("ShareSuccess"),"saveUploadPlatformLink","reportMaterialStatusSuccess",(0,c.T4)({type:"USE_SHARE_SUCCESS_CALLBACK"})]},{cond:"isUploadFailed",target:"#uploadFailed",actions:["saveUploadPlatformLink","saveFailedReason",(0,p.Rm)("UploadFailed"),"reportMaterialStatusFail"]}]}}}},uploaded:{states:{success:{id:"shareSuccess",on:{REPORT_WATCH:{actions:["reportExportPanelOpen","reportSmartToolPage"]}}},failed:{id:"uploadFailed",on:{RETRY:{target:"#preparing",actions:["reportExportPanelRetry"]}}}}},unbind:{id:"unbind",initial:"loading",states:{loading:{invoke:{src:()=>x.shareUserUnbind({platform:o.c.Shopify}),onDone:{target:"#show.hasNotBind",actions:[(0,p.Rm)("User unbind successfully."),(0,c.kp)({userInfo:()=>{}}),(0,c.T4)("USER_UNBIND_SUCCESS_CALLBACK"),(0,c.T4)({type:"REMOVE_USER_INFO",platform:o.c.Shopify})]},onError:{target:"#unbind.failed",actions:[(0,c.T4)("USER_UNBIND_FAILED_CALLBACK")]}}},failed:{}}}},on:{UPLOAD_TO_PLATFORM:{target:"#preparing",actions:["saveFormInfo"]},UPLOAD_FAILED:[{target:"#uploadFailed",actions:["saveUploadFailedErrorCode"]}]}}}}},on:{UPDATE_SHOPIFY_META_INFO:{actions:[(0,c.kp)({thirdpartyMetaInfo:(e,t)=>{var a;return null==(a=null==t?void 0:t.data)?void 0:a.thirdpartyMetaInfo}})]},INIT_SERVICE:{target:"close"},SAVE_FILE_INFO:{actions:["saveFileInfo"]},SAVE_REPORT_EXTRA:{actions:["saveReportExtra"]},SAVE_SPACE_INFO:{actions:["saveSpaceInfo"]},SAVE_SHARE_TYPE:{actions:"saveShareType"},SHOW:{target:"show.hasBind"},BACK_CHOSEN_STATE:{target:"show.unknowBind",actions:["reportExportPanelBack"]},BACK_CHOOSE_STATE:{target:"close",actions:[()=>Ge.deleteFormData(),(0,c.T4)("CLEAR_SELECTED_PLATFORM"),e=>{new $e({context:e,action:o.E.back}).report()}]},UPDATE_SELECTED_USER_ID:{actions:[(0,c.kp)({selectedUserId:(e,t)=>{var a;return null==(a=null==t?void 0:t.data)?void 0:a.selectedUserId}})]},USER_UNBIND:{target:"#unbind",actions:[(0,p.Rm)("Click\u300cSign out\u300dbutton"),(e,t)=>{var a;((null==(a=t.data)?void 0:a.report)??1)&&new $e({context:e,action:o.E.sign_out}).report()}]},INIT_USER_INFO:{cond:"hasUserInfo",target:"show.hasBind",actions:["saveUserInfo","updateSelectedUserId"]},TRANSITION_UPLOADING:{target:"#polling",actions:["saveJobIds","savePlatformLink","saveShareType"],internal:!0},TRANSITION_UPLOAD_SUCCESS:{target:"#shareSuccess",actions:["saveJobIds","savePlatformLink","saveShareType"]},TRANSITION_UPLOAD_FAILED:{target:"#uploadFailed",actions:["saveJobIds","savePlatformLink","saveShareType","saveFailedReason"]},REPORT_FEEDBACK:{actions:e=>{new $e({context:e,action:o.E.feedback}).report()}},CONNECT_ACCOUNT:{actions:[(0,c.T4)(((e,t)=>({type:"OPEN_AUTH_WINDOW",data:{...t.data,order:o.h.Second}}))),e=>{new $e({context:e,action:o.E.connect_ins_via_fb}).report()}]},UPDATE_PROGRESS:{actions:[(0,p.Rm)("Update progress..."),"updateProgressByTime"]}}},{guards:{hasUserInfo:(e,t)=>{var a,r;return(null==(r=null==(a=null==t?void 0:t.data)?void 0:a[o.c.Shopify])?void 0:r.accounts.length)>0},isBind:({userInfo:e})=>!(null==e||!e.accounts.length),isUploadFailed:(e,t)=>{var a;return(null==(a=t.data)?void 0:a.status)===Te.uploadFailed},isShareSuccess:(e,t)=>{var a;return(null==(a=t.data)?void 0:a.status)===Te.shareSuccess},isVideoTooLong:(e,t)=>{var a,r;return(null==(r=null==(a=null==t?void 0:t.data)?void 0:a.data)?void 0:r.ret)===o.g.VIDEO_DURATION_TOO_LONG}},actions:{initContext:(0,c.kp)({uploadProgress:0}),saveSpaceInfo:(0,c.kp)({workspaceId:(e,t)=>{var a;return null==(a=t.spaceInfo)?void 0:a.workspaceId}}),saveShareType:(0,c.kp)({businessType:(e,t)=>{var a;return(null==(a=t.data)?void 0:a.businessType)??o.F.FilmVideo}}),saveReportExtra:(0,c.kp)({currentPage:(e,t)=>t.currentPage,openType:(e,t)=>t.openType,reportExtra:(e,t)=>({...e.reportExtra,...(0,r.A)(t.reportExtra,(e=>![void 0,null].includes(e)))})}),saveFileInfo:(0,c.kp)({fileInfo:(e,t)=>t.fileInfo}),saveUserInfo:(0,c.kp)({userInfo:(e,t)=>{var a;return null==(a=null==t?void 0:t.data)?void 0:a[o.c.Shopify]}}),updateSelectedUserId:(0,c.kp)({selectedUserId:e=>{var t,a,r;if(!e.selectedUserId){const{accountId:o}=(0,l.e)();return o||(null==(r=null==(a=null==(t=null==e?void 0:e.userInfo)?void 0:t.accounts)?void 0:a[0])?void 0:r.user_id)}return""}}),updateProgressByTime:(0,c.kp)({uploadProgress:(e,t)=>{var a;const{fileSize:r=Number(e.fileInfo.fileSize)||e.randomFileSize,createTime:o=e.uploadStartTime}=t.data??{},n=+`9${null==(a=r.toString())?void 0:a[r.toString().length-1]}`,i=(0,l.d)({totalSize:r,createTime:o,maxProgress:n});return Math.max(e.uploadProgress,i)}}),saveUploadFailedErrorCode:(0,c.T4)(((e,t)=>{var a,r;return{type:"SAVE_ERROR_CODE",errorCode:null==(r=null==(a=null==t?void 0:t.data)?void 0:a.data)?void 0:r.ret}})),saveUploadPlatformLink:(0,c.kp)({}),saveFailedReason:(0,c.kp)({failReason:(e,t)=>{var a;return null==(a=t.data)?void 0:a.fail_reason}}),savePlatformLink:(0,c.kp)({}),saveJobIds:(0,c.kp)({jobIds:(e,t)=>{var a;return null==(a=t.data)?void 0:a.jobIds}}),saveFormInfo:(0,c.kp)({formInfo:(e,t)=>t.data}),reportUploadSuccess:e=>{e.businessType===o.F.Graphic?me().report({action:ie.show,panel_page:se.saveShopifyResult}):(0,o.n)().report({action:o.E.show,panel_page:o.P.save_shopify_result})},reportUploadFail:e=>{e.businessType===o.F.Graphic?me().report({action:ie.show,panel_page:se.saveShopifyFail}):(0,o.n)().report({action:o.E.show,panel_page:o.P.save_shopify_fail})},reportExportPanelOpen:e=>{var t;e.businessType===o.F.Graphic?me().report({action:ie.open,panel_page:se.saveShopifyResult,save_shopify_type:null!=(t=e.formInfo)&&t.need_replace_media?"replace_original":"upload_as_new"}):(0,o.n)().report({action:o.E.open,panel_page:o.P.save_shopify_result})},reportSmartToolPage:e=>{const{reportExtra:t}=e;"smart_tool_page"===(null==t?void 0:t.currentPage)&&null!=t&&t.toolType&&(new o.S).report({current_page:null==t?void 0:t.currentPage,from_page:(null==t?void 0:t.fromPage)??"first_page",enter_from:(null==t?void 0:t.enterFrom)??"first_page",tool_type:null==t?void 0:t.toolType,action:"watch_on_shopify"})},reportMaterialStatusSuccess:e=>{(new ge).report({status:"success",platform:"shopify",current_page:Ze(e.businessType,e.currentPage)})},reportExportPanelRetry:e=>{e.businessType===o.F.Graphic?me().report({action:ie.retry,panel_page:se.saveShopifyFail}):(0,o.n)().report({action:o.E.retry,panel_page:o.P.save_shopify_fail})},reportMaterialStatusFail:e=>{(new ge).report({status:"fail",platform:"shopify",fail_reason:null==e?void 0:e.failReason,current_page:Ze(e.businessType,e.currentPage)})},reportExportPanelBack:e=>{e.businessType===o.F.Graphic?me().report({action:ie.settings,panel_page:se.saveShopifyFail}):(0,o.n)().report({action:o.E.setting,panel_page:o.P.save_shopify_fail})},reporterClickShareWhere:({fileInfo:e,reportExtra:t={}})=>{var a,r,n,i,s,d,c;(new te).report({...(0,l.g)(null==e?void 0:e.asset),template_id:null==(r=null==(a=null==e?void 0:e.asset)?void 0:a.meta)?void 0:r.templateId,video_type_id:(0,l.p)(null==(i=null==(n=null==e?void 0:e.asset)?void 0:n.meta)?void 0:i.templateProducerAppId)??l.v[null==(d=null==(s=null==e?void 0:e.asset)?void 0:s.meta)?void 0:d.itemType],platform:o.c.Shopify,video_id:(null==e?void 0:e.videoId)??"",current_page:t.currentPage,enter_from:t.enterFrom,resolution:String(null==e?void 0:e.resolution)||"undefined",size:Number(null==e?void 0:e.fileSize)||0,format:(null==e?void 0:e.format)??"undefined",video_duration:(null==e?void 0:e.duration)??0,tool_type:(null==t?void 0:t.toolType)||(null==(c=(0,l.g)(null==e?void 0:e.asset))?void 0:c.tool_type),task_id:null==t?void 0:t.taskId,intelligent_request_id:null==t?void 0:t.intelligentRequestId,autocut_template_id:null==t?void 0:t.autocutTemplateId})}},services:{publishToShopify:async e=>{var t,a,r,n,s,l,d,c;return e.businessType===o.F.Graphic?(me().setParams({save_shopify_type:null!=(t=e.formInfo)&&t.need_replace_media?"replace_original":"upload_as_new"}),me().report({action:ie.saveBack,panel_page:se.saveShopifyDetail})):(0,o.n)().report({action:o.E.saveBack,panel_page:o.P.save_shopify_detail}),{jobIds:(null==(c=null==(d=(await i.f.syncMediaToThirdparty({platform:o.c.Shopify,account_id:e.selectedUserId??"",need_replace_media:null==(a=e.formInfo)?void 0:a.need_replace_media,to_scene:(null==(r=e.formInfo)?void 0:r.to_scene)??"media",medias:null!=(n=e.fileInfo)&&n.assetIdList?e.fileInfo.assetIdList.map((t=>{var a,r;return{file_id:(null==(a=e.thirdpartyMetaInfo)?void 0:a.thirdparty_fileid)??"",path:(null==(r=e.formInfo)?void 0:r.path)??"",asset_id:t}})):[{asset_id:null==(s=e.fileInfo)?void 0:s.fileId,path:(null==(l=e.formInfo)?void 0:l.path)??""}]})).data)?void 0:d.jobs)?void 0:c.map((e=>e.job_id)))||[]}},mockProgress:()=>e=>{const t=setInterval((()=>{e("UPDATE_PROGRESS")}),500);return()=>clearInterval(t)},startPolling:({jobIds:e,selectedUserId:t=""})=>a=>{if(!e||0===e.length)throw new Error("No shareId provided!");const r=setInterval((async()=>{var r;try{const n=await i.f.checkSyncMediaToThirdparty({platform:o.c.Shopify,job_ids:e,account_id:t});a({type:"UPDATE_PROGRESS"});const s=(null==(r=n.data)?void 0:r.job_status_list)||[];if(!s.length)return void a("UPLOAD_FAILED");let l=!1,d=!0,c=!0;if(s.forEach((e=>{0===e.status&&(l=!0),-1===e.status&&(d=!1),1===e.status&&(c=!1)})),l)return;a(d?{type:"PUBLISH_PROGRESS",data:{status:Te.shareSuccess}}:c?{type:"PUBLISH_PROGRESS",data:{status:Te.uploadFailed}}:{type:"PUBLISH_PROGRESS",data:{status:Te.uploadFailed,fail_reason:"web_shopify_text_images_part_success"}})}catch{a("UPLOAD_FAILED")}}),1e3);return()=>clearInterval(r)}}}),et=(0,d.O)({initial:"close",context:{reportExtra:{},fileInfo:{},businessType:o.F.FilmVideo,openType:ke.default},states:{close:{entry:["initContext"]},show:{id:"show",states:{init:{}}}},on:{INIT_SERVICE:{target:"close"},SHOW:{target:"show.init"},BACK_CHOOSE_STATE:{target:"close",actions:[(0,c.T4)("CLEAR_SELECTED_PLATFORM")]},SAVE_REPORT_EXTRA:{actions:["saveReportExtra"]}}},{actions:{saveReportExtra:(0,c.kp)({currentPage:(e,t)=>t.currentPage,openType:(e,t)=>t.openType,reportExtra:(e,t)=>({...e.reportExtra,...(0,r.A)(t.reportExtra,(e=>![void 0,null].includes(e)))})})}}),tt=e=>{(0,o.n)().report(e)},at=(0,d.O)({id:"LvShareTt",initial:"close",invoke:[{id:"asyncTaskActor",src:o.L}],states:{show:{entry:[({userInfo:e})=>{(0,o.n)().setParam({action:o.E.share_tiktok,panel_page:o.P.share_tiktok_detail,share_account:null==e?void 0:e.creator_username})}],states:{unknowBind:{always:[{target:"hasBind",cond:"isBind"},{target:"hasNotBind"}]},hasBind:{initial:"notUpload",states:{notUpload:{initial:"loading",invoke:{id:"getPreFormData",src:"getPreFormData",onDone:{target:".hasGetPreForm",actions:["savePreForm"]},onError:{target:".hasGetPreForm"}},states:{hasGetPreForm:{},loading:{}}},uploading:{invoke:{id:"getUploadingProgress",src:"getUploadingProgress"},states:{auditing:{entry:[()=>(0,o.n)().setParam({panel_page:o.P.share_tiktok_result}),(0,c.kp)({uploadProgress:0})]},uploadSuccess:{entry:[()=>(0,o.n)().setParam({panel_page:o.P.share_tiktok_result}),(0,c.kp)({uploadProgress:0})]}},on:{GET_UPLOAD_PROGRESS:[{target:".uploadSuccess",actions:["saveUploadPlatformLink"],cond:"isUploadSuccess"},{target:"shareSuccess",actions:["saveUploadPlatformLink"],cond:"isShareSuccess"},{target:"uploadFailed",actions:["saveUploadPlatformLink"],cond:"isUploadFailed"},{target:"uploadAuditFailed",actions:["saveUploadPlatformLink"],cond:"isUploadAuditFailed"},{target:".auditing",actions:["saveUploadPlatformLink"],cond:"isUploadAuditing"},{actions:["getUploadProgressByTime","saveUploadPlatformLink"],cond:"isDealing"},{target:"publishTimeOut",actions:["saveUploadPlatformLink"],cond:"isPublishTimeOut"},{target:"privacyNotMatch",actions:["saveUploadPlatformLink"],cond:"isPrivacyNotMatch"}],GET_UPLOAD_FAILED:{}}},uploadAuditFailed:{entry:[()=>(0,o.n)().setParam({panel_page:o.P.share_tiktok_result}),(0,c.kp)({uploadProgress:0})]},publishTimeOut:{entry:[()=>(0,o.n)().setParam({panel_page:o.P.share_tiktok_result}),(0,c.kp)({uploadProgress:0})]},privacyNotMatch:{entry:[()=>(0,o.n)().setParam({panel_page:o.P.share_tiktok_result}),(0,c.kp)({uploadProgress:0})]},shareSuccess:{entry:[(0,c.T4)({type:"USE_SHARE_SUCCESS_CALLBACK"}),()=>(0,o.n)().setParam({panel_page:o.P.share_tiktok_result}),(0,c.kp)({uploadProgress:0})]},uploadFailed:{entry:[()=>(0,o.n)().setParam({panel_page:o.P.share_tiktok_result}),(0,c.kp)({uploadProgress:0})],on:{RETRY:[{cond:"isNotExceedDuration",actions:[(0,c.T4)({type:"SAVE_ERROR_CODE",errorCode:10})]},{actions:["handleUpload"]}]}}},on:{UPLOAD_TO_PLATFORM:[{cond:"isNotExceedDuration",actions:[(0,c.T4)({type:"SAVE_ERROR_CODE",errorCode:o.g.VIDEO_DURATION_TOO_SHORT})]},{actions:["handleUpload","reporterClickShareWhere"]}],TRANSITION_TO_UPLOADING:{target:".uploading",actions:["saveShareId"]},UPLOAD_FAILED:[{target:"hasNotBind",actions:["uploadFailed","saveUploadFailedErrorCode"],cond:"isUserInfoError"},{actions:["uploadFailed","saveUploadFailedErrorCode"],cond:"isVideoTooLong"},{target:".uploadFailed",actions:["uploadFailed","saveUploadFailedErrorCode"]}]}},hasNotBind:{}}},close:{entry:["initContext"]}},on:{INIT_SERVICE:{target:"close"},INIT_USER_INFO:{actions:(0,c.kp)({userInfo:(e,t)=>{var a;return null==(a=null==t?void 0:t.data)?void 0:a[O.TT_USER_INFO]}})},SAVE_FILE_INFO:{actions:["saveFileInfo"]},REFRESH_USER_INFO:{actions:["refreshUserInfo"]},REFRESH_USER_INFO_CONTEXT:[{target:"show.hasBind",actions:["saveUserInfo"],cond:"userInfoNotNull"},{actions:["saveUserInfo"]}],USER_UNBIND:{actions:["userUnbind",({reportExtra:e})=>{e.toolType||tt({action:o.E.sign_out})}]},UNBIND_SUCCESS:{target:"show.hasNotBind",actions:[(0,c.T4)({type:"USER_UNBIND_SUCCESS_CALLBACK"}),(0,c.T4)({type:"REMOVE_USER_INFO",platform:o.c.TikTok}),(0,c.kp)({userInfo:()=>Ie.TikTok})]},UNBIND_FAILED:{actions:[(0,c.T4)({type:"USER_UNBIND_FAILED_CALLBACK"})]},SHOW:[{target:"show.hasBind",actions:["saveReportExtra","saveSpaceInfo"]}],BACK_CHOSEN_STATE:{target:"show.unknowBind",actions:[()=>{tt({action:o.E.back})}]},BACK_CHOOSE_STATE:{target:"close",actions:[()=>(0,o.n)().deleteFormData(),({reportExtra:e})=>{null!=e&&e.toolType||tt({action:o.E.back,panel_page:o.P.share_tiktok_detail})},(0,c.T4)({type:"CLEAR_SELECTED_PLATFORM"})]},REQUEST_FORM_DATA_SUCCESS:{actions:["savePreForm"]},TRANSITION_UPLOADING:{target:"show.hasBind.uploading",actions:["saveShareId","savePlatformLink","saveReportExtra","requestPreFormData","saveSpaceInfo"],internal:!0},TRANSITION_UPLOAD_SUCCESS:{target:"show.hasBind.shareSuccess",actions:["saveShareId","savePlatformLink","saveReportExtra","saveSpaceInfo"]},TRANSITION_UPLOAD_FAILED:{target:"show.hasBind.uploadFailed",actions:["saveShareId","savePlatformLink","saveReportExtra","saveSpaceInfo"]},TRANSITION_AUDITING:{target:"show.hasBind.uploading.auditing",actions:["saveShareId","savePlatformLink","saveReportExtra","saveSpaceInfo"]}}},{services:{getUploadingProgress:({shareId:e})=>t=>{const a=setInterval((async()=>{var a;try{if(!e)throw new Error("none share id");const r=await z.getShareProgress({share_ids:[e]});t({type:"GET_UPLOAD_PROGRESS",data:null==(a=r.share_tasks)?void 0:a[e]})}catch{t("GET_UPLOAD_FAILED")}}),1e3);return()=>clearInterval(a)},getPreFormData:async({fileInfo:e})=>{try{if(null!=e&&e.fileId){const t=await z.getShareFormInfo({id:e.fileId,share_type:(null==e?void 0:e.fileType)??o.F.FilmVideo,platform:o.i.Tiktok});return await Promise.resolve(JSON.parse(t.form_info))}return await Promise.reject(new Error("No file id"))}catch(t){return Promise.reject(t)}}},actions:{initContext:(0,c.kp)({shareId:void 0,uploadProgress:0}),saveSpaceInfo:(0,c.kp)({workspaceId:(e,t)=>t.data.workspaceId}),saveReportExtra:(0,c.kp)({reportExtra:({reportExtra:e},t)=>Object.assign(e||{},{...null==t?void 0:t.data.reportExtra})}),saveFileInfo:(0,c.kp)({fileInfo:(e,t)=>t.fileInfo}),saveUserInfo:(0,c.kp)({userInfo:(e,t)=>{var a;return null==(a=null==t?void 0:t.data)?void 0:a[O.TT_USER_INFO]}}),refreshUserInfo:(0,c.tN)((()=>({type:"ADD_TASK",exec:async()=>await x.getShareUserInfo({platforms:[o.c.TikTok]}),successType:"REFRESH_USER_INFO_CONTEXT",failType:"GET_USER_INFO_ERROR"})),{to:"asyncTaskActor"}),handleUpload:(0,c.tN)((({fileInfo:e,shareId:t,userInfo:a,workspaceId:r,currentPage:n},i)=>({type:"ADD_TASK",exec:async()=>{var s,l,d,c,u,p,_,f,v,h,m,g,S,T,I,E,y,k,A,R,N,P,C,b,O,w,L,F,U;const D=null==(l=null==(s=(0,o.r)())?void 0:s.getConfig())?void 0:l.header,x={header:D,client_ip:"",params:{scenario:"custom",current_page:n,is_pwa:q()?1:0,pwa_from:X(),open_from_pwa:J()?1:0,used_ttlive_material:null!=(c=null==(d=null==e?void 0:e.asset)?void 0:d.meta)&&c.used_ttlive_material?1:0},user:{user_id:null==(u=i.data)?void 0:u.uid,user_is_login:!0,user_unique_id:null==(p=i.data)?void 0:p.uid,web_id:null==(_=null==D?void 0:D.custom)?void 0:_.web_id}};if(i.isRetry)return i.distinguishAccount?{shareId:(await z.shareToThirdPartyPlatform({platform:o.i.Tiktok,share_id:t||"0",distinguish_account:!1,workspace_id:r,custom_info:JSON.stringify(x)})).share_id??t}:{shareId:(await z.shareToThirdPartyPlatform({platform:o.i.Tiktok,share_id:t||"0",distinguish_account:!0,workspace_id:r,custom_info:JSON.stringify(x)})).share_id??t};{const n={video_post_duration:(null==(f=null==i?void 0:i.data)?void 0:f.fileInfo.duration)/1e3,format:(null==(v=null==i?void 0:i.data)?void 0:v.fileInfo.format)||(null==e?void 0:e.format)||"mp4"},s=null==(m=null==(h=null==i?void 0:i.data)?void 0:h.formInfo)?void 0:m.privacy_level,l={SELF_ONLY:"private",MUTUAL_FOLLOW_FRIENDS:"friends",PUBLIC_TO_EVERYONE:"public"};(0,o.n)().report({action:o.E.upload,size:Number(null==e?void 0:e.fileSize)||0,share_account:null==a?void 0:a.creator_username,share_caption:null==(S=null==(g=null==i?void 0:i.data)?void 0:g.formInfo)?void 0:S.title,share_caption_words_cnt:null==(E=null==(I=null==(T=null==i?void 0:i.data)?void 0:T.formInfo)?void 0:I.title)?void 0:E.length,share_view_range:l[s],allow_comment:+!(null!=(k=null==(y=null==i?void 0:i.data)?void 0:y.formInfo)&&k.disable_comment),allow_duet:+!(null!=(R=null==(A=null==i?void 0:i.data)?void 0:A.formInfo)&&R.disable_duet),allow_stitch:+!(null!=(P=null==(N=null==i?void 0:i.data)?void 0:N.formInfo)&&P.disable_stitch)});const d={platform:o.i.Tiktok,draft_id:"0",asset_id_list:[(null==e?void 0:e.fileId)??(null==(b=null==(C=null==i?void 0:i.data)?void 0:C.fileInfo)?void 0:b.fileId)??""],share_type:null==e?void 0:e.fileType,form_info:null==(O=null==i?void 0:i.data)?void 0:O.formInfo,file_info:n,distinguish_account:!0,workspace_id:r,custom_info:JSON.stringify(x),is_from_tt_live:null==(L=null==(w=null==e?void 0:e.asset)?void 0:w.meta)?void 0:L.used_ttlive_material,tt_live_type:null==(U=null==(F=null==e?void 0:e.asset)?void 0:F.meta)?void 0:U.tt_live_type};return{shareId:(await z.shareToThirdPartyPlatform(d)).share_id??t}}},successType:"TRANSITION_TO_UPLOADING",failType:"UPLOAD_FAILED"})),{to:"asyncTaskActor"}),userUnbind:(0,c.tN)((()=>({type:"ADD_TASK",exec:async()=>({...await x.shareUserUnbind({platform:o.c.TikTok})}),successType:"UNBIND_SUCCESS",failType:"UNBIND_FAILED"})),{to:"asyncTaskActor"}),savePreForm:(0,c.kp)({preFormInfo:(e,t)=>t.data}),getUploadProgressByTime:(0,c.kp)({uploadProgress:({fileInfo:e},t)=>{var a,r;const o=(null==e?void 0:e.fileSize)||0,n=+`9${null==(a=o.toString())?void 0:a[o.toString().length-1]}`,i=null==(r=t.data)?void 0:r.create_time;return(0,l.d)({totalSize:Number(o),createTime:i,maxProgress:n})}}),uploadFailed:(0,c.kp)({shareId:(e,t)=>{var a,r,o;return null==(o=null==(r=null==(a=null==t?void 0:t.data)?void 0:a.data)?void 0:r.data)?void 0:o.share_id}}),saveUploadFailedErrorCode:(0,c.T4)(((e,t)=>({type:"SAVE_ERROR_CODE",errorCode:t.data.data.ret}))),reporterClickShareWhere:({fileInfo:e,reportExtra:t,userInfo:a},r)=>{var n,i,s,d,c,u,p,_,f,v,h,m,g,S,T,I,E,y,k,A;(new te).report({...(0,l.g)(null==e?void 0:e.asset),template_id:null==(i=null==(n=null==e?void 0:e.asset)?void 0:n.meta)?void 0:i.templateId,video_type_id:(0,l.p)(null==(d=null==(s=null==e?void 0:e.asset)?void 0:s.meta)?void 0:d.templateProducerAppId)??l.v[null==(u=null==(c=null==e?void 0:e.asset)?void 0:c.meta)?void 0:u.itemType],platform:o.c.TikTok,video_id:(null==e?void 0:e.videoId)||"",current_page:t.currentPage,enter_from:t.enterFrom,resolution:String(null==e?void 0:e.resolution),size:null!=e&&e.fileSize?Number(null==e?void 0:e.fileSize):0,format:(null==e?void 0:e.format)||"",video_duration:(null==e?void 0:e.duration)??0,share_account:null==a?void 0:a.creator_username,share_caption:null==(_=null==(p=null==r?void 0:r.data)?void 0:p.formInfo)?void 0:_.title,share_caption_words_cnt:null==(h=null==(v=null==(f=null==r?void 0:r.data)?void 0:f.formInfo)?void 0:v.title)?void 0:h.length,share_view_range:null==(g=null==(m=null==r?void 0:r.data)?void 0:m.formInfo)?void 0:g.privacy_level,allow_comment:+!(null!=(T=null==(S=null==r?void 0:r.data)?void 0:S.formInfo)&&T.disable_comment),allow_duet:+!(null!=(E=null==(I=null==r?void 0:r.data)?void 0:I.formInfo)&&E.disable_duet),allow_stitch:+!(null!=(k=null==(y=null==r?void 0:r.data)?void 0:y.formInfo)&&k.disable_stitch),tool_type:(null==t?void 0:t.toolType)||(null==(A=(0,l.g)(null==e?void 0:e.asset))?void 0:A.tool_type),task_id:null==t?void 0:t.taskId,intelligent_request_id:null==t?void 0:t.intelligentRequestId,autocut_template_id:null==t?void 0:t.autocutTemplateId})},requestPreFormData:(0,c.tN)((({fileInfo:e})=>({type:"ADD_TASK",exec:async()=>{const t=await z.getShareFormInfo({id:(null==e?void 0:e.fileId)??"0",share_type:(null==e?void 0:e.fileType)??o.F.FilmVideo,platform:o.i.Tiktok});return JSON.parse(t.form_info)},successType:"REQUEST_FORM_DATA_SUCCESS",failType:"REQUEST_FORM_DATA_FAILED"})),{to:"asyncTaskActor"}),saveUploadPlatformLink:(0,c.kp)({platformLink:(e,t)=>{var a;return null==(a=null==t?void 0:t.data)?void 0:a.link}}),savePlatformLink:(0,c.kp)({platformLink:(e,t)=>{var a;return null==(a=null==t?void 0:t.data)?void 0:a.platformLink}}),saveShareId:(0,c.kp)({shareId:(e,t)=>null==t?void 0:t.data.shareId})},guards:{userInfoNotNull:(e,t)=>{var a;return!(null==(a=t.data)||!a[O.TT_USER_INFO])},isBind:({userInfo:e})=>!(null==e||!e.creator_nickname),isUploadSuccess:(e,t)=>t.data.status===Te.uploadSuccess,isUploadFailed:(e,t)=>t.data.status===Te.uploadFailed,isUploadAuditing:(e,t)=>t.data.status===Te.auditing,isUploadAuditFailed:(e,t)=>t.data.status===Te.auditFailed,isPublishTimeOut:(e,t)=>t.data.status===Te.publishTimeOut,isPrivacyNotMatch:(e,t)=>t.data.data.ret===o.g.PRIVACY_NOT_VERIFIED,isDealing:(e,t)=>t.data.status===Te.dealing,isShareSuccess:(e,t)=>t.data.status===Te.shareSuccess,isNotExceedDuration:({fileInfo:e})=>((null==e?void 0:e.duration)??0)<3100,isUserInfoError:(e,t)=>{var a,r;return(null==(r=null==(a=null==t?void 0:t.data)?void 0:a.data)?void 0:r.ret)===o.g.UPLOAD_AUTH_ERROR},isVideoTooLong:(e,t)=>{var a,r;return(null==(r=null==(a=null==t?void 0:t.data)?void 0:a.data)?void 0:r.ret)===o.g.VIDEO_DURATION_TOO_LONG},isNoneFormData:({preFormInfo:e})=>!e}}),rt=e=>{(0,o.n)().report(e)},ot=(0,d.O)({id:"LvShareTtam",initial:"close",invoke:[{id:"asyncTaskActor",src:o.L},{id:"getUserInfo",src:"getUserInfo",onDone:{actions:(0,c.kp)({userInfo:(e,t)=>{var a;return null==(a=null==t?void 0:t.data)?void 0:a.accounts},switchAccount:({switchAccount:e},t)=>{var a,r;const n=null==(a=null==t?void 0:t.data)?void 0:a.accounts;if(null!=n&&n.length)return(0,o.n)().setParam({core_user_id:null==(r=null==n?void 0:n[0])?void 0:r.tt4b_uid}),e??(null==n?void 0:n[0])}})}}],states:{show:{entry:[({userInfo:e})=>{var t;(0,o.n)().setParam({action:o.E.share_ttam,panel_page:o.P.share_ttam_detail,share_account:null==(t=null==e?void 0:e[0])?void 0:t.display_name})}],states:{unknowBind:{always:[{target:"hasBind",cond:"isBind"},{target:"hasNotBind"}]},hasBind:{initial:"notUpload",states:{notUpload:{initial:"loading",invoke:{id:"getPreShareData",src:"getPreShareData",onDone:{target:".hasGetPreShareData",actions:["savePreShareData"]},onError:{target:".hasGetPreShareData",actions:["savePreShareData","saveUploadFailedErrorCode"]}},states:{hasGetPreShareData:{},loading:{}}},uploading:{invoke:{id:"getUploadingProgress",src:"getUploadingProgress"},states:{auditing:{entry:[()=>(0,o.n)().setParam({panel_page:o.P.share_ttam_result}),(0,c.kp)({uploadProgress:0})]},uploadSuccess:{entry:[()=>(0,o.n)().setParam({panel_page:o.P.share_ttam_result}),(0,c.kp)({uploadProgress:0})]}},on:{GET_UPLOAD_PROGRESS:[{target:".uploadSuccess",actions:["saveUploadPlatformLink"],cond:"isUploadSuccess"},{target:"shareSuccess",actions:["saveUploadPlatformLink"],cond:"isShareSuccess"},{target:"uploadFailed",actions:["saveUploadPlatformLink","saveFailedAdvList"],cond:"isUploadFailed"},{target:"uploadAuditFailed",actions:["saveUploadPlatformLink"],cond:"isUploadAuditFailed"},{target:".auditing",actions:["saveUploadPlatformLink"],cond:"isUploadAuditing"},{actions:["getUploadProgressByTime","saveUploadPlatformLink"],cond:"isDealing"}],GET_UPLOAD_FAILED:{target:"uploadFailed"},CANCEL_UPLOAD_SUCCESS:{target:"notUpload",actions:["useCancelUploadCallback","cancelSuccess"]},CANCEL_UPLOAD_FAILED:{actions:"useCancelUploadFailedCallback"}}},uploadAuditFailed:{entry:[()=>(0,o.n)().setParam({panel_page:o.P.share_ttam_result}),(0,c.kp)({uploadProgress:0})]},shareSuccess:{entry:[(0,c.T4)({type:"USE_SHARE_SUCCESS_CALLBACK"}),()=>(0,o.n)().setParam({panel_page:o.P.share_ttam_result}),(0,c.kp)({uploadProgress:0})]},uploadFailed:{entry:[()=>(0,o.n)().setParam({panel_page:o.P.share_ttam_result}),"requestPreShareData",(0,c.kp)({uploadProgress:0})],on:{RETRY:[{actions:["handleUpload"]}]}}},on:{SWITCH_ACCOUNT:{target:"hasBind",actions:(0,c.kp)({switchAccount:({userInfo:e},t)=>{const a=null==e?void 0:e.filter((e=>(null==e?void 0:e.display_name)===t.switchName));return null==a?void 0:a[0]}})},UPLOAD_TO_PLATFORM:[{actions:["handleUpload","saveSelectedAdvList","reporterClickShareWhere"]}],TRANSITION_TO_UPLOADING:[{target:".uploading",actions:["saveShareId"],cond:"hasShareId"},{actions:"saveErrorCodeRetryFailed"}],UPLOAD_FAILED:[{target:".uploadFailed",actions:["uploadFailed","saveUploadFailedErrorCode"]}]}},hasNotBind:{entry:[(0,c.kp)({advList:()=>({advertisers:[]})})]}},on:{BACK_CHOOSE_STATE:{target:"close",actions:[()=>(0,o.n)().deleteFormData(),({reportExtra:e})=>{null!=e&&e.toolType||rt({action:o.E.back,panel_page:o.P.share_ttam_detail})},(0,c.T4)({type:"CLEAR_SELECTED_PLATFORM"})]}}},close:{entry:["initContext"]}},on:{REFRESH_USER_INFO_TO_FILTER:{actions:"refreshUserInfoToFilter"},REFRESH_USER_INFO_TO_FILTER_SUCCESS:{actions:[(0,c.kp)({userInfo:(e,t)=>t.data.accounts,switchAccount:({switchAccount:e},t)=>{var a;return(null==(a=t.data.accounts.filter((t=>(null==t?void 0:t.tt4b_uid)===(null==e?void 0:e.tt4b_uid))))?void 0:a[0])??void 0}})]},SAVE_AGE_GATE:{actions:["saveAgeGate"]},SAVE_FAILED_ADV_LIST_AND_SWITCH_ID:{actions:["saveFailedAdvListFromTask"]},GET_USER_INFO_ERROR:{actions:["saveUploadFailedErrorCode"]},REFRESH_ADV_LIST:{target:"show.hasBind"},CANCEL_UPLOAD:{actions:["handleCancelUpload","saveCancelUploadCallback"]},CONFIRM_BIRTHDAY:{actions:["confirmBirthday"]},UPDATE_BIRTHDAY:{actions:["updateBirthday","assignDiffStatusSame"]},BACK_TO_EDIT_AGE:{actions:"assignDiffStatusSame"},SAVE_AGE_GATE_DIFF_STATUS:[{actions:"assignDiffStatus",cond:"birthdayIsDiff"},{actions:["assignDiffStatus","updateBirthday"]}],SAVE_AGE_GATE_LIMIT_STATUS:[{actions:["assignLimitStatus","assignAgeGateHide",(e,t)=>{const a=(window.screen.height-30-750)/2,r=(window.screen.width-800)/2;t.data.authUrl&&window.open(t.data.authUrl,"name=thirdparty_share_auth",`fullscreen=1,width=800,height=750,top=${a},left=${r}`)}],cond:"birthdayLimitStatusNormal"},{actions:["assignLimitStatus"]}],INIT_SERVICE:{target:"close"},INIT_USER_INFO:{actions:(0,c.kp)({userInfo:(e,t)=>{var a,r;return null==(r=null==(a=null==t?void 0:t.data)?void 0:a[o.c.TTAM])?void 0:r.accounts}})},SAVE_FILE_INFO:{actions:["saveFileInfo"]},REFRESH_USER_INFO:{actions:["refreshUserInfo"]},REFRESH_USER_INFO_CONTEXT:[{target:"show.hasBind",actions:["saveUserInfo","switchAuthAccount"],cond:"userInfoNotNull"},{actions:["saveUserInfo"]}],USER_UNBIND:{actions:["userUnbind"]},UNBIND_SUCCESS:{internal:!0,actions:["unbindRefreshUserInfo",()=>(0,o.n)().deleteParam(["share_account","core_user_id"]),(0,c.T4)({type:"USER_UNBIND_SUCCESS_CALLBACK"}),(0,c.T4)({type:"REMOVE_USER_INFO",platform:o.c.TTAM})]},UNBIND_FAILED:{actions:[(0,c.T4)({type:"USER_UNBIND_FAILED_CALLBACK"})]},UNBIND_REFRESH_USER_INFO:{target:"show.unknowBind",actions:[(0,c.kp)({userInfo:(e,t)=>t.data.accounts,switchAccount:(e,t)=>t.data.accounts[0]??void 0})]},SHOW:[{target:"show.hasBind",actions:["saveReportExtra","saveSpaceInfo"],internal:!0}],BACK_CHOSEN_STATE:{target:"show.unknowBind",actions:[()=>{rt({action:o.E.back})}]},REQUEST_FORM_DATA_SUCCESS:{actions:["savePreShareData"]},TRANSITION_UPLOADING:{target:"show.hasBind.uploading",actions:["saveShareId","savePlatformLink","saveReportExtra","requestPreShareData","saveSpaceInfo"],internal:!0},TRANSITION_UPLOAD_SUCCESS:{target:"show.hasBind.shareSuccess",actions:["saveShareId","savePlatformLink","saveReportExtra","saveSpaceInfo"],internal:!0},TRANSITION_UPLOAD_FAILED:{target:"show.hasBind.uploadFailed",actions:["saveShareId","savePlatformLink","saveReportExtra","saveFailedAdvListFromTask","saveSwitchAccount","saveSpaceInfo"],internal:!0},TRANSITION_AUDITING:{target:"show.hasBind.uploading.auditing",actions:["saveShareId","savePlatformLink","saveReportExtra","saveSpaceId"],internal:!0}}},{services:{getUserInfo:async()=>{try{const e=await K.getTt4bAccounts();return await Promise.resolve(e)}catch{return Promise.reject()}},getUploadingProgress:({shareId:e})=>t=>{const a=setInterval((async()=>{var a;try{if(!e)throw new Error("none share id");const r=await z.getShareProgress({share_ids:[e]});t({type:"GET_UPLOAD_PROGRESS",data:null==(a=r.share_tasks)?void 0:a[e]})}catch{t("GET_UPLOAD_FAILED")}}),3e3);return()=>clearInterval(a)},getPreShareData:async({fileInfo:e,switchAccount:t})=>{try{let a=null,r=null;return null!=e&&e.fileId&&(a=await z.getShareFormInfo({id:e.fileId,share_type:(null==e?void 0:e.fileType)??o.F.FilmVideo,platform:o.i.Ttam})),r=await K.getAdvertisers({tt4b_uid:(null==t?void 0:t.tt4b_uid)??""}),await Promise.resolve({formInfo:null!=a&&a.form_info?JSON.parse(a.form_info):{},advList:r})}catch(a){return Promise.reject(a)}}},actions:{initContext:(0,c.kp)({advList:void 0,failedAdvList:[],preFormInfo:void 0,shareId:void 0,uploadProgress:0,uploadedAdvList:[]}),saveSpaceInfo:(0,c.kp)({workspaceId:(e,t)=>t.data.workspaceId}),saveSwitchAccount:(0,c.kp)({switchAccount:({switchAccount:e,userInfo:t},a)=>{var r;return(null==(r=t.filter((e=>{var t;return e.tt4b_uid===(null==(t=null==a?void 0:a.data)?void 0:t.platformOpenId)})))?void 0:r[0])??e}}),saveAgeGate:(0,c.kp)({ageGate:(e,t)=>({isShow:t.data.is_show,limitStatus:t.data.limit_status})}),saveErrorCodeRetryFailed:(0,c.T4)({type:"SAVE_ERROR_CODE",errorCode:"200941"}),saveFailedAdvListFromTask:(0,c.kp)({failedAdvList:(e,t)=>t.data.failedAdvList}),handleCancelUpload:(0,c.tN)((({shareId:e})=>({type:"ADD_TASK",exec:async()=>await z.cancelUploadTask({id:e??"0"}),successType:"CANCEL_UPLOAD_SUCCESS",failType:"CANCEL_UPLOAD_FAILED"})),{to:"asyncTaskActor"}),saveCancelUploadCallback:(0,c.kp)({cancelUploadCallback:(e,t)=>t.callback,cancleUploadFailedCallback:(e,t)=>t.failedCallback}),useCancelUploadCallback:({cancelUploadCallback:e})=>{null==e||e()},cancelSuccess:(0,c.kp)({uploadProgress:0}),useCancelUploadFailedCallback:({cancleUploadFailedCallback:e})=>{null==e||e()},saveFailedAdvList:(0,c.kp)({failedAdvList:(e,t)=>{var a;return(null==(a=null==t?void 0:t.data)?void 0:a.failed_advertisers)??[]}}),assignAgeGateHide:(0,c.kp)({ageGate:({ageGate:e})=>Object.assign(e??{},{isShow:!1})}),assignDiffStatus:(0,c.kp)({ageGate:({ageGate:e},t)=>Object.assign(e??{},{diffStatus:t.data.diff_status})}),assignDiffStatusSame:(0,c.kp)({ageGate:({ageGate:e})=>Object.assign(e??{},{diffStatus:F.SAME})}),assignLimitStatus:(0,c.kp)({ageGate:({ageGate:e},t)=>Object.assign(e??{},{limitStatus:t.data.limit_status})}),confirmBirthday:(0,c.tN)(((e,t)=>({type:"ADD_TASK",exec:async()=>({...await x.confirmBirthday({birthday:t.birthday}),birthday:t.birthday,authUrl:t.authUrl}),successType:"SAVE_AGE_GATE_DIFF_STATUS"})),{to:"asyncTaskActor"}),updateBirthday:(0,c.tN)(((e,t)=>({type:"ADD_TASK",exec:async()=>({...await x.updateBirthday({birthday:t.data.birthday}),birthday:t.data.birthday,authUrl:t.data.authUrl}),successType:"SAVE_AGE_GATE_LIMIT_STATUS"})),{to:"asyncTaskActor"}),switchAuthAccount:(0,c.kp)({switchAccount:({userInfo:e})=>e[0]}),saveReportExtra:(0,c.kp)({reportExtra:({reportExtra:e},t)=>Object.assign(e||{},{...null==t?void 0:t.data.reportExtra})}),saveFileInfo:(0,c.kp)({fileInfo:(e,t)=>t.fileInfo}),saveUserInfo:(0,c.kp)({userInfo:(e,t)=>{var a;return null==(a=null==t?void 0:t.data)?void 0:a.accounts}}),refreshUserInfo:(0,c.tN)((()=>({type:"ADD_TASK",exec:async()=>await K.getTt4bAccounts(),successType:"REFRESH_USER_INFO_CONTEXT",failType:"GET_USER_INFO_ERROR"})),{to:"asyncTaskActor"}),refreshUserInfoToFilter:(0,c.tN)((()=>({type:"ADD_TASK",exec:async()=>await K.getTt4bAccounts(),successType:"REFRESH_USER_INFO_TO_FILTER_SUCCESS"})),{to:"asyncTaskActor"}),unbindRefreshUserInfo:(0,c.tN)((()=>({type:"ADD_TASK",exec:async()=>await K.getTt4bAccounts(),successType:"UNBIND_REFRESH_USER_INFO"})),{to:"asyncTaskActor"}),saveSelectedAdvList:(0,c.kp)({uploadedAdvList:(e,t)=>{var a,r;return null==(r=null==(a=null==t?void 0:t.data)?void 0:a.advertisers)?void 0:r.map((e=>e.advertiser_id))}}),handleUpload:(0,c.tN)((({fileInfo:e,shareId:t,switchAccount:a,workspaceId:r,currentPage:n},i)=>({type:"ADD_TASK",exec:async()=>{var s,l,d,c,u,p;const _=null==(l=null==(s=(0,o.r)())?void 0:s.getConfig())?void 0:l.header,f={header:_,client_ip:"",params:{scenario:"custom",current_page:n},user:{user_id:null==(d=i.data)?void 0:d.uid,user_is_login:!0,user_unique_id:null==(c=i.data)?void 0:c.uid,web_id:null==(u=null==_?void 0:_.custom)?void 0:u.web_id}};if(i.isRetry)return{retry:!0,shareId:(await z.shareToThirdPartyPlatform({platform:o.i.Ttam,share_id:t||"0",workspace_id:r,custom_info:JSON.stringify(f)})).share_id??t};{(0,o.n)().report({action:o.E.upload,size:Number(null==e?void 0:e.fileSize)||0,share_account:null==a?void 0:a.display_name});const n={platform:o.i.Ttam,draft_id:"0",form_info:JSON.stringify({advertisers:null==(p=null==i?void 0:i.data)?void 0:p.advertisers,video_name:null==e?void 0:e.fileName}),asset_id_list:[(null==e?void 0:e.fileId)??""],share_type:null==e?void 0:e.fileType,platform_open_id:null==a?void 0:a.tt4b_uid,workspace_id:r,custom_info:JSON.stringify(f)};return{shareId:(await z.shareToThirdPartyPlatform(n)).share_id??t}}},successType:"TRANSITION_TO_UPLOADING",failType:"UPLOAD_FAILED"})),{to:"asyncTaskActor"}),userUnbind:(0,c.tN)((({switchAccount:e},t)=>({type:"ADD_TASK",exec:async()=>({...await K.unbindTt4bAccounts({tt4b_uid:(null==t?void 0:t.tt4bUid)??(null==e?void 0:e.tt4b_uid)??"0"})}),successType:"UNBIND_SUCCESS",failType:"UNBIND_FAILED"})),{to:"asyncTaskActor"}),savePreShareData:(0,c.kp)({preFormInfo:(e,t)=>t.data.formInfo,advList:(e,t)=>{var a;return null==(a=t.data)?void 0:a.advList}}),getUploadProgressByTime:(0,c.kp)({uploadProgress:({fileInfo:e},t)=>{var a,r;const o=(null==e?void 0:e.fileSize)||0,n=+`9${null==(a=o.toString())?void 0:a[o.toString().length-1]}`,i=null==(r=t.data)?void 0:r.create_time;return(0,l.d)({totalSize:Number(o),createTime:i,maxProgress:n})}}),uploadFailed:(0,c.kp)({shareId:(e,t)=>{var a,r,o;return null==(o=null==(r=null==(a=null==t?void 0:t.data)?void 0:a.data)?void 0:r.data)?void 0:o.share_id}}),saveUploadFailedErrorCode:(0,c.T4)(((e,t)=>{var a,r;return{type:"SAVE_ERROR_CODE",errorCode:null==(r=null==(a=null==t?void 0:t.data)?void 0:a.data)?void 0:r.ret}})),reporterClickShareWhere:({fileInfo:e,reportExtra:t,currentPage:a,switchAccount:r},n)=>{var i,s,d,c,u,p,_,f,v,h,m,g;(new te).report({...(0,l.g)(null==e?void 0:e.asset),template_id:null==(s=null==(i=null==e?void 0:e.asset)?void 0:i.meta)?void 0:s.templateId,video_type_id:(0,l.p)(null==(c=null==(d=null==e?void 0:e.asset)?void 0:d.meta)?void 0:c.templateProducerAppId)??l.v[null==(p=null==(u=null==e?void 0:e.asset)?void 0:u.meta)?void 0:p.itemType],platform:o.c.TTAM,video_id:(null==e?void 0:e.videoId)||"",current_page:a||"",enter_from:t.enterFrom,resolution:String(null==e?void 0:e.resolution),size:Number(null==e?void 0:e.fileSize)||0,format:(null==e?void 0:e.format)||"",video_duration:(null==e?void 0:e.duration)??0,core_user_id:null==r?void 0:r.tt4b_uid,upload_adv_cnt:null==(f=null==(_=null==n?void 0:n.data)?void 0:_.advertisers)?void 0:f.length,adv_id:null==(m=null==(h=null==(v=null==n?void 0:n.data)?void 0:v.advertisers)?void 0:h.map((e=>e.advertiser_id)))?void 0:m.join(","),tool_type:(null==t?void 0:t.toolType)||(null==(g=(0,l.g)(null==e?void 0:e.asset))?void 0:g.tool_type),task_id:null==t?void 0:t.taskId,intelligent_request_id:null==t?void 0:t.intelligentRequestId,autocut_template_id:null==t?void 0:t.autocutTemplateId})},requestPreShareData:(0,c.tN)((({fileInfo:e,switchAccount:t})=>({type:"ADD_TASK",exec:async()=>{const a=await z.getShareFormInfo({id:(null==e?void 0:e.fileId)??"0",share_type:(null==e?void 0:e.fileType)??o.F.FilmVideo,platform:o.i.Ttam}),r=await K.getAdvertisers({tt4b_uid:(null==t?void 0:t.tt4b_uid)??""});return{formInfo:JSON.parse(a.form_info),advList:r}},successType:"REQUEST_FORM_DATA_SUCCESS",failType:"REQUEST_FORM_DATA_FAILED"})),{to:"asyncTaskActor"}),saveUploadPlatformLink:(0,c.kp)({platformLink:(e,t)=>{var a;return null==(a=null==t?void 0:t.data)?void 0:a.link}}),savePlatformLink:(0,c.kp)({platformLink:(e,t)=>{var a;return null==(a=null==t?void 0:t.data)?void 0:a.platformLink}}),saveShareId:(0,c.kp)({shareId:(e,t)=>null==t?void 0:t.data.shareId})},guards:{hasShareId:(e,t)=>!!t.data.shareId,birthdayLimitStatusNormal:(e,t)=>t.data.limit_status===L.NORMAL,birthdayIsDiff:(e,t)=>!!t.data.diff_status,userInfoNotNull:(e,t)=>{var a,r;return!(null==(r=null==(a=t.data)?void 0:a.accounts)||!r.length)},isBind:({userInfo:e})=>!!e.length,isUploadSuccess:(e,t)=>t.data.status===Te.uploadSuccess,isUploadFailed:(e,t)=>t.data.status===Te.uploadFailed,isUploadAuditing:(e,t)=>t.data.status===Te.auditing,isUploadAuditFailed:(e,t)=>t.data.status===Te.auditFailed,isDealing:(e,t)=>t.data.status===Te.dealing,isShareSuccess:(e,t)=>t.data.status===Te.shareSuccess,isNoneFormData:({preFormInfo:e})=>!e}});const nt=({openType:e,...t})=>{const a=(0,o.n)();a.setParam(t);let r=a.getReportParam();!function(e){return[ke.detailPage,ke.sharePage,ke.embedPage,ke.workspace,ke.sharedLinks,ke.receivedLinks,ke.modalWorkspace,ke.uploadShare].includes(e)}(e)?a.report({}):("extension"===new URL(window.location.href).searchParams.get("from")&&(r={...r,current_page_type:"record_plugin"}),ne.reportEvent(r))},it=(0,o.n)(),st=(0,d.O)({id:"LvShareYt",initial:"close",invoke:[{id:"asyncTaskActor",src:o.L}],states:{show:{id:"show",entry:[({userInfo:e})=>it.setParam({share_account:null==e?void 0:e.email})],states:{unknowBind:{always:[{target:"hasBind",cond:"isBind"},{target:"hasNotBind"}]},hasBind:{initial:"notUpload",states:{notUpload:{},uploading:{entry:[(0,c.kp)({uploadProgress:0})],states:{preparing:{id:"preparing",invoke:{src:"publishToYouTube",onDone:{target:"#polling",actions:["saveShareId"]},onError:[{cond:"isUserInfoError",target:"#show.hasNotBind",actions:["saveUploadFailedErrorCode"]},{target:"#uploadFailed",actions:["saveUploadFailedErrorCode"]}]}},polling:{id:"polling",entry:[(0,c.kp)({uploadProgress:0})],invoke:{id:"startPolling",src:"startPolling"},on:{GET_UPLOAD_PROGRESS:[{cond:"isShareSuccess",target:"#shareSuccess",actions:[(0,p.Rm)("ShareSuccess"),"saveUploadPlatformLink",(0,c.T4)({type:"USE_SHARE_SUCCESS_CALLBACK"})]},{cond:"isUploadFailed",target:"#uploadFailed",actions:["saveUploadPlatformLink","saveFailedReason",(0,p.Rm)("UploadFailed")]},{actions:[(0,p.Rm)("GettingProgress"),"getUploadProgressByTime"]}]}}}},uploaded:{states:{success:{id:"shareSuccess"},failed:{id:"uploadFailed",on:{RETRY:{target:"#preparing"}}}}},unbind:{id:"unbind",initial:"loading",states:{loading:{invoke:{src:()=>x.shareUserUnbind({platform:o.c.YouTube}),onDone:{target:"#show.hasNotBind",actions:[(0,p.Rm)("User unbind successfully."),(0,c.kp)({userInfo:()=>{}}),(0,c.T4)("USER_UNBIND_SUCCESS_CALLBACK"),(0,c.T4)({type:"REMOVE_USER_INFO",platform:o.c.YouTube})]},onError:{target:"#unbind.failed",actions:[(0,c.T4)("USER_UNBIND_FAILED_CALLBACK")]}}},failed:{}}}},on:{UPLOAD_TO_PLATFORM:{target:"#preparing",actions:["reporterClickShareWhere"]}}},hasNotBind:{}}},close:{entry:["initContext"]}},on:{INIT_SERVICE:{target:"close"},INIT_USER_INFO:{actions:(0,c.kp)({userInfo:(e,t)=>{var a;return null==(a=null==t?void 0:t.data)?void 0:a[O.YT_USER_INFO]}})},SAVE_SHARE_TYPE:{actions:"saveShareType"},SAVE_FILE_INFO:{actions:["saveFileInfo"]},SAVE_REPORT_EXTRA:{actions:["saveReportExtra"]},SAVE_SPACE_INFO:{actions:["saveSpaceInfo"]},REFRESH_USER_INFO:{actions:["refreshUserInfo"]},REFRESH_USER_INFO_CONTEXT:[{target:"show.hasBind",actions:["saveUserInfo"],cond:"userInfoNotNull"},{actions:["saveUserInfo"]}],USER_UNBIND:{target:"#unbind",actions:[(0,p.Rm)("Click\u300cSign out\u300dbutton"),({reportExtra:e,openType:t})=>{e.toolType||nt({openType:t,action:o.E.sign_out})}]},SHOW:{target:"show.hasBind"},BACK_CHOSEN_STATE:{target:"show.unknowBind",actions:[({openType:e})=>{nt({openType:e,action:o.E.back})}]},BACK_CHOOSE_STATE:{target:"close",actions:[()=>it.deleteFormData(),({reportExtra:e,openType:t})=>{e.toolType||nt({openType:t,action:o.E.back})},(0,c.T4)({type:"CLEAR_SELECTED_PLATFORM"})]},TRANSITION_UPLOADING:{target:"#polling",actions:["saveShareId","savePlatformLink","saveShareType"],internal:!0},TRANSITION_UPLOAD_SUCCESS:{target:"#shareSuccess",actions:["saveShareId","savePlatformLink","saveShareType"]},TRANSITION_UPLOAD_FAILED:{target:"#uploadFailed",actions:["saveShareId","savePlatformLink","saveShareType","saveFailedReason"]}}},{services:{publishToYouTube:async({fileInfo:e,shareId:t,shareType:a,userInfo:r,workspaceId:n,openType:i,currentPage:s},l)=>{var d,c,u,p,_,f,v,h,m,g,S,T,I,E;const y=a===o.f.YouTube?o.i.Youtube:o.i.YoutubeShort,k=(0,o.r)().getConfig().header,A={header:k,client_ip:"",params:{scenario:"custom",current_page:s,default_tag:null==(d=null==l?void 0:l.data)?void 0:d.default_tag,default_describe:null==(c=null==l?void 0:l.data)?void 0:c.default_describe},user:{user_id:null==(u=l.data)?void 0:u.uid,user_is_login:!0,user_unique_id:null==(p=l.data)?void 0:p.uid,web_id:k.custom.web_id}};if(l.isRetry)return l.distinguishAccount,{shareId:(await z.shareToThirdPartyPlatform({platform:y,asset_id_list:[(null==e?void 0:e.fileId)??""],share_type:null==e?void 0:e.fileType,workspace_id:n,custom_info:JSON.stringify(A)})).share_id??t};{nt({openType:i,action:o.E.upload,size:Number((null==e?void 0:e.fileSize)??0),share_email:null==r?void 0:r.email,share_caption:null==(f=null==(_=null==l?void 0:l.data)?void 0:_.formInfo)?void 0:f.title,share_caption_words_cnt:null==(m=null==(h=null==(v=null==l?void 0:l.data)?void 0:v.formInfo)?void 0:h.title)?void 0:m.length,share_view_range:null==(S=null==(g=null==l?void 0:l.data)?void 0:g.formInfo)?void 0:S.privacy_level,is_cover_added:null!=(I=null==(T=null==l?void 0:l.data)?void 0:T.formInfo)&&I.cover?"1":"0"});const s={platform:y,asset_id_list:[(null==e?void 0:e.fileId)??""],share_type:null==e?void 0:e.fileType,form_info:{...null==(E=l.data)?void 0:E.formInfo,youtube_share_type:a},workspace_id:n,custom_info:JSON.stringify(A)};return{shareId:(await z.shareToThirdPartyPlatform(s)).share_id??t}}},startPolling:({shareId:e})=>t=>{if(!e)throw new Error("No shareId provided!");const a=setInterval((async()=>{try{const a=await Be(e);t({type:"GET_UPLOAD_PROGRESS",data:a})}catch{t("UPLOAD_FAILED")}}),1e3);return()=>clearInterval(a)}},actions:{initContext:(0,c.kp)({shareId:void 0,uploadProgress:0}),saveSpaceInfo:(0,c.kp)({workspaceId:(e,t)=>{var a;return null==(a=t.spaceInfo)?void 0:a.workspaceId}}),saveReportExtra:(0,c.kp)({currentPage:(e,t)=>t.currentPage,openType:(e,t)=>t.openType,reportExtra:(e,t)=>({...e.reportExtra,...(0,r.A)(t.reportExtra,(e=>![void 0,null].includes(e)))})}),saveFileInfo:(0,c.kp)({fileInfo:(e,t)=>t.fileInfo}),saveUserInfo:(0,c.kp)({userInfo:(e,t)=>{var a;return null==(a=null==t?void 0:t.data)?void 0:a[O.YT_USER_INFO]}}),refreshUserInfo:(0,c.tN)((()=>({type:"ADD_TASK",exec:async()=>await x.getShareUserInfo({platforms:[o.c.YouTube]}),successType:"REFRESH_USER_INFO_CONTEXT",failType:"GET_USER_INFO_ERROR"})),{to:"asyncTaskActor"}),getUploadProgressByTime:(0,c.kp)({uploadProgress:({fileInfo:e},t)=>{var a,r;const o=(null==e?void 0:e.fileSize)||0,n=+`9${null==(a=o.toString())?void 0:a[o.toString().length-1]}`,i=null==(r=t.data)?void 0:r.create_time;return(0,l.d)({totalSize:Number(o),createTime:i,maxProgress:n})}}),saveUploadFailedErrorCode:(0,c.T4)(((e,t)=>({type:"SAVE_ERROR_CODE",errorCode:t.data.data.ret}))),reporterClickShareWhere:({fileInfo:e,reportExtra:t,userInfo:a,shareType:r},n)=>{var i,s,d,c,u,p,_,f,v,h,m,g,S,T,I,E,y,k;(new te).report({...(0,l.g)(null==e?void 0:e.asset),template_id:null==(s=null==(i=null==e?void 0:e.asset)?void 0:i.meta)?void 0:s.templateId,video_type_id:(0,l.p)(null==(c=null==(d=null==e?void 0:e.asset)?void 0:d.meta)?void 0:c.templateProducerAppId)??l.v[null==(p=null==(u=null==e?void 0:e.asset)?void 0:u.meta)?void 0:p.itemType],platform:o.c.YouTube,youtubeShareType:r,video_id:(null==e?void 0:e.videoId)??"undefined",current_page:t.currentPage,enter_from:t.enterFrom,resolution:String((null==e?void 0:e.resolution)??""),size:Number((null==e?void 0:e.fileSize)??0),format:(null==e?void 0:e.format)??"undefined",video_duration:(null==e?void 0:e.duration)??0,share_email:null==a?void 0:a.email,share_caption:null==(f=null==(_=null==n?void 0:n.data)?void 0:_.formInfo)?void 0:f.title,share_caption_words_cnt:null==(m=null==(h=null==(v=null==n?void 0:n.data)?void 0:v.formInfo)?void 0:h.title)?void 0:m.length,is_cover_added:null!=(S=null==(g=null==n?void 0:n.data)?void 0:g.formInfo)&&S.cover?"1":"0",default_tag:null==(T=null==n?void 0:n.data)?void 0:T.default_tag,default_describe:null==(I=null==n?void 0:n.data)?void 0:I.default_describe,share_view_range:null==(y=null==(E=null==n?void 0:n.data)?void 0:E.formInfo)?void 0:y.privacy_level,tool_type:(null==t?void 0:t.toolType)||(null==(k=(0,l.g)(null==e?void 0:e.asset))?void 0:k.tool_type),task_id:null==t?void 0:t.taskId,intelligent_request_id:null==t?void 0:t.intelligentRequestId,autocut_template_id:null==t?void 0:t.autocutTemplateId})},saveUploadPlatformLink:(0,c.kp)({platformLink:(e,t)=>{var a;return null==(a=null==t?void 0:t.data)?void 0:a.link}}),saveFailedReason:(0,c.kp)({fail_reason:(e,t)=>{var a;return null==(a=null==t?void 0:t.data)?void 0:a.fail_reason}}),savePlatformLink:(0,c.kp)({platformLink:(e,t)=>{var a;return null==(a=null==t?void 0:t.data)?void 0:a.platformLink}}),saveShareId:(0,c.kp)({shareId:(e,t)=>null==t?void 0:t.data.shareId}),saveShareType:(0,c.kp)({shareType:(e,t)=>t.data.youtubeShareType??o.f.YouTube})},guards:{userInfoNotNull:(e,t)=>{var a;return!(null==(a=t.data)||!a[O.YT_USER_INFO])},isBind:({userInfo:e})=>!(null==e||!e.email),isUploadFailed:(e,t)=>t.data.status===Te.uploadFailed,isShareSuccess:(e,t)=>t.data.status===Te.shareSuccess,isUserInfoError:(e,t)=>{var a,r;return(null==(r=null==(a=null==t?void 0:t.data)?void 0:a.data)?void 0:r.ret)===o.g.UPLOAD_AUTH_ERROR}}}),lt=({selectedPlatform:e,facebookShareType:t,youtubeShareType:a,fileInfo:r,enterFrom:o,isAuth:n,currentPage:i,toolType:s,task_id:d,intelligent_request_id:c,autocut_template_id:u,smart_ad_video_id:p,url_to_video_request_id:_})=>{var f,v,h,m,g,S;try{(new ee).report({...(0,l.g)(null==r?void 0:r.asset),template_id:null==(v=null==(f=null==r?void 0:r.asset)?void 0:f.meta)?void 0:v.templateId,video_type_id:(0,l.p)(null==(m=null==(h=null==r?void 0:r.asset)?void 0:h.meta)?void 0:m.templateProducerAppId)??l.v[null==(S=null==(g=null==r?void 0:r.asset)?void 0:g.meta)?void 0:S.itemType],platform:e||"",facebookShareType:t,youtubeShareType:a,is_authorize:n,enter_from:o,video_id:(null==r?void 0:r.videoId)||"",current_page:i,resolution:null!=r&&r.resolution?String(null==r?void 0:r.resolution):"",size:null!=r&&r.fileSize?Number(null==r?void 0:r.fileSize):0,format:(null==r?void 0:r.format)||"",video_duration:(null==r?void 0:r.duration)??0,tool_type:s,task_id:d,intelligent_request_id:c,autocut_template_id:u,smart_ad_video_id:p,url_to_video_request_id:_})}catch{}};var dt=(e=>(e.LV_SHARE_TT="LvShareTt",e.LV_SHARE_TTAM="LvShareTtam",e.LV_SHARE_YT="LvShareYt",e.LV_SHARE_FACEBOOK="LvShareFacebook",e.LV_SHARE_SHOPIFY="LvShareShopify",e.LV_SHARE_EMBED_SHOPIFY="LvShareEmbedShopify",e))(dt||{});const ct={[o.c.TikTok]:"LvShareTt",[o.c.TTAM]:"LvShareTtam",[o.c.YouTube]:"LvShareYt",[o.c.Facebook]:"LvShareFacebook",[o.c.Shopify]:"LvShareShopify",[o.c.Schedule]:"LvShareTt",[o.c.EmbedShopify]:"LvShareEmbedShopify"},ut={[o.c.Facebook]:O.FACEBOOK_USER_INFO,[o.c.YouTube]:O.YT_USER_INFO,[o.c.TikTok]:O.TT_USER_INFO,[o.c.TTAM]:o.c.TTAM,[o.c.Shopify]:o.c.Shopify},pt=[o.g.PERMISSION_ERROR,o.g.VIDEO_DURATION_TOO_SHORT,o.g.VIDEO_DURATION_TOO_SHORT_TTAM,o.g.UPLOAD_AUTH_ERROR,o.g.AUTH_ERROR,o.g.TTAM_AUTH_ERROR,o.g.TTAM_AUTH_ERROR_10,o.g.TTAM_AUTH_ERROR_611,o.g.COUNTRY_NOT_SUPPORT,o.g.VIDEO_DURATION_TOO_LONG,o.g.UNKONWN_ERROR,o.g.NO_TIMES_TO_UPLOAD,o.g.PERMISSTION_NOT_VERIFIED,o.g.PRIVACY_NOT_VERIFIED,o.g.ACCOUNT_CHANGED,o.g.ACCOUNT_DISCONNECT,o.g.SHARE_TTAM_RETRY_FAILED,o.g.GET_TT4B_ACCOUNTS_FAILED,o.g.GET_ADVERTISERS_FAILED,o.g.SHARE_TTAM_CHANGED_BIND,o.g.TT4B_RIGHT_FAILED,o.g.SHARE_TTAM_USER_DISAUTHORIZED,o.g.FACEBOOK_AUTH_ERROR,o.g.FAILED_BY_RISK,o.g.FAILED_BY_FREQUENCY],_t={[o.c.TikTok]:{tooShort:o.g.VIDEO_DURATION_TOO_SHORT},[o.c.TTAM]:{tooShort:o.g.VIDEO_DURATION_TOO_SHORT_TTAM}},ft=(0,d.O)({id:"LvShareVideoMachine",initial:"user",context:{userInfo:{},errorCode:"-1",detailPageOpenCallback:void 0,currentPage:s.M.Editor,businessType:o.F.FilmVideo,openType:ke.default},invoke:[{id:"asyncTaskActor",src:o.L},{id:"LvShareTt",src:at,data:e=>({uploadProgress:0,currentPage:e.currentPage,reportExtra:e.reportExtra,isNewShareExport:e.isNewShareExport})},{id:"LvShareTtam",src:ot,data:e=>({uploadProgress:0,currentPage:e.currentPage,reportExtra:e.reportExtra,isNewShareExport:e.isNewShareExport})},{id:"LvShareYt",src:st,data:e=>({uploadProgress:0,currentPage:e.currentPage,reportExtra:e.reportExtra,isNewShareExport:e.isNewShareExport})},{id:"LvShareFacebook",src:He,data:e=>({isNewShareExport:e.isNewShareExport})},{id:"LvShareShopify",src:Qe,data:e=>({isNewShareExport:e.isNewShareExport,reportExtra:e.reportExtra})},{id:"LvShareEmbedShopify",src:et,data:e=>({isNewShareExport:e.isNewShareExport})}],states:{auth:{id:"auth",states:{success:{},failed:{},loading:{entry:["reportAuthRequest"],invoke:{src:"openAuthWindow"},after:{18e4:{actions:(0,c.tN)((e=>({type:"USER_AUTH_FAIL",platform:e.selectedPlatform,status:Se.FAIL})))}}}},on:{OPEN_AUTH_WINDOW:"#auth.loading",CHOOSE_PLATFORM:[{cond:"isSchedulePost",actions:["choosePlatform"]},{cond:"isTooShort",actions:(0,c.kp)({errorCode:(e,t)=>{var a,r;return(null==(r=null==_t?void 0:_t[null==(a=null==t?void 0:t.data)?void 0:a.platform])?void 0:r.tooShort)??"-1"}})},{cond:"hasUserInfo",target:"#auth.success",actions:["choosePlatform","saveShareType","reportClickShareChannel","showChild"]},{target:"#auth.loading",actions:["choosePlatform","saveShareType","reportClickShareChannel"]}],TTAM_INSIDE_CHOOSE_PLATFORM:[{target:"#auth.loading",actions:["choosePlatform","saveShareType","reportClickShareChannel"]}],USER_AUTH_SUCCESS:{target:"user.loading",actions:["refreshUserInfo","removeLocalStorage"]},USER_AUTH_FAIL:{target:"auth.failed",actions:["userAuthFail","removeLocalStorage"]},UPDATE_SHOPIFY_META_INFO:{actions:[(0,c.tN)(((e,t)=>({type:"UPDATE_SHOPIFY_META_INFO",data:t.data})),{to:"LvShareShopify"})]}}},user:{id:"user",initial:"loading",states:{loading:{invoke:{src:"getAllUserInfo",onError:"#auth.failed",onDone:{target:"#auth.success",actions:[(0,c.kp)({userInfo:(e,t)=>t.data}),...Object.values(dt).map((e=>(0,c.tN)(((e,t)=>({type:"INIT_USER_INFO",data:t.data})),{to:e})))]}}}}}},on:{CLEAR_SELECTED_PLATFORM:{actions:(0,c.kp)({selectedPlatform:()=>{}})},RETRY_REFRESH_USER_INFO:{target:"user.loading",actions:"retryRefreshUserInfo"},REMOVE_USER_INFO:{actions:[(0,c.kp)({userInfo:({userInfo:e},t)=>(0,r.A)(e,((e,a)=>a!==ut[t.platform]))})]},SAVE_SPACE_INFO:{actions:[(0,c.kp)({spaceId:(e,t)=>{var a;return null==(a=null==t?void 0:t.spaceInfo)?void 0:a.spaceId},workspaceId:(e,t)=>{var a;return null==(a=null==t?void 0:t.spaceInfo)?void 0:a.workspaceId}}),...Object.values(dt).map((e=>(0,c.D)(e)))]},SAVE_FILE_INFO:{actions:["saveFileInfo",...Object.values(dt).map((e=>(0,c.D)(e)))]},SAVE_REPORT_EXTRA:{actions:["saveReportExtra",...Object.values(dt).map((e=>(0,c.D)(e)))]},SAVE_FAILED_ADV_LIST_AND_SWITCH_ID:{actions:(0,c.tN)(((e,t)=>({type:"SAVE_FAILED_ADV_LIST_AND_SWITCH_ID",data:t.data})),{to:"LvShareTtam"})},SAVE_UNBIND_CALLBACK:{actions:["saveUserUnbindCallback"]},USER_UNBIND_SUCCESS_CALLBACK:{actions:({userUnbindSuccessCallback:e})=>{null==e||e()}},USER_UNBIND_FAILED_CALLBACK:{actions:({userUnbindFailedCallback:e})=>{null==e||e()}},RETRY_SHARE_FAILED_CALLBACK:{actions:({retryShareFailedCallback:e})=>{null==e||e()}},INIT_SERVICE:{actions:["initContext",...Object.values(dt).map((e=>(0,c.D)(e)))]},TRANSITION_UPLOADING:{actions:[(0,c.tN)((({workspaceId:e},t)=>({type:"TRANSITION_UPLOADING",data:{...t.data,workspaceId:e}})),{to:(e,t)=>ct[t.data.platform]??"LvShareTt"}),"transitionStateSaveReportExtra","choosePlatform"]},TRANSITION_UPLOAD_SUCCESS:{actions:[(0,c.tN)((({workspaceId:e},t)=>({type:"TRANSITION_UPLOAD_SUCCESS",data:{...t.data,workspaceId:e}})),{to:(e,t)=>ct[t.data.platform]??"LvShareTt"}),"transitionStateSaveReportExtra","choosePlatform"]},TRANSITION_UPLOAD_FAILED:{actions:[(0,c.tN)((({workspaceId:e},t)=>({type:"TRANSITION_UPLOAD_FAILED",data:{...t.data,workspaceId:e}})),{to:(e,t)=>ct[t.data.platform]??"LvShareTt"}),"transitionStateSaveReportExtra","choosePlatform"]},TRANSITION_AUDITING:{actions:[(0,c.tN)((({workspaceId:e},t)=>({type:"TRANSITION_AUDITING",data:{...t.data,workspaceId:e}})),{to:(e,t)=>ct[t.data.platform]??"LvShareTt"}),"transitionStateSaveReportExtra","choosePlatform"]},CLEAR_SHARE_VIDEO_ERROR_CODE:{actions:["clearErrorCode"]},SAVE_ERROR_CODE:{actions:(0,c.kp)({errorCode:({errorCode:e},t)=>pt.includes(t.errorCode)?t.errorCode:e})},SAVE_SHARE_SUCCESS_CALLBACK:{actions:["saveShareSuccessCallback"]},USE_SHARE_SUCCESS_CALLBACK:{actions:({shareSuccessCallback:e,fileInfo:t})=>{null==e||e({fileId:null!=t&&t.fileId?null==t?void 0:t.fileId:"-1"})}},SAVE_SHARE_TYPE:{actions:["LvShareFacebook","LvShareYt","LvShareShopify"].map((e=>(0,c.D)(e)))},AUTH_STATUS_REPORT:{actions:"reportAuthStatus"},AUTH_REQUEST_REPORT:{actions:"reportAuthRequest"},BIND_BY_SCHEDULE:{actions:[(0,c.kp)({userInfo:({userInfo:e},t)=>{const{platform:a}=t.data,r=t.data.userInfo;return a===o.j.TTAM?{...e,[ut[o.c.TTAM]]:{accounts:r}}:Object.assign(e,{[ut[a]]:r[0]})}}),"refreshUserInfoBySchedule"]},UNBIND_BY_SCHEDULE:{actions:["refreshUserInfoBySchedule",(0,c.kp)({userInfo:({userInfo:e},t)=>{var a,r;const{platform:n}=t.data,{unbindAccountId:i}=t.data;return n===o.j.TTAM?Object.assign(e,{[ut[o.c.TTAM]]:Object.assign(e.TTAM??{},{accounts:(null==(r=null==(a=e.TTAM)?void 0:a.accounts)?void 0:r.filter((e=>e.tt4b_uid!==i)))??[]})}):Object.assign(e,{[ut[n]]:null})}})]}}},{services:{openAuthWindow:(e,t)=>e=>{var a;const{order:r=o.h.First}=t.data,{popupHeight:n,popupWidth:i,iTop:s,iLeft:l}={popupWidth:800,popupHeight:750,iTop:(window.screen.height-30-750)/2,iLeft:(window.screen.width-800)/2};window.open((null==(a=t.data)?void 0:a.authUrl)||"","name=thirdparty_share_auth",`fullscreen=1,width=${i},height=${n},top=${s},left=${l}`);const d=t=>{if(t.key===E.THIRDPARTY_SHARE_AUTH&&t.newValue){const{status:a,platform:n,unauthorizedScope:i}=JSON.parse(t.newValue);r===o.h.First&&e({type:"AUTH_STATUS_REPORT",data:{status:a,failReason:a===Se.INSUFFICIENT_PERMISSIONS?Se.INSUFFICIENT_PERMISSIONS:void 0}}),e("success"===a?{type:"USER_AUTH_SUCCESS",platform:n,status:a,unauthorizedScope:i??void 0}:{type:"USER_AUTH_FAIL",platform:n,status:a,unauthorizedScope:i??void 0})}};return window.addEventListener("storage",d),()=>{window.removeEventListener("storage",d)}},getAllUserInfo:async()=>{var e,t,a,r;try{const[n,s,l]=await Promise.allSettled([x.getShareUserInfo({platforms:[o.c.TikTok,o.c.YouTube,o.c.Facebook]}),K.getTt4bAccounts().then((e=>{var t;return(null==(t=null==e?void 0:e.accounts)?void 0:t.length)>0?e:null})),i.f.userInfo({platform:y.Shopify},"multi")]);return await Promise.resolve({...n.value,[o.c.TTAM]:s.value,[o.c.Shopify]:null!=(t=null==(e=l.value)?void 0:e.data)&&t.user_infos?{accounts:null==(r=null==(a=l.value)?void 0:a.data)?void 0:r.user_infos}:null})}catch{return Promise.reject()}}},actions:{refreshUserInfoBySchedule:(0,c.tN)((({userInfo:e})=>({type:"INIT_USER_INFO",data:e})),{to:(e,t)=>t.data.platform&&ct[t.data.platform]||"LvShareTt"}),saveShareType:(0,c.tN)((e=>({type:"SAVE_SHARE_TYPE",data:e}))),saveFileInfo:(0,c.kp)({fileInfo:(e,t)=>t.fileInfo}),showChild:(0,c.tN)((({reportExtra:e,workspaceId:t,currentPage:a},r)=>({type:"SHOW",data:{...r.data,reportExtra:e,currentPage:a,workspaceId:t}})),{to:(e,t)=>{const{data:{platform:a}}=t;return ct[a]??"LvShareTt"}}),choosePlatform:(0,c.kp)({youtubeShareType:(e,t)=>t.data.youtubeShareType,facebookShareType:(e,t)=>t.data.facebookShareType,businessType:({businessType:e},t)=>t.data.businessType??e,selectedPlatform:(e,t)=>{const{data:{platform:a}}=t;return a}}),refreshUserInfo:(0,c.tN)(((e,t)=>({type:"REFRESH_USER_INFO",data:t})),{to:(e,t)=>ct[t.platform]??"LvShareTt"}),retryRefreshUserInfo:(0,c.tN)((()=>({type:"REFRESH_USER_INFO"})),{to:({selectedPlatform:e})=>e&&ct[e]||"LvShareTt"}),removeLocalStorage:()=>{i.a.removeItem(E.THIRDPARTY_SHARE_AUTH)},initContext:(0,c.kp)({selectedPlatform:()=>{},facebookShareType:()=>{},youtubeShareType:()=>{},businessType:o.F.FilmVideo,detailPageOpenCallback:()=>{},preFormInfo:void 0,errorCode:"-1"}),clearErrorCode:(0,c.kp)({errorCode:({errorCode:e})=>e&&""}),userAuthFail:(0,c.kp)({errorCode:(e,t)=>{var a;if(t.platform===o.c.TikTok)return t.status===Se.INSUFFICIENT_PERMISSIONS?o.g.PERMISSION_ERROR:t.status===Se.REGION_NOT_SUPPORT?o.g.COUNTRY_NOT_SUPPORT:o.g.AUTH_ERROR;if(t.platform===o.c.TTAM){if(t.status===Se.INSUFFICIENT_PERMISSIONS){const e=null==(a=t.unauthorizedScope)?void 0:a.split(",");return 2===(null==e?void 0:e.length)?o.g.TTAM_AUTH_ERROR_611_10:null!=e&&e.includes("10")?o.g.TTAM_AUTH_ERROR_10:null!=e&&e.includes("611")?o.g.TTAM_AUTH_ERROR_611:"-1"}return t.status===Se.OVER_MAX_TT4B_ACCOUNT_SIZE?o.g.OVER_MAX_TT4B_ACCOUNT_SIZE:o.g.TTAM_AUTH_ERROR}return t.platform===o.c.Facebook?o.g.FACEBOOK_AUTH_ERROR:t.platform===o.c.YouTube&&t.status===Se.INSUFFICIENT_PERMISSIONS?o.g.YOUTUBE_INSUFFICIENT_PERMISSIONS:"-1"}}),saveShareSuccessCallback:(0,c.kp)({shareSuccessCallback:(e,t)=>t.callback}),saveReportExtra:(0,c.kp)({currentPage:(e,t)=>t.currentPage,openType:(e,t)=>t.openType,reportExtra:(e,t)=>({...e.reportExtra,...(0,r.A)(t.reportExtra,(e=>![void 0,null].includes(e)))})}),transitionStateSaveReportExtra:(0,c.kp)({reportExtra:(e,t)=>{var a;return{...e.reportExtra,...(0,r.A)(null==(a=t.data)?void 0:a.reportExtra,(e=>![void 0,null].includes(e)))}}}),saveUserUnbindCallback:(0,c.kp)({userUnbindFailedCallback:(e,t)=>t.unbindFailedCallback,userUnbindSuccessCallback:(e,t)=>t.unbindSuccessCallback}),reportAuthRequest:({selectedPlatform:e,currentPage:t,facebookShareType:a,youtubeShareType:r,businessType:o},n)=>{(new $).report({platform:e,current_page:t,facebookShareType:a,youtubeShareType:r,businessType:o,...n.data})},reportAuthStatus:({selectedPlatform:e,currentPage:t,facebookShareType:a,youtubeShareType:r,businessType:o},n)=>{(new Z).report({platform:e,current_page:t,facebookShareType:a,youtubeShareType:r,businessType:o,...n.data})},reportClickShareChannel:({fileInfo:e,currentPage:t,reportExtra:a,facebookShareType:r,youtubeShareType:n,selectedPlatform:i,userInfo:s,isNewShareExport:d,businessType:c})=>{var u;c!==o.F.Graphic&&lt({selectedPlatform:i,fileInfo:e,facebookShareType:r,youtubeShareType:n,currentPage:t,enterFrom:d?"export":null==a?void 0:a.enterFrom,toolType:(null==a?void 0:a.toolType)||(null==(u=(0,l.g)(null==e?void 0:e.asset))?void 0:u.tool_type),isAuth:+!!s[ut[i]],task_id:null==a?void 0:a.taskId,intelligent_request_id:null==a?void 0:a.intelligentRequestId,autocut_template_id:null==a?void 0:a.autocutTemplateId,smart_ad_video_id:null==a?void 0:a.smartAdVideoId,url_to_video_request_id:null==a?void 0:a.urlToVideoRequestId})}},guards:{isSchedulePost:(e,t)=>{var a;return(null==(a=t.data)?void 0:a.platform)===o.c.Schedule},isTooShort:({fileInfo:e},t)=>{var a;return[o.c.TikTok,o.c.TTAM].includes(null==(a=t.data)?void 0:a.platform)&&((null==e?void 0:e.duration)??0)<3100},hasUserInfo:({userInfo:e},t)=>{var a,r,n,i,s,l,d,c;return(null==(a=t.data)?void 0:a.platform)===ut[o.c.TTAM]?!(null==(n=null==(r=null==e?void 0:e.TTAM)?void 0:r.accounts)||!n.length):(null==(i=t.data)?void 0:i.platform)===o.c.Shopify||(null==(s=t.data)?void 0:s.platform)===o.c.EmbedShopify?!(null==(d=null==(l=null==e?void 0:e[o.c.Shopify])?void 0:l.accounts)||!d.length):!!e[ut[null==(c=t.data)?void 0:c.platform]]}}})},11522:function(e,t,a){a(13398),a(38e3),a(67308),a(87581),a(4271),a(45475),a(14148)},54148:function(){},55820:function(){},69212:function(){}}]);
//# sourceMappingURL=3359.6879e105.js.map