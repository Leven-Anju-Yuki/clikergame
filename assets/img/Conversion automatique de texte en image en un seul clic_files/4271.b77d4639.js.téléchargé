/*! For license information please see 4271.b77d4639.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).xss={})}(this,(function(e){"use strict";var t=function(){return t=Object.assign||function(e){for(var t,o=1,a=arguments.length;o<a;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},t.apply(this,arguments)};function o(e,t,o){if(o||2===arguments.length)for(var a,n=0,r=t.length;n<r;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}var a=/[^a-zA-Z0-9\\_:.-]/gim,n=/</g,r=/>/g,i=/&#([a-zA-Z0-9]*);?/gim,s=/&quot;/g,l=/&colon;?/gim,c=/&newline;?/gim,d=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,u=/u\s*r\s*l\s*\(.*/gi,p=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,_=/"/g,h=function(e){return e.replace(n,"&lt;").replace(r,"&gt;")},m={indexOf:function(e,t){var o,a;for(o=0,a=e.length;o<a;o++)if(e[o]===t)return o;return-1},forEach:function(e,t,o){var a,n;for(a=0,n=e.length;a<n;a++)t.call(o,e[a],a,e)},some:function(e,t,o){var a,n;for(a=0,n=e.length;a<n;a++)if(t.call(o,e[a],a,e))return!0;return!1},trim:function(e){return e.replace(/(^\s*)|(\s*$)/g,"")},isArray:function(e){return e instanceof Array},includes:function(e,t){if("string"==typeof e)return-1!==e.indexOf(t);for(var o=0;o<e.length;o++)if(e[o]===t)return!0;return!1},spaceIndex:function(e){var t=/\s|\n|\t/.exec(e);return t?t.index:-1},uniq:function(e){for(var t={},o=[],a=0;a<e.length;a++)t[e[a]]||(o.push(e[a]),t[e[a]]=!0);return o},from:function(e){for(var t=[],o=0;o<e.length;o++)t.push(e[o]);return t},keys:function(e){var t=[];for(var o in e)t.push(o);return t}};function g(e){return null==e}function v(e){var t,o=m.spaceIndex(e);return t=-1===o?e.slice(1,-1):e.slice(1,o+1),"/"===(t=m.trim(t).toLowerCase()).slice(0,1)&&(t=t.slice(1)),"/"===t.slice(-1)&&(t=t.slice(0,-1)),t}function f(e,t){for(;t<e.length;t++){var o=e[t];if(" "!==o)return"="===o?t:-1}return-1}function y(e,t){for(;t>0;t--){var o=e[t];if(" "!==o)return"="===o?t:-1}return-1}function w(e){return function(e){return'"'===e[0]&&'"'===e[e.length-1]||"'"===e[0]&&"'"===e[e.length-1]}(e)?e.substr(1,e.length-2):e}function b(e,t){for(;t<e.length;t++){var o=e[t];if(" "!==o)return"'"===o||'"'===o?t:-1}return-1}function x(e){var t,o,a,n,r,i,s,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",d=0;for(e=function(e){e=e.replace(/rn/g,"n");for(var t="",o=0;o<e.length;o++){var a=e.charCodeAt(o);a<128?t+=String.fromCharCode(a):a>127&&a<2048?(t+=String.fromCharCode(a>>6|192),t+=String.fromCharCode(63&a|128)):(t+=String.fromCharCode(a>>12|224),t+=String.fromCharCode(a>>6&63|128),t+=String.fromCharCode(63&a|128))}return t}(e);d<e.length;)n=(t=e.charCodeAt(d++))>>2,r=(3&t)<<4|(o=e.charCodeAt(d++))>>4,i=(15&o)<<2|(a=e.charCodeAt(d++))>>6,s=63&a,isNaN(o)?i=s=64:isNaN(a)&&(s=64),c=c+l.charAt(n)+l.charAt(r)+l.charAt(i)+l.charAt(s);return c}function k(e){var t,o,a,n,r,i,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="",c=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");c<e.length;)t=s.indexOf(e.charAt(c++))<<2|(n=s.indexOf(e.charAt(c++)))>>4,o=(15&n)<<4|(r=s.indexOf(e.charAt(c++)))>>2,a=(3&r)<<6|(i=s.indexOf(e.charAt(c++))),l+=String.fromCharCode(t),64!==r&&(l+=String.fromCharCode(o)),64!==i&&(l+=String.fromCharCode(a));return l=function(e){for(var t="",o=0,a=0,n=0,r=0;o<e.length;)(a=e.charCodeAt(o))<128?(t+=String.fromCharCode(a),o++):a>191&&a<224?(r=e.charCodeAt(o+1),t+=String.fromCharCode((31&a)<<6|63&r),o+=2):(r=e.charCodeAt(o+1),n=e.charCodeAt(o+2),t+=String.fromCharCode((15&a)<<12|(63&r)<<6|63&n),o+=3);return t}(l),l}function A(e){return"</"===e.slice(0,2)}function S(e,t,o){var a="",n=0,r=!1,i=!1,s=0,l=e.length,c="",d="";e:for(s=0;s<l;s++){var u=e.charAt(s);if(!1===r){if("<"===u){r=s;continue}}else if(!1===i){if("<"===u){a+=o(e.slice(n,s)),r=s,n=s;continue}if(">"===u||s===l-1){a+=o(e.slice(n,r)),c=v(d=e.slice(r,s+1)),a+=t(r,a.length,c,d,A(d)),n=s+1,r=!1;continue}if('"'===u||"'"===u)for(var p=1,_=e.charAt(s-p);""===_.trim()||"="===_;){if("="===_){i=u;continue e}_=e.charAt(s-++p)}}else if(u===i){i=!1;continue}}return n<l&&(a+=o(e.substr(n))),a}function C(e,t){var o=0,n=0,r=[],i=!1,s=e.length;function l(e,o){if(!((e=(e=m.trim(e)).replace(a,"").toLowerCase()).length<1)){var n=t(e,o||"");n&&r.push(n)}}for(var c=0;c<s;c++){var d=e.charAt(c),u=void 0;if(!1!==i||"="!==d)if(!1===i||c!==n){if(/\s|\n|\t/.test(d)){if(e=e.replace(/\s|\n|\t/g," "),!1===i){if(-1===(u=f(e,c))){l(m.trim(e.slice(o,c))),i=!1,o=c+1;continue}c=u-1;continue}if(-1===(u=y(e,c-1))){l(i,w(m.trim(e.slice(o,c)))),i=!1,o=c+1;continue}}}else{if(-1===(u=e.indexOf(d,c+1)))break;l(i,m.trim(e.slice(n+1,u))),i=!1,o=(c=u)+1}else i=e.slice(o,c),o=c+1,n='"'===e.charAt(o)||"'"===e.charAt(o)?o:b(e,c+1)}return o<e.length&&(!1===i?l(e.slice(o)):l(i,w(m.trim(e.slice(o))))),m.trim(r.join(" "))}function I(e,t,o){if(o=function(e){return function(e){for(var t="",o=0,a=e.length;o<a;o++)t+=e.charCodeAt(o)<32?" ":e.charAt(o);return m.trim(t)}(e=function(e){return e.replace(l,":").replace(c," ")}(e=function(e){return e.replace(i,(function(e,t){return"x"===t[0]||"X"===t[0]?String.fromCharCode(parseInt(t.substr(1),16)):String.fromCharCode(parseInt(t,10))}))}(e=function(e){return e.replace(s,'"')}(e))))}(o),"href"===t||"src"===t){if("#"===(o=m.trim(o)))return"#";if("http://"!==o.substr(0,7)&&"https://"!==o.substr(0,8)&&"mailto:"!==o.substr(0,7)&&"tel:"!==o.substr(0,4)&&"data:image/"!==o.substr(0,11)&&"ftp://"!==o.substr(0,6)&&"./"!==o.substr(0,2)&&"../"!==o.substr(0,3)&&"#"!==o[0]&&"/"!==o[0])return""}else if("background"===t){if(d.lastIndex=0,d.test(o))return""}else if("style"===t){if(p.lastIndex=0,p.test(o))return"";if(u.lastIndex=0,u.test(o)&&(d.lastIndex=0,d.test(o)))return""}return function(e){return e=function(e){return e.replace(_,"&quot;")}(e),h(e)}(o)}var E=function(e){return"string"==typeof e?e.replace(/'/g,'"').replace('=""',"").replace(/\s+/g,"").toLowerCase():""},T=function(){function e(e){var t=function(e){var t={};for(var o in e)t[o]=e[o];return t}(e||{});t.stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=function(){return""}),t.whiteList={},t.onTag=function(){},t.onTagAttr=function(){},t.onIgnoreTag=function(){},t.onIgnoreTagAttr=function(){},t.safeAttrValue=I,t.escapeHtml=h,this.options=Object.assign(t,e)}return e.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t=this.options,o=t.whiteList,a=t.onTag,n=t.onIgnoreTag,r=t.onTagAttr,i=t.onIgnoreTagAttr,s=t.safeAttrValue,l=t.escapeHtml;t.stripBlankChar&&(e=function(e){var t=e.split("");return(t=t.filter((function(e){var t=e.charCodeAt(0);return!(127===t||t<=31&&10!==t&&13!==t)}))).join("")}(e)),t.allowCommentTag||(e=function(e){for(var t="",o=0;o<e.length;){var a=e.indexOf("\x3c!--",o);if(-1===a){t+=e.slice(o);break}t+=e.slice(o,a);var n=e.indexOf("--\x3e",a);if(-1===n)break;o=n+3}return t}(e));var c=!1;t.stripIgnoreTagBody&&(c=function(e,t){"function"!=typeof t&&(t=function(){});var o=!Array.isArray(e),a=[],n=!1;return{onIgnoreTag:function(r,i,s){if(function(t){return!!o||-1!==m.indexOf(e,t)}(r)){if(s.isClosing){var l="[/removed]",c=s.position+10;return a.push([!1!==n?n:s.position,c]),n=!1,l}return n||(n=s.position),"[removed]"}return t(r,i,s)},remove:function(e){var t="",o=0;return m.forEach(a,(function(a){t+=e.slice(o,a[0]),o=a[1]})),t+=e.slice(o)}}}(t.stripIgnoreTagBody,n),n=c.onIgnoreTag);var d=S(e,(function(e,t,c,d,u){var p={sourcePosition:e,position:t,isClosing:u,isWhite:Object.prototype.hasOwnProperty.call(o,c)},_=a(c,d,p);if(!g(_))return _;if(p.isWhite){if(p.isClosing)return"</".concat(c,">");var h=function(e){var t=m.spaceIndex(e);if(-1===t)return{html:"",closing:"/"===e[e.length-2]};var o="/"===(e=m.trim(e.slice(t+1,-1)))[e.length-1];return o&&(e=m.trim(e.slice(0,-1))),{html:e,closing:o}}(d),v=o[c],f=C(h.html,(function(e,t){var o=-1!==m.indexOf(v,e),a=r(c,e,t,o);return g(a)?o?(t=s(c,e,t,null))?"".concat(e,'="').concat(t,'"'):e:g(a=i(c,e,t,o))?void 0:a:a}));return d="<".concat(c),f&&(d+=" ".concat(f)),h.closing&&(d+=" /"),d+">"}return g(_=n(c,d,p))?l(d):_}),l);return c&&(d=c.remove(d)),d},e}(),P=!0,N=function(e){return e&&e.Math==Math&&e},j=N("object"==typeof globalThis&&globalThis)||N("object"==typeof window&&window)||N("object"==typeof self&&self)||N("object"==typeof global&&global)||Function("return this")();try{!0!==(P=!!(P=String(P)).startsWith("<%=")||JSON.parse(P))&&"true"!==P||(j=new Function("\nvar _checkXSS = function (it) {\n  return it && it.Math == Math && it;\n};\nreturn _checkXSS(typeof globalThis === 'object' && globalThis) ||\n_checkXSS(typeof window === 'object' && window) ||\n_checkXSS(typeof self === 'object' && self) ||\n_checkXSS(typeof global === 'object' && global) ||\nFunction('return this')();\n")())}catch(e){console.log(e)}var R=new(function(){function e(){var e=this;this.batchData=[],this.uniqKeys=new Set,this.timeout=2e3,this.lock=!1,this.getSlardarBid=function(){var t,o,a="cc_web";if(!m.includes(a,"bid"))return a;if(e.config&&e.config.bid)return e.config.bid;var n=j;if(n&&n._xssBid)return n._xssBid;if(n&&n.slardar&&"function"==typeof n.slardar.config){var r=(n.slardar.config()||{}).bid;if(r)return r}if(n&&n.Slardar&&"function"==typeof n.Slardar.config){var i=(n.Slardar.config()||{}).bid;if(i)return i}return(null===(o=null===(t=null==n?void 0:n.Slardar)||void 0===t?void 0:t._baseParams)||void 0===o?void 0:o.bid)||"argus"},this.getConfigRegion=function(){var t;return m.includes("va","region")?e.config&&e.config.region?e.config.region:((null===(t=null==j?void 0:j.gfdatav1)||void 0===t?void 0:t.region)||"cn").toLowerCase():"va"},this.gerReportUrl=function(){var t={cn:k("aHR0cHM6Ly9tb24uemlqaWVhcGkuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),boe:k("aHR0cHM6Ly9tb24uemlqaWVhcGkuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),ttp:k("aHR0cHM6Ly9tb24udXMudGlrdG9rdi5jb20vbW9uaXRvcl9icm93c2VyL2NvbGxlY3QvYmF0Y2gvc2VjdXJpdHkvP2JpZD0="),va:k("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),maliva:k("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),sg:k("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),boei18n:k("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9")}[e.getConfigRegion()];if(t)return t+e.getSlardarBid()}}return e.prototype.setConfig=function(e){this.config=e},e.prototype.upload=function(){var e=this;if(!this.config||!this.config.isCloseReport){var t=!1;t=String(t);try{if(!0===(t=!t.startsWith("<%=")&&JSON.parse(t))||"true"===t)return}catch(e){console.log(e)}var o=this.gerReportUrl();!this.lock&&o&&0!==this.batchData.length&&(this.lock=!0,setTimeout((function(){var t=e.batchData.slice(0,100);e.batchData=e.batchData.slice(100),j.fetch(o,{method:"post",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).catch((function(e){console.warn("xss defense report error",e)})),e.lock=!1,e.upload()}),this.timeout))}},e.prototype.generateKey=function(e){return e.collectKey?[e.collectMode,e.collectKey].join("___"):""},e.prototype.push=function(e){this.batchData.push(e),this.upload()},e.prototype.report=function(e){var t,o=this.generateKey(e);if(j.fetch&&e.collectKey){var a=(null===(t=null===window||void 0===window?void 0:window.location)||void 0===t?void 0:t.href)||"SSR";e.documentUrl=a;var n={age:Math.floor(Date.now()),type:"xss",url:a,body:e,"user-agent":""};"enforce"===e.disposition&&"SSR"!==a||(n.url=o),"SSR"===a&&(n.url="SSR___".concat(n.url),n.body.ssr=!0),this.push(n)}},e}());function L(e,t){return R.setConfig(t),new T(t).process(e)}var O=function(e){return-1===(e=(e=(e=(e=e.replace(/&colon;/gi,":")).replace(/&tab;/gi,"")).replace(/&newline;/gi,"")).replace(/(\t|\n|\r)/g,"")).indexOf("&#")?e.trim().toLowerCase():e.trim().replace(/&#(?:(x)([0-9a-f]+)|([0-9]+));?/gi,(function(e,t,o,a){return String.fromCharCode(t?parseInt(o,16):parseInt(a))})).replace(/(\t|\n|\r)/g,"").toLowerCase()};function F(e,t){if(void 0===e&&(e=""),"string"!=typeof e)return!0;if(e=O(e),m.includes(e,"base64")&&!function(e){if(""===e||""===e.trim())return!0;try{return!m.includes(e,"data:text/html;base64")}catch(e){return!0}}(e))return t&&t("data:text/html;base64"),!1;var o=["expression(","behavior:","view-source:"];if(m.some(o,(function(t){return-1!==e.indexOf(t)})))return m.forEach(o,(function(o){-1!==e.indexOf(o)&&t&&t(o)})),!1;var a=["data:application","data:javascript","data:text/html","data:texthtml"];if(m.some(a,(function(t){return-1!==e.indexOf(t)})))return m.forEach(a,(function(o){-1!==e.indexOf(o)&&t&&t(o)})),!1;if(e.indexOf("javascript:")>0)return t&&t("javascript:"),!1;if(/^javascript:/i.test(e)){var n=e.slice(11).replace(/\s/g,"").trim();return!!m.some(["void","void(0)","void0","false","undefined",";"],(function(e){return e===n}))||(t&&t("javascript:"),!1)}return!0}var D=function(e,t){var o,a,n=!1;if(n=String(n),"string"!=typeof e)return e;if(o=e,a=Number(-1),"NaN"!==o.toString()&&-1!==a&&o.length>=a)return e;if(F(e,t))return e;try{if(!0===(n=!n.startsWith("<%=")&&JSON.parse(n))||"true"===n){var r=new URL(e);return r.origin+r.pathname}}catch(e){return console.log(e),"#"}return"#"};function U(e,t,a){if(void 0===e&&(e=""),void 0===t&&(t=[]),"string"!=typeof e)return!0;if(!F(e=O(e)))return!1;var n=function(e){var t=e.match(/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/)||[];return{url:t[0],scheme:t[1],slash:t[2],host:t[3],port:t[4],path:t[5],query:t[6],hash:t[7]}}(e),r=n.scheme,i=n.host;return a?Boolean(a(e)):!(!r||!i)&&(!m.includes(["http","https","file"],r)||("object"==typeof window&&window&&(t=o(o([],t,!0),[location.host],!1)),m.some(t,(function(e){return!!(e instanceof RegExp&&e.test(i))||e===i}))))}var M=U,B=U,z=function(e,t){for(var o={},a=0,n=m.keys(e);a<n.length;a++){var r=n[a];Array.isArray(e[r])?o[r]=m.from(e[r]):o[r]=z({},e[r])}for(var i=0,s=m.keys(t);i<s.length;i++)(r=s[i])in e?Array.isArray(e[r])?o[r]=e[r].concat(t[r]):o[r]=z(e[r],t[r]):Array.isArray(t[r])?o[r]=m.from(t[r]):o[r]=z({},t[r]);return o},G={blackList:{a:["folder"],meta:["content"],iframe:["srcdoc"],input:["pattern"],vmlframe:["xmlns"]},blackTags:["script","xml","embed","isindex","object","base","set","handler","animate","payload","import"],blackAttrs:["charset","ns","namespace","formaction","xlink:href","xmlns:xlink","handler","repeat","repeat-start","repeat-end"],blackAttrRegExps:[/^on/],filterList:{param:["value"],video:["poster"],form:["action"]},filterAttrs:["href","src","background","style","dynsrc","lowsrc","content"]};try{var W={};W.blackAttrRegExps&&(W.blackAttrRegExps=W.blackAttrRegExps.map((function(e){return new RegExp(e.toString().slice(1,e.toString().length-1))})));var V="merge";m.includes(V,"override")&&(G=W),m.includes(V,"merge")&&(G=z(G,W))}catch(e){console.log(e)}var H,q={mode:"black",whiteList:{},blackConfig:G,collect:null,initCollect:function(){q.collect={blackList:{},blackTags:[],blackAttrs:[],blackAttrRegExps:[],filterAttrs:[],filterList:{},filterProtocol:[]}},removeCollect:function(){var e=function(e){for(var t=0,o=function(o){Array.isArray(e[o])?0===e[o].length?delete e[o]:(e[o]=m.from(m.uniq(e[o])),t+=e[o].length):0===m.keys(e[o]).length?delete e[o]:m.keys(e[o]).forEach((function(a){e[o][a]=m.from(m.uniq(e[o][a])),t+=e[o][a].length}))},a=0,n=m.keys(e);a<n.length;a++)o(n[a]);return{count:t,ret:e}}(q.collect),t=e.count,o=e.ret;return q.collect=null,{collectKey:0===t?null:JSON.stringify(o),collectMode:"black"}},onIgnoreTag:function(e,t){var o;if(!m.includes(G.blackTags,e)){var a=S(t,(function(e,t,o,a,n){if(-1!==o.indexOf("/"))return h(a);if(n)return"</".concat(o,">");var r=function(e){var t,o=(t=/\s|\n|\t/.exec(e))?t.index:-1;if(-1===o)return{html:"",closing:"/"===e[e.length-2]};var a="/"===(e=e.slice(o+1,-1).trim())[e.length-1];return a&&(e=e.slice(0,-1).trim()),{html:e,closing:a}}(a),i=C(r.html,(function(e,t){var a,n=0;if(G.blackList[o]&&m.includes(G.blackList[o],e)&&(q.collect.blackList[o]=q.collect.blackList[o]||[],q.collect.blackList[o].push(e),n++),G.blackAttrRegExps.length&&G.blackAttrRegExps.some((function(t){return t.test(e)}))&&m.forEach(G.blackAttrRegExps,(function(t){t.test(e)&&(q.collect.blackAttrRegExps.push("".concat(t.toString(),"->").concat(e)),n++)})),G.blackAttrs.length&&m.includes(G.blackAttrs,e)&&(G.blackAttrs.push(e),n++),!n){if(G.filterList&&G.filterList[o]&&m.includes(G.filterList[o],e)){var r=D(t,(function(e){var t;null===(t=q.collect)||void 0===t||t.filterProtocol.push(e)}));return r!==t&&(q.collect.filterList[o]=q.collect.filterList[o]||[],q.collect.filterList[o].push(e)),t?"".concat(e,"='").concat(r,"'"):e}return G.filterAttrs&&m.includes(G.filterAttrs,e)?(r=D(t,(function(e){var t;null===(t=q.collect)||void 0===t||t.filterProtocol.push(e)})),r!==t&&(null===(a=q.collect)||void 0===a||a.filterAttrs.push(e)),t?"".concat(e,"='").concat(r,"'"):e):t?"".concat(e,"='").concat(t,"'"):e}}));return a="<".concat(o),i&&(a+=" ".concat(i)),r.closing&&(a+=" /"),a+">"}),h);return a}null===(o=q.collect)||void 0===o||o.blackTags.push(e)}},Y=function(e){var t=e.reportOnly,o=void 0===t||t,a=e.block;return o&&"all"===o?"report":("string"==typeof o&&("true"===o&&(o=!0),"false"===o&&(o=!1)),a?"enforce":o?"report":"enforce")},K=function(e){return function(o,a,n){if(!o||"string"!=typeof o)return o;var r=a;e===L&&(r=q).initCollect();var i=e(o,r);if(E(i)===E(o))return o;if(!n)return i;var s=n.logType,l=Y(n),c=r.removeCollect();return R.report(t(t({type:s,disposition:l},c),{sourceText:x(o.replace(/'/g,'"')),filterText:x(i.replace(/'/g,'"'))})),"enforce"===l?i:o}},J=K((function(e,t){return void 0===t&&(t={}),t&&t.whiteList||(t.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}),new T(t).process(e)})),$=K(L),Q=(H=D,function(e,t,o){var a=[],n=H(e,(function(e){a.push(e)}));if(n===e)return e;a=m.from(m.uniq(a));var r=t||o||{};if(!r)return n;var i=r.logType,s=Y(o);return R.report({type:i,disposition:s,collectKey:a.join("___"),collectData:JSON.stringify(a),collectMode:"black",sourceText:x(e),filterText:x(n)}),"enforce"===s?n:e}),Z=j._xssProject||{},X=j.xssNamespace||{},ee="3.0.30",te={FilterXSS:T,version:ee,webpackPluginVersion:"3.0.39",reportOnly:"all",filterXSS:J,_filterXSS:$,filterUrl:Q,BlackConfig:q,project:Z,setProjectName:function(e){Z[e]=this,j._xssProjectName=e}};X.cc_web_editor_smart_toolbox=te,j.xssNamespace=X,j.Math&&!j.Math.xssNamespace&&(j.Math.xssNamespace=X),Z[ee]=te,j.globalThis=j,j.getFilterXss=function(){return void 0!==this._xssProjectName?this._xssProject[this._xssProjectName]:te},j.xss=te,j.isSafeUrl=M,j.isSafeDomain=B,j.isSafeProtocol=F,j._xssProject=Z,j._xssProjectName&&(Z[j._xssProjectName]=te);var oe=te.setProjectName.bind(te);e.BlackConfig=q,e.FilterXSS=T,e._filterXSS=$,e.filterUrl=Q,e.filterXSS=J,e.isSafeDomain=B,e.isSafeProtocol=F,e.isSafeUrl=M,e.project=Z,e.setProjectName=oe,e.setXssNamespace=function(e){var t=e.appId,o=e.bid,a=e.region,n=e.isCloseReport;X[t]=te;var r=q;r.bid=o,r.region=a,r.enabled=!0,r.isCloseReport=n},e.xssNamespace=X,Object.defineProperty(e,"__esModule",{value:!0})})),(window.webpackChunksmart_toolbox=window.webpackChunksmart_toolbox||[]).push([[4271],{4271:function(e,t,o){o.d(t,{L:function(){return Uv},O:function(){return mr},R:function(){return Wa},c:function(){return Ji},d:function(){return ji},e:function(){return $n},f:function(){return In},g:function(){return Tn},h:function(){return Sr},p:function(){return co},t:function(){return go}});o(69212),o(13398);var a=o(77024),n=o(38e3),r=o(57691),i=o(67308),s=o(30395),l=o.n(s),c=o(14148),d=o(62281),u=o(45505),p=(o(45475),o(62289)),_=o(89934),h=o(77746),m=o(7631),g=o(88617),v=o(87237),f=o(4385),y=(o(78436),o(56741)),w=(o(63724),o(48613)),b=o(24110),x=(o(98634),o(85333),o(36096)),k=o(87176),A=o(80218),S=o(72579),C=o.n(S),I=o(66696),E=o(58519),T=o(67343),P=o(73044),N=(o(47881),o(68742)),j=o(2799),R=o.n(j),L=(o(71511),o(75139),o(89874),o(26789)),O=o(45476),F=o(62214),D=(o(91485),o(3501)),U=o(84698),M=o(37814),B=o(56464),z=(o(81324),o(11444)),G=(o(70382),o(89097)),W=(o(78790),o(10782)),V=(o(69628),o(60591)),H=o(5244),q=o.n(H),Y=o(91093),K=o(23974),J=(o(43666),o(8503),o(83105)),$=o(69874),Q=o(85371),Z=o(91776),X=o(66279),ee=o(76398),te=(o(57069),o(16081)),oe=(o(3234),o(32235)),ae=o(85886),ne=(o(13819),o(9932),o(14554)),re=(o(33102),o(8608),o(8706)),ie=o(42579),se=o.n(ie),le=o(52131),ce=o(9837),de=o(80305),ue=o(60710),pe=o(9416),_e=o(2754),he=o(53811),me=o(70849),ge=o(18091),ve=o(39642),fe=o(7661),ye=o(4570),we=o(78274),be=o(6055),xe=(o(87025),o(14936),o(6525)),ke=o(27594),Ae=o.n(ke),Se=o(97724),Ce=(o(40930),o(6822),o(93277),o(39811),o(30922)),Ie=o(58367),Ee=o(75291),Te=o(21511),Pe=(o(45607),o(76428),o(92057)),Ne=o(72410),je=o(2830),Re=o(37462),Le=o(39190),Oe=o(58840),Fe=o(99152),De=o(91689),Ue=o(20997),Me=o(42989),Be=o(56932),ze=(o(36371),o(60323),o(86044),o(72992)),Ge=o(77228),We=o(44870),Ve=o(44168),He=o(45487),qe=o(28526),Ye=o(82559),Ke=o(43362),Je=o(47093),$e=o(46448),Qe=o(61988),Ze=o(7677),Xe=o(92336),et=o.n(Xe),tt=o(57947),ot=o.n(tt),at=o(97834),nt=o(5092),rt=o.n(nt),it=o(63303),st=o.n(it),lt=o(85970),ct=o(93641),dt=(o(47583),o(2633)),ut=o(36755),pt=o(50501),_t=(o(65989),o(50601)),ht=o(28532),mt=(o(419),o(73281)),gt=(o(99481),o(61920)),vt=o(46538),ft=(o(52032),o(39649)),yt=(o(42136),o(5089)),wt=Object.defineProperty,bt=(e,t,o)=>(((e,t,o)=>{t in e?wt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o})(e,"symbol"!=typeof t?t+"":t,o),o);const xt={aid:d.P.APP_ID,appkey:"cc_web-web",app_name:"cc_web"},kt="google sem",At="direct";var St=(e=>(e.Light="light",e.Dark="dark",e))(St||{});const Ct={US:"11202206H2pXg2",GB:"11202205Wsj3E1",CA:"11202203Laxp61",AU:"11202203Laxp61",DE:"11202203Laxp61",FR:"11202203Laxp61",IT:"11202203Laxp61",ES:"11202203Laxp61",TR:"11202203Laxp61"},It=(e,t)=>e?"11202207M3BvW9":Ct[t.toUpperCase()]??"11202206H2pXg2",Et="Scheduled",Tt="PublishFail",Pt="ConnectionExpired";var Nt=(e=>(e.DISABLE_COMMENT="disable_comment",e.DISABLE_DUET="disable_duet",e.DISABLE_STITCH="disable_stitch",e))(Nt||{}),jt=(e=>(e.PRIVACY_LEVEL="privacy_level",e))(jt||{}),Rt=(e=>(e.INIT="INIT",e.PENDING="PENDING",e.SUCCESS="SUCCESS",e.FAIL="FAIL",e))(Rt||{}),Lt=(e=>(e.AUTO="auto",e.UNAUTO="unauto",e))(Lt||{}),Ot=(e=>(e.BOE="boe",e.SG="sg",e.VA="va",e))(Ot||{}),Ft=(e=>(e.Month="month",e.Year="year",e))(Ft||{}),Dt=(e=>(e[e.public=1]="public",e[e.space=0]="space",e[e.private=2]="private",e))(Dt||{}),Ut=(e=>(e[e.open=0]="open",e[e.close=1]="close",e[e.delete=2]="delete",e[e.modify=3]="modify",e))(Ut||{}),Mt=(e=>(e[e.NO_SHARE=0]="NO_SHARE",e[e.VALID_SHARE=1]="VALID_SHARE",e[e.BANNED_SHARE=2]="BANNED_SHARE",e))(Mt||{}),Bt=(e=>(e.BatchSendNoticeByEmail="2378",e))(Bt||{}),zt=(e=>(e[e.scheduleID=0]="scheduleID",e[e.assetIDList=1]="assetIDList",e))(zt||{});const Gt=R().create();Gt.interceptors.request.use((e=>(e.headers["x-idc-region"]="va",e)));var Wt=(e=>(e[e.Feedback=1]="Feedback",e[e.AgeFeedback=2]="AgeFeedback",e))(Wt||{});const Vt=async(e,t="")=>{const{content:o,imgList:a,problemList:n,contact:r,currentLanguage:i,appVersion:s,isVip:l,extra_params:c={},type:d=1}=e,u=a.map((e=>({image_width:e.ImageWidth,image_height:e.ImageHeight,image_uri:e.ImageUri}))),p=1===d?"\u3010Export & Share\u3011":"\u3010Export & Share - UserAge\u3011";let _={is_private_image:1,web_id:t};var h;1===d&&(_={..._,problemList:(h=n,h.map(((e,t)=>`${t+1}\u3001${e}`)).join(", "))});const m=new FormData;return m.append("content",`${p}${o}`),m.append("image_list",JSON.stringify(u)),m.append("contact",r??""),m.append("extra_persistent_params",JSON.stringify(_)),m.append("extra_params",JSON.stringify({..._,...c})),m.append("language",i??""),m.append("app_version",s??""),typeof l<"u"&&m.append("is_vip",l?"1":"0"),await(async e=>{const{aid:t,appkey:o,app_name:a}=xt;e.append("aid",t),e.append("app_name",a),e.append("appkey",o),e.append("multi_image","1");const n=await Gt({method:"post",url:`/feedback/2/post_message/?appkey=${o}&app_name=${a}&aid=${t}`,data:e,headers:{"Content-Type":"multipart/form-data"}}),r=n.data;if(0!==r.err_code)throw r;return n})(m)},Ht={baseURL:"/commerce",method:"POST",headers:{appid:d.P.APP_ID,loc:d.P.CHANNEL,lan:c.Ay.language||d.P.LAN,pf:d.P.APP_PF,appvr:d.P.VERSION,tdid:"","sign-ver":1,"app-sdk-version":d.P.APP_SDK_VERSION},useCommerceApi:!0},qt=d.b.createAxios(Ht);qt.interceptors.request.use((e=>{const{pf:t,appvr:o,tdid:a}=Ht.headers;return Object.assign(e.headers,(0,d.c)({url:`${e.baseURL}${e.url}`,pf:t,appvr:o,tdid:a})),e})),qt.interceptors.response.use((e=>{var t,o,a;if(200===e.status){const n=e.data;return"0"===n.ret?null!=(t=null==e?void 0:e.config)&&t.url&&e.config.url.indexOf("user_info")>0?Promise.resolve({data:n.data,signContext:{sign:n.sign,ret:n.ret,response:n.response,"device-time":null==(a=null==(o=null==e?void 0:e.config)?void 0:o.headers)?void 0:a["device-time"],systime:null==n?void 0:n.systime}}):Promise.resolve(n.data):Promise.reject(e)}return Promise.reject(e)})),(0,d.d)(qt,{retries:5,resetTimeout:!0,retryDelay:1e3,isRetry:()=>!0});const Yt={async getSubscriptionUserInfo(e){const t=await qt({url:"/v1/subscription/user_info",data:{aid:d.P.APP_ID,scene:"vip",from_db:e}}),{data:a,signContext:n}=t,r={appid:d.P.APP_ID,appvr:d.P.VERSION,"device-time":null==n?void 0:n["device-time"],pf:d.P.APP_PF,response:null==n?void 0:n.response,ret:n.ret,systime:null==n?void 0:n.systime},{sign:i}=n;if(i){const e=await(async(e,t,a)=>{const n=new(0,(await o.e(4448).then(o.bind(o,54448))).default);return n.setPublicKey(a),n.verify(e,t,Ae().SHA256)})((e=>{const t=[];return Object.entries(e).forEach((e=>{(0,Q.A)(e[1])||t.push(`${e[0]}=${e[1]}`)})),t.join("&")})(r),i,"-----BEGIN PUBLIC KEY-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC1I/Ml9Qkp6reos86Tjbd1R6q+\nbQwviSEmZzqtrhfGI+iMGKA74XSctUu8ZnWhOKsG5+PujMrIJX2WMRP0E5lhJpCh\nfgK3aiNikvgigORzf0Lz39XS46eAHJrPbMaQiabDfd/+CjkvxbV+LW3oPdoZj9Mn\n38OEHt9qVkUlvpv76wIDAQAB\n-----END PUBLIC KEY-----");if(n.sign&&e)return a;throw Error("Error: Auth sign")}throw Error("Error: Auth sign")},async getSpaceList(e){const t="/v1/subscription/workspace/space_list",o=(0,d.c)({url:t,...Ht.headers}),a=await qt({url:t,headers:{...o},data:{aid:Number(d.P.APP_ID),workspace_id:e}});return{spaceList:a.space_list,isFirstSubscribe:a.is_first_subscribe,isAutoSubscribe:a.is_auto_subscribe,isWebAutoSubscribe:a.is_web_auto_subscribe,isCancelSubscribe:a.is_cancel_subscribe,jointActivitySpaceList:a.joint_activity_space_list}},async getPriceList(e){const t="/v1/subscription/cc_web_price_list",o=(0,d.c)({url:t,...Ht.headers}),a={aid:Number(d.P.APP_ID),scene:"workspace",region:e},[n,r]=await(0,d.p)((()=>Promise.all([qt({url:t,headers:{...o},data:a}),qt({url:t,headers:{...o},data:{...a,scene:"web"}})])),{cacheKey:`promiseCache_getPriceList_${JSON.stringify(a)}`}),i=n.all_price_list.reduce(((e,t)=>(e[t.product_id]=t,e)),{}),s=n.tab_list.map((e=>({as_default:e.as_default,products:e.product_ids.map((e=>i[e]))})));return{allPriceList:[...n.all_price_list,...r.all_price_list],groupProductList:s,ccWebDisplayInfo:n.cc_web_display_info}},async getSubscriptionList(e){return await qt({url:"/v1/subscription/order_record_list",data:{aid:Number(d.P.APP_ID),workspace_id:e,cursor:0,count:1}})},async getVipPriceList(e,t="en"){const o={aid:d.P.APP_ID,scene:"vip",region:e,language:t},a=await(0,d.p)((()=>qt({url:"/v1/subscription/cc_price_list",data:o})),{cacheKey:`promiseCache_getSubscriptionPriceList_${JSON.stringify(o)}`}),n={month:[],year:[]};return a.all_price_list.forEach((e=>{const{cycle_unit:t,subscribe_cycle:o}=e;"MONTH"===t&&12!==o?n.month.push(e):n.year.push(e)})),{allVipPriceList:a.all_price_list,vipGroupProductList:n,ccWebDisplayInfo:a.cc_web_display_info}},async getSubscribeInfo(e="en"){return await qt({url:"/v1/subscription/get_subscribe_info",data:{language:e}})}};class Kt extends Error{constructor(e){super("Page is in background, request cancelled"),bt(this,"url"),this.name="RequestCancelledError",this.url=e}}const Jt=(e,t)=>{e.interceptors.request.use((e=>{const{enableURL:o}=t,a=typeof document<"u"&&document.hidden,n=!!e.url&&((e,t)=>t.some((t=>"string"==typeof t?e===t:t.test(e))))(e.url,o);if(a&&n){console.warn("Page is in background, request cancelled:",e.url);const t=new Kt(e.url);return Promise.reject(t)}return e}))},$t=d.b.createAxios();$t.interceptors.request.use((e=>({...e,baseURL:`https://${location.hostname}/`}))),$t.interceptors.response.use((e=>{if(200===e.status){const t=e.data;return Promise.resolve(t)}return Promise.reject(e)}));var Qt=(e=>(e.video="video",e.image="image",e.temp="temp",e))(Qt||{});const Zt={baseURL:"/lv/v1",method:"POST",headers:{loc:d.P.CHANNEL,lan:c.Ay.language||d.P.LAN,pf:d.P.APP_PF,appvr:d.P.VERSION,tdid:"","sign-ver":1,"app-sdk-version":d.P.APP_SDK_VERSION},params:{}},Xt=d.b.createAxios(Zt);let eo;Xt.interceptors.response.use((e=>{if(200===e.status){const t=e.data;return"0"===t.ret?Promise.resolve(t.data):Promise.reject(e)}return Promise.reject(e)})),(0,d.d)(Xt,{retries:5,resetTimeout:!0,retryDelay:1e3,isRetry:e=>{var t;return"200206"!==(null==(t=null==e?void 0:e.data)?void 0:t.ret)}});const to=()=>eo?{[d.N]:{domain:eo}}:{},oo={fixRequestDomain(){eo=d.b.getWebDomain()},async getUploadToken(e="video"){const t="/upload_sign";return await Xt({url:t,headers:{...(0,d.c)({url:`${Zt.baseURL}${t}`,...Zt.headers})},data:{key_version:"v5",biz:{video:"web_video",image:"replicate",temp:"temp_file"}[e]},...to()})},async createVideoData(e){const t="/upload/create_upload_task";return(await Xt({url:t,headers:{...(0,d.c)({url:`${Zt.baseURL}${t}`,...Zt.headers})},data:e,...to()})).task_id},async getVideoTaskInfo(e){const t="/upload/get_upload_task";return await Xt({url:t,[d.e]:{canRetry:!1},headers:{...(0,d.c)({url:`${Zt.baseURL}${t}`,...Zt.headers})},data:e,...to()})}},ao={baseURL:"/lv/v1",method:"POST",headers:{loc:d.P.CHANNEL,lan:c.Ay.language||d.P.LAN,pf:d.P.APP_PF,appvr:d.P.VERSION,tdid:"","sign-ver":1,"app-sdk-version":d.P.APP_SDK_VERSION}},no=d.b.createAxios(ao);no.interceptors.request.use((e=>{const{pf:t,appvr:o,tdid:a}=ao.headers;return Object.assign(e.headers,(0,d.c)({url:`${e.baseURL}${e.url}`,pf:t,appvr:o,tdid:a})),e})),no.interceptors.response.use((e=>{if(200===e.status){const t=e.data;return"0"===t.ret?Promise.resolve(t.data):Promise.reject(e)}return Promise.reject(e)}));const ro=R().create({method:"GET"});ro.interceptors.response.use((e=>200===e.status?Promise.resolve(e.data):Promise.reject(e)));const io={async getShareReportReason(){await d.b._locker.awaitForInit();let e="https://sf16-muse-va.ibytedtos.com/obj/ies-fe-bee-maliva/bee_prod/biz_80/bee_prod_80_bee_publish_4017.json";return d.b.getWebDomain().indexOf("sg")&&(e="https://sf-hs-sg.ibytedtos.com/obj/ies-fe-bee-alisg/bee_prod/biz_80/bee_prod_80_bee_publish_4017.json"),console.error("await jsonFileService.get(url)",await ro.get(e)),await ro.get(e)},async getCommentReportReason(){return await ro.get("")},async getAIGCReportReason(){try{const e=await ro.get("https://sf16-muse-va.ibytedtos.com/obj/ies-fe-bee-maliva/bee_prod/biz_49/bee_prod_49_bee_publish_644.json");if(!e.reasons)throw new Error("");return e}catch{return{reasons:[{text:"s2v_report_type_violent",cate:"violent",cid:401,tips:"",index:0,sort:0,reportParam:"violent_extremism"},{text:"s2v_report_type_illegal",cate:"illegal",cid:402,tips:"",index:1,sort:1,reportParam:"illegal_activities_and_regulated_goods"},{text:"s2v_report_type_graphic_content",cate:"graphic_content",cid:403,tips:"",index:2,sort:2,reportParam:"violent_and_graphic_content"},{text:"s2v_report_type_dangerous",cate:"dangerous",cid:404,tips:"",index:3,sort:3,reportParam:"suicide_self-harm_and_dangerous_acts"},{text:"s2v_report_type_hateful",cate:"hateful",cid:405,tips:"",index:4,sort:4,reportParam:"hateful_behavior"},{text:"s2v_report_type_harassment",cate:"harassment",cid:406,tips:"",index:5,sort:5,reportParam:"harassment_and_bullying"},{text:"s2v_report_type_adult",cate:"adult",cid:407,tips:"",index:6,sort:6,reportParam:"adult_nudity_and_sexual_activity"},{text:"s2v_report_type_minor",cate:"minor",cid:408,tips:"",index:7,sort:7,reportParam:"minor_safety"},{text:"s2v_report_type_integrity",cate:"integrity",cid:409,tips:"",index:8,sort:8,reportParam:"integrity_and_authenticity"},{text:"s2v_report_type_infringement",cate:"infringement",cid:410,tips:"",index:9,sort:9,reportParam:"intellectual_property_infringement"},{text:"s2v_report_type_other",cate:"other",cid:411,tips:"",index:10,sort:10,reportParam:"other"}]}}},async report(e){return await no.post("/report/report",e)},async eventReport(e){return await no.post("/event/report",e)},async aigcReport(e){return await no.post("/report/report",e)}},so={baseURL:"/lv/v1/common_task",method:"POST",headers:{loc:d.P.CHANNEL,lan:c.Ay.language||d.P.LAN,pf:d.P.APP_PF,appvr:d.P.VERSION,tdid:"","sign-ver":1,"app-sdk-version":d.P.APP_SDK_VERSION}},lo=d.b.createAxios(so);Jt(lo,{enableURL:[/\/list/]}),lo.interceptors.request.use((e=>{const{pf:t,appvr:o,tdid:a}=so.headers;return Object.assign(e.headers,(0,d.c)({url:`${e.baseURL}${e.url}`,pf:t,appvr:o,tdid:a})),e})),lo.interceptors.response.use((e=>{if(200===e.status){const t=e.data;return"0"===t.ret?Promise.resolve(t):Promise.reject(e)}return Promise.reject(e)}));const co={async getTaskCount(e){return await lo({url:"/count",data:e})},async getTaskList(e){return await lo({url:"/list",data:e})},async createTask(e){return await lo({url:"/create",data:e})},async batchGetTask(e){return await lo({url:"/batch_get",data:e})},async deleteRenderTask(e){return await lo({url:"/delete",data:e})}},uo={baseURL:"/lv/v1/task",method:"POST",headers:{loc:d.P.CHANNEL,lan:d.P.LAN,pf:d.P.APP_PF,appvr:d.P.VERSION,tdid:"","sign-ver":1,"app-sdk-version":d.P.APP_SDK_VERSION}},po=d.b.createAxios(uo);Jt(po,{enableURL:[/\/get_task_status/]}),po.interceptors.request.use((e=>{const{pf:t,appvr:o,tdid:a}=uo.headers;return Object.assign(e.headers,(0,d.c)({url:`${e.baseURL}${e.url}`,pf:t,appvr:o,tdid:a})),e})),po.interceptors.response.use((e=>{if(200===e.status){const t=e.data;return"0"===t.ret?Promise.resolve(t):Promise.reject(e)}return Promise.reject(e)}));const _o={async getTaskCenterStatus(){return await po({url:"/get_task_status"})},async getInviteInfo(e){return await po({url:"/get_invite_detail",data:e})},async getInviteLink(){return await po({url:"/get_invite_link"})},async getRewardTasks(){return await po({url:"/get_reward_tasks"})},async receiveTasks(e){return await po({url:"/receive_tasks",data:e})}},ho={baseURL:"/cc/v1/workspace",method:"POST",headers:{loc:d.P.CHANNEL,lan:c.Ay.language||d.P.LAN,pf:d.P.APP_PF,appvr:d.P.VERSION,tdid:"","sign-ver":1,"app-sdk-version":d.P.APP_SDK_VERSION}},mo=d.b.createAxios(ho);mo.interceptors.request.use((e=>{const{pf:t,appvr:o,tdid:a}=ho.headers;return Object.assign(e.headers,(0,d.c)({url:`${e.baseURL}${e.url}`,pf:t,appvr:o,tdid:a})),e})),(0,h.N)(mo),mo.interceptors.response.use((e=>{if(200===e.status){const t=e.data;return"0"===t.ret?Promise.resolve(t):Promise.reject(e)}return Promise.reject(e)}));const go={async getUserWorkSpace(e){return await mo({url:"/get_user_workspaces",data:e})},async createWorkspace(e){return await mo({url:"/create_workspace",data:e})},async checkCreateWorkspace(){return await mo({url:"check_create_workspace"})},async getWorkspaceMember(e){return await mo({url:"/get_member",data:e})},async getAllWorkspaceMember(e){var t,o,a,n,r;let i,s=[];do{i=await mo({url:"/get_member",data:{count:50,cursor:(null==(t=null==i?void 0:i.data)?void 0:t.next_cursor)||"0",workspace_id:e.workspace_id}}),null!=(a=null==(o=null==i?void 0:i.data)?void 0:o.member_list)&&a.length&&(s=(0,K.A)(s.concat(i.data.member_list),"uid"))}while(null!=(n=null==i?void 0:i.data)&&n.has_more);return{...i,data:{member_list:s,member_cnt:(null==(r=null==i?void 0:i.data)?void 0:r.member_cnt)||0}}},async mGetWorkspaceUserInfo(e){return await mo({url:"/mget_workspace_user_info",data:e})},async quitWorkspace(e){return await mo({url:"/quit_user",data:e})},async mGetWorkspaceInfo(e){return await mo({url:"/mget_workspace_info",data:e})},async getWorkspaceInfoEverPhotoToken(e){return await mo({url:"/get_ever_photo_token",data:e})},async getInvitationLink(e){return await mo({url:"/get_invitation_link",data:e})},async setWorkspaceUser(e){return await mo({url:"/set_user",data:e})},async removeWorkspaceUser(e){return await mo({url:"/remove_user",data:e})},async updateUserInfo(e){return await mo({url:"/update_user_info",data:e})},async updateWorkspaceInfo(e){return await mo({url:"/update_workspace_info",data:e})},async joinWorkspace(e){return await mo({url:"/join_workspace",data:e})},async getWorkspaceInfoByInvitationLink(e){return await mo({url:"/get_workspace_info_by_invitation_link",data:e})},async mGetWorkspaceEverphotoUserInfo(e){return await mo({url:"/mget_workspace_ever_photo_user_info",data:e})},async recentWorkspaceFileOpen(e,t){return await mo({url:"/recent_file_list",data:e,params:{needCache:(null==t?void 0:t.needCache)??!0}})},async syncWorkspaceInfoFileOpen(e){return await mo({url:"/sync_file_open_time",data:e})},async refreshUserWorkspaceInvitationLink(e){return await mo({url:"/refresh_invitation_link",data:e})},async updateUserWorkspaceInvitationLinkStatus(e){return await mo({url:"/update_invitation_link_status",data:e})},async workspaceDirectionalInvited(e){return await mo({url:"/email_directional_invited_v2",data:e})},async getWorkspaceFileEditOwner(e){return await mo({url:"/get_file_edit_owner",data:e})},async updateWorkspaceFileEditOwner(e){return await mo({url:"/update_file_edit_owner",data:e})},async mgetWorkspaceFileOpenTime(e){return await mo({url:"/mget_file_open_time",data:{...e,workspace_id:e.workspace_id||"0"}})},async getWorkspaceUploadLinkInfo(e){return await mo({url:"/get_upload_link_info",data:e})},async syncWorkspaceFile(e){return await mo({url:"/sync_file_everphoto",data:e})},async syncFileEverphotoState(e){return await mo({url:"/sync_file_everphoto_state",data:e})},async workspaceSensitiveWord(e){return await mo({url:"/sensitive_word",data:e})},async updateUserWorkspaceUploadLink(e){return await mo({url:"/update_workspace_upload_link",data:e})},async getUserWorkspaceUploadLink(e){return await mo({url:"/get_workspace_upload_link",data:e})},async getAllEverPhotoUser(){return await mo({url:"get_all_everphoto_user"})},async notifyUploadLink(e){return await mo({url:"upload_link_notify",data:e})},async getOnboardSample(e){return await mo({url:"/list_onboard_sample",data:e})},async createOnboardDraft(e){return await mo({url:"/create_onboard_draft",data:e})},async checkWorkspaceMember(e){const{data:t}=await mo({url:"/member/check",data:{workspace_id:e}});return{isInWorkspace:t.is_in_workspace}},async joinSpace(e){var t,o,a,n,r,i;const s={join_workspace_type:e.joinWorkspaceType,invite_link_param:{invitation_link:null==(t=e.inviteLinkParam)?void 0:t.invitationLink,invite_from:null==(o=e.inviteLinkParam)?void 0:o.inviteFrom},application_param:{workspace_id:null==(a=e.applicationParam)?void 0:a.workspaceId,source_type:null==(n=e.applicationParam)?void 0:n.sourceType,reason:null==(r=e.applicationParam)?void 0:r.reason,file_id:null==(i=e.applicationParam)?void 0:i.fileId}},{data:l}=await mo({url:"/join_workspace_with_apply",data:s});return{status:l.status,applicationId:l.application_id,workspaceInfo:l.workspace_info}},async dealApplication(e){return await mo({url:"/applications/update",data:{id:e.id,status:e.status,workspace_id:e.workspaceId}})},async getApplicationList(e){var t;const{data:o}=await mo({url:"/applications/list",data:{application_ids:e.applicationIds,need_detail:e.needDetail}});return{applications:null==(t=o.applications)?void 0:t.map((({has_approve_permission:e,application:t})=>({hasApprovePermission:e,application:{id:null==t?void 0:t.id,userId:null==t?void 0:t.user_id,workspaceId:null==t?void 0:t.workspace_id,status:null==t?void 0:t.status,reason:null==t?void 0:t.reason,userName:null==t?void 0:t.user_name,approverId:null==t?void 0:t.approver_id,approverName:null==t?void 0:t.approver_name,roleType:null==t?void 0:t.role_type,workspaceName:null==t?void 0:t.workspace_name,createdAt:null==t?void 0:t.created_at,timeoutAt:null==t?void 0:t.timeout_at}})))}},async getInvitationActivityStatus(e){return await mo({url:"/get_invitation_activity_status",data:{workspace_id:e}})},async joinInvitationActivity(e){return await mo({url:"/join_invitation_activity",data:{id:e}})}},vo={baseURL:"/pipo",method:"POST",headers:{loc:d.P.CHANNEL,lan:c.Ay.language||d.P.LAN,pf:d.P.APP_PF,appvr:d.P.VERSION,tdid:"","sign-ver":1,"app-sdk-version":d.P.APP_SDK_VERSION},useCommerceApi:!0},fo=d.b.createAxios(vo);function yo(e){return[Y.S.US,Y.S.BR].find((t=>t===e))?Ot.VA:Ot.SG}fo.interceptors.request.use((e=>{const{pf:t,appvr:o,tdid:a}=vo.headers;return Object.assign(e.headers,(0,d.c)({url:`${e.baseURL}${e.url}`,pf:t,appvr:o,tdid:a})),e})),fo.interceptors.response.use((e=>{if(200===e.status){const t=e.data;return"0"===t.ret?Promise.resolve(t):Promise.reject(e)}return Promise.reject(e)})),(0,d.d)(fo,{retries:5,resetTimeout:!0,retryDelay:1e3,isRetry:e=>{var t;return![d.E.PIPO.REFRESH_USER_SPACE_FAILURE].includes(null==(t=null==e?void 0:e.data)?void 0:t.ret)}});const wo={getNonceSingleton:(()=>{let e="",t=Number(new Date);return async()=>{const o=Number(new Date);return(!e||o>=t)&&(e=(await wo.getPipoNonce()).data.nonce,t=o+24e4),e}})(),getPipoApiServiceSingleton:(()=>{let e;return(t,o)=>(e||(e=new be.Ay({idc:t?Ot.BOE:yo(o),merchantId:It(t,o),hasRequestTime:!0})),e)})(),async getPipoUserRegion(){return await fo({url:"/v2/subscription/third_party/get_region",data:{aid:d.P.APP_ID}})},async getPipoNonce(){return await fo({url:"/v2/purchase/third_party/nonce",data:{aid:d.P.APP_ID}})},async initPipoPayment(e){return await fo({url:"/v2/purchase/third_party/init_payment",data:{aid:d.P.APP_ID,product_id:e.product_id,order_type:e.order_type,user_create_time:e.user_create_time,workspace_id:e.workspace_id,free_trial:e.free_trial}})},async freeTrialMakeOrder(e){return await fo({url:"/v2/subscription/third_party/free_trial_make_order",data:{aid:d.P.APP_ID,product_id:e.product_id,region:e.region,user_create_time:e.user_create_time,payment_method:e.payment_method}})},async cancelSubscripiton(e){return await fo({url:"/v2/subscription/third_party/cancel",data:{aid:d.P.APP_ID,subscribe_id:e.subscribe_id}})},async getCapcutOrderStatus(e){return await fo({url:"/v2/subscription/third_party/get_order_status",data:{aid:d.P.APP_ID,order_id:e.orderId,subscribe_type:e.subscribeType}})},async getStoreMethodStauts(e){return await fo({url:"/v2/subscription/third_party/get_store_method_status",data:{aid:d.P.APP_ID,idempotency_key:e.idempotencyKey}})},async getCashierBasicInfo(e){const t=wo.getPipoApiServiceSingleton(e.serviceProps.isBOE,e.serviceProps.region),o=await wo.getNonceSingleton();return await t.api.pipo.payment.getCashierBasicInfo({...e.basicInfoProps,nonce:o})},async getAgreementBasicInfo(e){const t=wo.getPipoApiServiceSingleton(e.serviceProps.isBOE,e.serviceProps.region),o=await wo.getNonceSingleton();return await t.api.pipo.payment.getAgreementBasicInfo({...e.basicInfoProps,nonce:o})},async postPipoPay(e){const t=wo.getPipoApiServiceSingleton(e.serviceProps.isBOE,e.serviceProps.region),o=await wo.getNonceSingleton();return await t.api.pipo.payment.pay({...e.payInfoProps,nonce:o})},async getPaymentDetails(e){const t=wo.getPipoApiServiceSingleton(e.serviceProps.isBOE,e.serviceProps.region),o=await wo.getNonceSingleton();return await t.api.pipo.payment.getPaymentDetails({...e.basicInfoProps,nonce:o})},async storingPaymentMethod(e){const t=wo.getPipoApiServiceSingleton(e.serviceProps.isBOE,e.serviceProps.region),o=await wo.getNonceSingleton();return await t.api.pipo.payment.storePaymentMethod({...e.basicInfoProps,nonce:o})},async getDistrict(e){return await wo.getPipoApiServiceSingleton(e.serviceProps.isBOE,e.serviceProps.region).api.location.get_district({...e.basicInfoProps})},async getPipoAddressAutoComplete(e){return(await wo.getPipoApiServiceSingleton(e.serviceProps.isBOE,e.serviceProps.region).api.addressAutocomplete.get_auto_complete({...e.basicInfoProps})).infos},async getPipoPlaceDetail(e){return(await wo.getPipoApiServiceSingleton(e.serviceProps.isBOE,e.serviceProps.region).api.addressAutocomplete.get_place_detail({...e.basicInfoProps})).addr_info},async getUnifiedBinDetail(e){const t=wo.getPipoApiServiceSingleton(e.serviceProps.isBOE,e.serviceProps.region),o=await wo.getNonceSingleton(),{card_number:a,country_or_region:n,merchant_user_id:r}=e.basicInfoProps;return await t.api.pipo.payment.getUnifiedBinDetail({card_number:a,country_or_region:n,merchant_user_id:r,nonce:o})}},bo={baseURL:"/lv/v1",method:"POST",headers:{loc:d.P.CHANNEL,lan:c.Ay.language||d.P.LAN,pf:d.P.APP_PF,appvr:d.P.VERSION,tdid:"","sign-ver":1,"app-sdk-version":d.P.APP_SDK_VERSION},params:{}},xo=d.b.createAxios(bo);xo.interceptors.request.use((e=>{const{pf:t,appvr:o,tdid:a}=bo.headers;return Object.assign(e.headers,(0,d.c)({url:`${e.baseURL}${e.url}`,pf:t,appvr:o,tdid:a})),e})),xo.interceptors.response.use((e=>{if(200===e.status){const t=e.data;return"0"===t.ret?Promise.resolve(t.data):Promise.reject(e)}return Promise.reject(e)})),(0,d.d)(xo,{retries:5,resetTimeout:!0,retryDelay:1e3,isRetry:()=>!0});const ko={async getCareerQuestionnaire(){return xo({url:"/persona/get_questionnaire",method:"POST"})},async submitCareerQuestionnaire(e){return xo({url:"/persona/submit_questionnaire",method:"POST",data:e})}},Ao={baseURL:"",method:"POST",headers:{loc:d.P.CHANNEL,lan:c.Ay.language||d.P.LAN,pf:d.P.APP_PF,appvr:d.P.VERSION,tdid:"","sign-ver":1,"app-sdk-version":d.P.APP_SDK_VERSION},params:{}},So=d.b.createAxios(Ao);So.interceptors.request.use((e=>{const{pf:t,appvr:o,tdid:a}=Ao.headers;return Object.assign(e.headers,(0,d.c)({url:`${e.baseURL}${e.url}`,pf:t,appvr:o,tdid:a})),e})),So.interceptors.response.use((e=>{if(200===e.status){const t=e.data;return"0"===t.ret?Promise.resolve(t.data):Promise.reject(e)}return Promise.reject(e)})),(0,d.d)(So,{retries:2,resetTimeout:!0,retryDelay:1e3,isRetry:()=>!0});const Co={async imageHighlightAnalyse(e){return await So({url:"/lv/v1/intelligence/image_highlight_analyse",data:e,[d.e]:{retries:0}})},async promoteAsset(e){return await So({url:"/lv/v1/ever_photo/promote_asset",data:e,[d.e]:{retries:0}})},async createAiTask(e){return await So({url:"/lv/v1/intelligence/create",data:e,[d.e]:{retries:0}})},async getDraftCover(e){return await So({url:"/lv/v1/editor/pack_resource",data:{workspace_id:e.workspaceId,materials:e.materials,referenced_assets:e.referencedAssets.map((e=>({md5:e.md5,source_path:e.sourcePath}))),sdk_version:"13.6.0",lang:c.Ay.language,region:"us"},[d.e]:{retries:0}})}};function Io(e){return(0,Fe.A)(e,((e,t,o,a)=>{e[(0,De.A)(a)?o:(0,Me.A)(o)]=(0,Ue.A)(t)?Io(t):t}))}function Eo(e){return(0,Fe.A)(e,((e,t,o,a)=>{e[(0,De.A)(a)?o:(0,Be.A)(o)]=(0,Ue.A)(t)?Eo(t):t}))}function To(e){return new Map([[u.q.TikTok,u.i.Tiktok],[u.q.YouTube,u.i.Youtube],[u.q.YouTubeShorts,u.i.YoutubeShort],[u.q.Instagram,u.i.Ins],[u.q.InstagramReels,u.i.Ins],[u.q.FacebookPage,u.i.FacebookPage],[u.q.FacebookGroup,u.i.FacebookGroup],[u.q.TTAM,u.i.Ttam]]).get(e)}function Po(e){return new Map([[u.i.Tiktok,u.q.TikTok],[u.i.Youtube,u.q.YouTube],[u.i.YoutubeShort,u.q.YouTubeShorts],[u.i.Ins,u.q.InstagramReels],[u.i.FacebookPage,u.q.FacebookPage],[u.i.FacebookGroup,u.q.FacebookGroup],[u.i.Ttam,u.q.TTAM]]).get(e)}const No={baseURL:"/lv/v1/schedule_post_task",method:"POST",headers:{loc:d.P.CHANNEL,lan:c.Ay.language||d.P.LAN,pf:d.P.APP_PF,appvr:d.P.VERSION,tdid:"","sign-ver":1,"app-sdk-version":d.P.APP_SDK_VERSION},params:{}},jo=d.b.createAxios(No);jo.interceptors.request.use((e=>{const{pf:t,appvr:o,tdid:a}=No.headers;return Object.assign(e.headers,(0,d.c)({url:`${e.baseURL}${e.url}`,pf:t,appvr:o,tdid:a})),e})),jo.interceptors.response.use((e=>{const t=(0,p.l)(e);if(200===t.status){const e=t.data;return"0"===e.ret?Promise.resolve(e.data):Promise.reject(t)}return Promise.reject(t)}),(e=>{const t=(0,p.l)(e.response);return Promise.reject(t)})),(0,d.d)(jo,{retries:0,resetTimeout:!0,retryDelay:500,isRetry:()=>!0});var Ro=(e=>(e[e.Scheduled=1]="Scheduled",e[e.Published=2]="Published",e[e.PublishFail=3]="PublishFail",e[e.ConnectionExpired=4]="ConnectionExpired",e))(Ro||{});const Lo={async getScheduleTask(e){var t;const o=Object.assign({},(0,ee.A)(e,["betweenTimestamp","assetIdList"]),{statusList:e.statusList.map((e=>Ro[e])),platformList:null==(t=e.platformList)?void 0:t.map((e=>To(e)))});return Io((await jo({url:"/get",data:Eo(o)})).schedule_post_task_list.map((e=>({...e,status:Ro[e.status],shareChannel:Po(e.platform),userName:e.third_party_platform_user_name}))))},create(e){return jo({url:"/create",data:Eo(e)})},update(e){return jo({url:"/update",data:Eo(e)})},cancel(e){return jo({url:"/cancel",data:e})}},Oo={baseURL:"/lv/v1",method:"POST",headers:{loc:d.P.CHANNEL,lan:c.Ay.language||d.P.LAN,pf:d.P.APP_PF,appvr:d.P.VERSION,tdid:"","sign-ver":1,"app-sdk-version":d.P.APP_SDK_VERSION},params:{}},Fo=d.b.createAxios(Oo);Fo.interceptors.request.use((e=>{const{pf:t,appvr:o,tdid:a}=Oo.headers;return Object.assign(e.headers,(0,d.c)({url:`${e.baseURL}${e.url}`,pf:t,appvr:o,tdid:a})),e})),Fo.interceptors.response.use((e=>{if(200===e.status){const t=e.data;return"0"===t.ret?Promise.resolve(t.data):Promise.reject(e)}return Promise.reject(e)})),(0,d.d)(Fo,{retries:5,resetTimeout:!0,retryDelay:1e3,isRetry:()=>!0});const Do={async getAbParam(){var e;try{const t=await(0,d.p)((()=>Fo({url:"/effect/get_ab_param",method:"POST"})),{cacheKey:"promiseCache_getSubscriptionAB_get_ab_param"}),o=JSON.parse(t.parameters);return!(null==(e=null==o?void 0:o.cc_web_fe_ab)||!e.enable_vip_feature)}catch{return!1}}},Uo="capcut_locale";const Mo=e=>e.toLocaleLowerCase()==="es-LA".toLocaleLowerCase()?"es-ES":e;function Bo(){const e=[{s:"windows",r:/Windows/},{s:"android",r:/Android/},{s:"CrOS",r:/CrOS/},{s:"linux",r:/(Linux|X11)/},{s:"ios",r:/(iPhone|iPad|iPod)/},{s:"macOrIpad",r:/Mac OS X/},{s:"mac",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/}];let t="unknown";for(let o=0;o<e.length;o++){const a=e[o];if(a.r.test(window.navigator.userAgent)){t=a.s,"macOrIpad"===a.s&&(t="MacIntel"===window.navigator.platform&&"number"==typeof window.navigator.maxTouchPoints&&window.navigator.maxTouchPoints>1?"ios":"mac");break}}return t}function zo(){var e;try{const t=window.navigator.userAgent;return(null==(e=[{match:"Chrome",value:"Chrome"},{match:"Firefox",value:"Firefox"},{match:"Safari",value:"Safari"},{match:["MSIE","Trident"],value:"Microsoft Internet Explorer"},{match:"Lark",value:"Lark"},{match:"TTWebView",value:"TTWebView"},{match:"Edge",value:"Microsoft Edge"}].find((e=>("string"==typeof e.match&&(e.match=[e.match]),e.match.some((e=>t.includes(e)))))))?void 0:e.value)||""}catch{return""}}function Go(){try{let e="";return window.LV_WEB_VERSION?e=window.LV_WEB_VERSION:window.gfdatav1&&(e=window.gfdatav1.ver),e=e.split(".").filter(((e,t)=>1!==t)).join("."),e}catch{return""}}function Wo(){try{return window._currentBranch||""}catch{return""}}function Vo(e,t){const o="userTracking",{ccWebSlardar:a}=window;a&&("info"===t?a("sendLog",{content:e,extra:{type:o}}):a("captureException",e instanceof Error?e:{content:e},{script:o}))}function Ho(e,t){try{sessionStorage.setItem(e,t)}catch(o){Vo(o,"error")}}function qo(e){try{return decodeURIComponent(e)}catch{return e}}function Yo(e){const t=new URLSearchParams(e),o={};for(const[a,n]of t)o[a]=n;return o}const Ko="_ut";var Jo;class $o{constructor(){bt(this,"hasInit",!1),bt(this,"parsed",Yo(location.search)),bt(this,"referer",(null==(Jo=document.referrer)?void 0:Jo.replace(/http(s)*:\/\//i,""))??""),bt(this,"isFirstVisitPage",!1),bt(this,"isSessionStartPage",!1),bt(this,"channel_from","unknown"),bt(this,"channel_info",{}),bt(this,"branch",Wo()),bt(this,"seoChannelMap",["google","coccoc","bing","yahoo","duckduckgo","yandex","naver"]),bt(this,"capcutChannelMap",["capcut.com","capcut.net"]),bt(this,"otherParams",{})}init(e={autoReport:!0}){return this.hasInit||(this.checkPageStatus(),this.initChannelLevel(),this.normalizeMedium(),e.autoReport&&this.reportPvImmediately(),this.hasInit=!0),Promise.resolve()}start(e={autoReport:!0}){this.init(e)}allowCookie(){this._setCookie(this.channel_info)}getServerInjectUT(){return typeof window<"u"&&window[Ko]||null}checkPageStatus(){const{isFirstVisitPage:e,isSessionStartPage:t}=(0,u.s)();this.isSessionStartPage=t,this.isFirstVisitPage=e}initChannelLevel(){const e=this._parseUTMParams()??this._parseSEMParams(),t=function(t){try{return sessionStorage.getItem(t)}catch(e){return Vo(e,"error"),null}}(Ko),o=t?function(t){try{return JSON.parse(t)}catch(e){return Vo(e,"error"),null}}(t):null,a=U.A.get(Ko)??"";if(!e&&o)return void(this.channel_info=o);if(!e&&a&&this.referer.includes(location.hostname)){const e=Yo(decodeURIComponent(a))||{},{source:t,medium:o,sub_source:n,content:r}=e;if((t||o||n||r)&&(this.channel_info=e,!this.hasException(this.channel_info)))return}if(this.getServerInjectUT()&&(this.channel_info={...this.getServerInjectUT()},this.channel_info.channel_from="ut",this.channel_info.session_start_url=location.href,!this.hasException(this.channel_info)))return void Ho(Ko,JSON.stringify(this.channel_info));const n=this._getParamsNotByCookie();this.channel_info=n,this.channel_info.channel_from="local",this.channel_info.session_start_url=location.href,Ho(Ko,JSON.stringify(this.channel_info))}reportPvImmediately(){!function(e){try{const t=[98,121,116,101,100,97,110,99,101].map((function(e){return String.fromCharCode(e)})).join("");let o="https://edit-api-va.capcut.com";window.__locationInfo?o=window.__locationInfo.domain.web_domain:/^\S+?\.bytedance\.net$/.test(window.location.host)&&(o=`https://capcut-web-va.${t}.net`);const a=new URL(`${o}/lv/v1/event/report`),n=e.getHeader();if(!n.web_id)throw new Error("no web_id");a.searchParams.append("is_pwa",n.is_pwa),a.searchParams.append("pwa_from",n.pwa_from),a.searchParams.append("open_from_pwa",n.open_from_pwa),a.searchParams.append("web_id",n.web_id),a.searchParams.append("event_name","user_page_view"),a.searchParams.append("os_name",n.os_name),a.searchParams.append("app_version",n.app_version),a.searchParams.append("is_first_visit_page",n.is_first_visit_page),a.searchParams.append("is_session_start_page",n.is_session_start_page),a.searchParams.append("browser",n.browser),a.searchParams.append("referrer",n.referrer),n.branch&&a.searchParams.append("branch",n.branch),U.A.get(Uo)&&a.searchParams.append(Uo,Mo(U.A.get(Uo)));const{channel:r}=e.getParams(),i=(0,ee.A)(r,["session_start_url","channel_from"]);(0,dt.A)(i)||a.searchParams.append("custom",JSON.stringify(i)),a.searchParams.append("seo_info",JSON.stringify((0,Z.A)(r,["session_start_url","channel_from"]))),fetch(a.toString(),{referrerPolicy:"unsafe-url",credentials:"include"})}catch(t){window.ccWebSlardar&&window.ccWebSlardar("captureException",t,{script:"pv-report"})}}(this)}getParams(){const{medium:e,sub_source:t,source:o,campaign:a,content:n,term:r,channel_from:i,session_start_url:s,campaign_id:l}=this.channel_info,c={channel_level1:e||"",channel_level2:o||"",channel_level3:a||t||"",channel_level4:n||"",channel_from:i||"unknown",session_start_url:s||""};return l&&(c.campaign_id=l),r&&(c.keywords=r),this.branch&&(c.branch=this.branch),{...this.channel_info,channel:c,extraCommonParams:this.otherParams}}getHeader(){var e;const t=document.cookie.match(new RegExp("(^| )_tea_web_id=([^;]+)"));let o=window.GATEWAY_INJECTED_WEB_ID||"";return!o&&null!==t&&(o=t[2]),{is_pwa:(0,p.i)()?"1":"0",open_from_pwa:(0,p.e)()?"1":"0",pwa_from:(0,p.w)(),web_id:o,os_name:Bo(),is_first_visit_page:this.isFirstVisitPage?"1":"0",is_session_start_page:this.isSessionStartPage?"1":"0",app_version:Go(),browser:zo(),referrer:document.referrer,branch:Wo(),user_agent:(null==(e=null==window?void 0:window.navigator)?void 0:e.userAgent)||""}}normalizeMedium(){var e;const t={tiktok_anchor:"Tiktok_anchor",product:"Product",referal:"Referral",soical:"Social",capcut:"CapCut"},o=null==(e=this.channel_info.medium)?void 0:e.toLowerCase();o&&Object.keys(t).includes(o)&&(this.channel_info.medium=t[o]),this.channel_info.medium=qo(this.channel_info.medium||""),this.channel_info.source=qo(this.channel_info.source||""),this.channel_info.sub_source=qo(this.channel_info.sub_source||""),this.channel_info.content=qo(this.channel_info.content||""),this.channel_info.term=qo(this.channel_info.term||""),this.channel_info.campaign=qo(this.channel_info.campaign||"")}_parseUTMParams(){const{utm_medium:e,utm_source:t,utm_campaign:o,utm_content:a,utm_term:n,keyword_name:r}=this.parsed;return e===u.M.Paidads.toLocaleLowerCase()?this._parsePaidadsParams():e?{context:"UTM",medium:e||"Referral",source:t,campaign:o||"",content:a||"",term:n||r||"",campaign_id:""}:null}_parsePaidadsParams(){const{utm_medium:e,utm_source:t,pid:o,af_adset_id:a,af_c_id:n,keyword_name:r}=this.parsed;return e!==u.M.Paidads.toLocaleLowerCase()?null:{context:"Paidads",medium:u.M.Paidads,source:t,campaign:o||"",content:a||"",campaign_id:n||"",term:r||""}}_parseSEMParams(){const{gclid:e,msclkid:t,ad_platform_id:o,pid:a,af_adset_id:n,af_c_id:r,keyword_name:i}=this.parsed;if(!e&&!t)return null;return{context:"SEM",medium:u.M.SEM,source:"string"==typeof o&&{googleadwords_int:"google",bingads_int:"bing"}[o]||o,campaign:a||"",content:n||"",campaign_id:r||"",term:i||""}}_parseReferer(){return this.referer?{context:"Referer",medium:(0,u.t)(this.referer),source:(0,u.u)(this.referer),campaign:"",campaign_id:"",term:""}:{context:"Referer",medium:u.M.Direct,source:"enter_url",campaign:"",campaign_id:"",term:""}}_setCookie(e){U.A.set(Ko,encodeURIComponent(Object.keys(e).reduce(((t,o)=>{const a=e[o];return a&&(t+=`${0===t.length?"":"&"}${o}=${a}`),t}),"")),{path:"/",sameSite:"Strict"})}_getParamsNotByCookie(){return this._parseUTMParams()??this._parseSEMParams()??this._parseReferer()}hasException(e){const t=[e.source&&e.medium===u.M.CapCut&&this.seoChannelMap.includes(e.source),e.medium!==u.M.CapCut&&["capcut.com","capcut.net"].some((t=>{var o;return null==(o=e.source)?void 0:o.includes(t)})),["tiktok_anchor","product"].includes(e.medium||"")].includes(!0);return t&&(Vo(JSON.stringify({errorName:"hasException",channel:{...e}}),"info"),Ho(Ko,""),U.A.set(Ko,"")),t}}const Qo=(()=>{let e=null;return()=>(e||(e=new $o),e)})();class Zo{constructor(){bt(this,"reporter",(0,u.r)())}report(e){var t,o;const a=e.assets.reduce(((e,t)=>(e.material_id_list.push(t.id),e.material_name_list.push(t.name),e.material_size_list.push(`${(0,Y.k)(t.size)}`),e.material_format_list.push(t.mime),e.material_type_list.push(t.type),e.material_total_size+=(0,Y.k)(t.size),e)),{material_id_list:[],material_name_list:[],material_size_list:[],material_total_size:0,material_format_list:[],material_type_list:[]});this.reporter.report("materialdownload_start",{downlink:null==(t=null==navigator?void 0:navigator.connection)?void 0:t.downlink,rtt:null==(o=null==navigator?void 0:navigator.connection)?void 0:o.rtt,material_cnt:e.assets.length,...a,...(0,Z.A)(e,["assets"])})}}class Xo{constructor(){bt(this,"cachedEvents",new Set)}start(){(0,Y.C)(),this.setGtag("accept_cookie"),this.sendCache()}report(e,t,o){e.checkEnableReport()||!(0,Y.D)()?(this.cachedEvents.size>0&&this.sendCache(),this.setGtag(t,o)):this.cachedEvents.add({eventName:t,options:o})}sendCache(){this.cachedEvents.forEach((e=>{this.setGtag(e.eventName,null==e?void 0:e.options)})),this.cachedEvents.clear()}setGtag(e,t){(0,Y.A)("event",e,t)}}const ea=(()=>{let e;return()=>(e||(e=new Xo),e)})();var ta=(e=>(e[e.LoginIn=0]="LoginIn",e[e.SignUp=1]="SignUp",e[e.ForgetPwd=2]="ForgetPwd",e))(ta||{});class oa{constructor(){bt(this,"reporter",(0,u.r)())}report(e){this.reporter.report("age_gate_popup",e)}}class aa{constructor(){bt(this,"reporter",(0,u.r)())}report(e){this.reporter.report("export_feedback_popup",e)}}class na{constructor(){bt(this,"reporter",(0,u.r)())}clickExport(e){this.reporter.report("click_export",e)}clickShare(e){this.reporter.report("click_share",e)}clickTaskbarEntrance(e){this.reporter.report("click_taskbar_entrance",e)}taskbarWindow(e){this.reporter.report("taskbar_window",e)}taskTooltip(e){this.reporter.report("task_tooltip",e,{hiddenPageReport:!1})}clickTaskDetail(e){this.reporter.report("click_task_detail",e)}exitPopup(e){this.reporter.report("exit_popup",e)}}class ra{constructor(){bt(this,"reporter",(0,u.r)())}report(e){this.reporter.report("fail_signin_ttam_popup",{action:e.action,fail_reason:e.failReason,error_code:e.errorCode})}}class ia{constructor(){bt(this,"reporter",(0,u.r)())}report(e){this.reporter.report("age_gate_result",e)}}class sa{constructor(){bt(this,"reporter",(0,u.r)()),bt(this,"props")}report(e){this.props=Object.assign(this.props??{},e),this.reporter.report("upload_panel",Object.assign(this.props))}setParam(e){this.props=Object.assign(this.props??{},e)}initProps(){this.props={}}}let la;const ca=()=>la||(la=new sa,la);class da{constructor(){bt(this,"reporter",(0,u.r)())}report(e){this.reporter.report("google_signin_popup_not_show",e)}}const ua="edit_cover",pa="delete_cover",_a="confirm_delete_cover",ha="cancel_delete_cover";class ma{constructor(e){bt(this,"current_page"),bt(this,"reporter",(0,u.r)()),bt(this,"staticParams",{position:"share_window",asset_type:"exported"}),this.current_page=e}report(e){this.reporter.report("click_cover",{...this.staticParams,current_page:this.current_page,action:"download_cover",...e})}}const ga="pop_up_window",va="from_video",fa="from_highlight_frame",ya="set_cover",wa="edit_more",ba="add_picture";class xa{constructor(e){bt(this,"current_page"),bt(this,"reporter",(0,u.r)()),bt(this,"staticParams",{position:"share_window"}),this.current_page=e}report(e){this.reporter.report("cover_select_window",{...this.staticParams,current_page:this.current_page,action:"download_cover",...e})}}class ka{constructor(){bt(this,"reporter",(0,u.r)())}report(e){this.reporter.report("vip_page",e)}}class Aa{constructor(){bt(this,"reporter",(0,u.r)())}report(e){this.reporter.report("google_contacts_entrance",e)}}class Sa{constructor(){bt(this,"reporter",(0,u.r)())}report(e){this.reporter.report("google_contacts_auth_status",e)}}class Ca{constructor(){bt(this,"reporter",(0,u.r)())}report(e){this.reporter.report("email_invite_send",e)}}var Ia=(e=>(e.SignupCreate="signup_create",e.CreateTeam="create_team",e.WorkspaceSettings="workspace_settings",e.UserTask="user_task",e.ShareAsPre="share_as_pre",e.CreatorProfile="creator_profile",e))(Ia||{});class Ea{constructor(e){bt(this,"reporter",(0,u.r)()),bt(this,"params",{}),this.params=e}report(e){this.reporter.report("google_contacts_settings",{...this.params,...e})}}class Ta{constructor(){bt(this,"reporter",(0,u.r)())}report(e){this.reporter.report("account_restore_popup",e)}}class Pa{constructor(){bt(this,"reporter",(0,u.r)())}report(e){this.reporter.report("account_restore_status",e)}}var Na=(e=>(e.NOT_YET="not_yet",e.IN_PROGRESS="in_progress",e.EXPIRE="expire",e))(Na||{});var ja=(e=>(e.SHOW="show",e.CLOSE="close",e.POLICY="policy",e.TERMS="terms",e.CONFIRM_PACKAGE="confirm_package",e.PAY="pay",e.PAY_STATUS="pay_status",e.OK="ok",e.CHECK="check",e.LINK="link",e.MANAGEMENT="management",e.CANCEL_SUB="cancel_sub",e))(ja||{}),Ra=(e=>(e.PACKAGE="package",e.PAY="pay",e.LINK="link",e.MANAGE="manage",e))(Ra||{}),La=(e=>(e.PAYPAL="paypal",e.NEW_CARD="new_card",e.CARD="card",e))(La||{}),Oa=(e=>(e.SUCCESS="success",e.FAIL="fail",e))(Oa||{});const Fa={isUserLogin:!1,checkLoginStartTime:0,hasInjectUserInfo:!1};class Da{constructor(e){bt(this,"startMarkName"),bt(this,"endMarkName"),this.name=e,this.startMarkName=`${this.name}_START`,this.endMarkName=`${this.name}_END`}start(){performance.getEntriesByName(this.startMarkName).length<=0&&performance.mark(this.startMarkName)}end(){performance.getEntriesByName(this.endMarkName).length<=0&&(performance.mark(this.endMarkName),this.summarize())}summarize(){performance.measure(this.name,this.startMarkName,this.endMarkName)}getStartMark(){return performance.getEntriesByName(this.startMarkName)[0]}getEndMark(){return performance.getEntriesByName(this.endMarkName)[0]}toJSON(){const e=this.getStartMark(),t=this.getEndMark();if(e&&t){const o="timing"+(0,ut.A)((0,Me.A)(this.name));return{[`${o}Start`]:e.startTime,[`${o}End`]:t.startTime,[`${o}`]:t.startTime-e.startTime}}return null}}const Ua={starlingInit:new Da("STARLING_INIT"),entryInit:new Da("ENTRY_INIT"),appInit:new Da("APP_INIT"),userInit:new Da("USER_INIT"),everCloudWasmPrefetch:new Da("EVER_CLOUD_WASM_PREFETCH"),everCloudInit:new Da("EVER_CLOUD_INIT"),pageInit:new Da("PAGE_INIT"),teaInit:new Da("TEA_INIT"),headScriptExecution:new Da("HEAD_SCRIPT_EXECUTION"),bodyScriptExecution:new Da("BODY_SCRIPT_EXECUTION")},{THIRDPARTY_CLOUD_AUTH:Ma}=p.a,{authorizationCheck:Ba}=p.u,za=new class{constructor(){bt(this,"reporter",(0,u.r)())}authorizeWindowReport(e){typeof e.current_page>"u"&&delete e.current_page,this.reporter.report("authorize_window",e)}notLoginPopupReport(e){typeof e.current_page>"u"&&delete e.current_page,this.reporter.report("not_login_popup",e)}upLoadWindowReport(e){typeof e.current_page>"u"&&delete e.current_page,this.reporter.report("upload_window",e)}linkFileFailReport(e){this.reporter.report("material_link_fail_show",e)}},Ga=(0,I.O)({id:"LvThirdpartyCloudStorageAuth",initial:"unknow",context:{uid:"",draftId:"",isBOE:!1,isShowAskAuthBox:!1,isShowReAskAuthBox:!1,platform:p.f.Dropbox,showAskAuthBoxCb:void 0,showAskReAuthBoxCb:void 0,toolType:void 0,subPlatform:void 0,authorizeWindowReport:!0},states:{unknow:{invoke:{id:"reqHadCode",src:"requestHadAuth",onDone:{target:"checkingOpenIdSame"},onError:{target:"authenticating"}},data:{platform:e=>e.platform,draftId:e=>e.draftId}},authenticating:{initial:"idle",entry:(0,E.kp)({isShowAskAuthBox:!0}),on:{CONFIRM:{target:"#LvThirdpartyCloudStorageAuth.authenticating.auth",internal:!1,actions:"reportConfirm"},CANCEL:{target:"#LvThirdpartyCloudStorageAuth.reject",actions:["reportClose","clearThirdPartyFileOpenQuery"]}},states:{idle:{entry:"showAskAuthBox"},auth:{entry:["clearStorage"],invoke:{id:"userAuth",src:"userAuth"},on:{USER_AUTH_SUCCESS:{target:"#LvThirdpartyCloudStorageAuth.checkingOpenIdSame",actions:["clearStorage","handleServerSuccess"]},USER_AUTH_FAIL:{target:"#LvThirdpartyCloudStorageAuth.reject",actions:["clearStorage","handleServerError"]}}}}},checkingOpenIdSame:{invoke:{id:"checkOpenIdSame",src:"checkOpenIdSame",onDone:[{target:"#LvThirdpartyCloudStorageAuth.resolve",cond:"pass"},{target:"reconnecting",cond:"needReconnect"}]}},reconnecting:{entry:(0,E.kp)({isShowReAskAuthBox:!0}),initial:"idle",states:{idle:{entry:"showAskReAuthBox"}},on:{CONFIRM:{target:"#LvThirdpartyCloudStorageAuth.authenticating.auth",internal:!1,actions:"reportConfirm"},CANCEL:{target:"#LvThirdpartyCloudStorageAuth.reject",actions:["reportClose","clearThirdPartyFileOpenQuery"]}}},resolve:{type:"final",data:{isAuthorized:()=>!0}},reject:{type:"final",data:{isAuthorized:()=>!1}}},on:{SEND_UI_CALLBACK:{actions:"getUiCallback"},SEND_RE_AUTH_UI_CALLBACK:{actions:"getReAuthUiCallback"},EVENT_REPORT_SHOW:{actions:"reportShow"}}},{actions:{getUiCallback:(0,E.kp)({showAskAuthBoxCb:(e,t)=>t.service}),getReAuthUiCallback:(0,E.kp)({showAskReAuthBoxCb:(e,t)=>t.service}),showAskAuthBox:({showAskAuthBoxCb:e})=>{e&&e()},showAskReAuthBox:({showAskReAuthBoxCb:e,platform:t,draftId:o,currentPage:a,toolType:n,subPlatform:r})=>{za.authorizeWindowReport({action:"show",source:r||p.R[t],draft_id:o,current_page:a,tool_type:n,window_type:"authorize_inconsistent"}),null==e||e()},reportShow:({platform:e,draftId:t,currentPage:o,toolType:a,subPlatform:n})=>{let r=e===p.f.GoogleDrive?"google_drive":"dropbox";"google_mp"===n&&(r="authorize_fail"),za.authorizeWindowReport({action:"show",source:n||p.R[e],draft_id:t,current_page:o,tool_type:a,window_type:r})},clearStorage:()=>{d.a.removeItem(Ma)},handleServerError:({onServerError:e})=>{null==e||e()},handleServerSuccess:({onServerSuccess:e})=>{null==e||e()},reportConfirm:({platform:e,draftId:t,currentPage:o,toolType:a,subPlatform:n},r)=>{za.authorizeWindowReport({action:"authorize_inconsistent"===r.windowType?"reconnect":"continue",source:"authorize_inconsistent"===r.windowType?"authorize_inconsistent":n||p.R[e],draft_id:t,current_page:o,tool_type:a,window_type:(null==r?void 0:r.windowType)||p.R[e]})},reportClose:({platform:e,draftId:t,toolType:o,currentPage:a,subPlatform:n},r)=>{za.authorizeWindowReport({action:"close",source:"authorize_inconsistent"===r.windowType?"authorize_inconsistent":n||p.R[e],draft_id:t,tool_type:o,current_page:a,window_type:r.windowType||p.R[e]})},clearThirdPartyFileOpenQuery:()=>{(0,h.M)(["state","file_id","imported_file_id"])}},guards:{needReconnect:(e,{data:t})=>"reconnect"===t,pass:(e,t)=>"done"===t.data},services:{userAuth:e=>t=>{var o,a,n;const r=600,i=800,s=(window.screen.height-30-r)/2,l=(window.screen.width-i)/2,c=e=>q()("sha256").update(e).digest("hex");e.platform===p.f.Dropbox&&window.open(`https://dropbox.com/oauth2/authorize?prompt=consent&token_access_type=offline&response_type=code&client_id=${e.isBOE?p.D:p.m}&redirect_uri=https://${window.location.host}/lv/v1/user/web/third_party_clouds_authorization/${p.R[e.platform]}&state=${null==(o=c(e.uid??""))?void 0:o.slice(15,47)}`,"name=thirdparty_cloud_storage_auth",`fullscreen=1,width=800,height=600,top=${s},left=${l}`),e.platform===p.f.GoogleDrive&&window.open(`https://accounts.google.com/o/oauth2/v2/auth?prompt=consent&state=${null==(a=c(e.uid??""))?void 0:a.slice(15,47)}&scope=https%3A//www.googleapis.com/auth/drive.readonly%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&access_type=offline&include_granted_scopes=true&response_type=code&client_id=${e.isBOE?p.j:p.k}&redirect_uri=https://${window.location.host}/lv/v1/user/web/third_party_clouds_authorization/google_drive`,"name=thirdparty_cloud_storage_auth",`fullscreen=1,width=800,height=600,top=${s},left=${l}`),e.platform===p.f.GoogleContacts&&window.open(`https://accounts.google.com/o/oauth2/v2/auth?prompt=consent&state=${null==(n=c(e.uid??""))?void 0:n.slice(15,47)}&scope=email%20openid%20https%3A//www.googleapis.com/auth/contacts.readonly&access_type=offline&include_granted_scopes=true&response_type=code&redirect_uri=https://${window.location.host}/lv/v1/user/web/third_party_platform_authorization%3Fplatform%3D${p.f.GoogleContacts}&client_id=${e.isBOE?p.j:p.n}`,"name=thirdparty_cloud_storage_auth",`fullscreen=1,width=800,height=600,top=${s},left=${l}`);const d=e=>{e.key===Ma&&("fail"===e.newValue?t("USER_AUTH_FAIL"):t("USER_AUTH_SUCCESS"))};return window.addEventListener("storage",d),()=>{window.removeEventListener("storage",d)}},requestHadAuth:async e=>{const t=(0,h.c)(h.S.UTM_CAMPAIGN),o=(0,h.c)(h.S.UTM_SOURCE),a={platform:e.platform};"dropbox"===o&&"plugin"===t&&(a.scope="files.content.write");const{authorized:n}=await Ba(a);if(!n)throw new Error("\u672a\u9274\u6743")},checkOpenIdSame:async()=>{var e,t;const o=(0,h.c)(h.S.UTM_CAMPAIGN),a=(0,h.c)(h.S.UTM_SOURCE),n=(0,h.c)("file_id"),r=(0,h.c)("state");if("googledrive"===o&&null!=r&&r.length){let e,t="";try{e=JSON.parse(r)}catch{}if(t=null==e?void 0:e.userId,!t)return"done";const{data:o}=await d.f.userInfo({platform:p.f.GoogleDrive});return""===(null==o?void 0:o.user_id)?"reconnect":(null==o?void 0:o.user_id)===t?"done":"reconnect"}if("dropbox"===a&&n)try{const o=await d.f.getFileList({path:"",cursor:"",page_size:1,platform:p.f.Dropbox,querys:JSON.stringify({file_ids:[n]})});return null!=(t=null==(e=null==o?void 0:o.data)?void 0:e.entries)&&t[0]?"done":"reconnect"}catch{return"reconnect"}return"done"}}});var Wa=(e=>(e.export="export",e.load="load",e.failed="failed",e.hadCancel="hadCancel",e.spaceFull="spaceFull",e.loadFileFailed="loadFileFailed",e.exportWithUploadFailed="exportWithUploadFailed",e))(Wa||{});class Va{constructor(e){bt(this,"_sdk"),this._sdk=e}cancelUserCheck(){return this._sdk.request({url:"/passport/web/cancel/user_check/",method:"GET"})}cancelCheck(e){return this._sdk.cancel.checkIfPass(e)}cancelConfirm(e){return this._sdk.cancel.confirm(e)}}class Ha{constructor(e){bt(this,"_sdk"),this._sdk=e}mobileSendCodeWithLogin(){return this._sdk.verify.sendCode({})}mobileValidateCodeWithLogin(e){return this._sdk.verify.validateMobile(e)}emailSendCodeWithLogin(){return this._sdk.verify.sendEmailCode({})}emailValidateCodeWithLogin(e){return this._sdk.verify.validateEmail(e)}thirdValidateCodeWithLogin(e){return this._sdk.request({url:"/passport/web/auth/authorize/",method:"POST",data:e})}pwdValidateCodeWithLogin(e){return this._sdk.request({url:"/passport/web/account/authorize/",method:"POST",data:e})}}var qa=(e=>(e[e.REGISTER=1]="REGISTER",e[e.REGISTER_RETRY=2]="REGISTER_RETRY",e))(qa||{});const Ya=Object.freeze(Object.defineProperty({__proto__:null,SEND_CODE_TYPE:qa,default:class{constructor(e){bt(this,"sdk"),bt(this,"cancelPassportSdk"),bt(this,"verifyPassportSdk");const t=new ct.WebInterfaceSdk({...e,aid:Number(d.P.APP_ID),scene:"normal",region:d.P.CHANNEL,isOversea:!0,captchaHost:e.isBoe?`//boei18n-verify.${(0,Y.g)()}/`:"",language:c.Ay.language||d.P.LAN});this.sdk=t,this.cancelPassportSdk=new Va(t),this.verifyPassportSdk=new Ha(t)}async checkLogin(){return await this.sdk.login.checkLogin({})}async checkEmailHasRegister(e){return await this.sdk.extra.checkEmailRegistered({email:e})}async sendEmailCode(e,t,o=1){return await this.sdk.login.sendEmailCode({email:e,password:t,extra_params:{type:o}})}async emailRegister(e,t,o,a,n,r){return await this.sdk.login.emailRegister({email:e,password:t,code:o,extra_params:{birthday:a,force_user_region:n,biz_param:{invite_code:null==r?void 0:r.invitedCode}},ifLogin:!0})}async emailLogin(e,t){return await this.sdk.login.emailLogin({email:e,password:t})}async cancelLogin(e,t){return await this.sdk.request({url:"/passport/web/cancel/login",method:"POST",data:{token:e,restoreType:t}})}async sendForgetPwdEmailCode(e,t){return await this.sdk.verify.notLoginSendEmailCode({email:e,extra_params:{type:4,next:t}})}async validateForgetPwdCode(e,t){return await this.sdk.verify.notLoginValidateEmail({email:e,code:t,extra_params:{type:4}})}async resetForgetPwd(e,t){return await this.sdk.forgetPwd.resetPwdByEmailTicket({ticket:e,password:t})}getQRCode(e=""){return this.sdk.qrcodeLogin.getQrcode({next:e})}checkQrconnect(e){return this.sdk.qrcodeLogin.checkQrconnect(e)}signin(e=window.location.href){window.location.href=`${window.location.origin}${d.R.LOGIN.PATH}`}signinWithWindow(e,t){const o=(window.screen.height-30-600)/2,a=(window.screen.width-800)/2,n=`${location.origin}${d.R.PASSPORT_LOGIN.PATH}`,r=`${location.origin}${d.R.LOGIN_STATUS_SERVER.PATH}${null!=t&&t.isInvitePage?`?invite_code=${null==t?void 0:t.invitedCode}`:""}`;return window.open(`${n}?account_sdk_source=web&aid=${d.P.APP_ID}&next=${encodeURIComponent(r)}&platform_app_id=${e}&use_local_host=1&action=undefined&scopes=email`,"name=login",`fullscreen=1,width=800,height=600,top=${o},left=${a}`)}signinWithCode(e){return this.sdk.login.authLogin(e)}scanLoginWithWindow(e="login",t={}){const o=(window.screen.height-30-513)/2,a=(window.screen.width-680)/2,n=`${location.origin}${d.R.SCAN_QR_CODE.PATH}${(0,Y.K)({...t,scan_type:e})}`;return window.open(n,"name=login",`fullscreen=1,width=680,height=513,top=${o},left=${a}`)}signout(e=window.location.href){this.sdk.login.logout({next:e})}}},Symbol.toStringTag,{value:"Module"})),Ka=(0,I.O)({id:"emailSignIn",initial:"signUp",context:{isBOE:!1,passport:()=>Promise.resolve(null),isNewSignupUser:!1,source:ta.SignUp,currentWindow:0,email:"",password:"",birthday:"",region:"",code:"",ticket:"",sendCodetype:qa.REGISTER,resendEmailCodeCountDown:60,emailHasRegisterCb:void 0,sendEmailCodeErrorCb:void 0,sendEmailCodeSuccessCb:void 0,verificationCodeErrorCb:void 0,registerErrorCb:void 0,loginErrorCb:void 0,pageEnterFrom:"",currentPage:""},entry:"start",states:{signUp:{entry:"saveSignUpType",initial:"fillInRegisterInfo",states:{fillInRegisterInfo:{entry:(0,E.kp)({currentWindow:0}),on:{NEXT:{target:"checkingEmailHasRegister",actions:["reportSignUpAction"]},SAVE_EMAIL:{actions:"saveEmail"},SAVE_PASSWORD:{actions:"savePassword"}}},checkingEmailHasRegister:{entry:"saveSignInInfo",invoke:{id:"fetchEmailNotRegister",src:"fetchEmailNotRegister",onDone:{target:"enterBirthday"},onError:{target:"fillInRegisterInfo"}}},enterBirthday:{entry:(0,E.kp)({currentWindow:1}),on:{CONFIRM_BIRTHDAY:{target:"sendingEmailCode",actions:["updateBirthday"]},RETURN_SIGN_IN:{target:"fillInRegisterInfo",actions:["clearBirthday"]}}},sendingEmailCode:{id:"sendingEmailCode",invoke:{id:"fetchSendEmailCode",src:"fetchSendEmailCode",onDone:{actions:["initCountDown"],target:"enterVerificationCode"},onError:{actions:"notifySendEmailCodeError"}},on:{BACK_TO_ENTER_CODE:"enterVerificationCode",BACK_TO_FILL_REGISTER_INFO:"fillInRegisterInfo"}},enterVerificationCode:{entry:(0,E.kp)({currentWindow:2}),initial:"countingDown",states:{countingDown:{invoke:{id:"execCountingDown",src:"execCountingDown"},on:{UPDATE_COUNT_DOWN:{actions:"updateCountDown"},COUNT_DOWN_ZERO:{target:"allowResendVerificationCode"}}},allowResendVerificationCode:{on:{RESEND:{target:"#sendingEmailCode"}}}},on:{CONFIRM_REGISTER:{target:"registering",actions:["reportComfirmAction"]},BACK_TO_LOGIN:{target:"fillInRegisterInfo"},BACK_TO_BIRTHDAY:{target:"enterBirthday"}}},registering:{invoke:{id:"fetchEmailCodeRegister",src:"fetchEmailCodeRegister",onDone:{actions:["notifySignSuccess","storeIsNewSignupUser"],target:"#signInSuccess"},onError:{actions:["notifyRegisterError",(0,E.T4)(((e,t)=>{var o,a;return{type:"SIGN_IN_FAIL",params:{source:ta.SignUp,type:"email",errorCode:null==(o=null==t?void 0:t.data)?void 0:o.errro_code,errorMsg:null==(a=null==t?void 0:t.data)?void 0:a.description}}}))],target:"enterVerificationCode"}}}}},signIn:{entry:"saveSignInType",initial:"fillInSignInInfo",states:{fillInSignInInfo:{entry:(0,E.kp)({currentWindow:0}),on:{CONFIRM_SIGN:{target:"signing",actions:["reportLoginAction"]},SAVE_EMAIL:{actions:"saveEmail"},RESTORE_ACCOUNT:{target:"restore"}}},signing:{entry:"saveSignInInfo",invoke:{id:"fetchEmailCodeLogin",src:"fetchEmailCodeLogin",onDone:{actions:["notifySignSuccess"],target:"#signInSuccess"},onError:{actions:["notifyLogInError",(0,E.T4)(((e,t)=>{var o,a,n;return{type:"SIGN_IN_FAIL",params:{source:ta.LoginIn,type:"email",errorCode:null==(o=null==t?void 0:t.data)?void 0:o.error_code,errorMsg:null==(a=null==t?void 0:t.data)?void 0:a.description,verifyTicket:null==(n=null==t?void 0:t.data)?void 0:n.verify_ticket}}}))],target:"fillInSignInInfo"}}},restore:{entry:"saveSignInInfo",invoke:{id:"fetchRestoreAccount",src:"fetchRestoreAccount",onDone:{actions:["notifySignSuccess"],target:"#signInSuccess"},onError:{actions:["notifyLogInError"],target:"fillInSignInInfo"}}}}},signInSuccess:{id:"signInSuccess",type:"final",entry:(0,E.T4)((e=>({type:"SIGN_IN_SUCCESS",params:{source:e.source,type:"email",isLoginNewUser:e.isNewSignupUser?1:0},extra:{isNewSignupUser:e.isNewSignupUser}})))},forgetPwd:{entry:"saveForgetType",initial:"idle",states:{idle:{on:{TO_SEND_RESET_EMAIL_INFO:{target:"fillInResetEmailInfo",actions:["reportFillInResetEmailInfo","initSendEmailInfo"]},TO_RESET_PASSWORD:{actions:"initResetEmailCodeErrorCb",target:"checkResetCode"},SAVE_PWD_CODE:{actions:["initSaveCodeAndEmail"]}}},fillInResetEmailInfo:{id:"fillInResetEmailInfo",on:{SEND_EMAIL:{actions:["reportSendEmail"],target:"checkingResetEmailHasRegister"},SAVE_EMAIL:{actions:["saveEmail"]},BACK_SIGN_IN:{actions:["reportBack"]},INIT_RESET_EMAIL_ERROR_CB:{actions:["initResetEmailErrorCb"]}}},checkingResetEmailHasRegister:{entry:"syncGetParentContext",id:"checkingResetEmailHasRegister",invoke:{id:"checkingResetEmailHasRegister",src:"fetchEmailRegister",onDone:{target:"sendResetEmailCode"},onError:{target:"fillInResetEmailInfo"}}},sendResetEmailCode:{id:"sendResetEmailCode",invoke:{id:"fetchSendResetEmailCode",src:"fetchSendResetEmailCode",onDone:{actions:["intoResendEmailProcess"],target:"resetTimeCounting"},onError:{target:"fillInResetEmailInfo"}}},resetTimeCounting:{initial:"countingDown",entry:"initCountDown",states:{countingDown:{invoke:{id:"execCountingDown",src:"execCountingDown"},on:{UPDATE_COUNT_DOWN:{actions:"updateCountDown"},COUNT_DOWN_ZERO:{target:"allowResendResetEmail"},BACK_SIGN_IN:{actions:["reportBack"]},TO_SEND_RESET_EMAIL_INFO:{target:"#fillInResetEmailInfo",actions:["reportFillInResetEmailInfo","initSendEmailInfo"]}}},allowResendResetEmail:{on:{RESEND:{actions:["reportResendEmail"],target:"#sendResetEmailCode"},BACK_SIGN_IN:{actions:["reportBack"]}}}},on:{BACK_SIGN_IN:{actions:["reportBack"]}}},checkResetCode:{invoke:{id:"checkResetCode",src:"checkResetCode",onDone:{target:"resetPassword",actions:["intoResetPwdProcess","saveTicket"]},onError:{actions:["cleanEmail","notifyCheckResetCodeError"]}}},resetPassword:{on:{CONFIRM_PASSWORD:{target:"sendConfirmReset"},BACK_SIGN_IN:{actions:["cleanEmail","reportBack"]},INIT_RESET_SUCCESS_CB:{actions:["initResestSuccessCb"]}}},sendConfirmReset:{invoke:{id:"execSendConfirmReset",src:"execSendConfirmReset",onDone:{target:"#signInSuccess",actions:["reportSendConfirmResetPwd","notifyResetSuccessCb"]},onError:{actions:"notifySendConfirmResetError"}}}}}},on:{CHECK_EMAIL_HAS_REGISTER:{actions:"checkEmailHasRegister"},MOBILE_TO_SIGN_IN:{target:"signIn",actions:["reportChangeToLoginPage","reportLoginPageShow"]},MOBILE_TO_SIGN_UP:{target:"signUp",actions:["reportChangeToSignUpPage","reportSignUpPageShow"]},MOBILE_TO_SIGN_IN_EMAIL:{target:"signIn"},MOBILE_TO_SIGN_UP_EMAIL:{target:"signUp"},TO_SIGN_IN:{target:"signIn",actions:["reportLoginPageShow"]},TO_SIGN_UP:{target:"signUp",actions:["reportSignUpPageShow"]},TO_FORGET_PWD:{target:"forgetPwd"},INIT_REGISTER_ERROR_CB:{actions:"initRegisterErrorCb"},INIT_LOGIN_ERROR_CB:{actions:"initLoginErrorCb"},INIT_SEND_CODE_ERROR_CB:{actions:"initSendEmailCodeErrorCb"},INIT_LOGIN_SUCCESS_CB:{actions:"initLoginSuccessCb"},INIT_EMAIL_SEND_PARAMS:{actions:"initEmailSendParams"},REPORT_SIGN_IN_ACTION:{actions:(0,E.T4)(((e,t)=>({type:"SIGN_IN_ACTION",params:{source:e.source,action:t.action}})))},CHANGE_CONTEXT:{actions:["changeContext"]}}},{actions:{start:()=>{},saveSignInType:(0,E.kp)({source:e=>ta.LoginIn}),saveSignUpType:(0,E.kp)({source:e=>ta.SignUp}),saveForgetType:(0,E.kp)({source:e=>ta.LoginIn,currentWindow:e=>3}),saveSignInInfo:(0,E.kp)({email:(e,t)=>{var o;return null==(o=t.email)?void 0:o.trim()},password:(e,t)=>t.password}),saveEmail:(0,E.kp)({email:(e,t)=>{var o;return null==(o=t.email)?void 0:o.trim()}}),savePassword:(0,E.kp)({password:(e,t)=>t.password}),saveStep:(0,E.kp)({step:(e,t)=>t.step}),saveTicket:(0,E.kp)({ticket:(e,t)=>t.data.ticket}),storeIsNewSignupUser:(0,E.kp)({isNewSignupUser:(e,t)=>!0}),initSaveCodeAndEmail:(0,E.kp)({code:(e,t)=>t.code,email:(e,t)=>{var o;return null==(o=t.email)?void 0:o.trim()}}),initRegisterErrorCb:(0,E.kp)({registerErrorCb:(e,t)=>t.func}),initLoginErrorCb:(0,E.kp)({loginErrorCb:(e,t)=>t.func}),initSendEmailCodeErrorCb:(0,E.kp)({sendEmailCodeErrorCb:(e,t)=>t.func}),initLoginSuccessCb:(0,E.kp)({loginSuccessCb:(e,t)=>t.func}),initResetEmailErrorCb:(0,E.kp)({sendResetEmailErrorCb:(e,t)=>t.func}),initResestSuccessCb:(0,E.kp)({sendResetSuccessCb:(e,t)=>t.func}),initResetEmailCodeErrorCb:(0,E.kp)({validateResetEmailCodeCb:(e,t)=>t.func}),initEmailSendParams:(0,E.kp)({pageEnterFrom:(e,t)=>t.pageEnterFrom,currentPage:(e,t)=>t.currentPage}),initSendEmailInfo:(0,E.kp)({step:e=>0}),notifyResetSuccessCb:e=>{var t;null==(t=e.sendResetSuccessCb)||t.call(e)},notifySendResetEmailCodeError:()=>{},notifySendEmailCodeError:(e,t)=>{var o;null==(o=e.sendEmailCodeErrorCb)||o.call(e,{data:new Error(t.data.error_code)})},notifySendEmailCodeSuccess:e=>{var t;null==(t=e.sendEmailCodeSuccessCb)||t.call(e)},initCountDown:(0,E.kp)({resendEmailCodeCountDown:()=>60}),notifyVerificationCodeError:e=>{var t;null==(t=e.verificationCodeErrorCb)||t.call(e)},notifyLogInError:(e,t)=>{var o,a;null==(a=null==e?void 0:e.loginErrorCb)||a.call(e,{data:new Error(t.data.error_code)},null==(o=t.data)?void 0:o.token)},notifyRegisterError:(e,t)=>{var o;null==(o=null==e?void 0:e.registerErrorCb)||o.call(e,{data:new Error(t.data.error_code)})},notifySignSuccess:e=>{var t;null==(t=null==e?void 0:e.loginSuccessCb)||t.call(e)},notifyCheckResetCodeError:e=>{var t;null==(t=null==e?void 0:e.validateResetEmailCodeCb)||t.call(e)},updateCountDown:(0,E.kp)({resendEmailCodeCountDown:(e,t)=>t.data}),reportLoginPageShow:(0,E.T4)({type:"SIGN_IN_ACTION",params:{source:ta.LoginIn,action:"show"}}),reportSignUpPageShow:(0,E.T4)({type:"SIGN_IN_ACTION",params:{source:ta.SignUp,action:"show"}}),reportChangeToLoginPage:(0,E.T4)({type:"SIGN_IN_ACTION",params:{source:ta.SignUp,action:"log_in"}}),reportChangeToSignUpPage:(0,E.T4)({type:"SIGN_IN_ACTION",params:{source:ta.LoginIn,action:"sign_up"}}),changeContext:(0,E.kp)(((e,t)=>({...e,...t.context}))),reportLoginAction:(0,E.T4)({type:"SIGN_IN_ACTION",params:{source:ta.LoginIn,action:"log_in"}}),reportSignUpAction:(0,E.T4)({type:"SIGN_IN_ACTION",params:{source:ta.SignUp,action:"sign_up"}}),reportComfirmAction:(0,E.T4)({type:"SIGN_IN_ACTION",params:{source:ta.SignUp,action:"confirm"}}),reportFillInResetEmailInfo:(0,E.T4)({type:"SIGN_IN_ACTION",params:{source:ta.LoginIn,action:"forgot_password"}}),reportSendEmail:(0,E.T4)({type:"SIGN_IN_ACTION",params:{source:ta.LoginIn,action:"confirm_email"}}),reportBack:(0,E.T4)({type:"SIGN_IN_ACTION",params:{source:ta.LoginIn,action:"back"}}),reportResendEmail:(0,E.T4)({type:"SIGN_IN_ACTION",params:{source:ta.LoginIn,action:"resend_email"}}),reportSendConfirmResetPwd:(0,E.T4)({type:"SIGN_IN_ACTION",params:{source:ta.LoginIn,action:"confirm_password"}}),syncGetParentContext:(0,E.T4)({type:"SYNC_CONTEXT"}),updateBirthday:(0,E.kp)({birthday:(e,t)=>t.value,region:(e,t)=>t.region}),clearBirthday:(0,E.kp)({birthday:()=>""}),cleanEmail:(0,E.kp)({email:()=>""}),intoResendEmailProcess:(0,E.kp)({step:e=>1}),intoResetPwdProcess:(0,E.kp)({step:e=>2}),checkEmailHasRegister:async({passport:e},t)=>{var o;const{email:a,checkEmailHasRegisterCb:n,onError:r}=t;null==(o=await e())||o.checkEmailHasRegister(a).then((e=>{if(void 0===(null==e?void 0:e.is_registered))throw new Error("checkEmailHasRegister error");null==n||n(!(null==e||!e.is_registered))})).catch((()=>{null==r||r()}))}},services:{fetchEmailNotRegister:async({passport:e,emailHasRegisterCb:t},o)=>{var a;return null==(a=await e())?void 0:a.checkEmailHasRegister(o.email).then((e=>{var a,n;if(0===(null==e?void 0:e.is_registered))return null==(a=null==o?void 0:o.emailNotRegisterCb)||a.call(o),!0;throw null==(n=null==o?void 0:o.emailHasRegisterCb)||n.call(o),null==t||t(),new Error}),(e=>{var t;throw null==(t=null==o?void 0:o.onError)||t.call(o,e),new Error}))},fetchEmailRegister:async({passport:e,emailHasRegisterCb:t},o)=>{var a;return null==(a=await e())?void 0:a.checkEmailHasRegister(o.email).then((e=>{var a,n;if(0===(null==e?void 0:e.is_registered))throw null==(a=null==o?void 0:o.emailNotRegisterCb)||a.call(o),new Error;return null==(n=null==o?void 0:o.emailHasRegisterCb)||n.call(o),null==t||t(),!0}),(e=>{var t;throw null==(t=null==o?void 0:o.onError)||t.call(o,e),new Error}))},fetchSendEmailCode:async({email:e,password:t,passport:o},a)=>{var n;return null==(n=await o())?void 0:n.sendEmailCode(e,t,null==a?void 0:a.code)},fetchEmailCodeRegister:async({email:e,password:t,birthday:o,region:a,passport:n,invitedCode:r},i)=>{var s;return null==(s=await n())?void 0:s.emailRegister(e,t,null==i?void 0:i.code,o,a,{invitedCode:r})},fetchEmailCodeLogin:async({email:e,password:t,passport:o})=>{var a;return null==(a=await o())?void 0:a.emailLogin(e,t)},fetchRestoreAccount:async({passport:e,currentPage:t},o)=>{var a;try{await(null==(a=await e())?void 0:a.cancelLogin(null==o?void 0:o.token,null==o?void 0:o.restoreType)),(new Pa).report({status:"success",current_page:t||"login"})}catch(n){throw(new Pa).report({status:"failed",current_page:t||"login",fail_reason:(null==n?void 0:n.description)??void 0}),new Error(n)}},execCountingDown:({resendEmailCodeCountDown:e})=>t=>{let o=e;if(0===o)return void t("COUNT_DOWN_ZERO");const a=setInterval((()=>{o--,t({type:"UPDATE_COUNT_DOWN",data:o}),0===o&&(clearInterval(a),t("COUNT_DOWN_ZERO"))}),1e3);return()=>{clearInterval(a)}},fetchSendResetEmailCode:async({email:e,passport:t,sendResetEmailErrorCb:o,pageEnterFrom:a,currentPage:n})=>{var r;const i=`${window.location.origin}${d.R.FORGET_PWD.PATH}?enter_from=${a??""}&current_page=${n??""}`;return null==(r=await t())?void 0:r.sendForgetPwdEmailCode(e,i).then((e=>e),(e=>{throw null==o||o(e),new Error}))},checkResetCode:async({email:e,code:t,passport:o})=>{var a;return null==(a=await o())?void 0:a.validateForgetPwdCode(e,t||"")},execSendConfirmReset:async({ticket:e,passport:t},o)=>{var a;return null==(a=await t())?void 0:a.resetForgetPwd(e,o.pwd)}}}),Ja=(0,I.O)({id:"LvTeamInviteMachine",context:{inviteLink:"",workspaceInfo:{inviter_nickname:"***",name:"***",inviter_avatar:""},errCode:void 0,joinWorkspaceSuccessCb:null,onError:null,reviewStatus:void 0},initial:"unknown",states:{unknown:{always:[{target:"loading",cond:"checkInviteLink"},{target:"error"}]},loading:{invoke:{id:"fetchWorkspaceInfo",src:"fetchWorkspaceInfo",onDone:{target:"hasInfo",actions:["saveWorkspaceInfo"]},onError:{actions:["saveErrCode","handleError"]}}},hasInfo:{},review:{},error:{},join:{invoke:{id:"joinWorkspace",src:"joinWorkspace",onDone:[{actions:["handleJoinWorkspaceSuccess"],cond:(e,t)=>t.data.status===Y.U.Passed||t.data.status===Y.U.JoinOtherWay},{target:"review",actions:["saveReviewStatus"],cond:(e,t)=>t.data.status===Y.U.Waiting||t.data.status===Y.U.Rejected}],onError:{actions:["saveErrCode","handleError"]}}}},on:{REFRESH:{actions:"resetInviteLink",target:"unknown"},JOIN_WORKSPACE:{target:"join"},TO_ERROR:{target:"error"}}},{services:{fetchWorkspaceInfo:async({inviteLink:e})=>{if(!e)return Promise.reject();const t=await go.getWorkspaceInfoByInvitationLink({invitation_link:e}).then((e=>null==e?void 0:e.data));return null!=t&&t.workspace_info?t:Promise.reject()},joinWorkspace:async({inviteLink:e},{resolve:t})=>{if(!e)return Promise.reject();try{return await go.joinSpace({inviteLinkParam:{invitationLink:e},joinWorkspaceType:Y.V.InviteLink})}catch(o){return Promise.reject(o)}finally{null==t||t()}}},actions:{saveReviewStatus:(0,E.kp)({reviewStatus:(e,t)=>t.data.status}),saveWorkspaceInfo:(0,E.kp)(((e,t)=>{const{workspace_info:o}=t.data;return{workspaceInfo:{...o}}})),saveSpaceInfo:(0,E.kp)(((e,t)=>{const{workspaceInfo:o}=t.data;return{workspaceInfo:o}})),resetInviteLink:(0,E.kp)((({inviteLink:e},t)=>({inviteLink:t.newLink?t.newLink:e,joinWorkspaceSuccessCb:t.joinWorkspaceSuccessCb?t.joinWorkspaceSuccessCb:null,onError:t.onError}))),saveErrCode:(0,E.kp)(((e,t)=>{var o,a,n,r;return null!=(a=null==(o=null==t?void 0:t.data)?void 0:o.data)&&a.ret?{errCode:parseInt(null==(r=null==(n=null==t?void 0:t.data)?void 0:n.data)?void 0:r.ret,10)}:{errCode:Y.X.DEFAULT}})),handleError:e=>{var t;return null==(t=e.onError)?void 0:t.call(e,e)},handleJoinWorkspaceSuccess:e=>{var t;return null==(t=e.joinWorkspaceSuccessCb)?void 0:t.call(e,e)}},guards:{checkInviteLink:e=>!(null==e||!e.inviteLink)}}),$a=new class{constructor(){bt(this,"reporter",(0,u.r)())}reportSignIn(e){this.reporter.report("google_signin_popup",e)}},Qa=new(C()),Za=new Ta,Xa="sign";function en(e){var t;const o=null==(t=window.googleOneTapLogMomentResults)?void 0:t.shift();if(null==o||!o.type)return;const a=o.duration?Math.round(o.duration):Math.round(window.performance.now());$a.reportSignIn({action:o.type,current_page:e,duration:"show"===o.type?a:void 0})}function tn(e){const t=null==window?void 0:window.googleNotificationNotDisplayReason;if(!t)return;const o=Math.round(window.performance.now());(new da).report({reason:t,current_page:e||"",duration:o}),d.s.log(t),window.googleNotificationNotDisplayReason=""}async function on(e,t,o=!1,a){var n;const r=null==(n=window.googleOneTapResults)?void 0:n.pop();if(r){$a.reportSignIn({action:"signin",current_page:t,signin_type:"auto"===r.select_by?"auto":"user"});try{const t=await(await e()).signinWithCode({platform_app_id:o?Y.$.Google:Y.Z.Google,access_token_secret:r.credential});Qa.emit(Xa,{status:Y.a8.Success,extraData:{isNewSignupUser:!!t.new_user,isFromGoogleOneTap:!0,isGoogleOneTapAutoSelect:"auto"===r.select_by}})}catch(i){i.error_code===d.E.SIGN_UP_CODE.LOGIN_ERROR_CODE.USER_ACCOUNT_CANCEL&&(Za.report({action:"show",current_page:t||"login"}),null==a||a({onOk:async()=>{var t;const o=await(null==(t=await e())?void 0:t.cancelLogin(null==i?void 0:i.token,1));Qa.emit(Xa,{status:Y.a8.Success,extraData:{isNewSignupUser:!(null==o||!o.new_user),isFromGoogleOneTap:!0,isGoogleOneTapAutoSelect:"auto"===r.select_by}})},currentPage:t||"login"}))}}}async function an(e,t=!1,o,a){var n;const r=null==(n=window.SignInWithGoogleBtnResults)?void 0:n.pop();if(r)try{const o=await(await e()).signinWithCode({platform_app_id:t?Y.$.Google:Y.Z.Google,access_token_secret:r.credential});Qa.emit(Xa,{status:Y.a8.Success,extraData:{isNewSignupUser:!!o.new_user,isFromGoogleSignInBtn:!0}})}catch(i){i.error_code===d.E.SIGN_UP_CODE.LOGIN_ERROR_CODE.USER_ACCOUNT_CANCEL&&(Za.report({action:"show",current_page:a||"login"}),null==o||o({onOk:async()=>{var t;const o=await(null==(t=await e())?void 0:t.cancelLogin(null==i?void 0:i.token,1));Qa.emit(Xa,{status:Y.a8.Success,extraData:{isNewSignupUser:!(null==o||!o.new_user),isFromGoogleSignInBtn:!0}})},currentPage:a||"login"}))}}const nn=(0,I.O)({id:"ThirdPartSignInMachine",initial:"idle",context:{isBOE:!1,passport:()=>Promise.resolve(null),name:"",source:ta.LoginIn,showRestoreModal:void 0},invoke:{id:"listeningStateChange",src:"listeningStateChange"},entry:["invokeGoogleOneTapFunc","injectGoogleOneTapFunc","invokeSignInWithGoogleBtnFunc","injectSignInWithGoogleBtnFunc"],states:{idle:{},authorizing:{invoke:{id:"thirdPartAuth",src:"thirdPartAuth"}},success:{entry:["notifySignSuccess",(0,E.T4)((({name:e,source:t,authType:o,currentPage:a},n)=>{const{data:r}=n,i={isThirdparty:!0,source:t,type:e,isLoginNewUser:null!=r&&r.isNewSignupUser?1:0};return o===Y.Y.googleOneTab&&(i.pageEnterFrom="google",i.statusEnterFrom="google"),o===Y.Y.googleOneTabAutoSelect&&(i.pageEnterFrom="google_auto",i.statusEnterFrom="google_auto"),a&&(i.currentPage=a),{type:"SIGN_IN_SUCCESS",params:i,extra:r}}))]},fail:{entry:(0,E.T4)((({name:e,source:t,errorCode:o,errorMsg:a,authType:n,currentPage:r})=>{const i={source:t,type:e,errorCode:o,errorMsg:a};return n===Y.Y.googleOneTab&&(i.pageEnterFrom="google",i.statusEnterFrom="google"),n===Y.Y.googleOneTabAutoSelect&&(i.pageEnterFrom="google_auto",i.statusEnterFrom="google_auto"),r&&(i.currentPage=r),{type:"SIGN_IN_FAIL",params:i}}))}},on:{AUTH:{target:"authorizing",internal:!1,actions:["clearStatus","updateName","updateSource","updateAuthType","updateCurrentPage","updateScanCodeParams","setCallback"]},AUTH_SUCCESS:{target:"success",actions:["clearStatus"]},AUTH_FAIL:{target:"fail",actions:["clearStatus"]},UPDATE_ERROR:{actions:["updateError"]},REPORT_SIGN_IN_ACTION:{actions:(0,E.T4)(((e,t)=>({type:"SIGN_IN_ACTION",params:{source:t.source??e.source,action:t.action}})))},INVOKE_CALLBACK:{actions:["invokeCallback"]},CHANGE_CONTEXT:{actions:["changeContext"]},INIT_LOGIN_SUCCESS_CB:{actions:"initLoginSuccessCb"},UPDATE_GOOGLE_ONE_TAP:{actions:["updateGoogleOneTap"]},UPDATE_GOOGLE_SIGNIN_BTN:{actions:["updateGoogleSignInBtn"]}}},{services:{listeningStateChange:({showRestoreModal:e,passport:t,currentPage:o})=>a=>function(e){function t(t){if(t.key!==Y.a0)return;const o=t.newValue;"string"==typeof o&&e(o)}function o(t){e(t.status,t.extraData)}return window.addEventListener("storage",t),Qa.on(Xa,o),()=>{window.removeEventListener("storage",t),Qa.off(Xa,o)}}(((n,r)=>{const i=d.a.getString(Y.a1)??void 0,s=d.a.getString(Y.a2)??void 0,l=d.a.getString(Y.a3)??void 0;if(a({type:"INVOKE_CALLBACK",errorCode:i,errorMsg:s}),n===Y.a8.Fail&&a({type:"UPDATE_ERROR",errorCode:i,errorMsg:s}),n===Y.a8.Success){const e=d.a.getJson(Y.a4);null!=r&&r.isFromGoogleOneTap&&a({type:"UPDATE_GOOGLE_ONE_TAP",data:{isGoogleOneTapAutoSelect:null==r?void 0:r.isGoogleOneTapAutoSelect}}),null!=r&&r.isFromGoogleSignInBtn&&a({type:"UPDATE_GOOGLE_SIGNIN_BTN"}),a({type:"AUTH_SUCCESS",data:r||e})}else l&&i&&parseInt(i)===d.E.SIGN_UP_CODE.LOGIN_ERROR_CODE.USER_ACCOUNT_CANCEL?(Za.report({action:"show",current_page:o||"login"}),null==e||e({onOk:async()=>{var e;await(null==(e=await t())?void 0:e.cancelLogin(l,1).then((()=>{const e=d.a.getJson(Y.a4);a({type:"AUTH_SUCCESS",data:r||e})})))},onCancel:()=>{a({type:"AUTH_FAIL"})},currentPage:o||"login"})):a({type:"AUTH_FAIL"})})),thirdPartAuth:async({isBOE:e,passport:t,isInvitePage:o,invitedCode:a,source:n,scanCodeParams:r},i)=>{const{platform:s}=i,l=await t(),c=new URL(window.location.href),u=s===Y.Z.TikTok||e&&s===Y.$.TikTok||s===Y.Z.TikTokLive||e&&s===Y.$.TikTokLive,p=s===Y.Z.ScanCode||e&&s===Y.$.ScanCode;u?function(e,t){const o=Math.random().toString(36).substring(2),a=(window.screen.height-30-600)/2,n=(window.screen.width-800)/2;d.a.setString(Y.a5,o);const r=new URLSearchParams;if(null!=t&&t.isInvitePage&&r.set("invite_code",(null==t?void 0:t.invitedCode)||""),null!=t&&t.isTTLive){const e=new URL(window.location.href);[h.S.UTM_MEDIUM,h.S.UTM_SOURCE,h.S.OPEN_ID,h.S.VID,"jump_action"].forEach((t=>{const o=e.searchParams.getAll(t);null!=o&&o.length&&o.forEach((e=>r.append(t,e)))}))}const i=JSON.stringify({csrfState:o,query:r.toString()}),s=`${location.origin}${d.R.TIKTOK_AUTH.PATH}/`,l=`${Y.a6}?client_key=${e?Y.T:Y.e}&scope=${Y.a7.TikTok}${null!=t&&t.isTTLive?`,${Y.a7.TikTokLive}`:""}&response_type=code&redirect_uri=${encodeURIComponent(s)}&state=${encodeURIComponent(i)}`;null!=t&&t.isTTLive?window.open(l,"_self"):window.open(l,"name=login",`fullscreen=1,width=800,height=600,top=${a},left=${n}`)}(e,{isInvitePage:o,invitedCode:a,isTTLive:c.searchParams.get(h.S.UTM_MEDIUM)===h.U.TIKTOK_LIVE}):p?null==l||l.scanLoginWithWindow(n===ta.LoginIn?"login":"sign_up",r):s&&(null==l||l.signinWithWindow(s,{isInvitePage:o,invitedCode:a}))}},actions:{clearStatus:()=>{d.a.removeItem(Y.a0),d.a.removeItem(Y.a1),d.a.removeItem(Y.a2),d.a.removeItem(Y.a3),d.a.removeItem(Y.a4),d.a.removeItem(Y.a5)},updateName:(0,E.kp)({name:(e,t)=>t.name}),updateSource:(0,E.kp)({source:(e,t)=>t.source}),updateAuthType:(0,E.kp)({authType:(e,t)=>t.authType}),updateCurrentPage:(0,E.kp)({currentPage:({currentPage:e},t)=>(null==t?void 0:t.currentPage)??e}),updateError:(0,E.kp)({errorCode:(e,t)=>t.errorCode,errorMsg:(e,t)=>t.errorMsg}),setCallback:(0,E.kp)({callback:(e,t)=>t.callback}),invokeCallback:(0,E.kp)((({callback:e},t)=>{const{errorCode:o,errorMsg:a}=t;return null==e||e({errorCode:o,errorMsg:a}),{callback:void 0}})),changeContext:(0,E.kp)(((e,t)=>({...e,...t.context}))),invokeGoogleOneTapFunc:({passport:e,isBOE:t,currentPage:o,showRestoreModal:a})=>{const n=window.googleOneTapLogMomentResults,r=(null==n?void 0:n.length)??0;for(let i=0;i<r;i++)en(o);tn(o||""),on(e,o,t,a)},injectGoogleOneTapFunc:({passport:e,isBOE:t,currentPage:o,showRestoreModal:a})=>{window.handleGoogleOneTapMoment=()=>{en(o),tn(o||"")},window.handleGoogleOneTapResult=()=>{on(e,o,t,a)}},invokeSignInWithGoogleBtnFunc:({passport:e,isBOE:t,showRestoreModal:o,currentPage:a})=>{an(e,t,o,a)},injectSignInWithGoogleBtnFunc:({passport:e,isBOE:t,showRestoreModal:o,currentPage:a})=>{window.handleSignInWithGoogleBtnResult=()=>{an(e,t,o,a)}},initLoginSuccessCb:(0,E.kp)({loginSuccessCb:(e,t)=>t.func}),notifySignSuccess:e=>{var t;const o=(0,h.c)("state"),a=(0,h.c)(h.S.UTM_CAMPAIGN),n=(null==o?void 0:o.length)&&"googledrive"===a;null==(t=null==e?void 0:e.loginSuccessCb)||t.call(e,n?"google_drive":void 0)},updateGoogleOneTap:(0,E.kp)({source:e=>ta.LoginIn,authType:(e,t)=>{var o;return null!=(o=null==t?void 0:t.data)&&o.isGoogleOneTapAutoSelect?Y.Y.googleOneTabAutoSelect:Y.Y.googleOneTab},name:e=>"google"}),updateGoogleSignInBtn:(0,E.kp)({source:e=>ta.LoginIn,authType:e=>Y.Y.googleSignInBtn,name:e=>"google"}),updateScanCodeParams:(0,E.kp)({scanCodeParams:(e,t)=>t.scanCodeParams})}}),rn=(0,I.O)({id:"LvUserInviteMachine",context:{isInvitePage:!1,invitedCode:"",inviteDetail:{}},initial:"unknow",states:{unknow:{invoke:{id:"fetchInviteInfo",src:"fetchInviteInfo",onDone:[{target:"ready",actions:["saveInviteDetail"]}],onError:[{target:"error"}]}},ready:{type:"final"},error:{type:"final"}}},{services:{async fetchInviteInfo({isInvitePage:e,invitedCode:t}){if(!t||!e)throw new Error("no invite code");const o=await _o.getInviteInfo({invite_code:t});return{inviterName:o.data.inviter_name,invitedSpaceCap:o.data.invited_space_cap,invitedSpaceTime:o.data.invited_space_time,rewardType:o.data.reward_type,inviterImg:o.data.inviter_img}}},actions:{saveInviteDetail:(0,E.kp)({inviteDetail:({inviteDetail:e},t)=>({...e,...t.data})})}}),sn=(0,I.O)({id:"userCareer",initial:"checkingCareer",context:{userInfo:void 0,noCareerCb:()=>null,userFinishCareerCb:()=>{},shouldShowCareerModal:!1,questionList:[],answers:[],questionCount:0,question:{},answer:[],modal:null,alreadyShowModal:!1,chooseProfessionShowReporter:new class{constructor(){bt(this,"reporter",(0,u.r)())}report(e){this.reporter.report("choose_profession_show",e)}},chooseProfessionConfirmReporter:new class{constructor(){bt(this,"reporter",(0,u.r)())}report(e){this.reporter.report("choose_profession_confirm",e)}},reporterParams:{}},states:{checkingCareer:{id:"checkingCareer",invoke:{id:"checkCareer",src:"checkCareer",onDone:"hasCareer",onError:"noCareer"}},noCareer:{initial:"fetching",states:{fetching:{invoke:{id:"fetchQuestionnaire",src:"fetchQuestionnaire",onDone:{target:"answering",actions:["updateQuestionList","updateQuestion"]},onError:{target:"unknownError"}}},answering:{invoke:{id:"showCareerModal",src:"showCareerModal",onDone:{actions:["updateModal","reportQuestionShow","setAlreadyShowModal"],cond:"isNotShowModal"}},on:{CHECK:{actions:["checkAnswer","reportCheck"]},BACK:{actions:["popAnswer","reportBack","updateQuestion","reportQuestionShow"]},NEXT:{actions:["pushAnswer","reportNext","updateQuestion","reportQuestionShow"]},SUBMIT:{target:"submitting",actions:["setOnSubmitError","reportSubmit","reportChooseCareer"]},INPUT:{actions:["inputAnswer"]},SKIP:{target:"skipped",actions:["setOnSkipError","reportSkip"]}}},submitting:{invoke:{id:"submit",src:"submit",onDone:{target:"#userCareer.hasCareer",actions:["updateCareer","notifyUserCareer","triggerUserFinishCareerCb"]},onError:{target:"answering",actions:["handleSubmitError"]}}},unknownError:{},skipped:{entry:["notifyUserCareerSkipped"],invoke:{id:"skip",src:"skip",onDone:{target:"#userCareer.hasCareer",actions:["updateSkippedCareer","notifyUserCareer"]},onError:{actions:["handleSkipError"]}}}}},hasCareer:{type:"final",entry:["stopEmailSignInActor"]}},on:{SET_NO_CAREER_CB:{actions:["setNoCareerCb"]}}},{services:{async checkCareer({shouldShowCareerModal:e,userInfo:t}){if((null==t||!t.career)&&e)throw new Error("no career")},async showCareerModal(e){var t;if(!e.alreadyShowModal)return null==(t=e.noCareerCb)?void 0:t.call(e)},async fetchQuestionnaire(){return ko.getCareerQuestionnaire()},async submit({answers:e,question:t,answer:o,modal:a}){const n=e.map((e=>({key:e.key,title:e.title,answer_list:e.answer_list.map((t=>({key:t.key,text:"q2a8"===t.key?t.text+e.other_input:t.text,text_starling:t.text_starling})))})));return n.push({key:t.key,title:t.title,answer_list:t.answer_list.filter((e=>o.find((t=>t===e.key)))).map((e=>({key:e.key,text:e.text,text_starling:e.text_starling})))}),null==a||a.close(),ko.submitCareerQuestionnaire({question_list:n})},async skip({answers:e,modal:t}){null==t||t.close();const o=e.map((e=>({key:e.key,title:e.title,answer_list:e.answer_list.map((e=>({key:e.key,text:e.text,text_starling:e.text_starling})))})));return ko.submitCareerQuestionnaire({question_list:0===o.length?null:o})}},actions:{setNoCareerCb:(0,E.kp)({noCareerCb:(e,t)=>t.callback}),updateCareer:(0,E.kp)({userInfo:({answers:e,userInfo:t})=>{var o,a,n;return{...t,career:null==(n=null==(a=null==(o=null==e?void 0:e[0])?void 0:o.answer_list)?void 0:a[0])?void 0:n.text_starling}}}),updateSkippedCareer:(0,E.kp)({userInfo:({answers:e,userInfo:t})=>{var o,a,n;return{...t,career:(null==(n=null==(a=null==(o=null==e?void 0:e[0])?void 0:o.answer_list)?void 0:a[0])?void 0:n.text_starling)??"skip"}}}),notifyUserCareer:(0,E.T4)((e=>{var t;return{type:"UPDATE_USER_CAREER",userInfo:{career:null==(t=e.userInfo)?void 0:t.career}}})),triggerUserFinishCareerCb:({userFinishCareerCb:e})=>null==e?void 0:e(),notifyUserCareerSkipped:(0,E.T4)((()=>({type:"UPDATE_USER_CAREER_SKIPPED",skipped:!0}))),updateQuestionList:(0,E.kp)({questionList:(e,t)=>t.data.question_list,questionCount:(e,t)=>t.data.question_count}),updateQuestion:(0,E.kp)({question:({questionList:e,answers:t})=>{const o=t.reduce(((e,t)=>(t.answer_list.forEach((t=>{e.add(t.key)})),e)),new Set);return e.find((e=>{var a,n,r,i,s,l,c;const d="or"===(null==(n=null==(a=e.depend_on)?void 0:a[0])?void 0:n.type)?null==(i=null==(r=e.depend_on)?void 0:r[0])?void 0:i.answer_list.some((e=>o.has(e))):null==(l=null==(s=e.depend_on)?void 0:s[0])?void 0:l.answer_list.every((e=>o.has(e)));return e.position===t.length+1&&(null==(c=e.depend_on)||!c.length||d)}))}}),checkAnswer:(0,E.kp)({answer:({question:e,answer:t},o)=>{const{key:a}=o;return"single"===e.type?t.find((e=>e===a))?[]:[a]:t.find((e=>e===a))?t.filter((e=>e!==a)):[...t,a]}}),inputAnswer:(0,E.kp)({question:({question:e},t)=>{const{value:o}=t;return e.other_input=o,e}}),popAnswer:(0,E.kp)({answers:({answers:e})=>{const t=[...e];return t.pop(),t},answer:e=>[]}),pushAnswer:(0,E.kp)({answers:({question:e,answers:t,answer:o})=>[...t,{...e,answer_list:e.answer_list.filter((e=>o.find((t=>t===e.key))))}],answer:e=>[]}),updateModal:(0,E.kp)({modal:(e,t)=>t.data}),setAlreadyShowModal:(0,E.kp)({alreadyShowModal:e=>!0}),setOnSubmitError:(0,E.kp)({onSubmitError:(e,t)=>t.onError}),setOnSkipError:(0,E.kp)({onSkipError:(e,t)=>t.onError}),handleSubmitError:({onSubmitError:e})=>{null==e||e()},handleSkipError:({onSkipError:e})=>{null==e||e()},reportChooseCareer:({userInfo:e,question:t,answers:o,answer:a,chooseProfessionConfirmReporter:n,reporterParams:r})=>{var i,s,l,c,d,u;const p=null!=e&&e.uid?parseInt(e.uid.slice(-2)):null,_=!p||p>20;null==n||n.report({current_page:(null==r?void 0:r.currentPage)??"",role:(null==(l=null==(s=null==(i=o.find((e=>"role"===e.question_type)))?void 0:i.answer_list)?void 0:s[0])?void 0:l.text_starling)??"",target:(null==(u=null==(d=null==(c=o.find((e=>"target"===e.question_type)))?void 0:c.answer_list)?void 0:d.map((e=>e.text_starling)))?void 0:u.join(","))??"",preference:t.answer_list.filter((e=>a.find((t=>t===e.key)))).map((e=>e.text_starling)).join(",")??"",type:"confirm",is_mapping_test:_?"0":"1"})},reportQuestionShow:({question:e,chooseProfessionShowReporter:t,reporterParams:o})=>{null==t||t.report({current_page:(null==o?void 0:o.currentPage)??"",popup_type:e.question_type,action:"show"})},reportBack:e=>{const{question:t,chooseProfessionShowReporter:o,reporterParams:a}=e;null==o||o.report({current_page:(null==a?void 0:a.currentPage)??"",popup_type:t.question_type,action:"back"})},reportNext:e=>{const{question:t,chooseProfessionShowReporter:o,reporterParams:a}=e;null==o||o.report({current_page:(null==a?void 0:a.currentPage)??"",popup_type:t.question_type,action:"next"})},reportSubmit:({question:e,chooseProfessionShowReporter:t,reporterParams:o})=>{null==t||t.report({current_page:(null==o?void 0:o.currentPage)??"",popup_type:e.question_type,action:"submit"})},reportCheck:({question:e,chooseProfessionShowReporter:t,reporterParams:o},a)=>{null==t||t.report({current_page:(null==o?void 0:o.currentPage)??"",popup_type:e.question_type,action:a.text})},reportSkip:({question:e,answers:t,chooseProfessionShowReporter:o,chooseProfessionConfirmReporter:a,reporterParams:n})=>{var r,i,s,l,c,d;null==o||o.report({current_page:(null==n?void 0:n.currentPage)??"",popup_type:e.question_type,action:"skip"}),null==a||a.report({current_page:(null==n?void 0:n.currentPage)??"",role:(null==(s=null==(i=null==(r=t.find((e=>"role"===e.question_type)))?void 0:r.answer_list)?void 0:i[0])?void 0:s.text_starling)??"skip",target:(null==(d=null==(c=null==(l=t.find((e=>"target"===e.question_type)))?void 0:l.answer_list)?void 0:c.map((e=>e.text_starling)))?void 0:d.join(","))??"skip",preference:"skip",type:"skip"})}},guards:{isNotShowModal:({alreadyShowModal:e})=>!e}});let ln={};const cn=(0,I.O)({id:"userWorkspace",initial:"unknown",context:{asyncFuncExecsRef:void 0,userInfo:void 0,getWorkspaceListSuccess:!1,workspaceList:[],currentWorkspaceInfo:void 0,workspaceExpandInfoMap:{},changeWorkspaceEventCache:"",updateWorkspaceEventCache:[],initWorkspaceCb:()=>{},changeWorkspaceCb:()=>{},initUserAndWorkspaceCb:()=>{},storageChangeWorkspaceCb:()=>{},refreshWorkspaceListCb:()=>{},beforeChangeWorkspaceCb:()=>Promise.resolve(),updateWorkspaceErrorCb:()=>{}},entry:["initAsyncFuncExecRef","notifyInitUserAndWorkspaceCb"],states:{unknown:{always:[{target:"gettingWorkspaceInfo"}]},gettingWorkspaceInfo:{id:"gettingWorkspaceInfo",invoke:{id:"fetchWorkspaceList",src:"fetchWorkspaceList",onDone:[{target:"hasWorkspaceInfo",actions:["updateWorkspaceList","initCurrentWorkspace","fetchWorkspaceListSuccess","notifyInitCurrentWorkspace","updateGetWorkspaceListSuccess","notifyInitUserAndWorkspaceCb","notifyRefreshWorkspace","consumeUpdateWorkspaceEventCache","notifyWorkspaceDataChange"],cond:"hasNotInitWorkspaceInfo"},{target:"hasWorkspaceInfo",actions:["updateWorkspaceList","updateCurrentWorkspace","fetchWorkspaceListSuccess","notifyRefreshWorkspace","consumeUpdateWorkspaceEventCache","notifyWorkspaceDataChange"],cond:"hasInitWorkspaceInfo"}],onError:{actions:["fetchWorkspaceListFail"],target:"noWorkspaceInfo"}}},hasWorkspaceInfo:{tags:["finished"]},noWorkspaceInfo:{tags:["finished"]}},on:{CHANGE_CONTEXT:{actions:["changeContext"]},REFRESH_WORKSPACE_LIST:{target:"#gettingWorkspaceInfo"},CHANGE_WORKSPACE:{actions:["checkChangeWorkspace"]},CHANGE_WORKSPACE_AFTER_CHECKING:{actions:["changeWorkspace","notifyChangeWorkspace","notifyWorkspaceDataChange"]},CHANGE_WORKSPACE_ERROR:{actions:["changeWorkspaceError"]},STORAGE_CHANGE_WORKSPACE:{actions:["storageChangeWorkspace"]},UPDATE_WORKSPACE:{actions:["fetchSpecificWorkspaceInfo"]},FETCH_SPECIFIC_WORKSPACE_DONE:{actions:["updateSpecificWorkspaceInfo","notifyWorkspaceDataChange","notifyRefreshWorkspace"]},FETCH_SPECIFIC_WORKSPACE_ERROR:{actions:["updateSpecificWorkspaceInfoError"]},NOTIFY_WORKSPACE_CHANGE:[{target:"#gettingWorkspaceInfo",cond:"notifyLeaveWorkspace"},{actions:["roleChange","notifyWorkspaceDataChange","notifyRefreshWorkspace"],cond:"notifyRoleChange"},{target:"#gettingWorkspaceInfo",cond:"notifyNewMember"}]}},{services:{async fetchWorkspaceList(e,t){let o=[];const a=function(){try{const e=typeof __userWorkspaces<"u"?JSON.parse(__userWorkspaces):void 0;return e&&"0"===e.ret?e.data:void 0}catch{return}}(),n=async e=>{const{data:t}=await go.getUserWorkSpace({cursor:e,count:100,need_convert_workspace:!0});o=[...o,...t.workspace_infos],t.has_more&&await n(t.next_cursor)};return"REFRESH_WORKSPACE_LIST"!==t.type&&a&&(0,De.A)(null==a?void 0:a.workspace_infos)?(o=[...a.workspace_infos],null!=a&&a.has_more&&await n(null==a?void 0:a.next_cursor)):await n("0"),"REFRESH_WORKSPACE_LIST"===t.type&&t.callback?{workspaceList:null==o?void 0:o.map((e=>({...e,dcName:(0,Y.E)(e.region)}))),callback:t.callback}:{workspaceList:null==o?void 0:o.map((e=>({...e,dcName:(0,Y.E)(e.region)})))}}},actions:{changeContext:(0,E.kp)(((e,t)=>({...e,...t.context}))),initAsyncFuncExecRef:(0,E.kp)({asyncFuncExecsRef:()=>(0,T.cH)(u.L)}),updateWorkspaceList:(0,E.kp)({workspaceList:(e,t)=>t.data.workspaceList}),checkChangeWorkspace:(0,E.tN)(((e,{data:t})=>({type:"ADD_TASK",exec:async()=>(await e.beforeChangeWorkspaceCb(),t),successType:"CHANGE_WORKSPACE_AFTER_CHECKING",failType:"CHANGE_WORKSPACE_ERROR"})),{to:e=>e.asyncFuncExecsRef}),initCurrentWorkspace:(0,E.kp)((e=>{var t,o;let a;return a=e.changeWorkspaceEventCache?null==(t=null==e?void 0:e.workspaceList)?void 0:t.find((t=>t.workspace_id===e.changeWorkspaceEventCache)):null==(o=null==e?void 0:e.workspaceList)?void 0:o.find((t=>{var o,a,n,r;return t.workspace_id===((null==(a=null==(o=e.userInfo)?void 0:o.defaultSpaceInfo)?void 0:a.workspaceId)||(null==(r=null==(n=e.userInfo)?void 0:n.spaceInfo)?void 0:r.workspaceId))})),{currentWorkspaceInfo:a,changeWorkspaceEventCache:""}})),fetchWorkspaceListSuccess:(e,t)=>{var o,a;null==(a=null==(o=t.data)?void 0:o.callback)||a.call(o)},notifyInitCurrentWorkspace:e=>{e.currentWorkspaceInfo&&e.initWorkspaceCb(e.currentWorkspaceInfo)},updateGetWorkspaceListSuccess:(0,E.kp)({getWorkspaceListSuccess:()=>!0}),notifyInitUserAndWorkspaceCb:e=>{var t;e.getWorkspaceListSuccess&&(null==(t=null==e?void 0:e.initUserAndWorkspaceCb)||t.call(e,{userInfo:e.userInfo,workspaceList:e.workspaceList}))},notifyRefreshWorkspace:e=>{var t;null!=e&&e.workspaceList&&(null==(t=null==e?void 0:e.refreshWorkspaceListCb)||t.call(e,e.workspaceList,e))},notifyWorkspaceDataChange:(0,E.T4)((e=>({type:"UPDATE_WORKSPACE_DATA_FROM_CHILD",workspaceList:e.workspaceList,currentWorkspaceInfo:e.currentWorkspaceInfo,workspaceExpandInfoMap:e.workspaceExpandInfoMap}))),consumeUpdateWorkspaceEventCache:P.LM((e=>{let t=[];return Array.isArray(e.updateWorkspaceEventCache)&&(t=e.updateWorkspaceEventCache.map((e=>(0,E.tN)({type:"UPDATE_WORKSPACE",workspaceId:e}))),t.push((0,E.kp)({updateWorkspaceEventCache:[]}))),t})),updateCurrentWorkspace:(0,E.kp)((e=>{var t,o;const a=null==(t=e.currentWorkspaceInfo)?void 0:t.workspace_id;return{currentWorkspaceInfo:null==(o=null==e?void 0:e.workspaceList)?void 0:o.find((e=>e.workspace_id===a))}})),changeWorkspace:(0,E.kp)(((e,{data:t,extInfo:o})=>{var a,n,r;return(null==(a=e.currentWorkspaceInfo)?void 0:a.workspace_id)===t.workspace_id?{}:{currentWorkspaceInfo:null==(n=null==e?void 0:e.workspaceList)?void 0:n.find((e=>e.workspace_id===t.workspace_id)),workspace_enter_from:null==(r=null==o?void 0:o.data)?void 0:r.workspace_enter_from}})),notifyChangeWorkspace:e=>{var t;e.currentWorkspaceInfo&&(null==(t=e.changeWorkspaceCb)||t.call(e,e.currentWorkspaceInfo,{userInfo:e.userInfo}))},changeWorkspaceError(){console.error("stop changing workspace!")},storageChangeWorkspace(e,{data:t}){e.storageChangeWorkspaceCb(t.workspace_id)},fetchSpecificWorkspaceInfo:(0,E.tN)(((e,{workspaceId:t})=>({type:"ADD_TASK",exec:async()=>{const[e,{data:o}]=await Promise.all([Yt.getSpaceList(t),go.mGetWorkspaceInfo({workspace_ids:[t]})]);ln={...ln,[t]:e};const a=o.workspace_infos[0];return{workspace_id:t,workspace_info:{...a,dcName:(0,Y.E)(a.region)},workspaceExpandInfoMap:{...ln}}},successType:"FETCH_SPECIFIC_WORKSPACE_DONE",failType:"FETCH_SPECIFIC_WORKSPACE_ERROR"})),{to:e=>e.asyncFuncExecsRef}),updateSpecificWorkspaceInfo:(0,E.kp)({workspaceList:(e,t)=>{var o;const{data:a}=t,{workspace_info:n}=a;if(n){const t=n;return null==(o=null==e?void 0:e.workspaceList)?void 0:o.map((e=>e.workspace_id===t.workspace_id?t:e))}return e.workspaceList},currentWorkspaceInfo:(e,t)=>{var o;const{data:a}=t,{workspace_info:n}=a;if(n){const t=n;if(t.workspace_id===(null==(o=e.currentWorkspaceInfo)?void 0:o.workspace_id))return t}return e.currentWorkspaceInfo},workspaceExpandInfoMap:(e,t)=>{const{data:o}=t;return o.workspaceExpandInfoMap??e.workspaceExpandInfoMap}}),updateSpecificWorkspaceInfoError:(e,t)=>{const{data:o}=t;e.updateWorkspaceErrorCb&&e.updateWorkspaceErrorCb(o.workspace_id)},roleChange:(0,E.kp)({workspaceList:(e,t)=>{var o,a;const{notifyData:n}=t,{workspace_id:r,new_role:i,uid:s}=n;return String(s)!==(null==(o=e.userInfo)?void 0:o.uid)?e.workspaceList:null==(a=e.workspaceList)?void 0:a.map((e=>e.workspace_id===r?{...e,role:i}:e))},currentWorkspaceInfo:(e,t)=>{var o,a;const{notifyData:n}=t,{workspace_id:r,new_role:i,uid:s}=n;return String(s)!==(null==(o=e.userInfo)?void 0:o.uid)?e.currentWorkspaceInfo:(null==(a=e.currentWorkspaceInfo)?void 0:a.workspace_id)===r?{...e.currentWorkspaceInfo,role:i}:e.currentWorkspaceInfo}})},guards:{hasInitWorkspaceInfo:e=>!(!e.currentWorkspaceInfo||!e.currentWorkspaceInfo.workspace_id),hasNotInitWorkspaceInfo:e=>!(e.currentWorkspaceInfo&&e.currentWorkspaceInfo.workspace_id),notifyLeaveWorkspace:(e,t)=>{const{notifyData:o}=t;return o.method===Y.a9.leaveWorkspace},notifyRoleChange:(e,t)=>{const{notifyData:o}=t;return o.method===Y.a9.roleChange},notifyNewMember:(e,t)=>{const{notifyData:o}=t;return o.method===Y.a9.newMember}}}),dn="__lvweb_user_status",un=(0,I.O)({id:"userStatusListener",initial:"listened",context:{uid:"",enableShowModal:!0,enableBlockRequestWhenDestroy:!0,enableClearBeforeUnload:!0},states:{listened:{entry:"setLocalStorageByDefault",invoke:[{id:"listenUserStatusByLocalStorage",src:"listenUserStatusByLocalStorage"},{id:"listenUserStatusWhenBlur",src:"listenUserStatusWhenBlur"}],on:{USER_HAS_LOGOUT:{target:"destroy",actions:["showModal","sendParentEvent"]},SIGN_OUT:{target:"destroy",actions:"notifySignOutByLocalStorage"}}},destroy:{entry:"tryToClearAllEffect"}}},{services:{listenUserStatusByLocalStorage:e=>t=>{const o=o=>{if(o.key===dn){const o=d.a.getJson(dn);(null==o?void 0:o.uid)!==e.uid&&t({type:"USER_HAS_LOGOUT"})}};return window.addEventListener("storage",o),()=>{window.removeEventListener("storage",o)}},listenUserStatusWhenBlur:e=>t=>{const o=()=>{if("visible"!==document.visibilityState){const o=d.a.getJson(dn);o&&o.uid!==e.uid&&t({type:"USER_HAS_LOGOUT"})}};return document.addEventListener("visibilitychange",o),()=>{document.removeEventListener("visibilitychange",o)}}},actions:{setLocalStorageByDefault:e=>{d.a.setJson(dn,{uid:e.uid,timestamp:Date.now()})},notifySignOutByLocalStorage:()=>{d.a.setJson(dn,{uid:"",timestamp:Date.now()})},showModal:e=>{e.enableShowModal&&y.A.error({alignCenter:!1,escToExit:!1,backspaceToExit:!1,maskClosable:!1,closeIcon:null,title:c.Ay.t("web_account_logout_title_error",{},"Account was changed"),content:c.Ay.t("web_account_logout_error",{},"Current login account has encountered an error, please refresh the page and try again."),okText:c.Ay.t("web_graphic_server_failure_refresh_page_btn",{},"Refresh"),onOk:()=>{window.location.reload()}})},sendParentEvent:(0,E.T4)({type:"USER_HAS_LOGOUT"}),tryToClearAllEffect:e=>{typeof window<"u"&&e.enableBlockRequestWhenDestroy&&(window.XMLHttpRequest.prototype.open=(e,t)=>{console.warn(`current page failure, stop all request:${e}:${t}`)}),typeof window<"u"&&e.enableClearBeforeUnload&&(window.onbeforeunload=()=>null)}}}),pn=({title:e,content:t,okText:o,onConfirm:a})=>(0,n.jsxs)("div",{className:"age-gate-mobile-dialog",children:[(0,n.jsx)("div",{className:"mask"}),(0,n.jsx)("div",{className:"modal-wrapper",children:(0,n.jsxs)("div",{className:"modal-content-wrapper",children:[(0,n.jsx)("div",{className:"modal-title",children:e}),(0,n.jsx)("div",{className:"modal-content",children:t}),(0,n.jsx)(k.A,{type:"primary",className:"modal-confirm",onClick:a,children:o})]})})]});const _n={open:function(e){let t=document.createElement("div");document.body.appendChild(t);const o=()=>{t&&(Le.unmountComponentAtNode(t),t=null)};return Le.render((0,n.jsx)(pn,{...e,onConfirm:()=>{var t;null==(t=e.onConfirm)||t.call(e),o()}}),t),{close:o}}};class hn{constructor(){bt(this,"LOCAL_STORE_PREFIX_KEY","quebec_age_gate_notification"),bt(this,"unbinds",[]),bt(this,"disablePaths",[/^(?:\/((?:[^\/#\?]+?)(?:\/(?:[^\/#\?]+?))*))?\/birthday-information[\/#\?]?$/i]),bt(this,"uid",""),bt(this,"verfiy_ticket",""),bt(this,"submitAppealTag",(e=>(0,n.jsx)("a",{type:"text",href:`/appeal-age-restriction?uid=${this.uid}&verify_ticket=${this.verfiy_ticket}`,target:"_self",children:e})))}isQuebec(){try{return!!window.ip_location_info.Subdivisions.find((e=>6115047===e.GeoNameID))}catch{return!1}}checkShowNoticePath(){try{const e=window.location.pathname;return!this.disablePaths.some((t=>t.test(e)))}catch{return!1}}start(e){if(this.checkShowNoticePath())if(null!=e&&e.verifyTicket){if(this.verfiy_ticket=null==e?void 0:e.verifyTicket,1091===(null==e?void 0:e.errorCode)&&this.shouldShowForbiddenPopup())return void this.renderForbiddenNotice()}else if(this.isUnder14()&&this.shouldShowNoticePopup())return void this.renderCountdownNotice()}isUS(){try{return"US"===window.__locationCountryCode}catch{return!1}}getUserInfo(){var e;try{const t=JSON.parse(window.__userInfoStringify??"");return this.uid=null==(e=t.data.user_info)?void 0:e.user_id,t.data.user_info}catch{return null}}destroy(){this.unbinds.forEach((e=>e()))}isUnder14(){try{const e=this.getUserInfo();if(!e)return!1;if(!e.has_birthday&&this.isQuebec()){const e=window.location.href,t=`${d.R.FILL_BIRTHDAY.PATH}?redirect_url=${encodeURIComponent(e)}`;return void(window.location.href=t)}return(2===e.ban_status||1===e.ban_status)&&e.ban_time}catch{return!1}}getFinalTimestamp(){var e;return 1e3*Number(null==(e=this.getUserInfo())?void 0:e.ban_time)}getRecord(){const e={thirty:0,seven:0,three:0,two:0,one:0,zero:0};try{const t=this.getUniqId();if(t&&typeof window<"u"){const o=d.a.getString(`${this.LOCAL_STORE_PREFIX_KEY}_${t}`);return o?JSON.parse(o):e}return e}catch{return e}}saveRecord(e){const t=this.getUniqId();t&&typeof window<"u"&&d.a&&d.a.setString(`${this.LOCAL_STORE_PREFIX_KEY}_${t}`,JSON.stringify(e))}getUniqId(){let e=window.GATEWAY_INJECTED_WEB_ID||"";if(!e){const t=document.cookie.match(new RegExp("(^| )_tea_web_id=([^;]+)"));null!==t&&(e=t[2])}return e}getDaysLeft(){const e=this.getFinalTimestamp()-Date.now();if(e<=0)return"zero";const t=Math.ceil(e/864e5);return t>30?"none":t<=30&&t>7?"thirty":t>3?"seven":t>2?"three":t>1?"two":t>0?"one":"zero"}refreshRecord(){const e=this.getRecord();e[this.getDaysLeft()]=1,this.saveRecord(e)}shouldShowNoticePopup(){const e=this.getDaysLeft(),t=this.getRecord();return"zero"!==e&&0===(null==t?void 0:t[e])}shouldShowForbiddenPopup(){return"zero"===this.getDaysLeft()}async waitForI18nInit(e=0,t=9){e!==t&&(c.Ay.i18nInstance.instance.isInitialized||await new Promise((t=>{setTimeout((async()=>{await this.waitForI18nInit(++e),t()}),1e3)})))}async renderCountdownNotice(){await this.waitForI18nInit();const e=this.getFinalTimestamp();if(!e)return;const{env:t}=(0,Y.v)(),o=se()(e).format("MM/DD/YYYY"),a=se()(e+97632e5).format("MM/DD/YYYY");console.log("appealDate",a);const r=c.Ay.t("web_quebec_users_tiitle_your_account_will_be_removed",{date:o},"Your account will be removed on {date} because you'll no longer meet the age requirements to use CapCut in your region."),i=c.Ay.t("web_quebec_users_text_you_can_submit_appeal_beface",{"text-href":this.submitAppealTag,date:a},"You can <text-href>submit an appeal</text-href> before {date}."),s=c.Ay.t("web_quebec_users_text_your_account_will_be_removed",{date:o},"Your account will be removed on {date}"),l=(0,n.jsxs)("div",{className:"quebec-content",children:[r,i]}),d=c.Ay.t("web_quebec_users_button_get_it_one",{},"Got it"),u="pc"===t?y.A.warning({title:s,content:l,maskClosable:!1,escToExit:!1,backspaceToExit:!1,okText:d,onConfirm:()=>this.refreshRecord(),style:{width:500}}):_n.open({title:s,content:l,okText:d,onConfirm:()=>this.refreshRecord()});this.unbinds.push((()=>{u.close()}))}goAppealPage(){this.refreshRecord(),window.open((0,h.n)("/appeal-age-restriction",{uid:this.uid,verify_ticket:this.verfiy_ticket,scene_block_scene:this.isUS()?"us13_young_block":""}),"_self")}async renderForbiddenNotice(){await this.waitForI18nInit();const{env:e}=(0,Y.v)(),t=c.Ay.t("web_quebec_users_text_your_account_removed_becaue_you",{},"Your account has been removed because you no longer meet the age requirement to use CapCut in your region."),o=c.Ay.t("web_quebec_users_button_appel_age_restriction",{"text-href":this.submitAppealTag},"<text-href>Appel age restriction</text-href>"),a=c.Ay.t("web_quebec_users_button_appel_age_restriction",{},"Appel age restriction"),r=t+o,i=c.Ay.t("web_quebec_users_tiitle_cannot_access_account",{},"Can't access account"),s=(0,n.jsx)("div",{className:"quebec-content",children:t}),l=c.Ay.t("web_quebec_users_button_get_it_one",{},"Got it"),d="pc"===e?y.A.error({title:i,content:s,maskClosable:!1,closable:!1,escToExit:!1,backspaceToExit:!1,okText:a,onConfirm:()=>this.goAppealPage()}):_n.open({title:i,content:r,okText:l,onConfirm:()=>this.refreshRecord()});this.unbinds.push((()=>{d.close()}))}}function mn(){const e=typeof __locationInfo<"u"?__locationInfo:void 0;if(!e)return;e&&d.b.updateRequestDomain(e);const t=e.code;return{region:t,idc:(0,Y.E)(t),newIdc:e.web_idc,reqDomain:e.domain}}async function gn(e,t,o){var a;try{const n=null==o?void 0:o.user_id,r=await(0,u.r)().asyncGetConfig(),i=(null==r?void 0:r.header)||{},{web_id:s}=await(0,u.r)().getToken();if(null==(a=null==i?void 0:i.custom)||!a.channel_level1){const e=Qo();await e.init();const{channel:t,extraCommonParams:o}=e.getParams();i.custom={...i.custom,...t,...o}}const l={header:i,client_ip:"",params:{scenario:"custom",is_pwa:(0,p.i)()?1:0,pwa_from:(0,p.w)(),open_from_pwa:(0,p.e)()?1:0},user:{user_id:n,user_is_login:e,user_unique_id:s,web_id:s}};s||window.ccWebSlardar&&window.ccWebSlardar("sendLog",{content:JSON.stringify({logType:e?"user_login":"user_signup",...l,...t}),extra:{type:"web_id_empty"}}),await io.eventReport({event_name:e?"user_login":"user_signup",custom_info:JSON.stringify(l),params:JSON.stringify(t)})}catch{}}const vn=(0,I.O)({id:"userMachine",context:{isBOE:!1,passport:()=>Promise.resolve(null),isNewSignupUser:!1,asyncFuncExecsRef:void 0,thirdPartSignInRef:void 0,emailSignInRef:void 0,teamInviteRef:void 0,userInviteRef:void 0,isCloudSubscribed:!1,userInfo:void 0,vipInfo:{flag:void 0,vipRealEnd:void 0,subscribeType:"un-auto",canFreeTrial:!1,canFreeTrialDays:0,productId:"",subscribeCycle:0,isFirstSubscribe:!1,isCancelSubscribe:!1,cycleUnit:""},spaceList:[],loginReporter:new class{constructor(){bt(this,"reporter",(0,u.r)())}reportStatus(e){this.reporter.reportBecon("login_status",e),e.is_login_new_user?ea().report(this.reporter,"sign_up"):ea().report(this.reporter,"sign_in")}reportPageAction(e){this.reporter.report("login_page",e)}},signUpReporter:new class{constructor(){bt(this,"reporter",(0,u.r)())}reportStatus(e){this.reporter.reportBecon("signup_status",e),e.is_login_new_user?ea().report(this.reporter,"sign_up"):ea().report(this.reporter,"sign_in")}reportPageAction(e){this.reporter.report("signup_page",e)}},logoutReporter:new class{constructor(){bt(this,"reporter",(0,u.r)())}report(){this.reporter.report("click_logout",{})}},fetchLocationReporter:new class{constructor(){bt(this,"reporter",(0,u.r)())}report(e){this.reporter.report("lvrd_fetch_location",e)}},lvrdCheckLoginReporter:new class{constructor(){bt(this,"reporter",(0,u.r)()),bt(this,"options",Fa)}updateOptions(e){this.options=(0,Se.A)({},this.options,e)}resetOptions(){this.options=Fa}report(e){const t={get_user_time:this.options.checkLoginStartTime?e.endTime-this.options.checkLoginStartTime:0,has_inject_user_info:this.options.hasInjectUserInfo,is_user_login:this.options.isUserLogin||!1};this.reporter.reportBecon("lvrd_check_login_time",t)}},currentWorkspaceInfo:void 0,workspaceExpandInfoMap:{},isWorkSpaceInited:!1,workspaceList:[],updateWorkspaceEventCache:[],changeWorkspaceEventCache:"",userCareerSkipped:!1,userStatusMachineParams:un.context,loginModalClosable:!0,everPhotoUsers:[],openServerReportUserStatus:!0,isInitialCheckLoginStatus:!0,ageGateChecker:new class{constructor(){bt(this,"quebecAgeGateBand",new hn)}start(e){this.quebecAgeGateBand.start(e)}destroy(){this.quebecAgeGateBand.destroy()}},ipLocationInfo:typeof window<"u"&&window.ip_location_info||null,loginSuccessCb:()=>{},userLoginedCb:()=>{},loginFailCb:()=>{},noCareerCb:()=>null,redirectToCb:()=>{},noSignInCb:()=>{},onFetchLocationFail:()=>{},initWorkspaceCb:()=>{},initUserAndWorkspaceCb:()=>{},changeWorkspaceCb:()=>{},refreshWorkspaceListCb:()=>{},beforeChangeWorkspaceCb:()=>Promise.resolve(),storageChangeWorkspaceCb:()=>{},updateWorkspaceErrorCb:()=>{},userFinishCareerCb:()=>{}},entry:["initPassport","initAsyncFuncExecRef","initChilrenMachine","performanceMarkStart"],initial:"unknown",states:{unknown:{always:[{actions:"getLocationCodeFromHtml",target:"checking",cond:"hasLocationCodeFromHtml"},{target:"fetchingLocation",cond:"shouldFetchLocation"},{target:"checking",actions:["clearUserInfo"]}]},fetchingLocation:{invoke:{id:"fetchLocation",src:"fetchLocation",onDone:{target:"checking",actions:["updateRegion"]},onError:{target:"fetchLocationFail"}}},checking:{invoke:{id:"getAndUpdateUserInfo",src:"getAndUpdateUserInfo",onDone:[{target:"hasSign",actions:["saveUserInfo","updateRegion","reportFetchLocationSuccess","updateIsInitialCheckLoginStatus"],cond:"isValidLocationFromCheckingPharse"},{target:"fetchLocationFail"}],onError:[{target:"noSign",actions:["noSignIn","updateIsInitialCheckLoginStatus"]}]}},noSign:{initial:"checkingThirdOpenId",states:{checkingThirdOpenId:{always:[{target:"googleDriveConfirmSigning",cond:"needShowGoogleDriveSign"},{target:"idle"}]},idle:{on:{SIGN_IN:{target:"signing",actions:["showSignHideModal","overwritePreExecTask"]},SIGN_IN_WITH_AUTH_TOKEN:{actions:"signInWithAuthToken"},SIGN_IN_WITH_AUTH_TOKEN_SUCCESS:{target:"checking",actions:"hideSignHideModal"}}},signing:{on:{EXIT_SIGN_IN:[{target:"thirdPartyConfirmSigning",cond:"needShowThirdPartySign"},{target:"idle",actions:["clearUrl"]}],SIGN_IN_SUCCESS:{target:"checking",actions:["thirdPartyStorageLoginSuccess","reportLoginSuccess","updateloginReportParams","storeLoginInfo"]},SIGN_IN_FAIL:{actions:["reportLoginFail","updateloginReportParams","reportLoginFailStatus","checkAgeGate"]}}},thirdPartyConfirmSigning:{on:{SIGN_IN:{target:"signing"},CANCEL_THIRD_LOGIN:{target:"idle",actions:["clearUrl"]}}},googleDriveConfirmSigning:{on:{CONFIRM_THIRD_LOGIN:{target:"idle",actions:"handleUserStop"}}},checking:{invoke:{id:"getAndUpdateUserInfo",src:"getAndUpdateUserInfo",meta:{noSign:!0},onDone:[{target:"#hasSign",actions:["saveUserInfo","updateRegion","reportFetchLocationSuccess","updateIsInitialCheckLoginStatus"],cond:"isValidLocationFromCheckingPharse"},{target:"#fetchLocationFail"}],onError:{target:"idle",actions:["clearUserInfo","updateIsInitialCheckLoginStatus"]}}}},entry:["performanceMarkEnd"]},hasSign:{id:"hasSign",initial:"preExec",states:{preExec:{invoke:{id:"preExecTaskWhenLogin",src:"preExecTaskWhenLogin",onDone:{target:"idle"},onError:{target:"idle"}}},idle:{}},entry:[(0,E.kp)({isWorkSpaceInited:!0}),"refreshPersonalWorkspace","reportLoginSuccessStatus","reportLvrdCheckLoginTime","userLoginedCb","stopEmailSignInActor","saveUserFromSignUpStorage","getAllEverPhotoUser","checkAgeGate","performanceMarkEnd"],invoke:[{id:"LvUserCareerMachine",src:sn,data:e=>{var t;return{...sn.context,userInfo:e.userInfo,noCareerCb:e.noCareerCb,userFinishCareerCb:e.userFinishCareerCb,shouldShowCareerModal:e.shouldShowCareerModal,reporterParams:{currentPage:null==(t=e.loginReportParams)?void 0:t.currentPage}}}},{id:"LvUserWorkspaceMachine",src:cn,data:e=>({...cn.context,userInfo:e.userInfo,changeWorkspaceEventCache:e.changeWorkspaceEventCache,updateWorkspaceEventCache:e.updateWorkspaceEventCache,initWorkspaceCb:e.initWorkspaceCb,initUserAndWorkspaceCb:e.initUserAndWorkspaceCb,changeWorkspaceCb:e.changeWorkspaceCb,refreshWorkspaceListCb:e.refreshWorkspaceListCb,storageChangeWorkspaceCb:e.storageChangeWorkspaceCb,beforeChangeWorkspaceCb:e.beforeChangeWorkspaceCb,updateWorkspaceErrorCb:e.updateWorkspaceErrorCb})},{id:"LvUserStatusListenerMachine",src:un,data:e=>({...un.context,...e.userStatusMachineParams,uid:e.userInfo.uid})},{id:"getUserSubscription",src:"getUserSubscription",onDone:{actions:"assignVipInfo"},onError:{}}],on:{SET_CAREER:{actions:["forwardToUserCareer"]},SET_NO_CAREER_CB:{actions:["forwardToUserCareer"]},UPDATE_USER_CAREER:{actions:["mergeUserInfo"]},UPDATE_USER_CAREER_SKIPPED:{actions:["updateUserCareerSkipped"]},SIGN_OUT:{actions:["reportClickLogout","forwardToUserStatusListener","signout"]},REFRESH_USER_SPACE:{actions:["refreshPersonalWorkspace"]},CHANGE_WORKSPACE:{actions:["forwardToUserWorkspace"]},REFRESH_WORKSPACE_LIST:{actions:["forwardToUserWorkspace"]},STORAGE_CHANGE_WORKSPACE:{actions:["forwardToUserWorkspace"]},UPDATE_WORKSPACE:{actions:["forwardToUserWorkspace"]},UPDATE_VIP_INFO:{actions:["updateVipInfoReq"]},NOTIFY_WORKSPACE_CHANGE:{actions:["forwardToUserWorkspace"]},UPDATE_WORKSPACE_DATA_FROM_CHILD:{actions:"updateWorkspaceDataFromChild"},GET_VIP_INFO_SUCCESS:{actions:["assignVipInfo"]}}},fetchLocationFail:{id:"fetchLocationFail",type:"final",entry:["handleFetchLocationFail","reportFetchLocationFail"]}},on:{SIGN_IN_WITH_URL:{actions:["loginingWithUrl"]},SET_NO_SIGN_IN_CB:{actions:["setNoSignInCb"]},SET_REDIRECT_TO_CB:{actions:["setRedirectToCb"]},SET_NO_CAREER_CB:{actions:["setNoCareerCb"]},UPDATE_REPORT_PARAMS:{actions:["updateloginReportParams","changeThirdPartCurrentPage","changeEmailCurrentPage"]},SIGN_IN_ACTION:{actions:["updateloginReportParams","reportSignInAction"]},SIGN_IN_SUCCESS:{target:"noSign.checking",actions:["reportLoginSuccess","updateloginReportParams"]},CHANGE_CONTEXT:{actions:P.Sw([{cond:"isInitWorkSpaceGuard",actions:["changeContext","changeThirdPartSignInContext","changeEmailSignInContext","changeUserWorkSpaceInContext"]},{actions:["changeContext","changeThirdPartSignInContext","changeEmailSignInContext"]}])},SYNC_CONTEXT:{actions:["changeEmailSignInPartialContext"]},UPDATE_WORKSPACE:{actions:"restoreUpdateWorkspaceEventCache"},CHANGE_WORKSPACE:{actions:["consumeChangeWorkspaceCache"]},GET_ALL_EVER_PHOTO_USER_SUCCESS:{actions:["saveAllEverPhotoUser"]},UPDATE_DEFAULT_WORKSPACE_INFO:{actions:["updateDefaultWorkspaceInfo","updateUserInfoStringify"]},SET_USER_LOGINED_CB:{actions:["setUserLoginedCb"]}}},{services:{async getAndUpdateUserInfo(e,t,{meta:o}){var a,n,r,i,s;null==(n=null==(a=null==e?void 0:e.lvrdCheckLoginReporter)?void 0:a.updateOptions)||n.call(a,{checkLoginStartTime:Date.now(),isUserLogin:null==o?void 0:o.noSign});const{source:l,medium:c,campaign:_,term:h=""}=Qo().getParams(),m=c===u.M.SEM,g=m?kt:"Direct"===c?At:c,v=m&&h&&_,f=(0,Y.N)();if(e.isInitialCheckLoginStatus&&!f&&typeof __isLogined<"u"&&!__isLogined&&!d.i)throw new Error("not logined");const y=f||await p.u.getAndUpdateUserInfo({sem_info:{is_sem:m,medium:c,register_source:g,register_second_source:l,keywords:v?h:void 0,campaign_id:v?_:void 0}});!f&&typeof window<"u"&&(window.__userInfoStringify=JSON.stringify({ret:"0",data:y,__clientInject:!0})),null==(i=null==(r=null==e?void 0:e.lvrdCheckLoginReporter)?void 0:r.updateOptions)||i.call(r,{hasInjectUserInfo:!!f});const w=(0,Y.E)(y.location.code);return d.b.updateRequestDomain({domain:y.location.domain}),{user_id_str:y.user_info.user_id,userInfo:y.user_info,region:y.location.code,spaceInfo:y.space_info,personalSpaceInfo:y.space_info,idc:w,newIdc:y.location.web_idc,reqDomain:y.location.domain,defaultSpaceInfo:null==(s=y.user_info)?void 0:s.default_space_info}},async fetchLocation(){const[e]=await(0,b.a)(async function(e=!1){try{const t=mn();if(e&&t)return t;const{data:o}=await Y.a.getLocation(),a=o.code,n=(0,Y.E)(a);return o&&d.b.updateRequestDomain(o),{region:a,idc:n,newIdc:o.web_idc,reqDomain:o.domain}}catch{console.error("get location failure\uff0cfallback to va.");const e=(0,d.h)();return d.b.updateRequestDomain({domain:e}),{region:Y.S.US,idc:Y.aa.VA,newIdc:"maliva",reqDomain:e}}}());return{region:e.region,idc:e.idc,newIdc:e.newIdc,reqDomain:e.reqDomain}},async preExecTaskWhenLogin(e){var t;try{await(null==(t=null==e?void 0:e.preExecTaskWhenLogin)?void 0:t.call(e))}catch{}},async getUserSubscription(){try{return await Yt.getSubscriptionUserInfo()}catch(e){return Promise.reject(e)}}},actions:{performanceMarkStart:()=>{Ua.userInit.start()},performanceMarkEnd:()=>{Ua.userInit.end()},initAsyncFuncExecRef:(0,E.kp)({asyncFuncExecsRef:()=>(0,T.cH)(u.L)}),getLocationCodeFromHtml:(0,E.kp)({userInfo:()=>{const{region:e,idc:t,reqDomain:o,newIdc:a}=mn()||{};return e?{region:e,idc:t,newIdc:a,reqDomain:o}:void 0}}),thirdPartyStorageLoginSuccess:async()=>{var e;if((0,h.i)()){const t=null==(e=window.location.originParams)?void 0:e.shop;await p.u.authorizationCheck({platform:p.f.Shopify,account_id:t})}},reportLoginSuccess:(e,t)=>{e.loginSuccessCb(t.data)},overwritePreExecTask:(0,E.kp)({preExecTaskWhenLogin:(e,t)=>t.preExecTaskWhenLogin}),userLoginedCb:e=>{e.userLoginedCb(e.userInfo)},reportLoginFail:e=>{e.loginFailCb()},saveUserInfo:(0,E.kp)({userInfo:({userInfo:e},t)=>{const o=t.data.userInfo,{spaceInfo:a}=t.data,n=null==o?void 0:o.default_space_info;return{...e,uid:o.user_id,name:o.nick_name,avatar:o.avatar_urls.avatar_url_small,career:o.career,register_source:o.register_source,isBindTT:o.is_bind_tt,ttUID:o.tt_user_id,email:o.email,create_time:o.create_time,is_new_user:o.is_new_user,spaceInfo:{spaceHost:null==a?void 0:a.space_host,spaceId:null==a?void 0:a.space_id,spaceIdc:null==a?void 0:a.space_idc,spaceResHost:null==a?void 0:a.space_res_host,workspaceId:null==a?void 0:a.workspace_id,spaceType:null==a?void 0:a.space_type,rawSpaceType:null==a?void 0:a.raw_space_type},personalSpaceInfo:{spaceHost:null==a?void 0:a.space_host,spaceId:null==a?void 0:a.space_id,spaceIdc:null==a?void 0:a.space_idc,spaceResHost:null==a?void 0:a.space_res_host,workspaceId:null==a?void 0:a.workspace_id,spaceType:null==a?void 0:a.space_type,rawSpaceType:null==a?void 0:a.raw_space_type},hasGoogleEmail:o.has_google_email,defaultSpaceInfo:n?{spaceHost:n.space_host,spaceId:n.space_id,spaceIdc:n.space_idc,spaceResHost:n.space_res_host,workspaceId:n.workspace_id,spaceType:n.space_type,rawSpaceType:n.raw_space_type}:void 0,has_birthday:o.has_birthday,is_young:o.is_young,forbidden_date:o.forbidden_date,useGPTText2Video:o.use_gpt_text2video,exportGPTText2Video:o.export_gpt_text2video}}}),mergeUserInfo:(0,E.kp)({userInfo:({userInfo:e},t)=>({...e,...t.userInfo})}),updateUserCareerSkipped:(0,E.kp)({userCareerSkipped:(e,t)=>t.skipped}),clearUserInfo:(0,E.kp)({userInfo:({userInfo:e})=>e?{region:e.region,idc:e.idc,newIdc:e.newIdc,reqDomain:e.reqDomain}:void 0}),loginingWithUrl:({passport:e},t)=>{e().then((e=>null==e?void 0:e.signin(null==t?void 0:t.backURL)))},signout:({passport:e},t)=>{e().then((e=>null==e?void 0:e.signout((null==t?void 0:t.redirectUrl)??void 0)))},noSignIn(e){e.noSignInCb()},reportLoginSuccessStatus:async(e,{data:t})=>{var o;const{loginReportParams:a,loginReporter:n,signUpReporter:r}=e;if(a&&["type","source"].every((e=>[void 0,""].every((t=>a[e]!==t))))){let i=a.source===ta.LoginIn;a.isThirdparty&&(i=!a.isLoginNewUser);const s=!i,l={enter_from:a.statusEnterFrom??"",current_page:a.currentPage||(i?"login":"signup"),status:"success",article_type:null!=a&&a.articleType?a.articleType:void 0,article_title:null!=a&&a.articleTitle?a.articleTitle:void 0,login_type:i?a.type:void 0,signup_type:s?a.type:void 0,videocut_id:t.userInfo.user_id,age_year:s?a.age_year:void 0,age_month:s?a.age_month:void 0,age_date:s?a.age_date:void 0,tool_type:a.toolType,is_login_new_user:a.isLoginNewUser,url:location.href,url_path:location.pathname,page_type:a.pageType,from_page:a.fromPage};null==(o=i?n:r)||o.reportStatus(l);const{openServerReportUserStatus:c=!0}=e;c&&await gn(i,l,null==t?void 0:t.userInfo)}e.redirectToCb(e)},reportLoginFailStatus:({loginReportParams:e,loginReporter:t,signUpReporter:o,openServerReportUserStatus:a=!0},n)=>{var r;if(e&&["type","source"].every((t=>[void 0,""].every((o=>e[t]!==o))))){const i=e.source===ta.LoginIn,s={enter_from:e.statusEnterFrom??"",current_page:e.currentPage||(i?"login":"signup"),status:"fail",article_type:null!=e&&e.articleType?e.articleType:void 0,article_title:null!=e&&e.articleTitle?e.articleTitle:void 0,login_type:e.source===ta.LoginIn?e.type:void 0,signup_type:e.source===ta.SignUp?e.type:void 0,error_code:n.params.errorCode,error_msg:n.params.errorMsg,tool_type:e.toolType,url:location.href,url_path:location.pathname,page_type:e.pageType};null==(r=i?t:o)||r.reportStatus(s),a&&gn(i,s)}},reportSignInAction:({loginReportParams:e,loginReporter:t,signUpReporter:o})=>{var a;if(e&&["action","source"].every((t=>[void 0,""].every((o=>e[t]!==o))))){const n=e.source===ta.LoginIn;null==(a=n?t:o)||a.reportPageAction({enter_from:e.pageEnterFrom,current_page:e.currentPage?e.currentPage:n?"login":"signup",action:e.action,article_type:null!=e&&e.articleType?e.articleType:void 0,article_title:null!=e&&e.articleTitle?e.articleTitle:void 0,tool_type:e.toolType,url:location.href,url_path:location.pathname,page_type:e.pageType,from_page:e.fromPage})}},reportClickLogout:({logoutReporter:e})=>{null==e||e.report()},updateloginReportParams:(0,E.kp)({loginReportParams:({loginReportParams:e},t)=>({...e,...t.params})}),refreshPersonalWorkspace:(0,E.tN)((e=>{var t,o;return{type:"UPDATE_WORKSPACE",workspaceId:(null==(o=null==(t=e.userInfo)?void 0:t.spaceInfo)?void 0:o.workspaceId)??""}})),initPassport:(0,E.kp)({passport:({isBOE:e})=>{let t=null;return async()=>{if(t)return t;const o=(await Promise.resolve().then((()=>Ya))).default;return t=new o({isBoe:e})}}}),updateRegion:(0,E.kp)({userInfo:({userInfo:e},t)=>Object.assign(e??{},{region:t.data.region,idc:t.data.idc,newIdc:t.data.newIdc,reqDomain:t.data.reqDomain})}),setNoSignInCb:(0,E.kp)({noSignInCb:(e,t)=>t.callback}),setRedirectToCb:(0,E.kp)({redirectToCb:(e,t)=>t.callback}),initChilrenMachine:(0,E.kp)({teamInviteRef:({isBOE:e})=>(0,T.cH)(Ja.withContext({inviteLink:"",workspaceInfo:{inviter_nickname:"***",name:"***",inviter_avatar:""},errCode:void 0,joinWorkspaceSuccessCb:null,onError:null,reviewStatus:void 0,isBOE:!!e})),userInviteRef:({inviteInfo:e})=>(0,T.cH)(rn.withContext({isInvitePage:null==e?void 0:e.isInvitePage,invitedCode:null==e?void 0:e.invitedCode})),thirdPartSignInRef:({isBOE:e,passport:t,inviteInfo:o,loginReportParams:a,showRestoreModal:n})=>(0,T.cH)(nn.withContext({showRestoreModal:n,isBOE:!!e,isInvitePage:null==o?void 0:o.isInvitePage,invitedCode:null==o?void 0:o.invitedCode,passport:t,name:"",source:ta.LoginIn,currentPage:null==a?void 0:a.currentPage})),emailSignInRef:({isBOE:e,passport:t,inviteInfo:o})=>(0,T.cH)(Ka.withContext({...Ka.context,isBOE:!!e,isInvitePage:null==o?void 0:o.isInvitePage,invitedCode:null==o?void 0:o.invitedCode,passport:t,email:"",password:"",birthday:"",ticket:""}))}),setNoCareerCb:(0,E.kp)({noCareerCb:(e,t)=>t.callback}),setUserLoginedCb:(0,E.kp)({userLoginedCb:(e,t)=>t.callback}),stopEmailSignInActor:P.ds((({emailSignInRef:e})=>e)),changeContext:(0,E.kp)(((e,t)=>(0,Se.A)({},e,t.context))),changeThirdPartSignInContext:(0,E.tN)(((e,t)=>({type:"CHANGE_CONTEXT",context:t.context})),{to:({thirdPartSignInRef:e})=>e}),changeEmailSignInContext:(0,E.tN)(((e,t)=>({type:"CHANGE_CONTEXT",context:t.context})),{to:({emailSignInRef:e})=>e}),changeUserWorkSpaceInContext:(0,E.tN)(((e,t)=>({type:"CHANGE_CONTEXT",context:t.context})),{to:"LvUserWorkspaceMachine"}),changeEmailSignInPartialContext:(0,E.tN)((({loginReportParams:e})=>({type:"CHANGE_CONTEXT",context:{pageEnterFrom:null==e?void 0:e.pageEnterFrom,currentPage:null==e?void 0:e.currentPage}})),{to:({emailSignInRef:e})=>e}),changeThirdPartCurrentPage:(0,E.tN)((({loginReportParams:e},t)=>{var o;return{type:"CHANGE_CONTEXT",context:{currentPage:(null==(o=null==t?void 0:t.params)?void 0:o.currentPage)??(null==e?void 0:e.currentPage)}}}),{to:({thirdPartSignInRef:e})=>e}),changeEmailCurrentPage:(0,E.tN)((({loginReportParams:e},t)=>{var o;return{type:"CHANGE_CONTEXT",context:{currentPage:(null==(o=null==t?void 0:t.params)?void 0:o.currentPage)??(null==e?void 0:e.currentPage)}}}),{to:({emailSignInRef:e})=>e}),handleFetchLocationFail:({onFetchLocationFail:e})=>e(),reportFetchLocationSuccess:({fetchLocationReporter:e})=>{null==e||e.report({status:"success"})},reportFetchLocationFail:({fetchLocationReporter:e})=>{null==e||e.report({status:"fail"})},consumeChangeWorkspaceCache:(0,E.kp)(((e,t)=>{const{data:o}=t;return o.workspace_id?{changeWorkspaceEventCache:o.workspace_id}:{}})),restoreUpdateWorkspaceEventCache:(0,E.kp)({updateWorkspaceEventCache:(e,t)=>[...e.updateWorkspaceEventCache,t.workspaceId]}),storeLoginInfo:(0,E.kp)(((e,t)=>{var o;return"SIGN_IN_SUCCESS"!==t.type?e:{isNewSignupUser:(null==(o=t.extra)?void 0:o.isNewSignupUser)||!1}})),reportLvrdCheckLoginTime:e=>{var t,o,a;null==(t=null==e?void 0:e.lvrdCheckLoginReporter)||t.report({endTime:Date.now()}),null==(a=null==(o=null==e?void 0:e.lvrdCheckLoginReporter)?void 0:o.resetOptions)||a.call(o)},updateWorkspaceDataFromChild:(0,E.kp)((({thirdPartyFileOpenCb:e,thirdPartyFileOpenCbCalled:t},o)=>{const a=(0,Z.A)(o,["type"]),{workspaceList:n=[]}=o;let r=!1;const i=(0,h.c)("state"),s=(0,h.c)("file_id"),l=(0,h.c)(h.S.UTM_CAMPAIGN),c=(0,h.c)(h.S.UTM_SOURCE),d="googledrive"===l&&!t&&(null==i?void 0:i.length);return(d||"dropbox"===c&&s)&&null!=n&&n.length&&(null==e||e(d?p.f.GoogleDrive:p.f.Dropbox,n),r=!0),{...a,thirdPartyFileOpenCbCalled:r}})),forwardToUserCareer:(0,E.D)("LvUserCareerMachine"),forwardToUserWorkspace:(0,E.D)("LvUserWorkspaceMachine"),forwardToUserStatusListener:(0,E.D)("LvUserStatusListenerMachine"),signInWithAuthToken:(0,E.tN)(((e,t)=>({type:"ADD_TASK",exec:async()=>{var e,o;try{if("success"!==(await(async e=>{const{APP_ID:t}=d.P,{token:o,state:a}=e,n=new FormData;return n.append("aid",t),n.append("token",o),n.append("state",a),await $t({method:"post",url:"/passport/transfer/token_auth/",data:n,headers:{"Content-Type":"multipart/form-data"}})})({token:t.data.token,state:t.data.state})).result)throw new Error("sign in auth failure")}catch(a){throw null==(o=(e=t.data).onFailure)||o.call(e,a),a}},successType:"SIGN_IN_WITH_AUTH_TOKEN_SUCCESS",failType:"SIGN_IN_WITH_AUTH_TOKEN_FAILURE"})),{to:e=>e.asyncFuncExecsRef}),saveUserFromSignUpStorage:({isNewSignupUser:e,userInfo:t})=>{if(e&&null!=t&&t.uid){const e=`${p.a.GUIDE_FROM_SIGN_UP}_${null==t?void 0:t.uid}`;d.a.setString(e,"true")}},getAllEverPhotoUser:(0,E.tN)((()=>({type:"ADD_TASK",exec:async()=>{var e;const t=await go.getAllEverPhotoUser();return(null==(e=null==t?void 0:t.data)?void 0:e.ever_photo_uids)??[]},successType:"GET_ALL_EVER_PHOTO_USER_SUCCESS"})),{to:e=>e.asyncFuncExecsRef}),saveAllEverPhotoUser:(0,E.kp)({everPhotoUsers:(e,t)=>t.data}),assignVipInfo:(0,E.kp)({vipInfo:(e,{data:t})=>({flag:t.flag,vipRealEnd:null==t?void 0:t.end_time,subscribeType:null==t?void 0:t.subscribe_type,canFreeTrial:null==t?void 0:t.can_free_trial,canFreeTrialDays:null==t?void 0:t.can_free_trial_days,productId:null==t?void 0:t.product_id,subscribeCycle:null==t?void 0:t.subscribe_cycle,isFirstSubscribe:null==t?void 0:t.is_first_subscribe,isCancelSubscribe:null==t?void 0:t.is_cancel_subscribe,cycleUnit:null==t?void 0:t.cycle_unit})}),updateVipInfoReq:(0,E.tN)((()=>({type:"ADD_TASK",exec:async()=>await Yt.getSubscriptionUserInfo(!0),successType:"GET_VIP_INFO_SUCCESS"})),{to:e=>e.asyncFuncExecsRef}),updateIsInitialCheckLoginStatus:(0,E.kp)({isInitialCheckLoginStatus:()=>!1}),updateDefaultWorkspaceInfo:(0,E.kp)({userInfo:(e,t)=>{const{userInfo:o,defaultWorkspaceInfo:a}=t.data;return{...o,defaultSpaceInfo:a}}}),updateUserInfoStringify:e=>{var t;try{const o=typeof __userInfoStringify<"u"?JSON.parse(__userInfoStringify):void 0;if(o){const a=o.data.user_info;a&&null!=(t=e.userInfo)&&t.defaultSpaceInfo&&(a.default_space_info={space_host:e.userInfo.defaultSpaceInfo.spaceHost,space_id:e.userInfo.defaultSpaceInfo.spaceId,space_idc:e.userInfo.defaultSpaceInfo.spaceIdc,space_res_host:e.userInfo.defaultSpaceInfo.spaceResHost,workspace_id:e.userInfo.defaultSpaceInfo.workspaceId,space_type:e.userInfo.defaultSpaceInfo.spaceType,raw_space_type:e.userInfo.defaultSpaceInfo.rawSpaceType}),window.__userInfoStringify=JSON.stringify(o)}}catch{}},checkAgeGate:({ageGateChecker:e},t)=>{var o,a,n;e.start({errorCode:Number(null==(o=null==t?void 0:t.params)?void 0:o.errorCode),errorMsg:null==(a=null==t?void 0:t.params)?void 0:a.errorMsg,verifyTicket:null==(n=null==t?void 0:t.params)?void 0:n.verifyTicket})},clearUrl:()=>{(0,h.M)(["state","file_id","imported_file_id","shop"])},handleUserStop:({thirdPartyFileOpenStopCb:e},t)=>{t.cancel&&((0,h.M)(["state","file_id","imported_file_id"]),null==e||e("user_cancel_login"))}},guards:{isInitWorkSpaceGuard:e=>!!e.isWorkSpaceInited,shouldFetchLocation:({userInfo:e,shouldFetchLocation:t})=>!!t&&typeof e>"u",hasLocationCodeFromHtml:()=>typeof __locationInfo<"u",isValidLocationFromCheckingPharse:(e,{data:t})=>!!t.region,needShowGoogleDriveSign:()=>{const e=(0,h.c)(h.S.UTM_CAMPAIGN),t=(0,h.c)("state");return!("googledrive"!==e||null==t||!t.length)},needShowThirdPartySign:()=>(0,h.i)()}});class fn extends S.EventEmitter{constructor(){super(...arguments),bt(this,"_userService")}init(e){this._userService=e.userService}getRegion(){var e,t;return null==(t=null==(e=this._userService.getSnapshot())?void 0:e.context.userInfo)?void 0:t.region}getNewIdc(){var e,t;return null==(t=null==(e=this._userService.getSnapshot())?void 0:e.context.userInfo)?void 0:t.newIdc}getReqDomain(){var e,t;return null==(t=null==(e=this._userService.getSnapshot())?void 0:e.context.userInfo)?void 0:t.reqDomain}getUserInfo(){var e;return null==(e=this._userService.getSnapshot())?void 0:e.context.userInfo}getUserCloudInfo(){var e;const{context:t}=this._userService.getSnapshot();return{workspaceInfo:t.currentWorkspaceInfo,workspaceExpandInfo:t.workspaceExpandInfoMap[(null==(e=t.currentWorkspaceInfo)?void 0:e.workspace_id)??""],workspaceExpandInfoMap:t.workspaceExpandInfoMap}}changeUserRegion(e){this._userService.send({type:"CHANGE_CONTEXT",context:{userInfo:{region:e,idc:(0,Y.E)(e)}}})}listenCareerStatus(e){const t=t=>{const o=this._getUserCareer(t);e(o)};return this._userService.onTransition(t),()=>{this._userService.off(t)}}listenLoginStatus(e){const t=t=>{const o=this._userHasSign(t);e({hasSign:o})};return this._userService.onTransition(t),()=>{this._userService.off(t)}}listenLoginOut(e){const t=t=>{var o;const a=null==(o=null==t?void 0:t.children)?void 0:o.LvUserStatusListenerMachine;a&&a.getSnapshot().matches("destroy")&&(null==e||e())};return this._userService.onTransition(t),()=>{this._userService.off(t)}}listenUserWholeStatus(e){const t=t=>{var o,a;const n=this._userHasSign(t),r=this._getUserCareer(t);e({hasSign:n,vipInfo:null==(o=t.context)?void 0:o.vipInfo,workspaceExpandInfoMap:null==(a=t.context)?void 0:a.workspaceExpandInfoMap,noSign:t.matches("noSign"),careerStatus:r.status,career:r.career,initFailed:t.matches("fetchLocationFail")})};return this._userService.onTransition(t),()=>{this._userService.off(t)}}listenVipInfo(e){const t=t=>{var o;e(null==(o=t.context)?void 0:o.vipInfo)};return this._userService.onTransition(t),()=>{this._userService.off(t)}}_userHasSign(e){var t;return(null==(t=e.context)?void 0:t.userInfo)&&Object.prototype.hasOwnProperty.call(e.context.userInfo,"uid")&&Object.prototype.hasOwnProperty.call(e.context.userInfo,"region")}_getUserCareer(e){var t,o,a,n;if(e.matches("noSign"))return{status:void 0,career:""};const r=null==(t=null==e?void 0:e.children.LvUserCareerMachine)?void 0:t.getSnapshot();return null!=r&&r.matches("hasCareer")&&null!=(a=null==(o=e.context)?void 0:o.userInfo)&&a.career?{status:!0,career:e.context.userInfo.career}:null!=r&&r.matches("noCareer")?{status:!1,career:(null==(n=e.context.userInfo)?void 0:n.career)||""}:{status:void 0,career:""}}}new fn;const yn=(e,t)=>{(new Ta).report({action:e,current_page:t??""})},wn=e=>new Promise(((t,o)=>{const i=y.A.confirm({focusLock:!1,className:"lv_sign_in_panel_wide-restore-account",title:(0,n.jsxs)("div",{className:"lv_sign_in_panel_wide-restore-account-title",children:[(0,n.jsx)(r.__x,{size:24,color:"#2668FF"}),c.Ay.t("web_deactivate_button_delete_restore",{},"Restore deleted account")]}),content:(0,n.jsx)("div",{className:"lv_sign_in_panel_wide-restore-account-content",children:c.Ay.t("web_deactivate_text_trying_sign_into",{},"You\u2019re trying to sign into a deleted account. By signing in, your account will be restored. If you don\u2019t restore the account, it will be permanently deleted in 30 days.")}),maskStyle:{zIndex:1103},wrapStyle:{zIndex:1103},onOk:async()=>{yn("restore",null==e?void 0:e.currentPage);try{i.update({okButtonProps:{loading:!0}}),await e.onOk(),i.close(),(new Pa).report({status:"success",current_page:(null==e?void 0:e.currentPage)??""}),t()}catch(n){a.A.error("API error"),(new Pa).report({status:"failed",current_page:(null==e?void 0:e.currentPage)??"",fail_reason:(null==n?void 0:n.description)??void 0}),o(n)}finally{i.update({okButtonProps:{loading:!1}})}},onCancel:()=>{var t;null==(t=null==e?void 0:e.onCancel)||t.call(e),yn("cancel",null==e?void 0:e.currentPage)},okText:c.Ay.t("web_deactivate_button_restore_confirm",{},"Restore account"),cancelText:c.Ay.t("web_deactivate_button_cancel_restore",{},"Cancel"),okButtonProps:{type:"primary"},icon:null,closeIcon:(0,n.jsx)(r.gzW,{size:20,onClick:()=>{var t;null==(t=null==e?void 0:e.onCancel)||t.call(e),yn("cancel",null==e?void 0:e.currentPage)}})})})),bn=(0,i.createContext)({userService:{},theme:St.Light,setTheme:()=>{},locale:{}});const xn=new class{constructor(){bt(this,"_theme",St.Light)}init(e){const t=this.retrive()?this.retrive()===St.Dark:document.body.getAttribute("lv-theme")===St.Dark;return this.apply(t?St.Dark:St.Light),e(t?St.Dark:St.Light),this.listen(e)}listen(e){const t=window.matchMedia("(prefers-color-scheme: dark)"),o=t=>{this.apply(t.matches?St.Dark:St.Light,!0),e(t.matches?St.Dark:St.Light)};return t.addListener(o),()=>{t.removeListener(o)}}apply(e,t=!1){this._theme=e,e===St.Dark?document.body.setAttribute("lv-theme","dark"):document.body.removeAttribute("lv-theme"),t&&this.store()}checkCookieEnabled(){return typeof window>"u"||!navigator.cookieEnabled}retrive(){if(!this.checkCookieEnabled())return d.a.getString(p.a.CAPCUT_THEME)}store(){this.checkCookieEnabled()||(U.A.set(p.a.CAPCUT_THEME,this._theme),d.a.setString(p.a.CAPCUT_THEME,this._theme))}clear(){this.checkCookieEnabled()||(U.A.remove(p.a.CAPCUT_THEME),d.a.removeItem(p.a.CAPCUT_THEME))}};function kn(){return new h.L({countryCode:void 0,getBrowserLang:()=>{if((0,b.i)())return window.navigator.language},cookieGetter:U.A.get.bind(U.A),cookieSetter:U.A.set.bind(U.A)})}const An=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Sn=()=>null!=location&&location.originParams?location.originParams:location.search||"",Cn=()=>An?Sn():"";function In(e){const{disableLocale:t,forceCompleteUrl:o=!1,search:a,realtimeSearch:n}=e??{},r=Cn();return(0,i.useCallback)(((e,i={},s)=>{const l=(0,b.i)()?n?Sn():r:a,d=new URLSearchParams(l);Object.keys(i).forEach((e=>{if(!i[e])return;const t=i[e];d.set(e,`${t}`)})),(0,p.i)()&&d.set("open_from_pwa","1");for(const t of s??[])d.delete(t);let u=t?e:h.L.formatRoutePath({path:e,locale:c.Ay.language});const _=o?location.origin:void 0;try{const e=new URL(u,_);e.search="",u=e.toString()}catch{}return d.toString()?`${u}?${d.toString()}`:u}),[t])}function En(e,t=!0){(0,i.useEffect)((()=>{null==e||e.onChange((({firstPartyAnalytics:e})=>{e&&t&&((0,u.r)().start(),(0,u.r)().clearInitQueue())}))}),[e,t])}const Tn=e=>{(0,i.useEffect)((()=>{const t=t=>{t.key===e&&t.stopPropagation()};return document.addEventListener("keydown",t,!0),()=>{document.removeEventListener("keydown",t,!0)}}),[])};function Pn(e,t){if(null==e)return{};var o,a,n=function(e,t){if(null==e)return{};var o,a,n={},r=Object.keys(e);for(a=0;a<r.length;a++)o=r[a],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)o=r[a],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}var Nn={spin:"style_spin__5uCiL","iconpark-spin":"style_iconpark-spin__mGDV3",rtl:"style_rtl__vYVyg","iconpark-spin-rtl":"style_iconpark-spin-rtl__ZyqaE"};!function(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&!(typeof document>"u")){var a=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===o&&a.firstChild?a.insertBefore(n,a.firstChild):a.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}}(".style_spin__5uCiL,.style_spin__5uCiL svg {animation: style_iconpark-spin__mGDV3 1s infinite linear;}\n.style_rtl__vYVyg,.style_rtl__vYVyg svg {transform: scaleX(-1);}\n.style_spin__5uCiL.style_rtl__vYVyg,.style_spin__5uCiL.style_rtl__vYVyg svg {animation: style_iconpark-spin-rtl__ZyqaE 1s infinite linear;}\n@keyframes style_iconpark-spin__mGDV3 {\n  0% { -webkit-transform: rotate(0); transform: rotate(0);} 100% {-webkit-transform: rotate(360deg); transform: rotate(360deg);}\n}\n@keyframes style_iconpark-spin-rtl__ZyqaE {\n  0% {-webkit-transform: scaleX(-1) rotate(0); transform: scaleX(-1) rotate(0);} 100% {-webkit-transform: scaleX(-1) rotate(360deg); transform: scaleX(-1) rotate(360deg);}\n}");var jn=["size","width","height","spin","rtl","color","fill","stroke","className"];function Rn(e){var t=(0,i.useRef)(null),o=e.size,a=void 0===o?"1em":o,n=e.width,r=e.height,s=e.spin,l=e.rtl,c=e.color,d=e.fill,u=e.stroke,p=e.className,_=Pn(e,jn),h=n||a,m=r||a,g=u||c,v=d||c;return(0,i.useEffect)((function(){var e,o;v||(null===(e=t.current)||void 0===e||e.querySelectorAll("[data-follow-fill]").forEach((function(e){e.setAttribute("fill",e.getAttribute("data-follow-fill")||"")})));g||(null===(o=t.current)||void 0===o||o.querySelectorAll("[data-follow-stroke]").forEach((function(e){e.setAttribute("stroke",e.getAttribute("data-follow-stroke")||"")})))}),[u,c,d]),i.createElement("svg",Object.assign({ref:t,width:h,height:m,viewBox:"0 0 24 24",preserveAspectRatio:"xMidYMid meet",fill:"none",role:"presentation",xmlns:"http://www.w3.org/2000/svg",className:"".concat(p||""," ").concat(s?Nn.spin:""," ").concat(l?Nn.rtl:"").trim()},_),i.createElement("g",null,i.createElement("path",{"data-follow-fill":"currentColor",d:"m7.358 12.696-1.91.354A3.001 3.001 0 0 0 6 19h3v2H6a5 5 0 0 1-.917-9.916 7 7 0 1 1 13.833 0A5.002 5.002 0 0 1 18 21h-3v-2h3a3 3 0 0 0 .552-5.95l-1.91-.354.298-1.92a5 5 0 1 0-9.88 0l.298 1.92Z",fill:v}),i.createElement("path",{"data-follow-fill":"currentColor",d:"M15.854 16.146a.5.5 0 0 0 0-.707l-3.147-3.146a1 1 0 0 0-1.414 0l-3.147 3.146a.5.5 0 0 0 0 .707l.708.708a.5.5 0 0 0 .707 0L11 15.414V20.5a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-5.086l1.44 1.44a.5.5 0 0 0 .706 0l.708-.708Z",fill:v})))}var Ln=["size","width","height","spin","rtl","color","fill","stroke","className"];function On(e){var t=(0,i.useRef)(null),o=e.size,a=void 0===o?"1em":o,n=e.width,r=e.height,s=e.spin,l=e.rtl,c=e.color,d=e.fill,u=e.stroke,p=e.className,_=Pn(e,Ln),h=n||a,m=r||a,g=u||c,v=d||c;return(0,i.useEffect)((function(){var e,o;v||(null===(e=t.current)||void 0===e||e.querySelectorAll("[data-follow-fill]").forEach((function(e){e.setAttribute("fill",e.getAttribute("data-follow-fill")||"")})));g||(null===(o=t.current)||void 0===o||o.querySelectorAll("[data-follow-stroke]").forEach((function(e){e.setAttribute("stroke",e.getAttribute("data-follow-stroke")||"")})))}),[u,c,d]),i.createElement("svg",Object.assign({ref:t,width:h,height:m,viewBox:"0 0 24 24",preserveAspectRatio:"xMidYMid meet",fill:"none",role:"presentation",xmlns:"http://www.w3.org/2000/svg",className:"".concat(p||""," ").concat(s?Nn.spin:""," ").concat(l?Nn.rtl:"").trim()},_),i.createElement("g",null,i.createElement("path",{d:"m12 14.121 6.586 6.586a.5.5 0 0 0 .707 0l1.414-1.414a.5.5 0 0 0 0-.707L14.121 12l6.586-6.586a.5.5 0 0 0 0-.707l-1.414-1.414a.5.5 0 0 0-.707 0L12 9.879 5.414 3.293a.5.5 0 0 0-.707 0L3.293 4.707a.5.5 0 0 0 0 .707L9.879 12l-6.586 6.586a.5.5 0 0 0 0 .707l1.414 1.414a.5.5 0 0 0 .707 0L12 14.121Z",clipRule:"evenodd",fillRule:"evenodd","data-follow-fill":"currentColor",fill:v})))}var Fn=["size","width","height","spin","rtl","color","fill","stroke","className"];function Dn(e){var t=(0,i.useRef)(null),o=e.size,a=void 0===o?"1em":o,n=e.width,r=e.height,s=e.spin,l=e.rtl,c=e.color,d=e.fill,u=e.stroke,p=e.className,_=Pn(e,Fn),h=n||a,m=r||a,g=u||c,v=d||c;return(0,i.useEffect)((function(){var e,o;v||(null===(e=t.current)||void 0===e||e.querySelectorAll("[data-follow-fill]").forEach((function(e){e.setAttribute("fill",e.getAttribute("data-follow-fill")||"")})));g||(null===(o=t.current)||void 0===o||o.querySelectorAll("[data-follow-stroke]").forEach((function(e){e.setAttribute("stroke",e.getAttribute("data-follow-stroke")||"")})))}),[u,c,d]),i.createElement("svg",Object.assign({ref:t,width:h,height:m,viewBox:"0 0 40 40",preserveAspectRatio:"xMidYMid meet",fill:"none",role:"presentation",xmlns:"http://www.w3.org/2000/svg",className:"".concat(p||""," ").concat(s?Nn.spin:""," ").concat(l?Nn.rtl:"").trim()},_),i.createElement("g",null,i.createElement("g",{fillOpacity:".2",filter:"url(#d3f14__a)"},i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5 10a5 5 0 0 1 5-5h20a5 5 0 0 1 5 5v20a5 5 0 0 1-5 5h-.132L17.124 22.256a4.167 4.167 0 0 0-5.892 0L5 28.488V10Zm23.333 5a3.333 3.333 0 1 1-6.666 0 3.333 3.333 0 0 1 6.666 0Z",fill:"url(#d3f14__b)"}),i.createElement("path",{d:"M5.681 32.52A4.998 4.998 0 0 0 10 35h15.154L14.767 24.613a.834.834 0 0 0-1.178 0L5.68 32.52Z",fill:"url(#d3f14__c)"})),i.createElement("defs",null,i.createElement("linearGradient",{id:"d3f14__b",x1:"20",y1:"5",x2:"20",y2:"35",gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#B8D3E0"}),i.createElement("stop",{offset:"1",stopColor:"#B8D3E0"})),i.createElement("linearGradient",{id:"d3f14__c",x1:"20",y1:"5",x2:"20",y2:"35",gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#B8D3E0"}),i.createElement("stop",{offset:"1",stopColor:"#B8D3E0"})),i.createElement("filter",{id:"d3f14__a",x:"5",y:"5",width:"30",height:"32",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},i.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),i.createElement("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),i.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),i.createElement("feOffset",{dy:"2"}),i.createElement("feGaussianBlur",{stdDeviation:"4"}),i.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),i.createElement("feColorMatrix",{values:"0 0 0 0 0.773889 0 0 0 0 0.869556 0 0 0 0 0.933333 0 0 0 0.1 0"}),i.createElement("feBlend",{in2:"shape",result:"effect1_innerShadow_1215_559888"})))))}var Un=["size","width","height","spin","rtl","color","fill","stroke","className"];function Mn(e){var t=(0,i.useRef)(null),o=e.size,a=void 0===o?"1em":o,n=e.width,r=e.height,s=e.spin,l=e.rtl,c=e.color,d=e.fill,u=e.stroke,p=e.className,_=Pn(e,Un),h=n||a,m=r||a,g=u||c,v=d||c;return(0,i.useEffect)((function(){var e,o;v||(null===(e=t.current)||void 0===e||e.querySelectorAll("[data-follow-fill]").forEach((function(e){e.setAttribute("fill",e.getAttribute("data-follow-fill")||"")})));g||(null===(o=t.current)||void 0===o||o.querySelectorAll("[data-follow-stroke]").forEach((function(e){e.setAttribute("stroke",e.getAttribute("data-follow-stroke")||"")})))}),[u,c,d]),i.createElement("svg",Object.assign({ref:t,width:h,height:m,viewBox:"0 0 20 20",preserveAspectRatio:"xMidYMid meet",fill:"none",role:"presentation",xmlns:"http://www.w3.org/2000/svg",className:"".concat(p||""," ").concat(s?Nn.spin:""," ").concat(l?Nn.rtl:"").trim()},_),i.createElement("g",null,i.createElement("g",{"data-follow-fill":"currentColor",fill:v},i.createElement("path",{d:"m8.518 2.828 1.29 1.29c-.446.34-.872.7-1.278 1.08L7.34 4.007a.833.833 0 0 0-1.18 0L3.986 6.183a.833.833 0 0 0 0 1.179l.778.778a5.517 5.517 0 0 0-1.504.853l-.453-.453a2.5 2.5 0 0 1 0-3.535l2.176-2.177a2.5 2.5 0 0 1 3.536 0Zm3.273 12.585.07-.176.773.774a.834.834 0 0 0 1.178 0l2.177-2.176a.833.833 0 0 0 0-1.179l-1.097-1.096c.374-.409.73-.84 1.068-1.29l1.207 1.208a2.5 2.5 0 0 1 0 3.535l-2.176 2.176a2.5 2.5 0 0 1-3.536 0l-.448-.448c.32-.401.585-.848.784-1.328Z"}),i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.747 5.144c-1.58 1.31-2.939 2.94-3.651 4.379A4.008 4.008 0 0 0 2.5 13.487v3.175c0 .46.373.834.833.834h3.175a4.008 4.008 0 0 0 3.996-4.32c1.406-.645 3.077-2.064 4.418-3.711 1.444-1.775 2.674-4.02 2.674-6.132a.833.833 0 0 0-.833-.833c-2.092 0-4.275 1.2-6.016 2.644Zm1.065 1.283C10.408 7.59 9.267 8.976 8.667 10.11a4.01 4.01 0 0 1 1.354 1.447c1.05-.543 2.425-1.691 3.608-3.144 1.095-1.345 1.916-2.818 2.196-4.141-1.29.275-2.71 1.073-4.013 2.155ZM6.965 11.19a2.341 2.341 0 0 0-2.798 2.296v2.342h2.341a2.341 2.341 0 0 0 .457-4.638Z"}))))}var Bn=["size","width","height","spin","rtl","color","fill","stroke","className"];function zn(e){var t=(0,i.useRef)(null),o=e.size,a=void 0===o?"1em":o,n=e.width,r=e.height,s=e.spin,l=e.rtl,c=e.color,d=e.fill,u=e.stroke,p=e.className,_=Pn(e,Bn),h=n||a,m=r||a,g=u||c,v=d||c;return(0,i.useEffect)((function(){var e,o;v||(null===(e=t.current)||void 0===e||e.querySelectorAll("[data-follow-fill]").forEach((function(e){e.setAttribute("fill",e.getAttribute("data-follow-fill")||"")})));g||(null===(o=t.current)||void 0===o||o.querySelectorAll("[data-follow-stroke]").forEach((function(e){e.setAttribute("stroke",e.getAttribute("data-follow-stroke")||"")})))}),[u,c,d]),i.createElement("svg",Object.assign({ref:t,width:h,height:m,viewBox:"0 0 80 80",preserveAspectRatio:"xMidYMid meet",fill:"none",role:"presentation",xmlns:"http://www.w3.org/2000/svg",className:"".concat(p||""," ").concat(s?Nn.spin:""," ").concat(l?Nn.rtl:"").trim()},_),i.createElement("g",null,i.createElement("path",{"data-follow-fill":"currentColor",d:"M10 20c0-5.523 4.477-10 10-10h36.667c5.523 0 10 4.477 10 10v13.693L60 40.36V20a3.333 3.333 0 0 0-3.333-3.333H20A3.333 3.333 0 0 0 16.667 20v27.004l4.962-4.704a8.333 8.333 0 0 1 11.422-.041l12.951 12.099-4.717 4.716L28.5 47.13a1.667 1.667 0 0 0-2.285.009l-9.548 9.051v.477A3.333 3.333 0 0 0 20 60h20.683v6.667H20c-5.523 0-10-4.477-10-10V20Z",fill:v}),i.createElement("path",{"data-follow-fill":"currentColor",d:"M54.075 28.889a6.296 6.296 0 1 1-12.592 0 6.296 6.296 0 0 1 12.592 0Z",fill:v}),i.createElement("path",{"data-follow-fill":"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M75.009 42.094a7.085 7.085 0 0 0-10.02 0L47.41 59.675v10.087h9.952L75.01 52.114a7.085 7.085 0 0 0 0-10.02Zm-6.484 3.536a2.084 2.084 0 1 1 2.948 2.948L55.29 64.761h-2.881v-3.014L68.525 45.63Z",fill:v})))}var Gn=["size","width","height","spin","rtl","color","fill","stroke","className"];function Wn(e){var t=(0,i.useRef)(null),o=e.size,a=void 0===o?"1em":o,n=e.width,r=e.height,s=e.spin,l=e.rtl,c=e.color,d=e.fill,u=e.stroke,p=e.className,_=Pn(e,Gn),h=n||a,m=r||a,g=u||c,v=d||c;return(0,i.useEffect)((function(){var e,o;v||(null===(e=t.current)||void 0===e||e.querySelectorAll("[data-follow-fill]").forEach((function(e){e.setAttribute("fill",e.getAttribute("data-follow-fill")||"")})));g||(null===(o=t.current)||void 0===o||o.querySelectorAll("[data-follow-stroke]").forEach((function(e){e.setAttribute("stroke",e.getAttribute("data-follow-stroke")||"")})))}),[u,c,d]),i.createElement("svg",Object.assign({ref:t,width:h,height:m,viewBox:"0 0 44 44",preserveAspectRatio:"xMidYMid meet",fill:"none",role:"presentation",xmlns:"http://www.w3.org/2000/svg",className:"".concat(p||""," ").concat(s?Nn.spin:""," ").concat(l?Nn.rtl:"").trim()},_),i.createElement("g",null,i.createElement("rect",{fill:"#FB1616",rx:"22",height:"44",width:"44"}),i.createElement("path",{fill:"#fff",d:"M31.662 17.205a2.524 2.524 0 0 0-1.782-1.782C28.306 15 22 15 22 15s-6.307 0-7.88.42a2.524 2.524 0 0 0-1.783 1.783c-.42 1.573-.42 4.855-.42 4.855s0 3.282.42 4.854a2.526 2.526 0 0 0 1.783 1.782c1.573.423 7.88.423 7.88.423s6.306 0 7.88-.423a2.522 2.522 0 0 0 1.782-1.782c.421-1.572.421-4.854.421-4.854s0-3.282-.42-4.853Zm-11.665 7.866v-6.025l5.221 2.99-5.221 3.034Z"}),i.createElement("path",{fill:"#FB1616",d:"M19.996 25.07v-6.024l5.222 2.99-5.222 3.034Z"})))}var Vn=["size","width","height","spin","rtl","color","fill","stroke","className"];function Hn(e){var t=(0,i.useRef)(null),o=e.size,a=void 0===o?"1em":o,n=e.width,r=e.height,s=e.spin,l=e.rtl,c=e.color,d=e.fill,u=e.stroke,p=e.className,_=Pn(e,Vn),h=n||a,m=r||a,g=u||c,v=d||c;return(0,i.useEffect)((function(){var e,o;v||(null===(e=t.current)||void 0===e||e.querySelectorAll("[data-follow-fill]").forEach((function(e){e.setAttribute("fill",e.getAttribute("data-follow-fill")||"")})));g||(null===(o=t.current)||void 0===o||o.querySelectorAll("[data-follow-stroke]").forEach((function(e){e.setAttribute("stroke",e.getAttribute("data-follow-stroke")||"")})))}),[u,c,d]),i.createElement("svg",Object.assign({ref:t,width:h,height:m,viewBox:"0 0 44 44",preserveAspectRatio:"xMidYMid meet",fill:"none",role:"presentation",xmlns:"http://www.w3.org/2000/svg",className:"".concat(p||""," ").concat(s?Nn.spin:""," ").concat(l?Nn.rtl:"").trim()},_),i.createElement("g",null,i.createElement("rect",{fill:"#FB1616",rx:"22",height:"44",width:"44"}),i.createElement("path",{fill:"#F8F8F8",d:"m27.776 20.325-1.2-.5 1.43-.762a3.733 3.733 0 0 0 1.562-5.065 3.755 3.755 0 0 0-5.075-1.561l-8.5 4.504a3.753 3.753 0 0 0-2.001 3.494 3.767 3.767 0 0 0 2.221 3.253c.03.01 1.202.5 1.202.5l-1.422.751a3.759 3.759 0 0 0-1.974 3.306A3.774 3.774 0 0 0 17.775 32c.604 0 1.198-.145 1.733-.423l8.509-4.505a3.745 3.745 0 0 0 1.335-5.435 3.773 3.773 0 0 0-1.576-1.312Zm-7.778 4.333v-5.305l5.005 2.654-5.005 2.651Z"})))}var qn=["size","width","height","spin","rtl","color","fill","stroke","className"];function Yn(e){var t=(0,i.useRef)(null),o=e.size,a=void 0===o?"1em":o,n=e.width,r=e.height,s=e.spin,l=e.rtl,c=e.color,d=e.fill,u=e.stroke,p=e.className,_=Pn(e,qn),h=n||a,m=r||a,g=u||c,v=d||c;return(0,i.useEffect)((function(){var e,o;v||(null===(e=t.current)||void 0===e||e.querySelectorAll("[data-follow-fill]").forEach((function(e){e.setAttribute("fill",e.getAttribute("data-follow-fill")||"")})));g||(null===(o=t.current)||void 0===o||o.querySelectorAll("[data-follow-stroke]").forEach((function(e){e.setAttribute("stroke",e.getAttribute("data-follow-stroke")||"")})))}),[u,c,d]),i.createElement("svg",Object.assign({ref:t,width:h,height:m,viewBox:"0 0 44 44",preserveAspectRatio:"xMidYMid meet",fill:"none",role:"presentation",xmlns:"http://www.w3.org/2000/svg",className:"".concat(p||""," ").concat(s?Nn.spin:""," ").concat(l?Nn.rtl:"").trim()},_),i.createElement("g",null,i.createElement("rect",{fill:"#0075FA",rx:"22",height:"44",width:"44"}),i.createElement("rect",{fill:"#0075FA",rx:"20",height:"40",width:"40",y:"2",x:"2"}),i.createElement("path",{fill:"#fff",d:"M22 20.857c1.657 0 3-1.535 3-3.428C25 15.535 23.657 14 22 14s-3 1.535-3 3.429c0 1.893 1.343 3.428 3 3.428Zm-6.143.572c1.026 0 1.857-.96 1.857-2.143 0-1.184-.831-2.143-1.857-2.143-1.025 0-1.857.96-1.857 2.143 0 1.183.832 2.143 1.857 2.143ZM30 19.286c0 1.183-.831 2.143-1.857 2.143s-1.857-.96-1.857-2.143c0-1.184.831-2.143 1.857-2.143S30 18.103 30 19.286Zm-9.286 3.143a4.857 4.857 0 0 0-4.857 4.857v.428c0 1.026.832 1.857 1.857 1.857h8.429A1.857 1.857 0 0 0 28 27.714v-.428a4.857 4.857 0 0 0-4.857-4.857h-2.429Zm8.736 6.285h1.121c.79 0 1.429-.64 1.429-1.428v-.572a4.286 4.286 0 0 0-4.286-4.285h-.342a4.995 4.995 0 0 1 2.2 4.142v1.48c0 .234-.044.458-.122.663Zm-15.021-2.143c0-1.723.872-3.244 2.2-4.142h-.343A4.286 4.286 0 0 0 12 26.714v.572c0 .789.64 1.428 1.429 1.428h1.121a1.852 1.852 0 0 1-.121-.662v-1.48Z",clipRule:"evenodd",fillRule:"evenodd"})))}var Kn=["size","width","height","spin","rtl","color","fill","stroke","className"];function Jn(e){var t=(0,i.useRef)(null),o=e.size,a=void 0===o?"1em":o,n=e.width,r=e.height,s=e.spin,l=e.rtl,c=e.color,d=e.fill,u=e.stroke,p=e.className,_=Pn(e,Kn),h=n||a,m=r||a,g=u||c,v=d||c;return(0,i.useEffect)((function(){var e,o;v||(null===(e=t.current)||void 0===e||e.querySelectorAll("[data-follow-fill]").forEach((function(e){e.setAttribute("fill",e.getAttribute("data-follow-fill")||"")})));g||(null===(o=t.current)||void 0===o||o.querySelectorAll("[data-follow-stroke]").forEach((function(e){e.setAttribute("stroke",e.getAttribute("data-follow-stroke")||"")})))}),[u,c,d]),i.createElement("svg",Object.assign({ref:t,width:h,height:m,viewBox:"0 0 44 44",preserveAspectRatio:"xMidYMid meet",fill:"none",role:"presentation",xmlns:"http://www.w3.org/2000/svg",className:"".concat(p||""," ").concat(s?Nn.spin:""," ").concat(l?Nn.rtl:"").trim()},_),i.createElement("g",null,i.createElement("rect",{fill:"#0075FA",rx:"22",height:"44",width:"44"}),i.createElement("rect",{fill:"#0075FA",rx:"20",height:"40",width:"40",y:"2",x:"2"}),i.createElement("path",{fill:"#F8F8F8",d:"M32.167 22.109c0-5.58-4.518-10.109-10.084-10.109S12 16.529 12 22.109c0 4.892 3.469 8.966 8.067 9.906v-6.874H18.05V22.11h2.017v-2.53a3.537 3.537 0 0 1 3.529-3.538h2.52v3.033H24.1c-.555 0-1.008.455-1.008 1.01v2.023h3.025v3.032h-3.025v7.026c5.092-.506 9.075-4.812 9.075-10.058Z"})))}const $n=({title:e,content:t,confirmContext:o,cancelContext:a,visible:r,onOk:s,onCancel:c,onComponentRender:d,footer:u})=>((0,i.useEffect)((()=>{d&&d()}),[]),(0,n.jsx)(y.A,{visible:r,onOk:()=>s&&s(),onCancel:()=>c&&c(),autoFocus:!1,focusLock:!0,title:(0,n.jsx)(n.Fragment,{}),closable:!1,className:"lv_modal_ask-cancelModal",okButtonProps:{style:{display:s?"initial":"none"}},cancelButtonProps:{style:{display:c?"initial":"none"}},okText:o,cancelText:a,footer:u,children:(0,n.jsxs)("div",{className:"lv_modal_ask-cancelModal-body",children:[e&&(0,n.jsx)("div",{className:"lv_modal_ask-cancelModal-body-question",children:e}),(0,n.jsx)("div",{className:l()("lv_modal_ask-cancelModal-body-content",{"none-title":!e}),children:t})]})})),Qn=(0,i.createContext)({shareService:void 0,isNewShareExport:!1,selectItemID:void 0}),Zn=()=>(0,i.useContext)(Qn);function Xn(e){const{shareService:t=e}=(0,i.useContext)(Qn),o=(0,m.d)(t,(e=>e.context.selectedPlatform??u.c.TikTok)),a=(0,m.d)(t,(e=>e.children));return(0,i.useMemo)((()=>a[p.p[o]]),[a,o])}const er=({auto:e=!0,userId:t,shareType:o,onChange:a})=>{const{loading:n,data:r=[],run:i}=(0,ce.Ay)((()=>p.u.getFacebookShareList({id:t,type:o}).then((e=>(null==a||a(e),e)))),{ready:!!t,auto:e,refreshDeps:[t,o],throttleInterval:1e3});return{loading:n,data:r,refresh:i}},tr=({fileId:e,platform:t})=>{const{data:o,loading:a}=(0,ce.Ay)((()=>p.t.getShareFormInfo({id:e,share_type:u.F.FilmVideo,platform:t}).then((e=>null!=e&&e.form_info?JSON.parse((null==e?void 0:e.form_info)||"{}"):void 0))),{auto:!0});return{lastFormInfo:o,loading:a}},or=({url:e})=>{const[t,o]=(0,i.useState)(!0),[a,s]=(0,i.useState)(!1);return(0,n.jsxs)("div",{className:l()("Lv_Task-item-img",t&&"Lv_Task-item-img-loading"),children:[(0,n.jsx)("div",{className:"Lv_Task-item-img-default",children:(a||t)&&(0,n.jsx)(r.Qjn,{size:32})}),e&&!a&&(0,n.jsx)("img",{crossOrigin:"anonymous",src:e,alt:"",onError:()=>s(!0),onLoad:()=>o(!1)})]})},ar=(e,t,o,a)=>{var i;const s=[{id:p.S.Review,title:c.F2.t("web_embedcode_title_share_for_review",{},"Share for review")},{id:p.S.SharePresentation,title:c.F2.t("web_embedcode_text_share_as_pre",{},"Share for presentation")},{id:u.c.TikTok,title:c.F2.t("upload_tiktok",{},"Upload to TikTok")},{id:u.c.TTAM,title:c.F2.t("web_upload_to_tt",{},"Upload to TikTok Ads Manager")},{id:u.c.Facebook,title:a},{id:u.c.YouTube,title:c.F2.t("web_shareYouTube_title_share_to_YouTube",{},"Upload to Youtube")},{id:p.S.Download,title:c.F2.t("web_download",{},"Download")},{id:p.S.SaveDropbox,title:c.F2.t("web_dropbox_text_save_to_dropbox",{},"Save to Dropbox")},{id:u.c.Schedule,title:c.F2.t("web_timing_title_schedule_Post",{},"Schedule")}];return o?(0,n.jsx)("div",{className:"lv_share_export-container-header-left-text",children:null==(i=s.find((e=>e.id===o)))?void 0:i.title}):t?(0,n.jsx)("div",{className:"lv_share_export-container-header-left-text",children:t}):e?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.eep,{size:20,color:"#2DD196",style:{marginRight:"8px"}}),(0,n.jsx)("div",{className:"lv_share_export-container-header-left-text",children:c.F2.t("web_sharereview_text_video_is_ready",{},"Your video is ready!")})]}):null},nr=({renderService:e,shareModalHideCallback:t,showHideUi:o,handleCloseCallback:a})=>{var s,d,p,_,h,v;const[f,y]=(0,g.B)(e),w=f.matches("open.save.saving"),b=f.matches("open.rendering"),A=f.matches("open.renderSuccess.requestSuccess"),S=f.matches("open.save.fail"),C=f.matches("open.renderFailed"),I=f.matches("open.renderFailed")||f.matches("open.renderSuccess.requestFailed")||f.matches("open.save.fail"),[E,T]=(0,i.useState)(!1),P=f.context.allowCloseWindow??!0,N=null==(d=null==(s=f.context)?void 0:s.selectItemData)?void 0:d.selectItemID,j=(0,m.d)(e,(e=>{var t;return null==(t=e.context)?void 0:t.customText})),R=(0,m.d)(e,(e=>{var t;return null==(t=e.context)?void 0:t.hideHeaderBtn})),L=null==(v=null==(h=null==(_=null==(p=f.context)?void 0:p.selectItemData)?void 0:_.payload)?void 0:h.item)?void 0:v.platformContent,O=(0,n.jsx)(x.A,{className:"lv_share_export-tooltip",position:"top",trigger:"hover",content:c.F2.t("web_ttam_feedback"),children:(0,n.jsx)(r.R6Z,{className:"right-feedback",size:24,onClick:()=>{S||C?(0,u.n)().report({action:u.E.feedback},{panel_page:S?u.P.save_fail:u.P.export_fail}):(0,u.n)().report({action:u.E.feedback}),Ji({})}})}),F=(0,n.jsx)(x.A,{className:"lv_share_export-tooltip",position:"top",trigger:"hover",content:c.F2.t("hide_to_taskbar"),children:(0,n.jsx)(r.lq4,{size:24,onClick:()=>{var e,o,n,r;a(),y("CLOSE"),null==t||t(),(0,u.n)().report({action:u.E.hide,current_page:null==(o=null==(e=Ev())?void 0:e.extraData)?void 0:o.currentPage,enter_from:null==(r=null==(n=Ev())?void 0:n.extraData)?void 0:r.enterFrom})}})}),D=(0,n.jsx)(x.A,{className:"lv_share_export-tooltip",position:"top",trigger:"hover",content:c.F2.t("web_ttam_close"),children:(0,n.jsx)(r.En0,{size:24,onClick:()=>{var e,t,o,n;a(),y("CLOSE"),(0,u.n)().report({action:u.E.close,current_page:null==(t=null==(e=Ev())?void 0:e.extraData)?void 0:t.currentPage,enter_from:null==(n=null==(o=Ev())?void 0:o.extraData)?void 0:n.enterFrom})}})}),U=(0,i.useMemo)((()=>!!w||!!b&&!P),[w,b,P]);return(0,i.useEffect)((()=>{U||T(!1)}),[U]),(0,n.jsxs)("div",{className:"lv_share_export-container-header",children:[(0,n.jsx)("div",{className:"lv_share_export-container-header-left",children:ar(A,null==j?void 0:j.title,N,L)}),(0,n.jsxs)("div",{className:"lv_share_export-container-header-right",children:[!R&&(0,n.jsxs)(n.Fragment,{children:[O,U&&(0,n.jsx)(mt.A,{showArrow:!0,arrowProps:{className:"hideModalIcon-arrow"},popupVisible:E&&U,position:"br",getPopupContainer:e=>document.querySelector(".lv_share_export-container-header-right")??e,popup:()=>(0,n.jsxs)("div",{className:"hideModalIcon-trigger",style:{width:280},children:[(0,n.jsx)("div",{className:"title",children:c.F2.t("web_not_hide")}),(0,n.jsx)("div",{className:"content",children:c.F2.t("web_not_hide_window")}),(0,n.jsx)("div",{className:"footer",children:(0,n.jsx)(k.A,{type:"primary",onClick:()=>T((e=>!e)),children:c.F2.t("web_got_it")})})]}),children:(0,n.jsx)(x.A,{className:"lv_share_export-tooltip",position:"top",trigger:"hover",content:c.F2.t("hide_to_taskbar"),children:(0,n.jsx)(r.lq4,{className:l()({"hideModalIcon-disable":!U}),size:24,onClick:()=>{var e,t,o,a;T((e=>!e)),(0,u.n)().report({action:u.E.hide,panel_page:u.P.saving,current_page:null==(t=null==(e=Ev())?void 0:e.extraData)?void 0:t.currentPage,enter_from:null==(a=null==(o=Ev())?void 0:o.extraData)?void 0:a.enterFrom})}})})}),!U&&(o?F:D)]}),R&&I&&D]})]})};var rr=(e=>(e.presentationPage="share-as-presentation-page",e.shareCodeEmbedPage="share-code-embed-page",e))(rr||{});const ir={allow_download:!0,presentation_share_link:"",owner:"",presentation_share_id:"",access_type:1,auto_subtitles:!0,auto_subtitles_config:{source_lang:"en-GB",display_by_default:!1},title:"",description:""},sr={route:{page:"share-as-presentation-page"},setRoute:()=>{console.log("[setRoute] child component doesn\u2019t see the value from context provider")},settingsInfo:ir,setSettingsInfo:()=>{console.log("[setSettingsInfo] child component doesn\u2019t see the value from context provider")},params:{workspaceID:"0",fileID:"0"},report:()=>{console.log("[report] child component doesn\u2019t see the value from context provider")}};c.Ay.t("web_embedcode_text_share_as_pre"),c.Ay.t("web_embedcode_text_complete_embed");const lr=(0,i.createContext)(sr),cr={"presentation-wrapper":"_presentation-wrapper_pxcdy_1","switch-wrapper":"_switch-wrapper_pxcdy_27","switch-label":"_switch-label_pxcdy_33","select-wrapper":"_select-wrapper_pxcdy_40","select-label":"_select-label_pxcdy_44","switch-component":"_switch-component_pxcdy_52","select-component":"_select-component_pxcdy_53","auto-subtitles-wrapper":"_auto-subtitles-wrapper_pxcdy_56","auto-subtitles-child-wrapper":"_auto-subtitles-child-wrapper_pxcdy_62","group-item":"_group-item_pxcdy_82","option-item":"_option-item_pxcdy_92","option-tag":"_option-tag_pxcdy_98","title-description-wrapper":"_title-description-wrapper_pxcdy_113",title:"_title_pxcdy_113",description:"_description_pxcdy_116","share-channels-tip":"_share-channels-tip_pxcdy_126"},dr=(0,i.createContext)({expandModalInstance:void 0,localeTranslation:{},handleClose:()=>{},isChangeSubTab:!1,setIsChangeSubTab:()=>{}}),ur=e=>{const t={MONTH:1,YEAR:12},o={1:"1_month",12:"12_month"};if(null==e||!e.cycleUnit||null==e||!e.subscribeCycle)return"free";const a=((null==t?void 0:t[e.cycleUnit])??0)*e.subscribeCycle;return a&&null!=o&&o[a]?`${o[a]}${"auto"===e.subscribeType?"_auto":""}`:"free"},pr=e=>{var t,o;const a=null==(o=null==(t=null==e?void 0:e.spaceList)?void 0:t.filter((e=>!e.product_id.includes("subscription"))))?void 0:o.reduce(((e,t)=>t.space_capacity+e),0);return a?(0,Y.b)(a,"gb"):"0GB"},_r=e=>{const t={MONTH:1,YEAR:12},o={1:"1_month",12:"12_month"};if(null==e||!e.cycle_unit||null==e||!e.subscribe_cycle)return"free";const a=((null==t?void 0:t[e.cycle_unit])??0)*e.subscribe_cycle;return a&&null!=o&&o[a]?`${o[a]}${e.auto_subscribe?"_auto":""}`:"free"};i.forwardRef((({handleValidate:e,toBind:t},o)=>{const{isChangeSubTab:a}=(0,i.useContext)(dr),s=(0,i.useContext)(dr).expandModalInstance.instanceService,l=(0,m.d)(s,(e=>e.context.paymentMethods)),d=(0,m.d)(s,(e=>e.context.isBOE)),u=(0,m.d)(s,(e=>e.context.locale)),p=(0,m.d)(s,(e=>e.hasTag("loading"))),_=(0,m.d)(s,(e=>e.context.userInfo)),h=(0,m.d)(s,(e=>e.hasTag("fail"))),g=(0,m.d)(s,(e=>e.context.reporterParams)),v=(0,m.d)(s,(e=>e.context.cloudInfo)),f=(0,m.d)(s,(e=>e.context.productInfo)),y=(0,m.d)(s,(e=>e.context.orderInfo)),w=(0,m.d)(s,(e=>e.context.currentPayment)),b=(0,i.useCallback)((e=>wo.getDistrict({serviceProps:{isBOE:d,region:_.region},basicInfoProps:{language:u,key:"83639969f5b36a5e31a83487aedcbc9b",geonameid:e}})),[]);return(0,n.jsxs)(D.A,{webp:!0,className:"lv-storage-expand_payment-dropin-container",loading:p,children:[!h&&(0,n.jsx)(le.bv,{ref:o,onGetUnifiedBinDetail:async(e,t)=>await wo.getUnifiedBinDetail({serviceProps:{isBOE:d,region:_.region},basicInfoProps:{card_number:e,country_or_region:t,merchant_user_id:_.uid}}),paymentMethodsList:l.paymentMethodsList,onSubmit:async e=>{const{formData:o,paymentMethodType:n,paymentParams:r,paymentMethod:i,storeCard:l,token:c}=e,d={method_id:i.paymentMethodId,payment_method_token:c,payment_elements:r};"CCDC"===n&&!c&&(d.element_params=o),t?(s.send({type:"REPORT_CLOUD_PAY_WINDOW",action:ja.LINK}),s.send({type:"BINDPAYPAl",entryTag:"bind",pipoSubmitParams:e})):(s.send({type:"REPORT_CLOUD_PAY_WINDOW",action:ja.PAY}),((e,t,o,a,n,r,i)=>{var s,l,c;(new ka).report({action:"payment_pay",pay_type:null!=(c=null==(l=null==(s=null==t?void 0:t.payment_method)?void 0:s.method_id)?void 0:l.includes)&&c.call(l,"ccdc")?"ccdc":"paypal",order_id:i,sub_page:null!=o&&o.isCloud?"cloud":"vip",page_from:null==a?void 0:a.pageFrom,is_switch_tab:e?1:0,page_from_extra:null==a?void 0:a.pageFromExtra,product_id:o?null==o?void 0:o.product_id:void 0,currency:o?null==o?void 0:o.currency_code:void 0,membership_type_now:ur(n),membership_type_buy:null!=o&&o.isCloud||!o?void 0:_r(o),is_free_trial:null!=o&&o.isCloud||!o?void 0:o.can_trial?1:0,price:o?Number(null==o?void 0:o.price_tips):void 0,cloud_storage_now:pr(r),cloud_storage_buy:null!=o&&o.isCloud?null==o?void 0:o.product_capacity_tips:void 0,current_page:null==a?void 0:a.currentPage})})(a,w,f,g,null==_?void 0:_.vipInfo,v,null==y?void 0:y.order_id),s.send({type:"PAYING",data:{store_payment_method:l,payment_method:d},pipoSubmitParams:e,entryTag:"pay"}))},storedPaymentMethodsList:l.storedPaymentMethodsList,onValidate:t=>{e(t)},onSelectPaymentMethod:e=>{const t=e.paymentMethod.paymentMethodId;s.send({type:"SAVE_BIND_PAYMENT",paymentMethod:{method_id:t,payment_elements:[],payment_method_token:e.token}})},onFetchDistrict:b,onQueryOrder:()=>null}),h&&(0,n.jsxs)("div",{className:"fetchError",children:[(0,n.jsx)("div",{className:"icon",children:(0,n.jsx)(r.cwh,{size:100})}),(0,n.jsx)("div",{className:"context",children:c.Ay.t("web_cash_and_pay_plan_could_not_load",{},"Couldn\u2019t load")}),(0,n.jsx)(k.A,{onClick:()=>{s.send({type:"RE_FETCH"})},children:c.Ay.t("web_cash_and_pay_plan_reload",{},"Reload")})]})]})}));var hr=(e=>(e.CAPACITY_INSUFFICIENT="CAPACITY_INSUFFICIENT",e.CAPACITY_INSUFFICIENT_WITH_BUY="CAPACITY_INSUFFICIENT_WITH_BUY",e.CAPACITY_BUY="CAPACITY_BUY",e.UPLOAD_FULL_SPACE_RESOLVE="UPLOAD_FULL_SPACE_RESOLVE",e.VIP_BUY="VIP_BUY",e.MANAGEMENT="MANAGEMENT",e))(hr||{});Ft.Month,Ft.Year;var mr=(e=>(e.UpgradeToPro="upgrade_to_pro",e.profileIconUpgrade="profile_icon_upgrade",e.spaceUpgrade="space_upgrade",e.spaceLimitUpgrade="space_limit_upgrade",e.removeWatermarkUpgrade="remove_watermark_upgrade",e.allowDownloadUpgrade="allow_download_upgrade",e.editUpgradeToUnlock="edit_upgrade_to_unlock",e.exportUpgradeToPro="export_upgrade_to_pro",e.notification="notification",e))(mr||{});const gr=p.a.CLOUD_STORAGE_PAYMENT_AND_BINDING,vr=({isBind:e,orderId:t,isSubscribe:o,disabledClosed:a=!0})=>`${window.location.origin+d.R.THIRDPARTY_CLOUD_STORAGE_AUTH.PATH}?callBackType=${p.a.CLOUD_STORAGE_PAYMENT_AND_BINDING}&is_bind=${e}&orderId=${t}&isSubscribe=${o}&disabledClosed=${a}`,fr=({isBind:e,orderId:t,isSubscribe:o})=>`${vr({isBind:e,orderId:t,isSubscribe:o})}&notify=true`,yr=(e,t)=>({environment:e?"test":"live",locale:t,flow:"web",color_theme:"light"}),wr=e=>{var t,o,a;const n=(null==(t=null==e?void 0:e.spaceList)?void 0:t.length)&&(null==(a=null==(o=null==e?void 0:e.spaceList)?void 0:o.reduce(((e,t)=>e.space_end>t.space_end?e:t)))?void 0:a.space_end)||0;return n?se()(1e3*n).format("YYYY/MM/DD"):""},br=e=>{var t;return null!=e&&e.isFirstSubscribe?Na.NOT_YET:null!=(t=null==e?void 0:e.spaceList)&&t.length?Na.IN_PROGRESS:Na.EXPIRE},xr=e=>{var t,o,a;return null!=(o=null==(t=null==e?void 0:e.payment_method)?void 0:t.method_id)&&o.includes("paypal")?La.PAYPAL:null!=(a=null==e?void 0:e.payment_method)&&a.payment_method_token?La.CARD:La.NEW_CARD},kr=e=>Math.round(e/1048576*100)/100;const Ar={webid:"",pipoSubmitParams:void 0,entryTag:"pay",enableSubscription:void 0,videoOperation:[],isVideoOperationPlay:!0,isShowCloudExpandEntrance:!0,userInfo:void 0,cloudInfo:void 0,workspaceInfo:void 0,workspaceList:void 0,defaultWorkspaceInfo:void 0,isBOE:!0,productInfo:void 0,orderInfo:void 0,bindInfo:void 0,locale:"en",vipGroupProductList:{[Ft.Month]:[],[Ft.Year]:[]},groupProductList:[],allPriceList:void 0,allVipPriceList:void 0,currentPayment:void 0,agreementLinks:{privacy_policy:"",terms_of_service:"",payment_agreement:""},paymentMethods:{paymentMethodsList:[],storedPaymentMethodsList:[]},subscribeInfo:[],riskInfo:void 0,reporterParams:void 0,onPayStatusChange:()=>{},onModalStatusChange:()=>{},onBindStatusChange:()=>{},handleReporterProcessing:()=>{},cancelSubscrtbeErrorCallback:()=>{},cancelSubscrtbeSuccessCallback:()=>{},handleCloseCancelRenewalModal:()=>{}};(0,I.O)({id:"LvStorageExpandService",context:Ar,initial:"initing",invoke:[{id:"fetchVideoOperation",src:"fetchVideoOperation",onDone:{actions:"saveVideoOperation"}},{id:"getSubscriptionAb",src:"getSubscriptionAb",onDone:{actions:"assignEnableSubscription"}}],states:{initing:{initial:"unknow",states:{unknow:{always:[{target:"unLogin",cond:"noLogined"},{target:"login"}]},unLogin:{on:{USER_HAS_LOGIN:{target:"login"}}},login:{entry:["initStorageListener"],tags:"loading",invoke:[{id:"fetchGroupProductList",src:"fetchGroupProductList",onDone:{target:"#LvStorageExpandService.hide",actions:["saveGroupProductList","saveAllPriceList","saveWebDisplay"]},onError:{target:"#LvStorageExpandService.hide"}}]}}},hide:{entry:["setDefaultproductInfo"]},display:{initial:"working",invoke:[{id:"asyncTaskActor",src:u.L},{id:"getSubscribeInfo",src:"getSubscribeInfo",onDone:{actions:"saveSubscribeInfo"}},{id:"getSpaceList",src:"getSpaceList",onDone:{actions:"saveSpaceList"}}],states:{working:{initial:"selectingVipProduct",states:{selectingVipProduct:{initial:"loading",entry:["clearOrderInfo","clearProductInfo","clearPayment","clearPaymentMethods","clearBindInfo"],states:{loading:{tags:"loading",invoke:[{id:"fetchVipGroupProductList",src:"fetchVipGroupProductList",onDone:{actions:["saveVipGroupProductList","saveAllVipPriceList","saveWebDisplay"]},onError:{target:"fetchError"}}],always:[{target:"selecting",cond:"isVipListPreDataReady"}]},selecting:{},fetchError:{tags:["fail"]}},on:{SHOW_PAYMENT_METHODS:{target:"selectingPayment",actions:["saveCurrentProduct"]},GO_CLOUD_PRODUCT:{target:"selectingProduct"},RE_FETCH:{target:".loading"}}},selectingProduct:{tags:["package"],entry:["clearOrderInfo","clearProductInfo","clearPayment","clearPaymentMethods","clearBindInfo"],initial:"loading",states:{loading:{tags:"loading",invoke:[{id:"fetchGroupProductList",src:"fetchGroupProductList",onDone:{actions:["saveGroupProductList","saveAllPriceList","saveWebDisplay"]},onError:{target:"fetchError"}}],always:[{target:"selecting",cond:"isSpaceListPreDataReady"}]},selecting:{},fetchError:{tags:["fail"]}},on:{RECORD_CURRENT_PRODUCT:{actions:["saveCurrentProduct"]},SHOW_PAYMENT_METHODS:{target:"selectingPayment",actions:["saveCurrentProduct"]},BACK:{target:"selectingVipProduct"},RE_FETCH:{target:".loading"}}},selectingPayment:{tags:["pay","back"],initial:"loading",entry:"clearOrderInfo",states:{loading:{tags:"loading",invoke:[{src:"fetchPaymentMethods",id:"fetchPaymentMethods",onDone:[{target:"fillingForm",actions:"savePaymentMethods"}],onError:{target:"fetchError"}}]},fetchError:{tags:["fail"],on:{RE_FETCH:{target:"loading"}}},fillingForm:{}},on:{PAYING:{actions:["saveCurrentPayment","recodeEntryTag","savePipoSubmitParams"],target:"getOrderInfo"},SAVE_BIND_PAYMENT:{actions:"saveBindPayment"},BINDPAYPAl:{target:"getOrderInfo",actions:["recodeEntryTag","savePipoSubmitParams"]},CHANGE_PAYMENT:{actions:"changePayment"},SAVE_RISK_INFO:{actions:"saveRiskInfo"},BACK:[{target:"selectingProduct",cond:"isCloudProduct"},{target:"selectingVipProduct"}]}},getOrderInfo:{initial:"loading",always:[{target:"paying",cond:({orderInfo:e,entryTag:t})=>!!e&&("pay"===t&&0===e.type)},{target:"binding",cond:({orderInfo:e,entryTag:t})=>!!e&&("bind"===t&&0===e.type)},{target:"binding",cond:({orderInfo:e})=>!!e&&2===e.type},{target:"binding.freeTrialLinkSuccess",actions:e=>{const{onBindStatusChange:t,onPayStatusChange:o}=e;null==o||o("SUCCESS",e),null==t||t("SUCCESS")},cond:({orderInfo:e})=>!!e&&1===e.type}],invoke:{src:"fetchPaymentOrderId",id:"fetchPaymentOrderId",onDone:[{actions:["savePaymentOrderId","getRiskInfo"]}],onError:{target:".fail"}},states:{loading:{tags:["loading"]},fail:{tags:["fail"]}},on:{RETRY_SELECT_PAYMENT:{target:"selectingPayment"},BACK_SELECTING_PAYMENT:{target:"selectingPayment"},BACK:[{target:"selectingProduct",cond:"isCloudProduct"},{target:"selectingVipProduct"}]}},paying:{initial:"judging",tags:["pay"],invoke:[{id:"listeningStateChange",src:"listeningStateChange"}],states:{judging:{tags:["loading","back"],always:[{cond:"inPaymentPending",target:"loading"},{cond:"inPaymentSuccess",target:"success"},{cond:"inPaymentFail",target:"fail"}],invoke:{id:"handlePaying",src:"handlePaying",onDone:[{target:"loading",actions:"handleRedirect",cond:(e,t)=>"redirect"===t.data.result_code},{target:"intervalLoading",cond:(e,t)=>"accepted"===t.data.result_code||"success"===t.data.result_code,actions:"closeProxyWindow"},{target:"fail",cond:(e,t)=>["error","canceled"].includes(t.data.result_code),actions:"closeProxyWindow"},{target:"fail",actions:"closeProxyWindow"}],onError:{target:"fail",actions:"closeProxyWindow"}}},loading:{tags:["loading","back"],entry:"updateOrderPendingInfo"},intervalLoading:{tags:["loading","back"],invoke:{id:"intervalCheckStatus",src:"intervalCheckStatus"}},queryLoading:{tags:["loading","queryLoading","back"],invoke:{id:"intervalCheckStatus",src:"intervalCheckStatus"}},success:{tags:"success",entry:["handleStatusChange","updateOrderSuccessStatus"],invoke:{id:"invokeReportStatus",src:"invokeReportStatus"}},fail:{tags:"fail",entry:["handleStatusChange","updateOrderFailStatus"],invoke:{id:"invokeReportStatus",src:"invokeReportStatus"}}},on:{BACK_SELECTING_PRODUCT:{target:"selectingProduct"},BACK:[{target:"selectingProduct",cond:"isCloudProduct"},{target:"selectingVipProduct"}],ON_OK:[{target:"selectingProduct",cond:"isCloudProduct"},{target:"selectingVipProduct"}],TO_SUCCESS:{target:".success"},TO_FAIL:{target:".fail",actions:["updateOrderFailCode"]},TO_CHECK_RESULT:{target:".queryLoading"},RETRY_SELECT_PAYMENT:{target:"selectingPayment"}}},binding:{initial:"unknown",tags:["pay","link"],invoke:{id:"listeningStateChange",src:"listeningStateChange"},states:{unknown:{tags:["loading","back"],invoke:{id:"storePaymentMethod",src:"storePaymentMethod",onDone:[{target:"queryLoading",actions:["saveIdempotencyKey","closeProxyWindow"],cond:(e,t)=>"success"===t.data.result_code},{target:"bindLoading",actions:["handleRedirect","saveIdempotencyKey"],cond:(e,t)=>"redirect"===t.data.result_code},{target:"fail",cond:(e,t)=>"error"===t.data.result_code,actions:"closeProxyWindow"},{target:"fail",actions:"closeProxyWindow"}],onError:{target:"fail",actions:"closeProxyWindow"}}},bindLoading:{tags:["loading","back"],on:{TO_CHECK_RESULT:{target:"queryLoading"}}},queryLoading:{tags:["loading","back","queryLoading"],invoke:{id:"queryBindStatus",src:"queryBindStatus",onDone:[{target:"freeTrialLinkSuccess",actions:e=>{const{onBindStatusChange:t,onPayStatusChange:o}=e;null==o||o("SUCCESS",e),null==t||t("SUCCESS")},cond:({productInfo:e},t)=>!(null==e||!e.can_trial||"success"!==t.data.status)},{target:"success",actions:({onBindStatusChange:e})=>{null==e||e("SUCCESS")},cond:({productInfo:e},t)=>!(null!=e&&e.can_trial)&&"success"===t.data.status},{target:"fail",actions:({onBindStatusChange:e})=>{null==e||e("FAIL")},cond:(e,t)=>"error"===t.data.status},{target:"bindLoading",actions:({onBindStatusChange:e})=>{null==e||e("PROCESSING")}}]}},freeTrialLinkSuccess:{tags:"success"},success:{tags:"success"},fail:{tags:"fail"}},on:{RETRY_SELECT_PAYMENT:{target:"selectingPayment"},BACK_SELECTING_PAYMENT:{target:"selectingPayment"},BACK:[{target:"selectingProduct",cond:"isCloudProduct"},{target:"selectingVipProduct"}],ON_OK:[{target:"selectingProduct",cond:"isCloudProduct"},{target:"selectingVipProduct"}],INIT_BIND_STATUS_CHANGE:{actions:["initBindStatusChange"]}}},back:{type:"history",history:"shallow"}}},autoRenewal:{initial:"loading",tags:["back","manage","renewalBack"],states:{loading:{tags:"loading",invoke:{id:"getSubscribeInfo",src:"getSubscribeInfo",onDone:{target:"fillingForm",actions:"saveSubscribeInfo"},onError:{target:"fetchError"}}},fetchError:{tags:["fail"],on:{RE_FETCH:{target:"loading"}}},fillingForm:{},cancelRenewal:{tags:"cancelRenewalLoading",invoke:{id:"cancelAutoRenewal",src:"cancelAutoRenewal",onDone:{target:"loading",actions:["changeCloudCancelStatus",({cancelSubscrtbeSuccessCallback:e,handleCloseCancelRenewalModal:t})=>{e(),null==t||t()}]},onError:{target:"fillingForm",actions:({cancelSubscrtbeErrorCallback:e})=>{e()}}}}},on:{BACK:{target:"working.back"},CANCEL:{target:".cancelRenewal",actions:(0,E.kp)({handleCloseCancelRenewalModal:(e,t)=>null==t?void 0:t.handleCloseCancelRenewalModal})}}}},on:{BACK_HIDE:{actions:(0,E.kp)({isShowCloudExpandEntrance:()=>!0})},TO_AUTO_RENEWAL:{target:".autoRenewal"},QUERY_STATUS:[{target:".working.paying.queryLoading",in:"#LvStorageExpandService.display.working.paying.loading"},{target:".working.binding.queryLoading",in:"#LvStorageExpandService.display.working.binding.bindLoading"}]}}},on:{SAVE_VIDEO_OPERATION:{actions:["saveVideoOperation"]},SHOW_PAY_MODAL:{target:"display",actions:["reportCloudEntrance"]},HIDE_PAY_MODAL:{target:"hide",actions:["hidePayModal"]},REPORT_INSUFFICIENT_MODAL:{actions:["reportSpacePopup"]},REPORT_CLOUD_PAY_WINDOW:{actions:["reportCloudPayWindow"]},REPORT_CLOUD_CLOSE_POPUP:{actions:["reportCloudClosePopup"]},DISPLAY_BACK:{target:"display"},INIT_PARAMS:{actions:"initParams"},INIT_REPORTER_PARAMS:{actions:"initReporterParams"},INIT_TO_CLOUD:{target:"display.working.selectingProduct",actions:["reportCloudEntrance"]},VIDEO_OPERATION_PLAY:{actions:(0,E.kp)({isVideoOperationPlay:()=>!0})},VIDEO_OPERATION_PAUSE:{actions:(0,E.kp)({isVideoOperationPlay:()=>!1})},UNSHOW_CLOUD_EXPAND:{target:"display",actions:[(0,E.kp)({isShowCloudExpandEntrance:()=>!1}),"reportCloudEntrance"]},SHOW_AUTO_RENEWAL:{target:"display.autoRenewal",actions:[(0,E.kp)({isShowCloudExpandEntrance:()=>!1}),"reportCloudEntrance"]}}},{guards:{noLogined:e=>{var t;return!(null!=(t=null==e?void 0:e.userInfo)&&t.hasLogined)},inPaymentPending:e=>{var t;return(null==(t=e.orderInfo)?void 0:t.order_status)===Rt.PENDING},inPaymentSuccess:e=>{var t;return(null==(t=e.orderInfo)?void 0:t.order_status)===Rt.SUCCESS},inPaymentFail:e=>{var t;return(null==(t=e.orderInfo)?void 0:t.order_status)===Rt.FAIL},isCloudProduct:e=>{var t;return!(null==(t=null==e?void 0:e.productInfo)||!t.isCloud)},isVipListPreDataReady:e=>!!e.allVipPriceList,isSpaceListPreDataReady:e=>!(!e.cloudInfo||!e.allPriceList)},actions:{saveVipGroupProductList:(0,E.kp)({vipGroupProductList:(e,t)=>t.data.vipGroupProductList}),saveAllVipPriceList:(0,E.kp)({allVipPriceList:(e,t)=>t.data.allVipPriceList}),getRiskInfo:(0,E.kp)({riskInfo:({userInfo:e,locale:t,allPriceList:o,allVipPriceList:a,webid:n,productInfo:r},i)=>{var s,l,c,u;const p=(0,xe.DR)();return(0,xe.DJ)(null==(s=null==i?void 0:i.data)?void 0:s.order_id),JSON.stringify({...p,screen_resolution:[null==p?void 0:p.screen_width,null==p?void 0:p.screen_height],user_register_country:null==e?void 0:e.region,email:null==e?void 0:e.email,user_register_time:null==e?void 0:e.createTime,account_name:null==e?void 0:e.name,account_create_days:(Number(new Date)/1e3-e.createTime)/86400,uid:null==e?void 0:e.uid,app_name:d.P.APP_NAME,app_id:d.P.APP_ID,app_language:t,sys_language:t,os_version:navigator.userAgent,device_id:n,ip:null==(l=i.data)?void 0:l.client_ip,terminal_type:(0,Y.v)().env,update_time:Number(new Date),user_id:null==e?void 0:e.uid,user_create_time:new Date(1e3*((null==e?void 0:e.createTime)??0)).toISOString(),request_id:null==(c=i.data)?void 0:c.order_id,item_sku_product_info:null==(u=null!=r&&r.isCloud?o:a)?void 0:u.map((e=>({item_sku_id:e.product_id,item_sku_unit_price:e.price_tips,item_sku_currency:e.currency_code,item_sku_quantity:1})))})}}),recodeEntryTag:(0,E.kp)({entryTag:(e,t)=>t.entryTag}),savePipoSubmitParams:(0,E.kp)({pipoSubmitParams:(e,t)=>t.pipoSubmitParams}),saveSpaceList:(0,E.kp)({cloudInfo:(e,t)=>t.data}),saveVideoOperation:(0,E.kp)({videoOperation:(e,t)=>t.data}),reportSpacePopup:({handleReporterProcessing:e,reporterParams:t,workspaceInfo:o},a)=>{try{null==e||e("cloud_space_popup",{action:a.action,enter_from:t.enterFrom,current_page:t.currentPage,space_id:null==o?void 0:o.workspace_id,role:null==o?void 0:o.role,space_user_cnt:null==o?void 0:o.member_cnt,tool_type:(null==t?void 0:t.toolType)||""})}catch(n){console.error("reportSpacePopup",n)}},reportCloudEntrance:({handleReporterProcessing:e,cloudInfo:t,workspaceInfo:o,reporterParams:a})=>{try{null==e||e("click_cloud_entrance",{status:br(t),enter_from:a.enterFrom,current_page:a.currentPage,tool_type:null==a?void 0:a.toolType,used_space:kr((null==o?void 0:o.usage)??0),max_space:kr((null==o?void 0:o.quota)??0),expire_date:wr(t),space_id:null==o?void 0:o.workspace_id})}catch(n){console.error("reportCloudEntrance",n)}},reportCloudPayWindow:({handleReporterProcessing:e,workspaceInfo:t,orderInfo:o,currentPayment:a,bindInfo:n,productInfo:r,cloudInfo:i,reporterParams:s},l,{state:c})=>{var d,u;try{const{action:p}=l;let _=Ra.PACKAGE,h={};c.hasTag("manage")?(_=Ra.MANAGE,h={pay_channel:null!=(u=null==(d=null==n?void 0:n.paymentMethod)?void 0:d.method_id)&&u.includes("paypal")?La.PAYPAL:La.CARD}):c.hasTag("pay")&&(h={cloud_storage_buy:kr((null==r?void 0:r.product_capacity)??0),cloud_type_buy:null==r?void 0:r.product_id,origin_price:Number(r.price_tips),price:Number(r.price_tips),currency:null==r?void 0:r.currency_code,order_id:null==o?void 0:o.order_id,pay_channel:xr(a)},_=c.hasTag("link")?Ra.LINK:Ra.PAY,!c.hasTag("link")&&[ja.OK,ja.PAY_STATUS].includes(p)&&(h={...h,pay_status:(null==o?void 0:o.order_status)===Rt.SUCCESS?Oa.SUCCESS:Oa.FAIL})),null==e||e("cloud_pay_window",{action:p,enter_from:s.enterFrom,current_page:s.currentPage,tool_type:s.toolType,status:br(i),sub_page:_,cloud_storage_now:kr(t.quota),cloud_storage_used:kr(t.usage),expire_date:wr(i),space_id:null==t?void 0:t.workspace_id,space_user_cnt:null==t?void 0:t.member_cnt,...h})}catch(p){console.error("reportCloudPayWindow",p)}},hidePayModal:e=>{const{onModalStatusChange:t}=e;null==t||t("CLOSED",e)},reportCloudClosePopup:({handleReporterProcessing:e},t)=>{null==e||e("cancel_sub_popup",{action:t.action})},handleRedirect:({orderInfo:e},t)=>{var o;"redirect"===(null==t?void 0:t.data.result_code)&&d.a.setNestedJsonItem(gr,e.order_id,{url:null==(o=t.data)?void 0:o.redirect_details.url,status:"PENDING"})},closeProxyWindow:({orderInfo:e})=>{d.a.setNestedJsonItem(gr,e.order_id,{status:"CLOSED"})},handleStatusChange:(e,t,{state:o})=>{const{onPayStatusChange:a}=e;o.hasTag("success")?null==a||a("SUCCESS",e):o.hasTag("fail")&&(null==a||a("FAIL",e))},saveBindPayment:(0,E.kp)({bindInfo:({bindInfo:e},t)=>({...e||{},paymentMethod:t.paymentMethod,status:Rt.INIT}),currentPayment:(e,t)=>({payment_method:t.paymentMethod,store_payment_method:!0})}),saveIdempotencyKey:(0,E.kp)({bindInfo:({bindInfo:e},t)=>({...e||{},status:Rt.PENDING,idempotencyKey:t.data.idempotencyKey})}),changeCloudCancelStatus:(0,E.kp)({cloudInfo:({cloudInfo:e})=>({...e,isCancelSubscribe:!0})}),initBindStatusChange:(0,E.kp)({onBindStatusChange:(e,t)=>t.cb}),saveCurrentPayment:(0,E.kp)({currentPayment:(e,t)=>t.data}),saveGroupProductList:(0,E.kp)({groupProductList:(e,t)=>t.data.groupProductList}),saveAllPriceList:(0,E.kp)({allPriceList:(e,t)=>t.data.allPriceList}),saveRiskInfo:(0,E.kp)({riskInfo:(e,t)=>t.data}),saveWebDisplay:(0,E.kp)({agreementLinks:(e,t)=>t.data.ccWebDisplayInfo}),initParams:(0,E.kp)({webid:(e,t)=>t.data.webid,userInfo:(e,t)=>t.data.userInfo,isBOE:(e,t)=>t.data.isBOE,locale:(e,t)=>t.data.locale,cloudInfo:(e,t)=>t.data.cloudInfo,workspaceInfo:(e,t)=>t.data.workspaceInfo,defaultWorkspaceInfo:(e,t)=>t.data.defaultWorkspaceInfo,workspaceList:(e,t)=>t.data.workspaceList,onPayStatusChange:(e,t)=>t.data.onPayStatusChange,handleReporterProcessing:(e,t)=>t.data.handleReporterProcessing,onModalStatusChange:(e,t)=>t.data.onModalStatusChange,cancelSubscrtbeErrorCallback:(e,t)=>t.data.cancelSubscrtbeErrorCallback,cancelSubscrtbeSuccessCallback:(e,t)=>t.data.cancelSubscrtbeSuccessCallback}),saveCurrentProduct:(0,E.kp)({productInfo:(e,t)=>t.value}),savePaymentMethods:(0,E.kp)({paymentMethods:(e,t)=>t.data.paymentMethods}),savePaymentOrderId:(0,E.kp)({orderInfo:({orderInfo:e},t)=>({order_status:Rt.INIT,...e??{},...t.data})}),updateOrderPendingInfo:(0,E.kp)({orderInfo:({orderInfo:e})=>({...e,order_status:Rt.PENDING})}),updateOrderSuccessStatus:(0,E.kp)({orderInfo:({orderInfo:e})=>({...e,order_status:Rt.SUCCESS})}),updateOrderFailStatus:(0,E.kp)({orderInfo:({orderInfo:e})=>({...e,order_status:Rt.FAIL})}),updateOrderFailCode:(0,E.kp)({orderInfo:({orderInfo:e},t)=>({...e,orderErrCode:t.errCode})}),clearOrderInfo:(0,E.kp)({orderInfo:e=>{}}),clearProductInfo:(0,E.kp)({productInfo:e=>{}}),clearPayment:(0,E.kp)({currentPayment:e=>{}}),clearPaymentMethods:(0,E.kp)({paymentMethods:e=>({paymentMethodsList:[],storedPaymentMethodsList:[]})}),clearBindInfo:(0,E.kp)({bindInfo:e=>{}}),saveSubscribeInfo:(0,E.kp)({subscribeInfo:(e,t)=>t.data}),initReporterParams:(0,E.kp)({reporterParams:(e,t)=>t.val}),assignEnableSubscription:(0,E.kp)({enableSubscription:(e,t)=>!!t.data})},services:{getSubscriptionAb:async()=>{try{return await Do.getAbParam()}catch(e){return Promise.reject(e)}},fetchVideoOperation:async e=>{const t=await(await fetch("https://sf16-muse-va.ibytedtos.com/obj/ies-fe-bee-maliva/bee_prod/biz_149/bee_prod_149_bee_publish_565.json")).json();return null==t?void 0:t.bee_dsrc_548},listeningStateChange:e=>t=>function(e,t){function o(o){const{orderInfo:a}=e;o.key===p.a.CLOUD_STORAGE_PAYMENT_AND_BINDING&&a&&"PAIDDOWN"===d.a.getNestedJsonItem(gr,null==a?void 0:a.order_id).status&&t()}return window.addEventListener("storage",o),()=>{window.removeEventListener("storage",o)}}(e,(()=>{t({type:"QUERY_STATUS"})})),intervalCheckStatus:({orderInfo:e,productInfo:t})=>o=>{const a=setInterval((async()=>{var a;try{const a=await wo.getCapcutOrderStatus({orderId:e.order_id,subscribeType:t.auto_subscribe?0:1});["SUCCESS","SUBSCRIBED"].includes(a.data.status)?o({type:"TO_SUCCESS"}):["FAILED","CLOSED"].includes(a.data.status)&&o({type:"TO_FAIL"})}catch(n){o({type:"TO_FAIL",errCode:null==(a=null==n?void 0:n.data)?void 0:a.ret})}}),2e3);return()=>{clearInterval(a)}},invokeReportStatus:e=>e=>{e({type:"REPORT_CLOUD_PAY_WINDOW",action:ja.PAY_STATUS})},fetchGroupProductList:async({userInfo:e})=>await Yt.getPriceList(e.region),fetchVipGroupProductList:async({userInfo:e,locale:t})=>await Yt.getVipPriceList(e.region,t),queryOrderStatus:async({orderInfo:e,productInfo:t})=>await wo.getCapcutOrderStatus({orderId:e.order_id,subscribeType:t.auto_subscribe?0:1}),fetchPaymentOrderId:async({productInfo:e,userInfo:t,workspaceInfo:o,defaultWorkspaceInfo:a,currentPayment:n,pipoSubmitParams:r})=>{const i=async()=>wo.initPipoPayment({product_id:e.product_id,order_type:e.auto_subscribe?Lt.AUTO:Lt.UNAUTO,user_create_time:t.createTime||Math.round(Date.now()/1e3),workspace_id:(null!=e&&e.isCloud?null==o?void 0:o.workspace_id:null==a?void 0:a.workspace_id)??"",free_trial:null==e?void 0:e.can_trial}),s=async()=>{var o;return wo.freeTrialMakeOrder({region:(null==t?void 0:t.region)??"",product_id:e.product_id,user_create_time:t.createTime||Math.round(Date.now()/1e3),payment_method:(null==(o=null==n?void 0:n.payment_method)?void 0:o.method_id)??""})};try{return null!=e&&e.can_trial?null!=r&&r.token?{...(await s()).data,type:1}:{...(await i()).data,type:2}:{...(await i()).data,type:0}}catch(l){return Promise.reject(l)}},handlePaying:async({isBOE:e,riskInfo:t,currentPayment:o,locale:a,userInfo:n,orderInfo:r,productInfo:i})=>{window.open(vr({isBind:!1,orderId:r.order_id,isSubscribe:i.auto_subscribe}));let s={};try{s=await wo.postPipoPay({serviceProps:{isBOE:e,region:n.region},payInfoProps:{amount:i.price_tips,charge_id:r.payment_reference,currency:i.currency_code,payment_reference:r.payment_reference,configuration:yr(e,a),payment_method:o.payment_method,idempotency_key:`${null==r?void 0:r.order_id}|${Number(new Date)}`,risk_info:t,return_url:fr({orderId:r.order_id,isSubscribe:i.auto_subscribe,isBind:!1}),store_payment_method:!(null==i||!i.auto_subscribe)||o.store_payment_method,merchant_user_id:null==n?void 0:n.uid,is_agreement:null==i?void 0:i.auto_subscribe,agreement_id:r.agreement_id,initiator_type:"cit"}})}catch(l){console.error("error",l)}return{...s}},fetchPaymentMethods:async({userInfo:e,isBOE:t,locale:o,productInfo:a})=>{var n;const{uid:r,region:i}=e,s={isBOE:t,region:i};let l;try{l=null!=a&&a.auto_subscribe?await wo.getAgreementBasicInfo({serviceProps:s,basicInfoProps:{merchant_user_id:r,configuration:yr(t,o),country_or_region:i,amount_value:a.price_tips,currency:a.currency_code}}):await wo.getCashierBasicInfo({serviceProps:s,basicInfoProps:{merchant_user_id:r,configuration:yr(t,o),country_or_region:i,config_model_code:["cyber"],pms_params:{country_code:i,currency:a.currency_code,amount_value:a.price_tips,sdk_type:"@pipo-lib/api",sdk_version:"1.96.1"}}})}catch(c){return Promise.reject(c)}return{paymentMethods:{paymentMethodsList:null==l?void 0:l.methods.map((e=>({paymentMethodId:e.payment_method_id}))),storedPaymentMethodsList:null==(n=null==l?void 0:l.stored_methods)?void 0:n.map((e=>({paymentMethodId:null==e?void 0:e.payment_method_id,title:null==e?void 0:e.masked_identity,token:null==e?void 0:e.payment_method_token,isPrimary:null==e?void 0:e.isPrimary,expiryDate:null==e?void 0:e.expiry_date,isExpired:null==e?void 0:e.is_expired})))}}},queryBindStatus:async({bindInfo:e})=>(await wo.getStoreMethodStauts({idempotencyKey:e.idempotencyKey})).data,storePaymentMethod:async({isBOE:e,userInfo:t,productInfo:o,orderInfo:a,riskInfo:n,locale:r,bindInfo:i,pipoSubmitParams:s})=>{window.open(vr({isBind:!0,orderId:a.order_id,isSubscribe:o.auto_subscribe}));const l=null!=o&&o.can_trial?`${null==a?void 0:a.order_id}`:`${null==a?void 0:a.order_id}|${Number(new Date)}`;return{...await wo.storingPaymentMethod({serviceProps:{isBOE:e,region:t.region},basicInfoProps:{notification_url:null==a?void 0:a.store_method_notification_url,country_or_region:t.region,merchant_user_id:t.uid,idempotency_key:l,return_url:fr({orderId:a.order_id,isSubscribe:o.auto_subscribe,isBind:!0}),risk_info:n,configuration:yr(e,r),payment_method:{method_id:i.paymentMethod.method_id,payment_elements:null==s?void 0:s.paymentParams}}}),idempotencyKey:l}},cancelAutoRenewal:async(e,t)=>{try{return await wo.cancelSubscripiton({subscribe_id:t.subscribeId})}catch(o){return Promise.reject(o)}},getSubscribeInfo:async()=>(await Yt.getSubscribeInfo()).subscribe_list,getSpaceList:async e=>{var t;return await Yt.getSpaceList((null==(t=null==e?void 0:e.workspaceInfo)?void 0:t.workspace_id)??"0")}}});const Sr=new class{constructor(){bt(this,"reportParams",Object.create(null)),bt(this,"reporter",new u.v),bt(this,"_createUpdater",((...e)=>t=>{this.reportParams={...this.reportParams,...(0,ee.A)(t,e)}})),bt(this,"_createRemover",((...e)=>()=>{this.reportParams=(0,Z.A)(this.reportParams,e)})),bt(this,"_reportExportPanel",(e=>{const t=(0,X.A)({...this.reportParams,...e},(e=>(0,Q.A)(e)||""===e));this.reporter.reportEvent(t)})),bt(this,"updateEntry",this._createUpdater("current_page","enter_from")),bt(this,"updateEditType",this._createUpdater("edittype","original_edittype","tool_type","template_id","video_type_id","video_type_list","smart_script_id","script_request_id","script_id","is_smart_tool","is_smart_crop","is_cover_added","template_is_smart_crop")),bt(this,"updateDigitalHuman",this._createUpdater("ai_character_cnt","ai_character_processing_cnt","ai_character_time","ai_character_processing_time","ai_character_id","ai_character_frame","ai_character_tone")),bt(this,"updateDraft",this._createUpdater("draft_id")),bt(this,"updateVideo",this._createUpdater("video_id","video_duration","format","size","resolution")),bt(this,"removeVideo",this._createRemover("video_id","video_duration","format","size","resolution")),bt(this,"reportExportingAction",this._reportExportPanel),bt(this,"reportExportFailAction",this._reportExportPanel),bt(this,"reportSaveFailAction",this._reportExportPanel),bt(this,"reportShareForReviewAction",this._reportExportPanel),bt(this,"reportShareAsPresentationAction",this._reportExportPanel),bt(this,"reportDownloadAction",this._reportExportPanel),bt(this,"reportThirdPartyPublishAction",this._reportExportPanel)}},Cr=({style:e,expandModalInstance:t,eventParams:o,isDownloadCard:a=!1})=>{var s,l;const[d,p]=(0,i.useState)(!1),[_]=(0,g.B)(null==t?void 0:t.getService()),{flag:h=!1}=(null==(l=null==(s=null==_?void 0:_.context)?void 0:s.userInfo)?void 0:l.vipInfo)||{},v=(0,m.d)(null==t?void 0:t.getService(),(e=>e.context.enableSubscription));(0,i.useEffect)((()=>{(async()=>{if(t)return p(await(null==t?void 0:t.isSupportExpand()));p(!1)})()}),[h]);const f=a?c.Ay.t("web_sharereview_button_permissions_allow_download",{},"Allow download"):c.Ay.t("web_first_subscribe_text_sweep_watermark",{},"Upgrade to remove watermark"),y=a?c.Ay.t("web_first_subscribe_text_cannnot_download",{},"This project can\u2019t be downloaded because Pro features and materials are used in it. Upgrade to Pro to download this project."):c.Ay.t("web_first_subscribe_text_with_watermark",{},"Watermark is added because Pro features and materials are used in the project. Upgrade to Pro to remove it."),w=h?a?c.Ay.t("web_first_subscribe_text_download_share_again",{},""):c.Ay.t("web_first_subscribe_text_watermark_share_again",{},"Try sharing for review again to remove the watermark."):f;return t&&v&&d?(0,n.jsxs)("div",{className:"vip-equity-card-wrap",style:e,children:[(0,n.jsxs)("div",{className:"card-left",children:[(0,n.jsx)("div",{className:"icon"}),(0,n.jsx)("div",{className:"show-description",children:w}),!h&&(0,n.jsx)(x.A,{content:y,style:{whiteSpace:"pre-wrap",zIndex:9999},children:(0,n.jsx)(r.UvL,{className:"info-icon"})})]}),!h&&(0,n.jsx)("div",{className:"card-right",children:(0,n.jsx)("div",{className:"btn",onClick:()=>{var e,n;Sr.reportShareAsPresentationAction({action:u.E.upgrade,enter_from:"share_for_review",no_vip_used_material:h?0:1,...o}),null==t||t.show({type:hr.VIP_BUY,reporterParams:{...o,pageFrom:a?mr.allowDownloadUpgrade:mr.removeWatermarkUpgrade,currentPage:null==(n=null==(e=Ev())?void 0:e.eventParams)?void 0:n.currentPage}})},children:c.Ay.t("web_first_subscribe_text_upgrade",{},"Upgrade")})})]}):null},Ir="_form-input_wf4rg_1",Er="_textarea_wf4rg_4",Tr=O.A.TextArea,Pr=e=>{const{style:t,initialValue:o,disabled:a,isDescription:r,placeholder:s,validator:l}=e,c=r?300:100,[d]=L.A.useForm();return(0,i.useEffect)((()=>{d.setFieldValue("value",o)}),[o]),(0,n.jsx)(L.A,{className:Ir,form:d,layout:"vertical",children:(0,n.jsx)(L.A.Item,{style:{margin:0},field:"value",rules:[{validateTrigger:["onBlur"],validator:async(e,t)=>{t(await l(e??""))}}],children:(0,n.jsx)(Tr,{style:t,className:Er,placeholder:s,disabled:a,autoSize:{minRows:1},maxLength:c,showWordLimit:!0})})})};var Nr=(e=>(e.copyLink="copyLink",e.embedCode="embedCode",e.facebook="facebook",e.twitter="twitter",e.email="email",e.reddit="reddit",e.tumblr="tumblr",e.whatsapp="whatsapp",e.googleContacts="googleContacts",e))(Nr||{});function jr(e,t){const o=new URLSearchParams;for(const[n,r]of Object.entries(t))null!=r&&o.append(n,r);const a=o.toString();return a?`${e}?${a}`:e}function Rr(e,t){window.open(jr(e,t),"","height=400,width=550")}function Lr({shareLink:e,title:t}){const{nickName:o}=(0,Y.O)();return`${c.Ay.t("web_sharereview_text_shareview_link",{placeholder0:o,placeholder1:t},"{placeholder0} shared a CapCut link with you {placeholder1}")} ${e}`}const Or=({onOk:e})=>{const[t,o]=(0,i.useState)(!0),[a,r]=(0,i.useState)(null);return(0,i.useEffect)((()=>{p.u.getAuthorizedUserInfo({platform:p.f.GoogleContacts}).then((e=>{r(e),o(!1)}))}),[]),t||!a?(0,n.jsx)(D.A,{webp:!0,loading:!0,className:"lv-google_contacts-loading"}):(0,n.jsx)("div",{className:"lv-google_contacts-confirm",children:(0,n.jsxs)("div",{className:"lv-google_contacts-confirm-content",children:[(0,n.jsxs)("div",{className:"lv-google_contacts-confirm-user",children:[(0,n.jsx)(re.A,{shape:"circle",size:56,children:(0,n.jsx)("img",{alt:a.name,src:a.cover_photo,crossOrigin:"anonymous"})}),(0,n.jsxs)("div",{className:"lv-google_contacts-confirm-userInfo",children:[(0,n.jsx)("div",{className:"user-name",children:a.name}),(0,n.jsx)("div",{className:"user-email",children:a.email}),(0,n.jsx)("div",{className:"time",children:c.F2.t("web_linked_on",{placeholder1:se()(a.authorized_time).format("YYYY-MM-DD")},"Linked on {placeholder1}")})]})]}),(0,n.jsx)(k.A,{size:"large",type:"primary",onClick:e,children:c.F2.t("web_unbind",{},"Unlink")})]})})},Fr=({isBOE:e=!1,enterFrom:t=Ia.WorkspaceSettings,uid:o="",shouldReport:r=!0})=>{const s=new Ea({enter_from:t}),l={uid:o,isShowReAskAuthBox:!1,isBOE:e,isShowAskAuthBox:!1,platform:p.f.GoogleContacts,draftId:"",authorizeWindowReport:!1,onServerError:()=>{a.A.error(c.F2.t("web_failed_to_bind_contacts",{},"Couldn\u2019t link. Try again.")),(new Sa).report({enter_from:t,status:"fail"})},onServerSuccess:()=>{a.A.success(c.F2.t("web_bind_address_book_successfully",{},"Google contacts linked")),(new Sa).report({enter_from:t,status:"success"})}},[d,,_]=(0,v.zl)(Ga,{context:l}),[h,m]=(0,i.useState)(_),[g,f]=(0,i.useState)(!1),[w,b]=(0,i.useState)(!1),[x,k]=(0,i.useState)(!0),A=d.matches("authenticating"),[S,C]=(0,i.useState)(!1),[I,E]=(0,i.useState)(null);(0,i.useEffect)((()=>{(0,u.r)().getABTestConfigSilent("invite_google_contacts",!1).then((e=>{C(e),e||k(!1)})),p.u.getAuthorizedUserInfo({platform:p.f.GoogleContacts}).then((e=>{E(e)}))}),[]),(0,i.useEffect)((()=>{A&&r&&((new Aa).report({enter_from:t,action:"show"}),k(!1))}),[A,t,r]),(0,i.useEffect)((()=>(h.onDone((e=>{k(!1);const{data:o}=e;o.isAuthorized||(new Aa).report({enter_from:t,action:"show"}),f(o.isAuthorized)})),()=>{h.stop()})),[h,t,r]);return{enable:S,isAuthorized:g,onAuthorize:(0,i.useCallback)((()=>{if((new Aa).report({enter_from:t,action:"click"}),h.state.done){const e=(0,T.U4)(Ga.withContext(l)).start();e.onTransition((t=>{t.matches({authenticating:"idle"})&&e.send("CONFIRM")})),m(e)}else h.send("CONFIRM")}),[h,t]),onUnlink:(0,i.useCallback)((async e=>{b(!0);try{let o=null;s.report({action:"show"}),await new Promise((e=>{o=y.A.confirm({className:"lv-google_contacts-unlink_modal",style:{width:544},title:c.F2.t("web_google_contacts_settings",{},"Google contacts settings"),icon:(0,n.jsx)(n.Fragment,{}),footer:null,content:(0,n.jsx)(Or,{onOk:e}),onOk:e,onCancel:()=>{s.report({action:"close"}),b(!1)}})})),s.report({action:"unlink"}),await new Promise((e=>{null==o||o.close(),y.A.confirm({className:"lv-google_contacts-unlink_modal",title:c.F2.t("web_sure_you_want_to_unbundle_google_contacts",{},"Unlink your Google contacts?"),icon:(0,n.jsx)(n.Fragment,{}),okText:c.F2.t("web_unbind",{},"Unlink"),cancelText:c.F2.t("web_contacts_cancel",{},"Cancel"),content:c.F2.t("web_unbind_google_contacts",{},"After unlinking, you can\u2019t invite your Google contacts."),onOk:e,onCancel:()=>{b(!1),s.report({action:"unlink_cancel"})}})})),s.report({action:"unlink_confirm"}),b(!1),await p.u.thirtpartCloudsDeauthorization({platform:p.f.GoogleContacts}),a.A.success(c.F2.t("web_unbundle_contacts_successfully",{},"Google contacts unlinked")),f(!1),(new Aa).report({enter_from:t,action:"show"}),null==e||e()}catch{a.A.error(c.F2.t("web_failed_to_unbundle_contacts",{},"Couldn\u2019t unlink. Try again."))}}),[]),isUnlinking:w,isChecking:x,recheck:(0,i.useCallback)((()=>{k(!0);const e=(0,T.U4)(Ga.withContext(l)).start();e.onTransition((e=>{e.matches({authenticating:"idle"})&&(f(!1),k(!1),(new Aa).report({enter_from:t,action:"show"}))})),m(e)}),[]),userInfo:I,setIsAuthorized:f}},Dr=i.memo((e=>{const{isAuthorized:t,onAuthorize:o,isOpenModal:a=!1,onUnlink:i,isUnlinking:s,isChecking:d=!0,isShowCp:u=!0,onOpenModal:p}=e;return(0,n.jsx)("div",{className:"lv-google_contacts",children:(0,n.jsx)(V.A,{className:"lv-google_contacts-trigger",animation:!0,loading:d,text:{rows:1,width:100},children:(0,n.jsx)(x.A,{content:t?void 0:()=>{const e=c.F2.t("web_google_link_google_disclosure",{href0:e=>(0,n.jsx)("a",{className:"lv-google_contacts-disclosure",target:"_blank",href:"https://www.capcut.com/resource/google-api-services-disclosure",children:e})},"<href0>Google API Services Disclosure</href0>");return(0,n.jsxs)("span",{children:[c.F2.t("web_google_text_read_google_disclosure",{},"View")," ",e]})},position:"tr",trigger:"hover",color:"#FFF",triggerProps:{style:{borderRadius:"12px !important",maxWidth:500,wordWrap:"break-word",wordBreak:"break-all"},popupStyle:{color:"rgba(17, 26, 44, 0.70)",fontWeight:500,fontSize:12,padding:16},popupAlign:{top:[12,12]},arrowProps:{className:"lv-google_contacts-arrowProps"},showArrow:!0},children:(0,n.jsx)("div",{className:"lv-google_contacts-trigger",onClick:()=>{t?a?null==p||p():s||null==i||i():null==o||o()},children:(0,n.jsxs)("span",{className:l()({"lv-google_contacts-auth":!0,"lv-google_contacts-setting":t}),children:[!t||a?(0,n.jsx)(r.zof,{size:16}):(0,n.jsx)(r.RD3,{size:16}),u&&c.F2.t("web_invite_text_link_google_contact",{},"Google contacts"),t?null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.UvL,{size:12}),(0,n.jsx)(r.hF0,{size:12})]})]})})})})})})),Ur=i.memo((e=>{const{enterForm:t,onOpenModal:o,...a}=e,r=(0,i.useCallback)((()=>{null==o||o()}),[o]);return(0,n.jsx)(Dr,{...a,onOpenModal:r})})),Mr={root:void 0,modalState:{visible:!1},dispatch:Re.A,onUnmount:Re.A},Br=i.createContext(Mr),zr=(e,t)=>{switch(t.type){case"modal/show":return{...e,props:t.payload.props,visible:t.payload.visible};case"modal/hide":return{...e,visible:t.payload.visible};case"modal/update":return{...e,props:t.payload.props};default:return{...e}}};function Gr(e){return{show:t=>{e.dispatch({type:"modal/show",payload:{props:t,visible:!0}})},hide:()=>{e.dispatch({type:"modal/hide",payload:{visible:!1}})},update:t=>{e.dispatch({type:"modal/update",payload:{props:t}})},remove:()=>{e.dispatch({type:"modal/hide",payload:{visible:!1}}),e.onUnmount()}}}const Wr=(e={})=>{const t=(()=>{const{modalState:e,dispatch:t,root:o,onUnmount:a}=(0,i.useContext)(Br),{hide:n,show:r,remove:s}=Gr({dispatch:t,root:o,onUnmount:a});return{visible:e.visible,hide:n,show:r,remove:s}})(),[o,a]=i.useState(!1);return{autoFocus:!1,maskClosable:!1,closable:!0,visible:t.visible,confirmLoading:o,onOk:()=>{var o;return a(!0),Promise.resolve(null==(o=null==e?void 0:e.onOk)?void 0:o.call(e)).then((()=>{t.hide()})).finally((()=>{a(!1)}))},onCancel:()=>{var o;t.hide(),null==(o=null==e?void 0:e.onCancel)||o.call(e)},afterCancel:()=>{var o;t.remove(),null==(o=null==e?void 0:e.afterCancel)||o.call(e)}}},Vr=(0,i.forwardRef)((({Component:e,root:t,onUnmount:o},a)=>{const[r,s]=(0,i.useReducer)(zr,Mr.modalState);return(0,i.useImperativeHandle)(a,(()=>s)),(0,n.jsx)(Br.Provider,{value:{modalState:r,dispatch:s,root:t,onUnmount:o},children:(0,n.jsx)(Br.Consumer,{children:({modalState:t})=>null!=t&&t.props?(0,n.jsx)(e,{...null==t?void 0:t.props}):null})})}));function Hr(e,t={}){const o="function"==typeof t.root?t.root():t.root??(()=>{const e=document.createElement("div");return document.body.appendChild(e),e})(),a=i.createRef(),r=()=>{Le.unmountComponentAtNode(o)},s=(0,n.jsx)(Vr,{ref:a,root:o,Component:e,onUnmount:r});return Le.render(s,o),Gr({dispatch:e=>{var t;return null==(t=a.current)?void 0:t.call(a,e)},root:o,onUnmount:r})}const qr="lv-google-share",Yr=`${qr}-modal`,Kr=e=>{const{style:t,wrapperStyle:o,isBOE:s,pageSize:d=50,onChange:u,userId:_,enterFrom:h,onConfirmUnlink:m,onClose:g}=e,{isAuthorized:v,onAuthorize:f,onUnlink:y,isUnlinking:w,isChecking:b,userInfo:x}=Fr({isBOE:s,enterFrom:h,uid:_||"",shouldReport:!0}),[k,A]=(0,i.useState)((0,n.jsx)(D.A,{webp:!0,loading:!0})),[S,C]=(0,i.useState)([]),[I,E]=(0,i.useState)([]),[T,P]=(0,i.useState)(!1),[N,j]=(0,i.useState)(""),[R,L]=(0,i.useState)(!1),[U,M]=(0,i.useState)(!1),B=(0,i.useRef)(""),z=(0,i.useCallback)((0,je.A)((async(e,t=!1)=>{var o;const a=null==e?void 0:e.trim(),{contacts:r,cursor:i,has_more:s}=await(null==(o=p.u)?void 0:o.getUserContacts({query_param:a,cursor:B.current,platform:p.f.GoogleContacts,count:d}));if(B.current=i,t)C((e=>[...e,...r]));else{const e=r.map((e=>(I.find((t=>e.email===t.email))&&(e.checked=!0),e)));C([...e])}L(s),s||A((0,n.jsx)(Ne.A,{})),I.length>=d&&M(!0)}),500),[B.current,d,I]);(0,i.useEffect)((()=>{v?z():(C([]),E([]),P(!1))}),[v]),(0,i.useEffect)((()=>{u&&u(I)}),[I]);const G=()=>{null==m||m(),null==g||g()};return(0,n.jsxs)("div",{className:l()(qr,{baseCls:""}),style:t,children:[(0,n.jsxs)("div",{className:`${qr}-content`,style:o,children:[(0,n.jsxs)("div",{className:`${qr}-content-left`,children:[(0,n.jsx)(O.A,{style:{width:386,marginBottom:12,marginRight:16},prefix:(0,n.jsx)(r.hu1,{}),allowClear:!0,placeholder:c.F2.t("web_google_placeholder_search_contacts",{},"Search contacts"),onChange:e=>{j(e),L(!1),B.current="",C([]),A((0,n.jsx)(D.A,{webp:!0,loading:!0})),z(e)},disabled:!v,size:"large"}),(0,n.jsx)(Pe.A,{style:{maxHeight:290},scrollLoading:v?k:null,onReachBottom:()=>{R&&z(N,!0)},dataSource:S,render:(e,t)=>(0,n.jsx)(Pe.A.Item,{children:(0,n.jsxs)("div",{onClick:()=>(e=>{if(U&&!S[e].checked)return;let t=[...I];const o=[...S];o[e].checked=!o[e].checked,o[e].checked?t.push(o[e]):t=I.filter((t=>o[e].email!==t.email)),t.length>=d?(M(!0),a.A.info(c.F2.t("web_google_toast_contact_number_limit",{},"Select up to 50 contacts"))):M(!1),E(t),C(o),P(t.length===S.length)})(t),className:"select-item",style:{display:"flex"},children:[(0,n.jsx)(F.A,{disabled:!e.checked&&U,style:{marginRight:8},checked:e.checked}),(0,n.jsxs)("div",{className:"left-item",children:[(0,n.jsx)("div",{className:"name",children:e.name}),(0,n.jsx)("div",{className:"email",children:e.email})]})]})},t)}),(0,n.jsxs)("div",{className:"select-all",children:[(0,n.jsx)(F.A,{onClick:()=>{if(S.length<=0)return;let e,t;if(e=!T,e){const e=S.filter((e=>e.checked));let o=d-e.length;t=S.map((e=>(e.checked||o>0&&(e.checked=!0,o--),e)))}else t=S.map((t=>(t.checked=e,t)));const o=t.filter((e=>e.checked));o.length>=d?M(!0):M(!1),P(!T),o.length>=d&&a.A.info(c.F2.t("web_google_toast_contact_number_limit",{},"Select up to 50 contacts")),E(o),C(t)},disabled:!v,checked:T}),(0,n.jsx)("div",{className:"text",children:c.F2.t("web_select_all",{},"Select all")})]})]}),(0,n.jsxs)("div",{className:`${qr}-content-right`,children:[(0,n.jsx)("div",{className:"title",children:c.F2.t("web_google_title_number_contacts_selected",{num:I.length,number0:I.length},"{number0} contact selected")}),(0,n.jsx)(Pe.A,{style:{maxHeight:326},size:"small",dataSource:I,render:(e,t)=>(0,n.jsx)(Pe.A.Item,{children:(0,n.jsxs)("div",{className:"select-item",children:[(0,n.jsxs)("div",{className:"wrapper",children:[(0,n.jsx)("div",{className:"name",children:e.name}),(0,n.jsx)("div",{className:"email",children:e.email})]}),(0,n.jsx)(r.$Ct,{onClick:()=>(e=>{const t=I.filter((t=>I[e].email!==t.email)),o=S.map((t=>(I[e].email===t.email&&(t.checked=!1),t)));t.length>=d?M(!0):M(!1),E(t),C([...o]),P(t.length===S.length)})(t),className:"icon"})]})},t)})]})]}),(0,n.jsxs)("div",{className:`${qr}-info`,children:[(0,n.jsx)("span",{children:v&&(null==x?void 0:x.email)}),(0,n.jsx)(Ur,{isAuthorized:v,onUnlink:()=>y(G),onAuthorize:f,isUnlinking:w,isChecking:b,isShowCp:!v,enterForm:h})]})]})},Jr=e=>q()("sha256").update(e).digest("hex"),$r=({query:e,origin:t})=>`${t}?${Object.entries(e).map((([e,t])=>`${e}=${t}`)).join("&")} `,Qr=({uid:e})=>{var t;return $r({origin:"https://www.tiktok.com/v2/auth/authorize",query:{client_key:(0,Y.i)()?u.w:u.x,scope:"user.info.basic%2Cvideo.publish",response_type:"code",state:JSON.stringify({state_id:null==(t=Jr(e||""))?void 0:t.slice(15,47),platform:"TikTok"}),redirect_uri:`${location.origin}/lv/v1/user/web/third_party_platform_authorization`}})},Zr=({uid:e})=>{var t;return`https://business-api.tiktok.com/portal/auth?app_id=${u.y}&redirect_key=${(0,Y.i)()?u.z:(0,Y.I)()?u.A:u.B}&state=${null==(t=Jr(e??""))?void 0:t.slice(15,47)}&redirect_uri=https%3A%2F%2F${window.location.host}%2Flv%2Fv1%2Fuser%2Fweb%2Fthird_party_platform_authorization%3Fplatform%3DTTAM&rid=${u.C}`},Xr=({uid:e})=>{var t;return`https://accounts.google.com/o/oauth2/auth?access_type=offline&include_granted_scopes=true&client_id=${(0,Y.i)()?u.G:u.H}&prompt=consent&redirect_uri=https://${window.location.host}/lv/v1/user/web/third_party_platform_authorization?platform=YouTube&response_type=code&scope=https://www.googleapis.com/auth/userinfo.profile+https://www.googleapis.com/auth/userinfo.email+https://www.googleapis.com/auth/youtube.upload&state=${null==(t=Jr(e??""))?void 0:t.slice(15,47)}`},ei=({uid:e})=>{var t;return $r({origin:"https://www.facebook.com/v17.0/dialog/oauth",query:{response_type:"code",state:null==(t=Jr(e||""))?void 0:t.slice(15,47),display:"popup",client_id:(0,Y.i)()?u.I.boe:u.I.ppe,redirect_uri:$r({origin:`${location.origin}/lv/v1/user/web/third_party_platform_authorization`,query:{platform:"Facebook",auth_type:"rerequest",scope:["public_profile","pages_show_list","pages_read_engagement","pages_manage_posts","publish_to_groups","instagram_content_publish","instagram_basic","business_management"].join(",")}})}})};function ti(e){return e||(0,Y.O)().uid}function oi(e){const[t,o]=(0,i.useState)(!1),{isAuthorized:a,enable:n}=Fr({isBOE:(0,Y.i)(),enterFrom:Ia.ShareAsPre,uid:ti(e)});return(0,i.useEffect)((()=>{n&&!a&&(new Aa).report({enter_from:Ia.ShareAsPre,action:"show"}),n&&o(!0)}),[n,a]),t}const ai=e=>(e=>{const t=()=>{var t;let o=document.getElementById(Yr);return o||(o=document.createElement("div"),o.id=Yr,null!=e&&e.getContactsPopupContainer?null==(t=e.getContactsPopupContainer)||t.appendChild(o):document.body.appendChild(o)),o},{show:o}=Hr((t=>{const o=Wr({onCancel:null==t?void 0:t.onClose}),[a,r]=(0,i.useState)([]),s=()=>{var e,a,n;null==(e=null==t?void 0:t.onClose)||e.call(t),null==(a=o.onCancel)||a.call(o),null==(n=o.afterCancel)||n.call(o)},l=()=>{null!=t&&t.onShare&&(null==t||t.onShare(a)),s()};return(0,n.jsx)(y.A,{title:c.F2.t("web_google_contacts",{},"Google contacts"),className:Yr,wrapClassName:`${qr}-wrapper`,visible:o.visible,footer:()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k.A,{onClick:s,children:c.F2.t("web_contacts_cancel",{},"Cancel")}),(0,n.jsx)(k.A,{onClick:l,disabled:!a.length,type:"primary",children:null!=e&&e.onlySelect?c.F2.t("confirm_ok",{},"Confirm"):c.F2.t("web_google_btn_share_video_share",{},"Share")})]}),onCancel:s,closable:!0,children:(0,n.jsx)(Kr,{...e,onChange:e=>{r(e)},onClose:s})})}),{root:t});return{show:()=>{o(e)}}})({isBOE:(0,Y.i)(),userId:ti(e.uid),onShare:t=>(async(e,t)=>{const{fileID:o="",workspaceID:n=""}=t;try{const t=e.filter((e=>e.checked)).map((e=>e.email)),r=t.reduce(((e,t)=>(e[t]={utm_campaign:"presentation",utm_content:"googlecontact"},e)),{});await d.l.batchSendNoticeByEmail({fileId:o,workspaceId:n,emails:t,query_param:r}).then((()=>{a.A.success(c.Ay.t("team_invite_link_sendemail_success",{},"Email sent")),(new Ca).report({enter_from:Ia.ShareAsPre,total_cnt:t.length,google_cnt:t.length})}))}catch{return}})(t,e),enterFrom:Ia.ShareAsPre,getContactsPopupContainer:document.getElementById("googleContacts")}),ni=e=>{var t;window.open(`https://accounts.google.com/o/oauth2/v2/auth?prompt=consent&state=${null==(t=Jr(ti(e.uid)))?void 0:t.slice(15,47)}&scope=email%20openid%20https%3A//www.googleapis.com/auth/contacts.readonly&access_type=offline&include_granted_scopes=true&response_type=code&redirect_uri=https://${window.location.host}/lv/v1/user/web/third_party_platform_authorization%3Fplatform%3DGoogleContacts&client_id=${(0,Y.i)()?p.j:p.n}`,"name=thirdparty_cloud_storage_auth","fullscreen=1,width=550,height=400");const{THIRDPARTY_CLOUD_AUTH:o}=p.a,n=t=>{var r,i;t.key===o&&("success"===t.newValue?(null==(i=(r=ai(e)).show)||i.call(r),(new Sa).report({enter_from:Ia.ShareAsPre,status:"success"})):(a.A.error(c.Ay.t("web_failed_to_bind_contacts",{},"Couldn\u2019t link. Try again.")),(new Sa).report({enter_from:Ia.ShareAsPre,status:"fail"})),d.a.removeItem(o),window.removeEventListener("storage",n))};window.addEventListener("storage",n)};function ri(e,t="var(--lvv-color-text-primary)",o,i){const{shareLink:s,title:l=""}=o,u=[{id:Nr.copyLink,name:c.Ay.t("web_embedcode_button_copy_link",{},"copy link"),icon:(0,n.jsx)(r.RSn,{size:24,color:t}),onClick:()=>{s?navigator.clipboard.writeText(s).then((()=>{a.A.success(c.Ay.t("web_sharereview_toast_link_copied",{},"Link copied"))})).catch((e=>{d.s.error("getDefaultChannelConfig copyLink",e),console.error("getDefaultChannelConfig copyLink",e),a.A.error(c.Ay.t("web_sharereview_toast_link_copy_fail",{},"Link copy failed"))})):a.A.error(c.Ay.t("web_sharereview_toast_link_copy_fail",{},"Link copy failed"))}},{id:Nr.embedCode,name:c.Ay.t("web_embedcode_button_embed_code",{},"embed code"),icon:(0,n.jsx)(r.qpX,{size:24,color:t}),onClick:()=>{}},{id:Nr.email,name:c.Ay.t("web_embedcode_text_e_mail",{},"email"),icon:(0,n.jsx)(r.eUD,{size:24,color:t}),onClick:()=>{try{const e=jr("mailto:",{body:s});window.open(e)}catch(e){d.s.error("getDefaultChannelConfig email",e),console.error("getDefaultChannelConfig email",e)}}},{id:Nr.twitter,name:c.Ay.t("web_share_button_twitter",{},"X"),icon:(0,n.jsx)(r.V0X,{size:36,color:"#1C9BF0"}),onClick:()=>{Rr("https://twitter.com/intent/tweet",{url:s})}},{id:Nr.facebook,name:c.Ay.t("web_embedcode_text_facebook",{},"facebook"),icon:(0,n.jsx)(r.$O4,{size:36,color:"#fff"}),onClick:()=>{Rr("https://www.facebook.com/share.php",{u:s})}},{id:Nr.googleContacts,name:c.Ay.t("web_google_contacts",{},"Google contacts"),icon:(0,n.jsx)(r.zof,{size:24}),onClick:()=>{!async function(e){var t,o;try{await p.u.getAuthorizedUserInfo({platform:p.f.GoogleContacts})&&(null==(o=(t=ai(e)).show)||o.call(t))}catch{ni(e),(new Aa).report({enter_from:Ia.ShareAsPre,action:"click"})}}(o)}},{id:Nr.reddit,name:c.Ay.t("web_share_button_reddit",{},"Reddit"),icon:(0,n.jsx)(r.WMi,{size:36}),onClick:()=>{Rr("https://www.reddit.com/submit",{url:s,title:l})}},{id:Nr.tumblr,name:c.Ay.t("web_share_button_tumblr",{},"Tumblr"),icon:(0,n.jsx)(r.wW$,{size:36}),onClick:()=>{Rr("https://www.tumblr.com/widgets/share/tool",{url:s,shareSource:"legacy",canonicalUrl:s,posttype:"link",title:l,caption:Lr(o),content:s})}},{id:Nr.whatsapp,name:c.Ay.t("web_share_button_whatsapp",{},"Whatsapp"),icon:(0,n.jsx)(r.w6m,{size:36}),onClick:()=>{Rr("https://api.whatsapp.com/send",{text:Lr(o),type:"custom_url",app_absent:"0"})}}];return(!e||!Array.isArray(e))&&(e=function(e,t){const o=[Nr.copyLink,Nr.embedCode,Nr.email,Nr.twitter,Nr.facebook,Nr.reddit,Nr.tumblr,Nr.whatsapp];return t&&oi(e)&&o.splice(5,0,Nr.googleContacts),o}(o.uid,i)),u.filter((t=>e.includes(t.id)))}const ii={"share-list-flex":"_share-list-flex_13mxq_1","share-list-grid":"_share-list-grid_13mxq_7"},si="_share-list-item_phjq8_1",li="_icon-size_phjq8_17",ci="_icon-wrapper_phjq8_21",di="_share-list-item-text_phjq8_29",ui="_share-list-item-disabled_phjq8_41";function pi({item:e,disabled:t,handleChannelClick:o,iconStyle:a}){return(0,n.jsxs)("div",{className:l()(si,t?ui:null),style:null==a?void 0:a.wrapperStyle,onClick:()=>{e.onClick(),o(e.id)},children:[(0,n.jsx)("div",{className:li,children:[Nr.copyLink,Nr.email,Nr.embedCode,Nr.googleContacts].includes(e.id)?(0,n.jsx)("div",{className:ci,style:null==a?void 0:a.iconWrapperStyle,children:e.icon}):e.icon}),(0,n.jsx)(G.A.Paragraph,{className:di,style:null==a?void 0:a.nameStyle,ellipsis:{showTooltip:!0,rows:2,cssEllipsis:!0},children:e.name})]})}const _i="presentation",hi="player",mi=({channelIDs:e,disabled:t=!1,videoInfo:o,iconStyle:a,handleChannelClick:r,isWrapping:i,isShowGoogleContract:s})=>{var l,d;const u=ri(e,(null==(l=null==a?void 0:a.iconWrapperStyle)?void 0:l.color)??(null==(d=null==a?void 0:a.wrapperStyle)?void 0:d.color),o,s);return(0,n.jsx)("div",{className:ii[i?"share-list-grid":"share-list-flex"],children:u.map((e=>(0,n.jsx)(n.Fragment,{children:t?(0,n.jsx)(x.A,{position:"top",style:{zIndex:10001},content:c.Ay.t("web_share_presentation_hover_cannot_share",{},"Can\u2019t share. This video is set to private."),children:(0,n.jsx)("div",{children:(0,n.jsx)(pi,{item:e,disabled:t,handleChannelClick:r,iconStyle:a},e.id)})}):(0,n.jsx)(pi,{item:e,disabled:t,handleChannelClick:r,iconStyle:a},e.id)})))})};function gi(e,t){return`${location.origin}/${_i}/${e}?workspaceId=${t}&utm_source=share&utm_medium=product`}function vi(e,t){return e&&t?1:0}function fi(e,t){return e?t??"":""}function yi(e,t){const o={...(0,u.n)().getReportParam(),...e};(0,B.C5)(t)?p.o.reportEvent(o):Sr.reportShareAsPresentationAction(e)}const wi=[{type:1,text:c.Ay.t("web_share_translation_text_everyone",{},"Public")},{type:2,text:c.Ay.t("web_share_translation_text_space",{},"Private")}];function bi({defaultPage:e,expandModalInstance:t,isShowVipEquityCard:o,eventParams:r,showVipCard:s,openType:l}){var p,_;const{settingsInfo:h,setRoute:m,params:g,setSettingsInfo:v}=(0,i.useContext)(lr),{workspaceID:f,fileID:y}=g,{presentation_share_link:w,presentation_share_id:b,title:x,description:k}=h,A=w||gi(b,f),S=(0,i.useRef)(null),{exportState:C}=(0,i.useContext)(bv),{getOptions:I,getRecentLanguageList:E,getTargetLanguageByCode:T,setRecentLanguage:P,getLanguageListFilterRecent:j}=(0,Y.H)(),R=I();(0,i.useEffect)((()=>{let t=!1;return async function(){var o;if(!y||!f||e===rr.presentationPage)return;let a=ir;try{a=await d.l.getPresentationSettingsInfo(y,f)}catch(n){d.s.error("ShareAsPresentation",n)}t||(null!=(o=a.auto_subtitles_config)&&o.source_lang||(a.auto_subtitles_config={...a.auto_subtitles_config,source_lang:"en-GB"}),v(a))}(),()=>{t=!0}}),[y,f]);const L=async(e,t=!1)=>{v({...h,...e});try{return await d.l.updatePresentationSettingsInfo({file_id:y,workspace_id:f,access_type:h.access_type,allow_download:h.allow_download,auto_subtitles:h.auto_subtitles,auto_subtitles_config:h.auto_subtitles_config,title:h.title,description:h.description,...e}),t||a.A.success(c.Ay.t("web_sharereview_toast_save_setting_success",{},"Settings saved")),{isSuccess:!0}}catch(o){const e=function(e){const t={2387:c.Ay.t("web_share_text_title_violate_cg",{},"This title may contain words that violate our Community Guidelines. Try another one."),2388:c.Ay.t("web_share_text_desc_violate_cg",{},"This description may contain words that violate our Community Guidelines. Try another one.")},o=c.Ay.t("web_sharereview_toast_save_setting_fail",{},"Couldn\u2019t save settings");return t[e.data.ret]??o}(o);return t||a.A.error(e),{isSuccess:!1,errorMessage:e}}},O=e=>{L({auto_subtitles_config:{...h.auto_subtitles_config,...e}})},D=async e=>{const t=await L(e);if(!t.isSuccess)return t.errorMessage};return(0,n.jsxs)("div",{className:cr["presentation-wrapper"],ref:S,children:[(0,n.jsxs)("div",{className:cr["select-wrapper"],children:[(0,n.jsx)("div",{className:cr["select-label"],children:c.Ay.t("web_graphic_login_agree_privacy",{},"Privacy")}),(0,n.jsx)(N.A,{className:cr["select-component"],value:h.access_type,onChange:e=>{L({access_type:e})},disabled:C,getPopupContainer:()=>S.current,children:wi.map((e=>(0,n.jsx)(N.A.Option,{value:e.type,children:e.text},e.type)))})]}),!(o||s)&&(0,n.jsxs)("div",{className:cr["switch-wrapper"],children:[(0,n.jsx)("div",{className:cr["switch-label"],children:c.Ay.t("web_embedcode_text_allow_download",{},"Allow download")}),(0,n.jsx)(te.A,{className:cr["switch-component"],disabled:C,checked:h.allow_download,onChange:e=>{L({allow_download:e})}})]}),(o||s)&&(0,n.jsx)(Cr,{isDownloadCard:!0,eventParams:{enter_from:"share_as_pre",...r},isShowVipEquityCard:o,expandModalInstance:t,style:{marginBottom:20}}),(0,n.jsxs)("div",{className:cr["auto-subtitles-wrapper"],children:[(0,n.jsxs)("div",{className:cr["switch-wrapper"],children:[(0,n.jsx)("div",{className:cr["switch-label"],children:c.Ay.t("web_share_translation_title_auto_captions",{},"Auto captions")}),(0,n.jsx)(te.A,{className:cr["switch-component"],checked:h.auto_subtitles,disabled:C,onChange:e=>{L({auto_subtitles:e})}})]}),h.auto_subtitles&&(0,n.jsxs)("div",{className:cr["auto-subtitles-child-wrapper"],children:[(0,n.jsxs)("div",{className:cr["switch-wrapper"],children:[(0,n.jsx)("div",{className:cr["switch-label"],children:c.Ay.t("web_share_translation_text_source_language",{},"Source language")}),(0,n.jsxs)(N.A,{className:cr["select-component"],disabled:C,value:(null==(p=null==h?void 0:h.auto_subtitles_config)?void 0:p.source_lang)||"en-GB",onChange:e=>{let t;R.some((o=>o.code===e&&(t=o.value,!0))),t&&P(t),O({source_lang:e})},triggerProps:{autoAlignPopupWidth:!1,autoAlignPopupMinWidth:!0,position:"br",getPopupContainer:()=>S.current},renderFormat:(e,t)=>{const o=T(t)??{};return null==o?void 0:o.title},children:[(0,n.jsx)(N.A.OptGroup,{label:c.Ay.t("web_supportEmail_text_recent",{},"Recents"),className:cr["group-item"],children:E().map((e=>(0,n.jsxs)(N.A.Option,{value:e.code,className:cr["option-item"],children:[(0,n.jsx)("div",{className:cr["option-tag"],children:e.countryCode}),e.title]},e.id)))}),(0,n.jsx)(N.A.OptGroup,{label:c.Ay.t("all_anguages",{},"All languages"),className:cr["group-item"],children:j().map((e=>(0,n.jsxs)(N.A.Option,{value:e.code,className:cr["option-item"],children:[(0,n.jsx)("div",{className:cr["option-tag"],children:e.countryCode}),e.title]},e.id)))})]})]}),(0,n.jsxs)("div",{className:cr["switch-wrapper"],children:[(0,n.jsx)("div",{className:cr["switch-label"],children:c.Ay.t("web_share_translation_text_show_captions",{},"Display by default")}),(0,n.jsx)(F.A,{className:cr["switch-component"],checked:null==(_=null==h?void 0:h.auto_subtitles_config)?void 0:_.display_by_default,disabled:C,onChange:e=>{O({display_by_default:e})}})]})]})]}),(0,n.jsxs)("div",{className:cr["title-description-wrapper"],children:[(0,n.jsx)("div",{className:cr.title,children:c.Ay.t("web_share_title_title",{},"Title")}),(0,n.jsx)(Pr,{isDescription:!1,initialValue:x,placeholder:c.Ay.t("web_share_text_add_title",{},"Enter title to describe your video"),validator:async e=>{if(h.title!==e)return D({title:e})},disabled:C}),(0,n.jsx)("div",{className:cr.description,children:c.Ay.t("web_share_title_description",{},"Description")}),(0,n.jsx)(Pr,{isDescription:!0,initialValue:k,placeholder:c.Ay.t("web_share_text_tell_video",{},"Tell people about your video"),validator:async e=>{if(h.description!==e)return D({description:e})},disabled:C})]}),(0,n.jsx)(ne.A,{}),(0,n.jsx)("div",{className:cr["share-channels-tip"],children:c.Ay.t("web_embedcode_button_share_to")}),(0,n.jsx)(mi,{handleChannelClick:e=>{(e=>{var t,o;yi({action:{[Nr.copyLink]:u.E.copy_link,[Nr.embedCode]:u.E.embed,[Nr.email]:u.E.email,[Nr.googleContacts]:u.E.google_contacts,[Nr.twitter]:u.E.twitter,[Nr.facebook]:u.E.facebook,[Nr.tumblr]:u.E.tumblr,[Nr.whatsapp]:u.E.whatsapp,[Nr.reddit]:u.E.reddit}[e],panel_page:u.P.share_pre_detail,allow_download:h.allow_download?1:0,video_privacy:(null==h?void 0:h.access_type)??1,auto_caption:null!=h&&h.auto_subtitles?1:0,source_language:fi(null==h?void 0:h.auto_subtitles,null==(t=null==h?void 0:h.auto_subtitles_config)?void 0:t.source_lang),auto_enable:vi(null==h?void 0:h.auto_subtitles,null==(o=null==h?void 0:h.auto_subtitles_config)?void 0:o.display_by_default),video_title:x,video_description:k},l)})(e),L({},!0),e===Nr.embedCode&&m({page:rr.shareCodeEmbedPage})},videoInfo:{shareLink:A,title:x??"",description:k??"",fileID:y,workspaceID:f},disabled:C||h.access_type===wi[1].type,iconStyle:{wrapperStyle:{color:"var(--lvv-color-text-primary)",width:"79px"},iconWrapperStyle:{background:"var(--lvv-color-white-inverted)"}},isWrapping:!0,isShowGoogleContract:!0}),(o||s)&&(0,n.jsx)(Cr,{isDownloadCard:!1,eventParams:{enter_from:"share_as_pre",...r},isShowVipEquityCard:o,expandModalInstance:t,style:{marginTop:20}})]})}const xi={"code-embed-wrapper":"_code-embed-wrapper_j0cyb_1","copy-html-title":"_copy-html-title_j0cyb_6",code:"_code_j0cyb_1","copy-code":"_copy-code_j0cyb_32","platform-work-on":"_platform-work-on_j0cyb_35","copy-smart-link-title":"_copy-smart-link-title_j0cyb_42",privacy_policy:"_privacy_policy_j0cyb_50","a-target":"_a-target_j0cyb_59"},ki={"lv-review-header":"_lv-review-header_50g93_1","go-back-wrapper":"_go-back-wrapper_50g93_6",title:"_title_50g93_23"};function Ai({title:e,handleClick:t}){return(0,n.jsxs)("div",{className:ki["lv-review-header"],children:[(0,n.jsx)("div",{className:ki["go-back-wrapper"],onClick:t,children:(0,n.jsx)(r.vdJ,{size:12})}),(0,n.jsx)("div",{className:ki.title,children:e})]})}function Si({openType:e}){var t,o;const{params:r,settingsInfo:s,setRoute:l}=(0,i.useContext)(lr),{presentation_share_link:_,presentation_share_id:h}=s,m=_||gi(h,r.workspaceID),[g,v]=(0,i.useState)("");(0,i.useEffect)((()=>{const{fileID:e,workspaceID:t}=r,o=`<iframe src="${location.origin}/${hi}/${h||e}?workspaceId=${t}" allow="clipboard-write" frameborder="0" width="100%" height="100%" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>`;v(o)}),[r]);const f=e!==p.O.sharePage?{allow_download:s.allow_download?1:0,video_privacy:null==s?void 0:s.access_type,auto_caption:null!=s&&s.auto_subtitles?1:0,source_language:fi(null==s?void 0:s.auto_subtitles,null==(t=null==s?void 0:s.auto_subtitles_config)?void 0:t.source_lang),auto_enable:vi(null==s?void 0:s.auto_subtitles,null==(o=null==s?void 0:s.auto_subtitles_config)?void 0:o.display_by_default)}:{};return(0,n.jsxs)("div",{className:xi["code-embed-wrapper"],children:[(0,n.jsx)(Ai,{title:c.Ay.t("web_embedcode_text_complete_embed"),handleClick:()=>l({page:rr.presentationPage})}),(0,n.jsx)("div",{className:xi["copy-html-title"],children:c.Ay.t("web_ombed_title_embedded_code",{},"Embeded code")}),(0,n.jsx)("div",{className:xi.code,children:g}),(0,n.jsx)(k.A,{type:"primary",className:xi["copy-code"],long:!0,onClick:()=>{yi({action:u.E.copy_code,panel_page:u.P.share_pre_detail,...f},e),navigator.clipboard.writeText(g).then((()=>{a.A.success(c.Ay.t("web_embedcode_toast_copy_code_success",{},"copied"))})).catch((e=>{console.error("copy embed code",e),a.A.error(c.Ay.t("web_embedcode_toast_copy_code_fail",{},"copy failed"))}))},children:c.Ay.t("web_embedcode_button_copy_code",{},"Copy code")}),(0,n.jsx)("div",{className:xi["copy-smart-link-title"],children:c.Ay.t("web_ombed_title_embedded_link",{},"Embeded link")}),(0,n.jsx)("div",{className:xi["platform-work-on"],children:c.Ay.t("web_ombed_desc_embedded_link",{},"Users can embed a video player onto platforms that support oEmbed with an embedded link.")}),(0,n.jsx)("div",{className:xi.code,children:m}),(0,n.jsx)(k.A,{type:"primary",className:xi["copy-code"],long:!0,onClick:()=>{navigator.clipboard.writeText(m).then((()=>{a.A.success(c.Ay.t("web_embedcode_toast_copy_code_success",{},"copied"))})).catch((()=>{a.A.error(c.Ay.t("web_embedcode_toast_copy_code_fail",{},"copy failed"))})),yi({action:u.E.copy_smartlink,panel_page:u.P.share_pre_detail,...f},e)},children:c.Ay.t("web_ombed_button_copy_link",{},"Copy Smart Link")}),(0,n.jsx)("div",{className:xi.privacy_policy,children:c.Ay.t("web_embedcode_text_privacy_policy",{"text-href0":e=>(0,n.jsx)("a",{target:"__blank",href:d.P.TERMS_OF_CAPCUT(c.Ay.language),className:xi["a-target"],children:e},"terms-of-user"),"text-href1":e=>(0,n.jsx)("a",{target:"_blank",href:d.P.PRIVACY_POLICY(c.Ay.language),className:xi["a-target"],children:e},"privacy-policy")},"By signing up, you accept the <text-href0>Terms of Use</text-href0> and <text-href1>Privacy Policy</text-href1>")})]})}class Ci{constructor(){bt(this,"_store"),this._store=new lt.I3}async fetchDecryptImage(e){const{url:t,key:o,skipCache:a=!1}=e;if(!t||!o)throw new Error("fetchDecryptImage: url or key can not be empty");let n=a?void 0:await this._store.tryGetSource(t);if(!n||!(n instanceof Uint8Array||n instanceof ArrayBuffer)){const e=await R().get(t,{responseType:"arraybuffer",withCredentials:!1});n=await(0,Y.J)(e.data,o),n&&this._store.saveSourceBlob({key:t,buffer:n})}const r=new Blob([n],{type:"image/*"});return window.URL.createObjectURL(r)}}let Ii;const Ei=()=>(Ii=Ii||new Ci,Ii);new S.EventEmitter;const Ti=e=>({allow_download:!e});function Pi({workspaceID:e,fileID:t,openType:o,expandModalInstance:a,isShowVipEquityCard:r,eventParams:s,showVipCard:l,setShowMainTitle:c}){const[d,p]=(0,i.useState)({page:rr.presentationPage}),_={...ir,...Ti(l||r)},[h,m]=(0,i.useState)(_),g=[{id:rr.presentationPage,element:(0,n.jsx)(bi,{eventParams:s,isShowVipEquityCard:r,showVipCard:l,expandModalInstance:a,openType:o})},{id:rr.shareCodeEmbedPage,element:(0,n.jsx)(Si,{openType:o})}];(0,i.useEffect)((()=>{null==c||c(d.page===rr.presentationPage)}),[d]);const{exportState:v}=(0,i.useContext)(bv);return(0,i.useEffect)((()=>{(0,B.Ib)(o)&&(v||yi({action:u.E.clickable,panel_page:u.P.share_pre_detail,no_vip_used_material:(r||l)&&a?1:0},o))}),[v]),(0,n.jsx)(lr.Provider,{value:{route:d,setRoute:p,settingsInfo:h,setSettingsInfo:m,params:{workspaceID:e,fileID:t}},children:g.map((({id:e,element:t})=>(0,n.jsx)("div",{style:e!==d.page?{display:"none"}:{display:"block",flexGrow:1,overflowY:"scroll"},children:t},e)))})}const Ni={v:"5.3.4",fr:60,ip:0,op:70,w:80,h:80,nm:"loading_\u526a\u6620\u65b0LOGO_\u8f93\u51fa_w",ddd:0,assets:[],layers:[{ddd:0,ind:1,ty:3,nm:"\u7a7a 1",sr:1,ks:{o:{a:0,k:0,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[40,40,0],ix:2},a:{a:0,k:[0,0,0],ix:1},s:{a:0,k:[7.6,7.6,100],ix:6}},ao:0,ip:0,op:70,st:0,bm:0},{ddd:0,ind:2,ty:4,nm:"\u5f62\u72b6\u56fe\u5c42 4",parent:1,td:1,sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[0,0,0],ix:2},a:{a:0,k:[0,0,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ix:1,ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],v:[[542,-334],[-442,182],[-434.64,294.042],[-428,317],[-403.003,318.91],[212.003,317.075],[237,317],[263.272,300.287],[283,270],[263,-65.063]],c:!1},ix:2},nm:"\u8def\u5f84 1",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"st",c:{a:0,k:[1,0,0,1],ix:3},o:{a:0,k:100,ix:4},w:{a:0,k:152,ix:5},lc:1,lj:1,ml:4,ml2:{a:0,k:4,ix:8},nm:"\u63cf\u8fb9 1",mn:"ADBE Vector Graphic - Stroke",hd:!1},{ty:"fl",c:{a:0,k:[.453682005639,.537254961799,.526438993566,1],ix:4},o:{a:0,k:100,ix:5},r:1,nm:"\u586b\u5145 1",mn:"ADBE Vector Graphic - Fill",hd:!0},{ty:"tr",p:{a:0,k:[0,0],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"\u53d8\u6362"}],nm:"\u5f62\u72b6 1",np:3,cix:2,ix:1,mn:"ADBE Vector Group",hd:!1},{ty:"tm",s:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},n:["0p833_0p833_0p167_0p167"],t:60,s:[0],e:[86]},{t:90}],ix:1},e:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},n:["0p833_0p833_0p167_0p167"],t:0,s:[0],e:[86]},{t:30}],ix:2},o:{a:0,k:0,ix:3},m:1,ix:2,nm:"\u4fee\u526a\u8def\u5f84 1",mn:"ADBE Vector Filter - Trim",hd:!1}],ip:-9,op:70,st:0,bm:0},{ddd:0,ind:3,ty:1,nm:"\u767d\u8272 \u7eaf\u8272 2",parent:1,tt:1,sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[0,0,0],ix:2},a:{a:0,k:[540,540,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,hasMask:!0,masksProperties:[{inv:!1,mode:"f",pt:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0],[-68.43,0],[0,0],[0,61.351],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,61.351],[0,0],[64.891,0],[0,0],[0,0],[0,0],[0,0]],v:[[1043.197,305.214],[1043.197,148.297],[36.803,674.5],[36.803,832.597],[146.527,931.703],[744.7,931.703],[854.424,832.597],[854.424,825.209],[776.555,784.224],[126.47,784.224]],c:!0},ix:1},o:{a:0,k:100,ix:3},x:{a:0,k:0,ix:4},nm:"\u8499\u7248 1"}],sw:1080,sh:1080,sc:"#ffffff",ip:0,op:70,st:0,bm:0},{ddd:0,ind:4,ty:4,nm:"\u5f62\u72b6\u56fe\u5c42 3",parent:1,td:1,sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[0,0,0],ix:2},a:{a:0,k:[0,0,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ix:1,ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],v:[[283,62],[269,-253],[258.14,-289.956],[245.323,-307.636],[229,-317],[-392.01,-319.781],[-417,-316],[-431.668,-297.891],[-439.394,-274.056],[-436,-177],[554,339]],c:!1},ix:2},nm:"\u8def\u5f84 1",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"st",c:{a:0,k:[1,0,0,1],ix:3},o:{a:0,k:100,ix:4},w:{a:0,k:152,ix:5},lc:1,lj:1,ml:4,ml2:{a:0,k:4,ix:8},nm:"\u63cf\u8fb9 1",mn:"ADBE Vector Graphic - Stroke",hd:!1},{ty:"fl",c:{a:0,k:[.453682005639,.537254961799,.526438993566,1],ix:4},o:{a:0,k:100,ix:5},r:1,nm:"\u586b\u5145 1",mn:"ADBE Vector Graphic - Fill",hd:!0},{ty:"tr",p:{a:0,k:[0,0],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"\u53d8\u6362"}],nm:"\u5f62\u72b6 1",np:3,cix:2,ix:1,mn:"ADBE Vector Group",hd:!1},{ty:"tm",s:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},n:["0p833_0p833_0p167_0p167"],t:90,s:[0],e:[100]},{t:120}],ix:1},e:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},n:["0p833_0p833_0p167_0p167"],t:30,s:[12],e:[100]},{t:60}],ix:2},o:{a:0,k:0,ix:3},m:1,ix:2,nm:"\u4fee\u526a\u8def\u5f84 1",mn:"ADBE Vector Filter - Trim",hd:!1}],ip:30,op:70,st:119,bm:0},{ddd:0,ind:5,ty:1,nm:"\u767d\u8272 \u7eaf\u8272 3",parent:1,tt:1,sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[0,0,0],ix:2},a:{a:0,k:[540,540,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,hasMask:!0,masksProperties:[{inv:!1,mode:"f",pt:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0],[0,0],[64.891,0],[0,0],[0,-62.531],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0],[0,-62.531],[0,0],[-68.43,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],v:[[452.103,464.491],[126.47,295.776],[774.196,295.776],[854.424,253.92],[854.424,248.582],[744.7,148.297],[146.527,148.297],[36.803,248.582],[36.803,406.679],[301.085,543.539],[854.424,831.418],[1043.197,931.703],[1043.197,772.426],[741.203,614.935]],c:!0},ix:1},o:{a:0,k:100,ix:3},x:{a:0,k:0,ix:4},nm:"\u8499\u7248 1"}],sw:1080,sh:1080,sc:"#ffffff",ip:30,op:70,st:119,bm:0},{ddd:0,ind:6,ty:4,nm:"\u5f62\u72b6\u56fe\u5c42 2",parent:1,td:1,sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[0,0,0],ix:2},a:{a:0,k:[0,0,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ix:1,ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],v:[[542,-334],[-442,182],[-434.64,294.042],[-428,317],[-403.003,318.91],[212.003,317.075],[237,317],[263.272,300.287],[283,270],[263,-65.063]],c:!1},ix:2},nm:"\u8def\u5f84 1",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"st",c:{a:0,k:[1,0,0,1],ix:3},o:{a:0,k:100,ix:4},w:{a:0,k:152,ix:5},lc:1,lj:1,ml:4,ml2:{a:0,k:4,ix:8},nm:"\u63cf\u8fb9 1",mn:"ADBE Vector Graphic - Stroke",hd:!1},{ty:"fl",c:{a:0,k:[.453682005639,.537254961799,.526438993566,1],ix:4},o:{a:0,k:100,ix:5},r:1,nm:"\u586b\u5145 1",mn:"ADBE Vector Graphic - Fill",hd:!0},{ty:"tr",p:{a:0,k:[0,0],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"\u53d8\u6362"}],nm:"\u5f62\u72b6 1",np:3,cix:2,ix:1,mn:"ADBE Vector Group",hd:!1},{ty:"tm",s:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},n:["0p833_0p833_0p167_0p167"],t:-10,s:[0],e:[86]},{t:20}],ix:1},e:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},n:["0p833_0p833_0p167_0p167"],t:-70,s:[0],e:[86]},{t:-40}],ix:2},o:{a:0,k:0,ix:3},m:1,ix:2,nm:"\u4fee\u526a\u8def\u5f84 1",mn:"ADBE Vector Filter - Trim",hd:!1}],ip:0,op:21,st:-70,bm:0},{ddd:0,ind:7,ty:1,nm:"\u767d\u8272 \u7eaf\u8272 2",parent:1,tt:1,sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[0,0,0],ix:2},a:{a:0,k:[540,540,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,hasMask:!0,masksProperties:[{inv:!1,mode:"f",pt:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0],[-68.43,0],[0,0],[0,61.351],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,61.351],[0,0],[64.891,0],[0,0],[0,0],[0,0],[0,0]],v:[[1043.197,305.214],[1043.197,148.297],[36.803,674.5],[36.803,832.597],[146.527,931.703],[744.7,931.703],[854.424,832.597],[854.424,825.209],[776.555,784.224],[126.47,784.224]],c:!0},ix:1},o:{a:0,k:100,ix:3},x:{a:0,k:0,ix:4},nm:"\u8499\u7248 1"}],sw:1080,sh:1080,sc:"#ffffff",ip:0,op:21,st:-70,bm:0},{ddd:0,ind:8,ty:4,nm:"\u5f62\u72b6\u56fe\u5c42 1",parent:1,td:1,sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[0,0,0],ix:2},a:{a:0,k:[0,0,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ix:1,ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],v:[[283,62],[269,-253],[258.14,-289.956],[245.323,-307.636],[229,-317],[-392.01,-319.781],[-417,-316],[-431.668,-297.891],[-439.394,-274.056],[-436,-177],[554,339]],c:!1},ix:2},nm:"\u8def\u5f84 1",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"st",c:{a:0,k:[1,0,0,1],ix:3},o:{a:0,k:100,ix:4},w:{a:0,k:152,ix:5},lc:1,lj:1,ml:4,ml2:{a:0,k:4,ix:8},nm:"\u63cf\u8fb9 1",mn:"ADBE Vector Graphic - Stroke",hd:!1},{ty:"fl",c:{a:0,k:[.453682005639,.537254961799,.526438993566,1],ix:4},o:{a:0,k:100,ix:5},r:1,nm:"\u586b\u5145 1",mn:"ADBE Vector Graphic - Fill",hd:!0},{ty:"tr",p:{a:0,k:[0,0],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"\u53d8\u6362"}],nm:"\u5f62\u72b6 1",np:3,cix:2,ix:1,mn:"ADBE Vector Group",hd:!1},{ty:"tm",s:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},n:["0p833_0p833_0p167_0p167"],t:20,s:[0],e:[100]},{t:50}],ix:1},e:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},n:["0p833_0p833_0p167_0p167"],t:-40,s:[12],e:[100]},{t:-10}],ix:2},o:{a:0,k:0,ix:3},m:1,ix:2,nm:"\u4fee\u526a\u8def\u5f84 1",mn:"ADBE Vector Filter - Trim",hd:!1}],ip:0,op:51,st:49,bm:0},{ddd:0,ind:9,ty:1,nm:"\u767d\u8272 \u7eaf\u8272 3",parent:1,tt:1,sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[0,0,0],ix:2},a:{a:0,k:[540,540,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,hasMask:!0,masksProperties:[{inv:!1,mode:"f",pt:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0],[0,0],[64.891,0],[0,0],[0,-62.531],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0],[0,-62.531],[0,0],[-68.43,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],v:[[452.103,464.491],[126.47,295.776],[774.196,295.776],[854.424,253.92],[854.424,248.582],[744.7,148.297],[146.527,148.297],[36.803,248.582],[36.803,406.679],[301.085,543.539],[854.424,831.418],[1043.197,931.703],[1043.197,772.426],[741.203,614.935]],c:!0},ix:1},o:{a:0,k:100,ix:3},x:{a:0,k:0,ix:4},nm:"\u8499\u7248 1"}],sw:1080,sh:1080,sc:"#ffffff",ip:0,op:51,st:49,bm:0}],markers:[]},ji=e=>{const{className:t}=e;return(0,n.jsx)("div",{className:l()("lv-loading",t),children:(0,n.jsx)("div",{className:"lv-lottie-loading",children:(0,n.jsx)(vt.e,{config:{loop:!0,animationData:Ni}})})})},Ri=({taskId:e,customContent:t,renderSimulateProgress:o,isRenderSuccess:s,isSaveStateInit:p,presetProgressLimit:_=0,allowCloseWindow:h,handleRenderCancel:m,ignoreErrCodeSet:g,handleIgnoreRenderingErr:v,createTime:f=0,expectFinishTime:y=0,process:w=0,allowCancelRender:b,isSupportExpand:x,type:A,errorCode:S,renderPendingErrCode:C,coverImg:I,retry:E,duplicate:T,goToCloud:P,renderStateOperatesCallback:N,handlePureTransitionRenderSuccess:j,customText:R,disableCancelConfirm:L,precision:O=0,handleProcessChange:F})=>{var U,M,B,z,G,W,V,H,q,Y,K,J,$,Q,Z,X,ee,te,oe,ae;const[ne,re]=(0,i.useState)(!1),[ie,se]=(0,i.useState)(!1),[le,ce]=(0,i.useState)(0),[pe,_e]=(0,i.useState)(0),[he,me]=(0,i.useState)(0),ge=(0,de.A)((e=>{null==N||N({type:"render_state_change",state:e,errorCode:S,renderPendingErrCode:C})})),ve=(0,i.useRef)(!1),fe=(0,de.A)(((t=0)=>{const o=u.T-_,a=_+t*o/u.T;if(isNaN(a))return d.s.error("ExportModalExportProgressComputeFail",new Error(`taskId:${e},progress:${t},result:${a}`),{toGroup:"true"}),void me(t);if(p){const e=a>_?Number(a.toFixed()):_;me(e)}else me(Number(a.toFixed()))})),ye=()=>{Sr.reportExportingAction({action:u.E.cancel_export,panel_page:u.P.exporting}),new Promise((e=>{m(e),se(!1),re(!0)})).then((()=>{re(!1)}))};(0,i.useEffect)((()=>{se(!1)}),[s]),(0,i.useEffect)((()=>{b||se(!1)}),[b]),(0,i.useEffect)((()=>{const e=Math.floor((new Date).getTime()/1e3);100===w?_e(w):A===Wa.export&&y>0&&e>y?_e(99):A===Wa.export&&o&&o.setOption({initProgress:0,maxProgress:99,createTime:f,expectFinishTime:y,callback:e=>{_e((t=>Math.max(t,e??0)))}})}),[A,o,w]),(0,i.useEffect)((()=>{null==F||F({mockProcess:pe,process:Number(w)}),fe(pe)}),[w,pe]),(0,i.useEffect)((()=>{A===Wa.export&&100===Math.floor(le)&&j()}),[le,A]),(0,ue.A)((()=>{ge(A)}),[A]);const we=(0,i.useCallback)((e=>(ce(e),O>0?Math.floor(e).toString():e.toString())),[O]),be=e=>{e(),Sr.reportExportFailAction({action:u.E.retry,panel_page:u.P.export_fail})},xe=p?_:0;return(0,n.jsxs)("div",{className:"lv_exportProcess",children:[(0,n.jsxs)("div",{className:l()("lv_exportProcess-container",I&&"haveImg"),children:[(0,n.jsxs)("div",{className:"lv_exportProcess-container-processNumber",children:[A===Wa.export&&(0,n.jsx)(gt.A,{countUp:!0,styleValue:{color:"#0fbf60"},value:he,countFrom:xe,renderFormat:we,precision:O,suffix:(0,n.jsx)("div",{className:"lv_exportProcess-container-processNumber-statistic-percent",children:"%"}),className:"lv_exportProcess-container-processNumber-statistic"},"lv_exportProcess-Statistic"),(A===Wa.failed||A===Wa.exportWithUploadFailed)&&(0,n.jsx)(n.Fragment,{}),A===Wa.load&&(0,n.jsx)(ji,{}),A===Wa.loadFileFailed&&(0,n.jsx)(r.sDs,{size:68,className:"load-file-failed-icon"})]}),A===Wa.loadFileFailed&&(0,n.jsx)("div",{className:"load-file-failed-desc",children:c.F2.t("web_delete_move_file")}),(0,n.jsxs)("div",{className:"lv_exportProcess-container-title",children:[A===Wa.export&&(null!=(ke=null==R?void 0:R.title)&&ke.export?null==(Ae=null==R?void 0:R.title)?void 0:Ae.export:t?(0,n.jsxs)("div",{className:`custom-title ${t.type}`,children:[(0,n.jsx)(r._Lo,{size:14,className:"icon"}),t.title]}):null!=g&&g.has(u.b.UploadFailed)?(0,n.jsxs)("div",{className:"custom-title warn",children:[(0,n.jsx)(r._Lo,{size:14,className:"icon"}),c.F2.t("web_export_desc_materials_lost",{},"The video may have issues, like black screens, because some materials are lost.")]}):c.F2.t("export_progress")),(A===Wa.failed||A===Wa.spaceFull||A===Wa.hadCancel)&&(0,n.jsxs)("div",{className:"lv_exportProcess-container-title-failed",children:[(0,n.jsx)(r.vOZ,{size:18}),(0,n.jsx)("div",{className:"lv_exportProcess-container-title-failed-content",children:(null==(U=null==R?void 0:R.title)?void 0:U.failed)??(null==(M=null==R?void 0:R.title)?void 0:M.spaceFull)??(null==(B=null==R?void 0:R.title)?void 0:B.hadCancel)??c.F2.t("failed_export")})]}),A===Wa.exportWithUploadFailed&&(0,n.jsxs)("div",{className:"lv_exportProcess-container-title-failed",children:[(0,n.jsx)(r.uRs,{size:18}),(0,n.jsx)("div",{className:"lv_exportProcess-container-title-failed-upload",children:c.F2.t("web_export_toast_material_miss",{},"Media lost")})]}),A===Wa.load&&((null==(z=null==R?void 0:R.title)?void 0:z.load)??c.F2.t("loading_resources"))]}),(0,n.jsxs)("div",{className:"lv_exportProcess-container-content",children:[A===Wa.export&&((null==(G=null==R?void 0:R.content)?void 0:G.export)??(t?(0,n.jsx)("div",{className:"custom-content",children:t.content}):h?(0,n.jsxs)(n.Fragment,{children:[c.F2.t("closing_not_suspend_export")," ",(0,n.jsx)("br",{})," ",c.F2.t("video_stored_cloud")]}):(0,n.jsx)(n.Fragment,{children:c.F2.t("web_not_ close_the browser",{},"Do not close the browser while the video is being saved")}))),A===Wa.exportWithUploadFailed&&(0,n.jsx)("div",{children:c.F2.t("web_export_toast_video_effect_miss",{placeholder0:""},"The track contains media that wasn\u2019t uploaded. If you continue to export, your video will be incomplete. {placeholder0}")}),A===Wa.failed&&((null==(V=null==(W=null==R?void 0:R.content)?void 0:W.failed)?void 0:V.call(W,S))??(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{children:c.F2.t("error_exporting")}),(0,n.jsx)("div",{children:c.F2.t("web_ttam_feedback_there",{"text-href":e=>(0,n.jsx)("a",{className:"a-target",onClick:()=>{(0,u.n)().report({action:u.E.feedback},{panel_page:u.P.export_fail}),Ji({})},children:e},"web_ttam_feedback_there")})})]})),A===Wa.hadCancel&&((null==(H=null==R?void 0:R.content)?void 0:H.hadCancel)??(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{children:c.F2.t("web_cancel_exporting",{},"Exporting has been canceled")})})),A===Wa.spaceFull&&((null==(q=null==R?void 0:R.content)?void 0:q.hadCancel)??(x?(0,n.jsx)(n.Fragment,{children:c.F2.t("web_cloud_storage_full2",{"text-href":e=>(0,n.jsx)("span",{style:{color:"var(--lvv-color-main-default)",cursor:"pointer"},onClick:E,children:e})},"Cloud space ran out. Upgrade to expand storage or manage in Cloud and <text-href>try again</text-href>.")}):(0,n.jsx)(n.Fragment,{children:c.F2.t("web_cloud_ ran_out",{"text-href":e=>(0,n.jsx)("span",{style:{color:"var(--lvv-color-main-default)",cursor:"pointer"},onClick:E,children:e})},"Cloud space ran out. Manage in Cloud and <text-href>try again</text-href>.")}))),A===Wa.load&&((null==(Y=null==R?void 0:R.content)?void 0:Y.load)??(0,n.jsxs)(n.Fragment,{children:[c.F2.t("closing_not_suspend_export"),(0,n.jsx)("br",{}),c.F2.t("video_stored_cloud")]}))]}),A===Wa.exportWithUploadFailed&&(0,n.jsxs)("div",{className:"lv_exportProcess-container-uploadFailed-content",children:[(0,n.jsxs)(k.A,{type:"primary",onClick:()=>{L?ye():se(!0)},disabled:ne,children:[ne&&(0,n.jsx)(D.A,{webp:!0,size:15}),c.F2.t("web_export_button_back_to_editor",{},"Go back to editor")]}),(0,n.jsx)(k.A,{className:"lv_exportProcess-container-continueButton",type:"secondary",onClick:v,children:c.F2.t("web_continue_export",{},"Continue")})]}),A===Wa.export&&(0,n.jsxs)(k.A,{className:"lv_exportProcess-container-cancelButton",style:{visibility:b?"visible":"hidden"},type:"secondary",onClick:()=>{b&&(L?ye():se(!0))},disabled:ne,children:[ne&&(0,n.jsx)(D.A,{webp:!0,size:15}),(null==(K=null==R?void 0:R.button)?void 0:K.export)??c.F2.t("web_cancel_export",{},"Cancel export")]}),A===Wa.failed&&(0,n.jsx)("div",{className:"lv_exportProcess-container-retryButton",onClick:()=>be(E),children:(0,n.jsx)(k.A,{type:"primary",children:(null==(J=null==R?void 0:R.button)?void 0:J.failed)??c.F2.t("try_again_web",{},"Try again")})}),A===Wa.hadCancel&&(0,n.jsx)("div",{className:"lv_exportProcess-container-retryButton",onClick:()=>be(T),children:(0,n.jsx)(k.A,{type:"primary",children:(null==($=null==R?void 0:R.button)?void 0:$.hadCancel)??c.F2.t("try_again_web",{},"Try again")})}),A===Wa.spaceFull&&(0,n.jsx)("div",{className:"lv_exportProcess-container-spaceFull",children:x?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k.A,{type:"primary",onClick:()=>{var e,t,o,n,r;(0,u.n)().report({action:u.E.upgrade});null==(r=null==(t=null==(e=Ev())?void 0:e.expandInstanceInfo)?void 0:t.expandModal)||r.show({type:"CAPACITY_BUY",reporterParams:{enterFrom:"export_panel",currentPage:null==(n=null==(o=Ev())?void 0:o.extraData)?void 0:n.currentPage,pageFrom:mr.spaceLimitUpgrade},onCurrentShowPayStatus:(e,t)=>{console.log(e,"===expand==callBack=status==",t),"success"===e&&!ve.current&&(ve.current=!0,setTimeout((()=>{console.log("===expand==callBack=onRetry=="),E(),a.A.info(c.F2.t("web_cloud_add_success5",{},"Your cloud space storage is expanded. Exporting video now."))}),3e3)),t&&(console.log(e,"===expand==callBack=close==",t),ve.current=!1)}}),(0,u.n)().report({action:u.E.upgrade})},children:c.F2.t("web_ttam_enlarge",{},"Upgrade")}),(0,n.jsx)(k.A,{type:"secondary",className:"spaceFull-goCloud-button",onClick:P,children:(null==(Q=null==R?void 0:R.button)?void 0:Q.spaceFull)??c.F2.t("back_to_workbench",{},"Open Space")})]}):(0,n.jsx)(k.A,{type:"secondary",className:"spaceFull-goCloud-button",onClick:P,children:(null==(Z=null==R?void 0:R.button)?void 0:Z.spaceFull)??c.F2.t("back_to_workbench",{},"Go to Cloud Space")})}),null==(X=null==R?void 0:R.extra)?void 0:X[A]]}),(0,n.jsx)($n,{title:(null==(ee=null==R?void 0:R.cancel)?void 0:ee.title)??c.F2.t("cancel_running_export",{},"Cancel export?"),content:(null==(te=null==R?void 0:R.cancel)?void 0:te.content)??c.F2.t("no_stored_cloud",{},"If you cancel export, your video will not be saved to Cloud Space."),confirmContext:(null==(oe=null==R?void 0:R.cancel)?void 0:oe.confirmBtn)??c.F2.t("cancel_tiktok",{},"Cancel"),cancelContext:(null==(ae=null==R?void 0:R.cancel)?void 0:ae.cancelBtn)??c.F2.t("goback",{},"Go back"),visible:ie,onOk:ye,onCancel:()=>se(!1)})]});var ke,Ae},Li=e=>{var t,o,a,s,d,p,h;const{isSaveFail:m,isSaving:g,errorCode:v,errorTitle:f,errorMessage:y,isSupportExpand:w,process:b,handleClose:x,saveStateOperatesCallback:A,disableCancelConfirm:S,precision:C=0}=e,[I,E]=(0,i.useState)(0),[T,P]=(0,i.useState)(!1),[N,j]=(0,i.useState)(v===_.Ts.INSUFFICIENT_SPACE);(0,i.useEffect)((()=>{j(v===_.Ts.INSUFFICIENT_SPACE)}),[v]);const R=(0,i.useMemo)((()=>({[_.Ts.BELOW_VERSION]:{icon:(0,n.jsx)(r.FTq,{size:80}),button:{context:c.Ay.t("web_ttam_refresh",{},"Refresh"),fn:()=>{null==A||A("refresh"),Sr.reportSaveFailAction({action:u.E.refresh,panel_page:u.P.save_fail})}}},[_.Ts.DELETED_MATERIAL]:{icon:(0,n.jsx)(r.Jcj,{size:80}),button:{context:c.Ay.t("web_edit_project",{},"Edit project"),fn:()=>{null==x||x(),null==A||A("edit_project"),Sr.reportSaveFailAction({action:u.E.back_to_edit,panel_page:u.P.save_fail})}}},[_.Ts.INVALID_MATERIAL]:{icon:(0,n.jsx)(r.Jcj,{size:80}),button:{context:c.Ay.t("web_edit_project",{},"Edit project"),fn:()=>{null==x||x(),null==A||A("edit_project"),Sr.reportSaveFailAction({action:u.E.back_to_edit,panel_page:u.P.save_fail})}}},[_.Ts.DELETED_PACKAGE]:{icon:(0,n.jsx)(r.F1t,{size:80}),button:{context:c.Ay.t("back_to_workbench",{},"Back to Cloud"),fn:()=>{null==x||x(),null==A||A("goto_platform"),Sr.reportSaveFailAction({action:u.E.cloud,panel_page:u.P.save_fail})}}},[_.Ts.INSUFFICIENT_SPACE]:{icon:(0,n.jsx)(n.Fragment,{}),button:{context:c.Ay.t("back_to_workbench",{},"Back to Cloud"),errorMessage:w?(0,n.jsx)(n.Fragment,{children:c.Ay.t("web_cloud_storage_full2",{"text-href":e=>(0,n.jsx)("span",{style:{color:"var(--lvv-color-main-default)",cursor:"pointer"},onClick:()=>{null==A||A("retry"),Sr.reportSaveFailAction({action:u.E.retry,panel_page:u.P.save_fail})},children:e})},"Cloud space ran out. Upgrade to expand storage or manage in Cloud and <text-href>try again</text-href>.")}):(0,n.jsx)(n.Fragment,{children:c.Ay.t("web_cloud_ ran_out",{"text-href":e=>(0,n.jsx)("span",{style:{color:"var(--lvv-color-main-default)",cursor:"pointer"},onClick:()=>{null==A||A("retry"),Sr.reportSaveFailAction({action:u.E.retry,panel_page:u.P.save_fail})},children:e})},"Cloud space ran out. Manage in Cloud and <text-href>try again</text-href>.")}),fn:()=>{null==A||A("goto_platform"),Sr.reportSaveFailAction({action:u.E.cloud,panel_page:u.P.save_fail})}}},[_.Ts.INVALID_TOKEN]:{icon:(0,n.jsx)(r.Pt1,{size:80}),button:{context:I<2?c.Ay.t("try_again_web",{},"Try again"):c.Ay.t("web_ttam_refresh",{},"Refresh"),fn:()=>{var e,t;I<2?(E((e=>e+1)),null==A||A("retry"),Sr.reportSaveFailAction({action:u.E.retry,panel_page:u.P.save_fail})):(null==(t=null==(e=null==window?void 0:window.location)?void 0:e.reload)||t.call(e),Sr.reportSaveFailAction({action:u.E.refresh,panel_page:u.P.save_fail}))}}},[_.Ts.SAVE_TIMEOUT]:{icon:(0,n.jsx)(n.Fragment,{}),button:{context:c.Ay.t("web_export_button_back_to_editor",{},"Go back to editor"),fn:()=>{null==x||x(),Sr.reportSaveFailAction({action:u.E.back_to_edit,panel_page:u.P.save_fail})}}},ELSE:{icon:(0,n.jsx)(r.Pt1,{size:80}),button:{context:I<2?c.Ay.t("try_again_web",{},"Try again"):c.Ay.t("web_ttam_refresh",{},"Refresh"),fn:()=>{var e,t;I<2?(E((e=>e+1)),null==A||A("retry"),Sr.reportSaveFailAction({action:u.E.retry,panel_page:u.P.save_fail})):(null==(t=null==(e=null==window?void 0:window.location)?void 0:e.reload)||t.call(e),Sr.reportSaveFailAction({action:u.E.refresh,panel_page:u.P.save_fail}))}}}})),[I]),L=()=>{null==A||A("cancelExport"),null==x||x(),Sr.reportSaveFailAction({action:u.E.cancel_export,panel_page:u.P.save_fail})},O=b??0,F=C>0?Math.floor((O??0)*(10*C))/(10*C):Math.floor(O);return(0,n.jsxs)("div",{className:l()("exportSaveProcess",{isFail:m,isSaving:g}),children:[(0,n.jsx)($n,{title:c.Ay.t("cancel_running_export",{},"Cancel export?"),content:c.Ay.t("no_stored_cloud",{},"If you cancel export, your video will not be saved to Cloud Space."),confirmContext:c.Ay.t("cancel_tiktok",{},"Cancel"),cancelContext:c.Ay.t("goback",{},"Go back"),visible:T,onOk:L,onCancel:()=>P((e=>!e))}),(0,n.jsxs)("div",{className:"saveProcess-saving",children:[(0,n.jsx)(gt.A,{value:F,suffix:(0,n.jsx)("div",{className:"statistic-percent",children:"%"}),className:"statistic",precision:C,countUp:!0,styleValue:{color:"#0fbf60"}}),(0,n.jsx)("div",{className:"title",children:c.Ay.t("save_web_ing",{},"Saving Video...")}),(0,n.jsx)("div",{className:"context",children:c.Ay.t("web_not_ close_the browser",{},"Do not close the browser while the video is being saved")}),(0,n.jsx)(k.A,{className:"exportSaveProcess-btn-font",type:"secondary",onClick:()=>{S?L():P((e=>!e))},children:c.Ay.t("cancel_export",{},"Cancel export")})]}),(0,n.jsxs)("div",{className:"saveProcess-fail",children:[(0,n.jsx)("div",{className:"icon",children:v?(null==(t=null==R?void 0:R[v])?void 0:t.icon)??R.ELSE.icon:R.ELSE.icon}),(0,n.jsxs)("div",{className:"title",style:v===_.Ts.SAVE_TIMEOUT?{color:"var(--lvv-color-warning-primary)"}:{},children:[v===_.Ts.SAVE_TIMEOUT?(0,n.jsx)(r.uRs,{}):(0,n.jsx)(r.vOZ,{}),f||c.Ay.t("couldnot_save",{},"Couldn\u2019t save")]}),(0,n.jsx)("div",{className:"context",children:v&&N?null==(a=null==(o=null==R?void 0:R[v])?void 0:o.button)?void 0:a.errorMessage:y||c.Ay.t("netwoek_web_error_web_cannot_web_save",{},"Network error. Couldn't save project")}),(0,n.jsxs)("div",{className:"btn-controller",children:[N&&w&&(0,n.jsx)(k.A,{type:"primary",onClick:()=>{var e,t,o,a,n;(0,u.n)().report({action:u.E.upgrade},{panel_page:u.P.save_fail}),null==(n=null==(t=null==(e=Ev())?void 0:e.expandInstanceInfo)?void 0:t.expandModal)||n.show({type:"CAPACITY_BUY",reporterParams:{enterFrom:"export_panel",currentPage:null==(a=null==(o=Ev())?void 0:o.extraData)?void 0:a.currentPage,pageFrom:mr.spaceLimitUpgrade}})},children:c.Ay.t("web_ttam_enlarge",{},"Upgrade")}),(0,n.jsx)(k.A,{type:N?"secondary":"primary",className:l()("saveProcess-btn-font",{"spaceFull-goCloud-button":N}),onClick:v?(null==(d=null==(s=null==R?void 0:R[v])?void 0:s.button)?void 0:d.fn)??R.ELSE.button.fn:R.ELSE.button.fn,children:v?(null==(h=null==(p=null==R?void 0:R[v])?void 0:p.button)?void 0:h.context)??R.ELSE.button.context:R.ELSE.button.context}),v===_.Ts.SAVE_TIMEOUT?(0,n.jsx)(k.A,{type:"secondary",className:l()("saveProcess-btn-font",{"spaceFull-goCloud-button":!0}),onClick:()=>{null==A||A("retry"),Sr.reportSaveFailAction({action:u.E.continue_export,panel_page:u.P.save_fail})},children:c.Ay.t("web_continue_export",{},"Continue")}):null]})]})]})};const Oi=({renderService:e})=>{const t=(0,i.useRef)(null),o=(0,i.useRef)({preTime:0,report:!1}),a=(0,i.useRef)(null),s=(0,i.useRef)(null),d=(0,i.useRef)(!1),p=(0,i.useRef)(null),[_,h]=(0,i.useState)(!1),[g,v]=(0,i.useState)(!1),f=(0,m.d)(e,(e=>{var t;return null==(t=null==e?void 0:e.context)?void 0:t.videoPlayInfo}))||{},y=(0,m.d)(e,(e=>{var t;return null==(t=e.context.videoPlayInfo)?void 0:t.waitingStartTime}))||0,{currentTime:w=0,playStatus:b,fullscreen:k,duration:A=0,videoInstance:S}=f,{send:C}=e;(0,i.useEffect)((()=>(y&&!d.current&&(a.current=setTimeout((()=>{!d.current&&v(!0),d.current=!0}),8e3)),()=>{clearTimeout(a.current)})),[y]),(0,i.useEffect)((()=>(g&&(s.current=setTimeout((()=>{v(!1)}),5e3)),()=>{clearTimeout(s.current)})),[g]),(0,i.useEffect)((()=>{!o.current.report&&o.current.preTime>0&&0===w&&A>0?((0,u.n)().report({action:u.E.video_finish}),o.current={preTime:0,report:!0}):o.current={...o.current,preTime:w}}),[w,A]);const[I,E]=function(e){const t=(0,i.useRef)(null),[o,a]=(0,i.useState)({percent:0,currentTime:0,seeking:!1}),n=(0,i.useMemo)((()=>(0,je.A)(((o,n)=>{if(!t.current)return;const r=o.clientX-t.current.getBoundingClientRect().left+1,i=(0,ft.A)(r/t.current.offsetWidth,0,1),s=(0,ft.A)(i*e,0,e);a((e=>({percent:i,currentTime:s,seeking:n??e.seeking})))}))),[e]);return(0,i.useEffect)((()=>{if(!t.current)return;const e=e=>{e.preventDefault(),n(e)},o=t=>{t.preventDefault(),window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",o),n(t,!1)},a=t=>{t.preventDefault(),window.addEventListener("mousemove",e),window.addEventListener("mouseup",o),n(t,!0)};return t.current.addEventListener("mousedown",a),()=>{t.current&&(t.current.removeEventListener("mousedown",a),t.current.removeEventListener("mousemove",e),t.current.removeEventListener("mouseup",o))}}),[e,n]),[t,o]}(A);return(0,i.useEffect)((()=>{C({type:"UPDATE_CURRENT_TIME",currentTime:E.currentTime})}),[E.currentTime]),(0,i.useEffect)((()=>{C({type:"CHANGE_DRAG_STATUS",dragging:E.seeking})}),[E.seeking]),(0,i.useEffect)((()=>{C({type:"INIT_XG_PLAYER"})}),[]),(0,n.jsxs)("section",{className:"lv_share_export-video",ref:t,onMouseEnter:()=>{clearTimeout(p.current),h(!0)},onMouseLeave:()=>{p.current=setTimeout((()=>{h(!1)}),500)},children:[(0,n.jsx)("div",{id:"SHARE_MODAL_VIDEO"}),(0,n.jsxs)("section",{className:l()("lv_share_export-video-tips",g&&"show"),children:[(0,n.jsxs)("div",{className:"lv_share_export-video-tips-left",children:[(0,n.jsx)(r.zK0,{size:16}),(0,n.jsx)("span",{children:c.F2.t("web_increase_resolution")})]}),(0,n.jsx)(r.En0,{size:16,onClick:()=>v(!1)})]}),(0,n.jsxs)("section",{className:l()("lv_share_export-video-controls",(E.seeking||_||!b)&&"show"),children:[(0,n.jsxs)("div",{className:l()("lv_share_export-video-progress",{seeking:E.seeking}),children:[(0,n.jsx)("div",{className:"progress-played",style:{width:w/A*100+"%"},children:(0,n.jsx)("span",{className:"progress-btn"})}),(0,n.jsx)("div",{className:"progress-seek-area",ref:I})]}),(0,n.jsxs)("div",{className:"lv_share_export-video-action",children:[(0,n.jsxs)("div",{className:"lv_share_export-video-action-left",children:[(0,n.jsx)("div",{className:"action-play",children:b?(0,n.jsx)(r.W$I,{onClick:()=>{C({type:"CHANGE_PLAY_STATUS",playStatus:!1})}}):(0,n.jsx)(r.K5u,{onClick:()=>{C({type:"CHANGE_PLAY_STATUS",playStatus:!0})}})}),(0,n.jsxs)("div",{className:"action-currentTime",children:[(0,n.jsx)("div",{children:(0,Y.f)(w)}),(0,n.jsx)(ne.A,{className:"current-time-divider",type:"vertical"}),(0,n.jsx)("div",{className:"current-time-duration",children:(0,Y.f)(A)})]})]}),(0,n.jsx)("div",{className:"lv_share_export-video-action-right",children:(0,n.jsx)("div",{className:"action-fullscreen",children:(0,n.jsx)(x.A,{style:{zIndex:1001},content:c.F2.t("web_full_screen",{},"full screen"),children:k?(0,n.jsx)(r.EGM,{onClick:()=>{null==S||S.exitFullscreen(t.current)}}):(0,n.jsx)(r.Lt1,{onClick:()=>{null==S||S.getFullscreen(t.current)}})})})})]})]})]})},Fi="_wrapper_jchsl_1",Di="_graphic-panel_jchsl_9",Ui="_body_jchsl_18",Mi="_left_jchsl_25",Bi="_right_jchsl_30",zi="_header_myxa5_1",Gi="_left_myxa5_7",Wi="_text_myxa5_11",Vi="_right_myxa5_17",Hi="_feedback_myxa5_23",qi=i.memo((({form:e,count:t,data:o})=>{const i=()=>e.getFieldValue("imgList"),s=t=>e.setFieldValue("imgList",t);return(0,n.jsxs)("div",{className:"upload-section-share",children:[o.map(((e,t)=>(0,n.jsxs)("div",{className:"upload-img",children:[(0,n.jsx)("img",{src:e.url,crossOrigin:"anonymous"}),"finished"===e.status?(0,n.jsx)("div",{className:"del_icon-wrapper",children:(0,n.jsx)(r.mTM,{className:"icons icons--del",onClick:()=>{if("finished"!==e.status)return;const o=i().slice(0);o.splice(t,1),s(o)}})}):(0,n.jsx)(D.A,{webp:!0})]},e.key))),o.length<t&&(0,n.jsxs)("label",{htmlFor:"upload-input",className:"upload-button",children:[(0,n.jsx)("input",{type:"file",className:"upload-input",id:"upload-input",onChange:async e=>{const n=e.target.files;if(n&&o.length+n.length>t)return a.A.error(c.Ay.t("picture_over_4")),void(e.target.value="");const r=e=>{const t={picture_over_mb:c.Ay.t("picture_over_mb"),upload_failed_click_retry:c.Ay.t("upload_failed_click_retry")};null!=t&&t[e.error]&&a.A.error(t[e.error])},l=async(e,t)=>{var o,a;if(e.size>1048576)return r({key:t,error:"picture_over_mb"});((e,t)=>{const o={image:()=>{const o=i();s(o.slice(0).concat({key:e,url:window.URL.createObjectURL(t),status:"unfinished"}))}};Object.keys(o).forEach((e=>{var a;null!=(a=null==t?void 0:t.type)&&a.includes(e)&&o[e]()}))})(t,e);try{const n=await(async e=>{const{aid:t,app_name:o}=xt,a=new FormData;return a.append("aid",t),a.append("watermark","1"),a.append("app_name",o),a.append("image",e),await Gt({method:"post",url:"/feedback/image/v1/upload/",data:a})})(e);((e,t)=>{const o=i();if("image"===e){const{key:e,ImageHeight:a,ImageUri:n,ImageWidth:r}=t,i=o.slice(0),l=i.findIndex((t=>t.key===e));i[l]&&(i[l]={...i[l],status:"finished",ImageUri:n,ImageWidth:r,ImageHeight:a}),s(i)}})("image",{key:t,ImageUri:null==(a=null==(o=null==n?void 0:n.data)?void 0:o.data)?void 0:a.web_uri,ImageWidth:n.data.data.width,ImageHeight:n.data.data.height})}catch(n){r({key:t,error:n})}};if(n)for(const t of n){const e=Date.now().toString();t.type.includes("image")&&l(t,e)}e.target.value=""},accept:"image/*"}),(0,n.jsx)(r.GM8,{className:"icon-add-img",size:20})]}),(0,n.jsxs)("div",{className:"img-count",children:[o.length,"/",t]})]})})),Yi=({initialValues:e,maxContent:t,onSubmit:o})=>{const[a]=L.A.useForm(),[r,s]=(0,i.useState)(!1),d=async()=>{s(!0);const e=a.getFieldsValue();e&&await o(e),s(!1)},u=(0,i.useMemo)((()=>({web_feedback_button_slow:c.Ay.t("web_feedback_button_slow",{},"Slow export speed or export issues"),web_feedback_button_out_syc:c.Ay.t("web_feedback_button_out_syc",{},"Audio out of sync"),web_feedback_button_visual:c.Ay.t("web_feedback_button_visual",{},"Visual abnormalities"),web_feedback_button_text_issue:c.Ay.t("web_feedback_button_text_issue",{},"Text issues"),web_feedback_button_sharing:c.Ay.t("web_feedback_button_sharing",{},"Sharing or uploading issues"),web_feedback_button_other_describe:c.Ay.t("web_feedback_button_other_describe",{},"Other (describe your problem below)")})),[]);return(0,n.jsxs)(L.A,{initialValues:e,className:"export-share-feedback-form",form:a,requiredSymbol:{position:"end"},labelAlign:"left",layout:"vertical",validateTrigger:"onSubmit",children:[(0,n.jsx)("div",{className:"feedback-modal-header",children:c.Ay.t("web_feedback_text_export_upload",{},"Export and upload feedback")}),(0,n.jsxs)("div",{className:"feedback-modal-container",children:[(0,n.jsx)(L.A.Item,{field:"problemList",label:c.Ay.t("web_feedback_text_what_problem",{},"What was the problem?"),rules:[{required:!0}],className:"problem-item",children:(0,n.jsx)(F.A.Group,{children:Object.keys(u).map((e=>(0,n.jsx)(F.A,{value:u[e],children:({checked:t})=>(0,n.jsx)("div",{className:l()("from-checkbox-item",{checked:t}),children:(0,n.jsx)("span",{children:u[e]})})},e)))})}),(0,n.jsx)(L.A.Item,{field:"content",label:c.Ay.t("feedback_problem_description"),rules:[{required:!0}],children:(0,n.jsx)(O.A.TextArea,{className:"feedback-content",placeholder:c.Ay.t("please_describe_your_problem_or_suggestion"),maxLength:{length:t,errorOnly:!0},showWordLimit:!0,autoSize:!0})}),(0,n.jsx)(L.A.Item,{field:"imgList",label:c.Ay.t("web_ttam_upload_files"),children:e=>(0,n.jsx)(qi,{form:a,count:4,data:e.imgList})}),(0,n.jsx)(L.A.Item,{label:c.Ay.t("email"),field:"contact",children:(0,n.jsx)(O.A,{className:"feedback-input",maxLength:100,placeholder:c.Ay.t("please_leave_your_contact_information_for_feedback")})})]}),(0,n.jsx)(L.A.Item,{wrapperCol:{span:24},className:"feedback-actions",shouldUpdate:!0,children:e=>{var o,a,i,s;const l=(null==(o=null==e?void 0:e.content)?void 0:o.length)<=t&&(null==(a=e.content)?void 0:a.length)&&(null==(i=e.problemList)?void 0:i.length)&&(null==(s=e.imgList)?void 0:s.every((e=>"finished"===e.status)));return(0,n.jsx)(k.A,{className:"feedback-confirm",type:"primary",htmlType:"submit",disabled:!l,loading:r,onClick:d,children:c.Ay.t("web_ttam_submit",{},"submit")})}})]})},Ki=({initialValues:e,maxContent:t,onCancel:o,onSubmit:a})=>{const[r]=L.A.useForm(),[s,l]=(0,i.useState)(!1),d=async()=>{l(!0);const e=r.getFieldsValue();e&&await a(e),l(!1)};return(0,n.jsxs)(L.A,{initialValues:e,className:"export-share-feedback-form",form:r,requiredSymbol:{position:"end"},labelAlign:"left",layout:"vertical",validateTrigger:"onSubmit",children:[(0,n.jsx)("div",{className:"feedback-modal-header",children:c.Ay.t("web_ttam_age_appeal_title")}),(0,n.jsx)(L.A.Item,{field:"content",label:c.Ay.t("web_ttam_description"),rules:[{required:!0}],children:(0,n.jsx)(O.A.TextArea,{className:"feedback-content",placeholder:c.Ay.t("please_describe_your_problem_or_suggestion"),maxLength:{length:t,errorOnly:!0},showWordLimit:!0})}),(0,n.jsx)(L.A.Item,{field:"imgList",label:c.Ay.t("web_ttam_upload_files"),rules:[{required:!0}],children:e=>(0,n.jsxs)("div",{className:"feedback-age-imgList",children:[(0,n.jsxs)("div",{className:"feedback-age-imgList-desc",children:[(0,n.jsx)("div",{className:"desc-pre"}),(0,n.jsx)("span",{children:c.Ay.t("web_ttam_age_appeal1",{"color-strong":e=>(0,n.jsx)("strong",{children:e})})})]}),(0,n.jsxs)("div",{className:"feedback-age-imgList-desc desc-privacy",children:[(0,n.jsx)("div",{className:"desc-pre"}),(0,n.jsx)("span",{children:c.Ay.t("web_ttam_age_appeal2")})]}),(0,n.jsx)(qi,{form:r,count:4,data:e.imgList})]})}),(0,n.jsx)(L.A.Item,{wrapperCol:{span:24},className:"feedback-actions",shouldUpdate:!0,children:e=>{var a,r,i;const l=e.content&&(null==(a=null==e?void 0:e.content)?void 0:a.length)<=t&&(null==(r=e.imgList)?void 0:r.length)&&(null==(i=e.imgList)?void 0:i.every((e=>"finished"===e.status)));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k.A,{className:"feedback-cancel",type:"default",onClick:o,children:c.Ay.t("web_cancel")}),(0,n.jsx)(k.A,{className:"feedback-confirm",type:"primary",htmlType:"submit",disabled:!l,loading:s,onClick:d,children:c.Ay.t("web_ttam_submit")})]})}})]})};function Ji({type:e=Wt.Feedback,webID:t="",onSubmited:o}){const i={content:"",imgList:[],problemList:[]},s={content:"",imgList:[]};return new Promise((l=>{let p=null;const _=e===Wt.Feedback?"export":"age";(new aa).report({action:"show",type:_});const h=async n=>{var r,i,s,h,m,g,v,f,y;const w=null==(i=null==(r=Ev())?void 0:r.getService("renderService"))?void 0:i.getSnapshot(),b=null==(s=null==w?void 0:w.context)?void 0:s.taskId,x=null==(h=null==w?void 0:w.context)?void 0:h.fileId,k=(null==(m=kn())?void 0:m.getCurrentLocale()).slice(0,2);(new aa).report({action:"submit",type:_,problem:null==(g=null==n?void 0:n.problemList)?void 0:g.join(",")});try{const r=(null==window?void 0:window._currentBranch)??"",i=JSON.parse(window.__userInfoStringify??"{}").data,s=null==(v=null==i?void 0:i.subscribe_info)?void 0:v.flag,d=await Vt({...n,type:e,isVip:s,appVersion:r,currentLanguage:k,extra_params:{taskId:b,fileId:x,state:JSON.stringify(null==w?void 0:w.toStrings()),url:(null==(y=null==(f=null==window?void 0:window.location)?void 0:f.toString)?void 0:y.call(f))||""}},t||(await(0,u.r)().getToken()).web_id);null==o||o(d.data.feedback_id),a.A.success(c.Ay.t("feedback_submit")),l(void 0),p.close()}catch(A){d.s.error("ExportAndShare-FeedbackModal-SubmitFeedback",A),a.A.error(2===A.err_code?c.Ay.t("feedback_submit_refresh"):c.Ay.t("web_network_error"))}};p=y.A.confirm({wrapClassName:"export-share-feedback-modal",title:null,footer:null,icon:null,closable:!0,closeIcon:(0,n.jsx)("div",{className:"closeIcon",onClick:()=>{(new aa).report({action:"close",type:_})},children:(0,n.jsx)(r.gzW,{size:20})}),maskClosable:!1,content:e===Wt.Feedback?(0,n.jsx)(Yi,{initialValues:i,maxContent:300,onSubmit:h}):(0,n.jsx)(Ki,{initialValues:s,maxContent:300,onCancel:()=>{(new aa).report({action:"cancel",type:_}),p.close()},onSubmit:h})})}))}const $i=({title:e,handleClose:t})=>{const o=(0,n.jsx)(x.A,{style:{zIndex:1001},position:"top",trigger:"hover",content:c.F2.t("web_ttam_feedback"),children:(0,n.jsx)(r.R6Z,{className:Hi,size:24,onClick:()=>{(0,p.g)().report({action:p.q.feedback}),Ji({})}})}),a=(0,n.jsx)(x.A,{style:{zIndex:1001},position:"top",trigger:"hover",content:c.F2.t("web_ttam_close"),children:(0,n.jsx)(r.En0,{size:24,onClick:()=>{t()}})});return(0,n.jsxs)("div",{className:zi,children:[(0,n.jsx)("div",{className:Gi,children:(0,n.jsx)("div",{className:Wi,children:e})}),(0,n.jsxs)("div",{className:Vi,children:[o,a]})]})},Qi="_graphic-previewer_diicy_1",Zi="_graphic-previewer-single-skeleton_diicy_15",Xi="_graphic-previewer-multiple_diicy_22",es="_single-wrapper_diicy_36",ts="_multiple-item-wrapper_diicy_41",os="_multiple-item-image_diicy_48",as="_multiple-item-page_diicy_56",ns=({previewUrl:e})=>e?(0,n.jsx)(yt.A,{className:es,src:e,width:408,height:498,preview:!1,alt:""}):(0,n.jsx)(yt.A,{src:"",alt:""}),rs=({previewUrl:e,index:t})=>(0,n.jsxs)("div",{className:ts,children:[(0,n.jsx)(yt.A,{className:os,src:e,width:172,height:96.75,preview:!1,alt:""}),(0,n.jsxs)("div",{className:as,children:["Page ",t+1]})]}),is=({previewUrlList:e})=>(0,n.jsx)(n.Fragment,{children:e.map(((e,t)=>(0,n.jsx)(rs,{previewUrl:e,index:t},t)))});var ss=(e=>(e.single="single",e.multiple="multiple",e))(ss||{});const ls=(0,i.createContext)({panelShowParams:{draftId:"",graphicInfoList:[]}}),cs=async(e="")=>{const[t,o]=await(async e=>{var t,o,a,n,r;const i=["",""];try{await lt.QO.init();const s=await lt.QO.getAssetByFileId(e);if(!s)return i;const l=null==(a=null==(o=null==(t=null==s?void 0:s._sourceData)?void 0:t.image_transcode_info)?void 0:o.origin)?void 0:a.preview_url,c=null==(r=null==(n=null==s?void 0:s._sourceData)?void 0:n.image_transcode_info)?void 0:r.key;return l&&c?[l,c]:i}catch{return i}})(e);if(t&&o)try{return await Ei().fetchDecryptImage({url:t,key:o,skipCache:!1})||void 0}catch{return}},ds=()=>(0,n.jsx)(V.A,{className:Zi,animation:!0,image:{style:{width:408,height:"100%",borderRadius:8}},text:!1}),us=({count:e})=>{let t=e;return e<2&&(t=2),e>8&&(t=8),(0,n.jsx)("div",{className:l()(Qi,Xi),children:Array.from({length:t}).map((()=>(0,n.jsx)(V.A,{className:ts,animation:!0,image:{style:{width:172,height:96.75,borderRadius:12}},text:!1})))})},ps=()=>{var e;const{panelShowParams:t}=(0,i.useContext)(ls),o=(0,i.useMemo)((()=>t.graphicInfoList.length>1?ss.multiple:ss.single),[t.graphicInfoList]),[a,r]=(0,i.useState)(!1),[s,c]=(0,i.useState)([]);(0,i.useEffect)((()=>{(async()=>{r(!0);const e=await Promise.all(t.graphicInfoList.map((e=>new Promise((async t=>{const{previewUrl:o,assetId:a}=e;if(o)return t(o);return t(await cs(a))})))));r(!1),c(e)})()}),[]);const d=(null==(e=t.graphicInfoList)?void 0:e.length)||1;return a?d>1?(0,n.jsx)(us,{count:d}):(0,n.jsx)(ds,{}):o===ss.multiple?(0,n.jsx)("div",{className:l()(Qi,Xi),children:(0,n.jsx)(is,{previewUrlList:s})}):(0,n.jsx)("div",{className:l()(Qi),children:(0,n.jsx)(ns,{previewUrl:s[0]})})};var _s=(e=>(e.UploadSuccess="uploadSuccess",e.UploadFailed="uploadFailed",e.UploadAuditing="uploadAuditing",e.UploadAuditFailed="uploadAuditFailed",e.ShareSuccess="shareSuccess",e.PublishTimeOut="publishTimeOut",e.PrivacyNotMatch="privacyNotMatch",e))(_s||{});const hs=({handleBack:e,headTitle:t,visible:o})=>o?(0,n.jsxs)("div",{className:"lv_share_header",children:[(0,n.jsx)("div",{className:"lv_share_header-icon",onClick:e,children:(0,n.jsx)(r.P1B,{})}),(0,n.jsx)("div",{className:"lv_share_header-title",children:t})]}):null,{Item:ms}=L.A,{TextArea:gs}=O.A,{Option:vs}=N.A,fs=F.A.Group,ys={TikTok:(0,n.jsx)(r.Do0,{})},ws={"video/mp4":"mp4"},bs=10001,xs=e=>{var t,o;const{uploadProgress:a,checkBoxOption:s,selectOption:d,userInfo:_,fileInfo:v,platformsList:f,popUpContainer:w}=e,[b,A]=(0,i.useState)(!1),{shareService:S,selectItemID:C}=Zn(),[I,E]=(0,g.B)(S),T="smart_tool_page"===(null==(t=I.context.reportExtra)?void 0:t.currentPage),[P,j]=(0,g.B)(I.children.LvShareTt),[R,O]=(0,i.useState)(""),[D]=(0,i.useState)(!1),[U,M]=(0,i.useState)(),[B,G]=(0,i.useState)(!1),[W,V]=(0,i.useState)(),{exportState:H}=(0,i.useContext)(bv),[q,Y]=(0,i.useState)(!1),[K,J]=(0,i.useState)(!1),[$,Q]=(0,i.useState)(!1),Z="Only me"===U,X=(0,m.d)(I.children.LvShareTt,(e=>e.context.preFormInfo)),ee=[{checkItem:U,checkSuccess:()=>G(!1),checkFailed:()=>G(!0)}];(0,i.useEffect)((()=>{var e,t,o,a,n,r,i,l;if(X){const c=null==(t=null==(e=P.context)?void 0:e.preFormInfo)?void 0:t.privacy_level;O((null==(a=null==(o=P.context)?void 0:o.preFormInfo)?void 0:a.title)??""),M((c&&(null==(n=null==_?void 0:_[p.T.PRIVACY_LEVEL_OPTIONS])?void 0:n.includes(c))&&(null==(l=null==(i=null==(r=d[u.c.TikTok])?void 0:r.filter((e=>e.key===Ss[c])))?void 0:i[0])?void 0:l.title))??""),V(s[u.c.TikTok].map(((e,t)=>{var o,a,n,r,i;return null==(a=null==(o=P.context)?void 0:o.preFormInfo)||!a.hasOwnProperty(e.serviceKey)||null!=(r=null==(n=P.context)?void 0:n.preFormInfo)&&r[e.serviceKey]||null!=(i=s[u.c.TikTok])&&i[t].disabled?"-1":(t+1).toString()})).filter((e=>"-1"!==e)))}}),[X]),(0,i.useEffect)((()=>{let e;switch(ee.forEach((e=>{e.checkItem&&e.checkSuccess()})),U){case"Only me":e="private";break;case"Friends":e="friends";break;case"EveryOne":e="public"}(0,u.n)().setParam({share_caption:R,share_caption_words_cnt:R.length,share_view_range:e,allow_comment:null!=W&&W.includes("1")?1:0,allow_duet:null!=W&&W.includes("2")?1:0,allow_stitch:null!=W&&W.includes("3")?1:0})}),[U,W,R]),(0,i.useEffect)((()=>{b&&A(!1)}),[_]);const oe=P.matches("show.hasBind.uploading"),ae=()=>{j({type:"USER_UNBIND"})},ne=["show.hasBind.notUpload.loading","show.hasBind.uploading"].some(P.matches)||b||P.matches("show.hasNotBind"),re=ne||q&&!$&&!K,ie=e=>{Q(e);const t=d[u.c.TikTok].find((e=>e.key===Ss.SELF_ONLY));t&&(t.disabled=e)},se=()=>{const e=w?{getPopupContainer:()=>w}:{};y.A.info({icon:null,title:c.Ay.t("web_posttt_title_agree_music_confirmation"),content:c.Ay.t("web_posttt_text_legal_copy1"),okText:c.Ay.t("web_space_workspace_get_it"),...e,cancelButtonProps:{style:{display:"none"}}})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(hs,{headTitle:c.Ay.t("upload_tiktok"),handleBack:()=>{j("BACK_CHOOSE_STATE")},visible:!C}),(0,n.jsxs)("div",{className:l()("lv_chosenPage-tt"),children:[(0,n.jsxs)("div",{style:{marginBottom:"24px"},children:[P.matches("show.hasBind")&&(0,n.jsx)(N.A,{placeholder:"Please select",className:"lv_chosenPage-tt-form-userInfo",defaultValue:"userInfo",disabled:oe,getPopupContainer:e=>(e.classList.add("lv_chosenPage-tt-userDropdown"),e),dropdownRender:()=>(0,n.jsx)("div",{className:"lv_chosenPage-tt-form-signout",onClick:ae,children:(0,n.jsxs)("div",{className:"lv_chosenPage-tt-form-signout-container",children:[(0,n.jsx)("div",{className:"lv_chosenPage-tt-form-signout-container-icon",children:(0,n.jsx)(r.ZT9,{size:20})}),(0,n.jsx)("div",{className:"lv_chosenPage-tt-form-signout-container-content",children:c.Ay.t("web_sign_out")})]})}),dropdownMenuStyle:{border:"1px solid rgba(255, 255, 255, 0.06)"},children:(0,n.jsx)(vs,{value:"userInfo",children:(0,n.jsxs)("div",{className:"lv_chosenPage-tt-form-userInfo-container",children:[(0,n.jsxs)("div",{className:"lv_chosenPage-tt-form-userInfo-container-headImg",children:[(0,n.jsx)("div",{className:"lv_chosenPage-tt-form-userInfo-container-headImg-img",children:_&&null!=_&&_.creator_avatar_url?(0,n.jsx)("img",{crossOrigin:"anonymous",src:null==_?void 0:_.creator_avatar_url,alt:""}):(0,n.jsx)(n.Fragment,{})}),(0,n.jsx)("div",{className:"lv_chosenPage-tt-form-userInfo-container-platform",children:ys[u.c.TikTok]})]}),(0,n.jsx)("div",{children:(0,n.jsx)("div",{className:"lv_chosenPage-tt-form-userInfo-container-name",children:_&&(null==_?void 0:_.creator_nickname)})})]})},"userInfo")}),P.matches("show.hasNotBind")&&(0,n.jsxs)("div",{className:"lv_chosenPage-tt-form-login",onClick:()=>{const e=f.filter((e=>e.platformName===u.c.TikTok));E({type:"CHOOSE_PLATFORM",data:{platform:u.c.TikTok,authUrl:e[0].authUrl}})},children:[(0,n.jsx)("div",{className:"lv_chosenPage-tt-form-login-head",children:(0,n.jsx)(r.W2v,{size:32})}),(0,n.jsx)("div",{className:"lv_chosenPage-tt-form-login-content",children:c.Ay.t("log_in")})]})]}),(0,n.jsx)("div",{className:l()("lv_chosenPage-tt-form",ne&&"lv_chosenPage-tt-form-disabled"),children:(0,n.jsxs)(L.A,{autoComplete:"off",layout:"vertical",disabled:ne,children:[(0,n.jsx)(ms,{label:c.Ay.t("caption"),className:"lv_chosenPage-tt-form-textArea",children:(0,n.jsx)(gs,{placeholder:c.Ay.t("describe_post"),maxLength:{length:2200,errorOnly:!0},showWordLimit:!0,autoSize:!1,onChange:e=>{const t=e.slice(0,2200);O(t)},value:R,error:D})}),(0,n.jsx)(ms,{label:c.Ay.t("tiktok_video_privacy"),className:"lv_chosenPage-tt-form-selectorItem",children:(0,n.jsx)(N.A,{style:{height:28},dropdownMenuStyle:{border:"1px solid rgba(255, 255, 255, 0.06)",zIndex:10001},onChange:M,value:U,className:"lv_chosenPage-tt-form-selectorContainer",renderFormat:(e,t)=>(0,n.jsx)(n.Fragment,{children:t}),error:B,triggerProps:{style:{zIndex:10001,marginTop:"10px"},containerScrollToClose:!0},children:null==(o=d[u.c.TikTok])?void 0:o.map((({key:e,title:t,content:o,disabled:a})=>(0,n.jsx)(vs,{value:t,disabled:a,children:(0,n.jsx)(x.A,{disabled:!a,content:c.Ay.t("web_posttt_text_content_videos"),style:{zIndex:bs},children:(0,n.jsxs)("div",{className:l()("lv_chosenPage-tt-form-selector",{disabled:a}),children:[(0,n.jsx)("div",{className:l()("lv_chosenPage-tt-form-selector-title",{disabled:a}),children:t}),(0,n.jsx)("div",{className:l()("lv_chosenPage-tt-form-selector-content",{disabled:a}),children:o})]})})},e)))})}),(0,n.jsx)("div",{className:"lv_chosenPage-tt-form-privacy-tip",children:c.Ay.t("web_cover_text_sure_privacy",{},"Make sure your privacy settings here are consistent with that on your TikTok app.")}),(0,n.jsx)(ms,{label:c.Ay.t("allow_users_to"),children:(0,n.jsx)(fs,{className:"lv_chosenPage-tt-form-checkBox",options:s[u.c.TikTok],onChange:V,value:W})}),(0,n.jsxs)("div",{className:"lv_chosenPage-tt-form-disclose-switch",children:[(0,n.jsx)("div",{className:"label",children:c.Ay.t("web_posttt_text_disclosed_video_content",{},"Disclose video content")}),(0,n.jsx)(te.A,{checked:q,onChange:e=>{Y(e),e||(J(!1),ie(!1))},disabled:ne})]}),q&&(K||$)&&(0,n.jsxs)("div",{className:"lv_chosenPage-tt-form-disclose-warning",children:[(0,n.jsx)(r.zaj,{size:16}),(0,n.jsx)("div",{className:"text",children:q?K&&!$?c.Ay.t("web_posttt_text_video_labeled",{},'Your video will be labeled "Promotional content". This cannot be changed once the post is live.'):!K&&$?c.Ay.t("web_posttt_text_labeled_paid_partnership",{},'Your video will be labeled "Paid partnership" and cannot be set to private. This cannot be changed once the post is live.'):K&&$?c.Ay.t("web_posttt_text_cannot_set_private",{},'Your video will be labeled "Paid partnership" and cannot be set to private. This cannot be changed once the post is live.'):"":""})]}),(0,n.jsx)("div",{className:"lv_chosenPage-tt-form-disclose-introduction",children:c.Ay.t("web_posttt_text_legal_copy2",{},"Turn on to disclose that this video promotes goods or services in exchange for something of value. Your video could promote yourself, a third party, or both.")}),q&&(0,n.jsxs)("div",{className:"lv_chosenPage-tt-form-disclose-list",children:[(0,n.jsxs)("div",{className:"row",children:[(0,n.jsx)("div",{className:"brand",children:c.Ay.t("web_posttt_text_your_brand",{},"Your brand")}),(0,n.jsx)(F.A,{size:"small",checked:K,onChange:e=>J(e),disabled:ne})]}),(0,n.jsx)("div",{className:"content-introduction",children:c.Ay.t("web_posttt_text__promoting_yourself")}),(0,n.jsxs)("div",{className:"row",children:[(0,n.jsx)("div",{className:l()("brand",{disabled:Z}),children:c.Ay.t("web_posttt_text_branded_content",{},"Branded content")}),(0,n.jsx)(x.A,{disabled:!Z,content:c.Ay.t("web_posttt_text_legal_copy3"),style:{zIndex:bs},children:(0,n.jsx)(F.A,{size:"small",disabled:Z||ne,checked:$,onChange:ie})})]}),(0,n.jsx)("div",{className:l()("content-introduction",{disabled:Z}),children:c.Ay.t("web_posttt_text_paid_partnership")})]})]})}),$&&(0,n.jsx)("div",{className:"privacy_policy",children:c.Ay.t("web_posttt_text_by_posting",{"text-href0":e=>(0,n.jsx)("a",{target:"__blank",href:"https://www.tiktok.com/legal/bc-policy",className:"a-target-style",children:e}),"text-href1":e=>(0,n.jsx)("span",{onClick:se,className:"a-target-style",children:e})},"By posting, you agree to our <text-href0>Branded Content Policy</text-href0> and <text-href1>Music Usage Confirmation</text-href1>")}),K&&!$&&(0,n.jsx)("div",{className:"privacy_policy",children:c.Ay.t("web_posttt_text_agree_music_confirmation",{"text-href0":e=>(0,n.jsx)("span",{onClick:se,className:"a-target-style",children:e})},"By posting, you agree to our <text-href1>Music Usage Confirmation</text-href1>")})]}),(0,n.jsxs)("div",{className:"lv_chosenPage-tt-form-upload",children:[(0,n.jsx)("div",{style:{display:oe?"flex":"none",justifyContent:"space-between"},children:(0,n.jsxs)("div",{className:"lv_chosenPage-tt-form-upload-uploadProgress",style:{width:"100%"},children:[(0,n.jsx)("div",{className:"lv_chosenPage-tt-form-upload-uploadProgress-uploadContent",children:`${c.Ay.t("uploading_x")} ${a}%`}),(0,n.jsx)(z.A,{percent:a,className:"lv_chosenPage-tt-form-upload-uploadProgress-line",showText:!1,trailColor:"#008695",color:"#00B6C2"})]})}),(0,n.jsx)(x.A,{disabled:!re||!H,content:H?c.Ay.t("web_posttemplate_toast_exporting_video"):c.Ay.t("web_posttt_text_legal_copy4",{},"Select disclosed content type or turn off the toggle"),style:{zIndex:bs},children:(0,n.jsx)(k.A,{style:{display:oe?"none":"block"},disabled:re||H,htmlType:"submit",type:"primary",long:!0,onClick:()=>{var e,t,o,a,n,r;const i={};if(s[u.c.TikTok].forEach((({serviceKey:e},t)=>{i[e]=!(null!=W&&W.includes((t+1).toString()))})),ee.filter((e=>!e.checkItem&&(e.checkFailed(),!0))).length)return;const l={title:R,...i,[jt.PRIVACY_LEVEL]:(()=>{let e;return d[u.c.TikTok].forEach((t=>{t.title===U&&(e=t.key)})),e&&Ss[e]})(),brand_organic_toggle:K,brand_content_toggle:$};try{if(T){const r=new u.S;let i;switch(U){case"Only me":i="private";break;case"Friends":i="friends";break;case"EveryOne":i="public"}const s={share_caption:R,share_caption_words_cnt:R.length,share_view_range:i,allow_comment:null!=W&&W.includes("1")?1:0,allow_duet:null!=W&&W.includes("2")?1:0,allow_stitch:null!=W&&W.includes("3")?1:0,tool_type:(null==(e=(0,h.g)(v.asset))?void 0:e.tool_type)||(null==(t=I.context.reportExtra)?void 0:t.toolType),enter_from:(null==(o=I.context.reportExtra)?void 0:o.enterFrom)||"first_page",from_page:null==(a=I.context.reportExtra)?void 0:a.fromPage,current_page:null==(n=I.context.reportExtra)?void 0:n.currentPage,resolution:null==v?void 0:v.resolution,size:"Calculating..."===(null==v?void 0:v.fileSize)?void 0:Math.round(Number((null==v?void 0:v.fileSize)||"0")/1024/1024*100)/100,format:null==v?void 0:v.format,video_duration:Math.round(Number((null==v?void 0:v.duration)||"0")/1e3),platform:"tiktok"};r.report({...s,action:"upload"})}}catch{}A(!0),j({type:"UPLOAD_TO_PLATFORM",data:{fileInfo:{...v,format:ws[v.format]},formInfo:l,uid:null==(r=I.context)?void 0:r.uid}})},children:c.Ay.t("tiktok_web_upload")})})]})]})},ks=({resultComponent:e,headTitle:t,uploadResult:o,handleBack:a,openType:r})=>{var i,s,l,c;return(0,n.jsxs)("div",{className:"lv_resultPage",children:[(0,n.jsx)(hs,{headTitle:t,handleBack:a,visible:!(0,B.Ib)(r)||(0,B.vN)(r)}),(0,n.jsxs)("div",{className:"lv_resultPage-uploadStatus",children:[(0,n.jsx)("div",{className:"lv_resultPage-uploadStatus-icon",children:null==(i=e[o])?void 0:i.icon},"icon"),(0,n.jsx)("div",{className:"lv_resultPage-uploadStatus-content",children:null==(s=e[o])?void 0:s.content},"content"),(0,n.jsx)("div",{className:"lv_resultPage-uploadStatus-subContent",children:null==(l=e[o])?void 0:l.subContent},"sub-content"),null==(c=e[o])?void 0:c.button]})]})},As=({handleBack:e,headTitle:t,uploadResult:o,openType:s,platform:l,authUrl:d})=>{var _,m,v,f,y,w,b,x,A,S;const C=Xn(),[I,E]=(0,g.B)(C),T="smart_tool_page"===(null==(_=I.context.reportExtra)?void 0:_.currentPage),{shareService:P}=Zn(),[N,j]=(0,g.B)(P),[R,L]=(0,i.useState)(!1),{copy:O}=(0,pe.A)(),F=e=>{var t,o,a,n,r,i;(0,u.n)().report({action:"tryAgain"===e?u.E.try_again:u.E.retry_failed,adv_id:null==(a=null==(o=null==(t=null==I?void 0:I.context)?void 0:t.failedAdvList)?void 0:o.map((e=>null==e?void 0:e.advertiser_id)))?void 0:a.join(","),upload_adv_cnt:null==(r=null==(n=null==I?void 0:I.context)?void 0:n.failedAdvList)?void 0:r.length}),L(!0),E({type:"RETRY",isRetry:!0,data:{uid:null==(i=N.context)?void 0:i.uid}})},D=()=>{var e,t,o,a,n,r,i,s,c,d,p,_,m,g,v;const f=null==(t=null==(e=I.context)?void 0:e.userInfo)?void 0:t.creator_username,y={[u.c.TikTok]:{action:u.E.watch,extraLink:"https://www.tiktok.com/"+(f?`@${f}`:"")},[u.c.TTAM]:{action:u.E.check},[u.c.YouTube]:{action:u.E.watch}};null!=(o=I.context)&&o.platformLink?window.open(null==(a=I.context)?void 0:a.platformLink):l===u.c.TikTok&&null!=(n=y[l])&&n.extraLink&&window.open(y[l].extraLink),(0,u.n)().report({action:y[l].action});try{if(T){const e=new u.S,t={tool_type:(null==(r=I.context.reportExtra)?void 0:r.toolType)||(0,h.g)(null==(i=I.context.fileInfo)?void 0:i.asset).tool_type,enter_from:(null==(s=I.context.reportExtra)?void 0:s.enterFrom)||"first_page",from_page:null==(c=I.context.reportExtra)?void 0:c.fromPage,current_page:null==(d=I.context.reportExtra)?void 0:d.currentPage,resolution:null==(p=I.context.fileInfo)?void 0:p.resolution,size:"Calculating..."===(null==(_=I.context.fileInfo)?void 0:_.fileSize)?void 0:Math.round(Number(null==(m=I.context.fileInfo)?void 0:m.fileSize)/1024/1024*100)/100,format:null==(g=I.context.fileInfo)?void 0:g.format,video_duration:Math.round(Number(null==(v=I.context.fileInfo)?void 0:v.duration)/1e3)};e.report({...t,action:"watch"})}}catch{}},U=()=>{(0,u.n)().report({action:u.E.retry}),E("USER_UNBIND"),j({type:"OPEN_AUTH_WINDOW",data:{authUrl:d}})},M=()=>{var e;(0,u.n)().report({action:u.E.copy_link}),O(null==(e=I.context)?void 0:e.platformLink),a.A.success(c.Ay.t("web_shareYouTube_button_copy_successfully",{},"Copy success"))},B=(0,de.A)((()=>{var e,t,o,a,n,r,i,s,l,c;(0,u.n)().report({action:u.E.feedback}),Ji({});try{if(T){const d=new u.S,p={tool_type:(null==(e=I.context.reportExtra)?void 0:e.toolType)||(0,h.g)(null==(t=I.context.fileInfo)?void 0:t.asset).tool_type,enter_from:(null==(o=I.context.reportExtra)?void 0:o.enterFrom)||"first_page",from_page:null==(a=I.context.reportExtra)?void 0:a.fromPage,current_page:null==(n=I.context.reportExtra)?void 0:n.currentPage,resolution:null==(r=I.context.fileInfo)?void 0:r.resolution,size:"Calculating..."===(null==(i=I.context.fileInfo)?void 0:i.fileSize)?void 0:Math.round(Number(null==(s=I.context.fileInfo)?void 0:s.fileSize)/1024/1024*100)/100,format:null==(l=I.context.fileInfo)?void 0:l.format,video_duration:Math.round(Number(null==(c=I.context.fileInfo)?void 0:c.duration)/1e3)};d.report({...p,action:"feedback"})}}catch{}})),{youtubeFailAction:z,youtubeFailReason:G}=(0,i.useMemo)((()=>{var e;const t=null==(e=I.context)?void 0:e.fail_reason,o=[{pattern:/authenticatedUserAccountSuspended/,message:c.Ay.t("couldnot_share_popup_desc_yt_ban_account",{},"You YouTube account has been suspended.")},{pattern:/insufficientPermissions|ACCESS_TOKEN_SCOPE_INSUFFICIENT/,message:c.Ay.t("couldnot_share_popup_desc_yt_no_access",{},"To share CapCut videos to YouTube, click the \u201cRetry\u201d button below and check the box before \u201cManage your YouTube videos."),actions:(0,n.jsx)(k.A,{type:"primary",className:"lv_resultPage-channel",onClick:U,size:"large",children:c.Ay.t("couldnot_share_popup_desc_yt_no_access_button",{},"Retry")})},{pattern:/youtubeSignupRequired|authenticatedUserNotChannel/,message:c.Ay.t("couldnot_share_popup_desc_yt_no_channel",{},"Create a YouTube channel to share CapCut videos to YouTube"),actions:(0,n.jsx)(k.A,{type:"primary",className:"lv_resultPage-channel",onClick:()=>((0,u.n)().report({action:u.E.create_youtube_channel}),void window.open("https://www.youtube.com/create_channel")),size:"large",children:c.Ay.t("web_shareYouTube_button_create_channel")})},{pattern:/uploadLimitExceeded/,message:c.Ay.t("web_upload_improve_text_exceed_limit",{},"You have exceeded the post limit, please try again in 24 hours")}],a=t?o.find((e=>e.pattern.test(t))):void 0;return{youtubeFailAction:null==a?void 0:a.actions,youtubeFailReason:(null==a?void 0:a.message)??c.Ay.t("web_shareYouTube_toast_report_to_us",{"text-href":e=>(0,n.jsx)("a",{className:"a-target",onClick:B,children:e})})}}),[I,R,E,B]),W={[_s.ShareSuccess]:{content:c.Ay.t("video_uploaded_tiktok"),subContent:c.Ay.t("web_ttam_feedback_there",{"text-href":e=>(0,n.jsx)("a",{className:"a-target",onClick:B,children:e})}),icon:(0,n.jsx)(r.gyW,{size:100}),button:(0,n.jsxs)(k.A,{type:"primary",className:"lv_resultPage-watch",onClick:D,size:"large",children:[(0,n.jsx)("div",{className:"lv_resultPage-watch-platformIcon",children:(0,n.jsx)(r.ckT,{size:18})}),c.Ay.t("watch_on_tiktok")]})},[_s.UploadSuccess]:{content:c.Ay.t("uploaded_review_passed_tiktok"),subContent:c.Ay.t("web_ttam_feedback_there",{"text-href":e=>(0,n.jsx)("a",{className:"a-target",onClick:B,children:e})}),icon:(0,n.jsx)(r.gyW,{size:100}),button:(0,n.jsxs)(k.A,{type:"primary",className:"lv_resultPage-watch",onClick:D,size:"large",children:[(0,n.jsx)("div",{className:"lv_resultPage-watch-platformIcon",children:(0,n.jsx)(r.ckT,{size:18})}),c.Ay.t("watch_on_tiktok")]})},[_s.UploadAuditFailed]:{content:c.Ay.t("review_exception_tiktok"),subContent:c.Ay.t("web_ttam_feedback_there",{"text-href":e=>(0,n.jsx)("a",{className:"a-target",onClick:B,children:e})}),icon:(0,n.jsx)(r.pxA,{size:100}),button:(0,n.jsxs)(k.A,{type:"primary",className:"lv_resultPage-watch",onClick:D,size:"large",children:[(0,n.jsx)("div",{className:"lv_resultPage-watch-platformIcon",children:(0,n.jsx)(r.ckT,{size:18})}),c.Ay.t("check_on_tiktok")]})},[_s.UploadAuditing]:{content:c.Ay.t("uploaded_under_review_tiktok"),subContent:c.Ay.t("web_ttam_feedback_there",{"text-href":e=>(0,n.jsx)("a",{className:"a-target",onClick:B,children:e})}),icon:(0,n.jsx)(r.e7_,{size:100}),button:(0,n.jsxs)(k.A,{type:"primary",className:"lv_resultPage-watch",disabled:!0,size:"large",children:[(0,n.jsx)("div",{className:"lv_resultPage-watch-platformIcon",children:(0,n.jsx)(r.ckT,{size:18})}),c.Ay.t("watch_on_tiktok")]})},[_s.UploadFailed]:{content:c.Ay.t("failed_upload_try_again"),subContent:c.Ay.t("web_ttam_feedback_there",{"text-href":e=>(0,n.jsx)("a",{className:"a-target",onClick:B,children:e})}),icon:(0,n.jsx)(r.pxA,{size:100}),button:(0,n.jsx)(k.A,{type:"primary",className:"lv_resultPage-watch",disabled:!(null!=(m=I.context)&&m.shareId)||R,onClick:()=>F("tryAgain"),size:"large",children:c.Ay.t("try_again_web")})},[_s.PublishTimeOut]:{content:c.Ay.t("web_cover_text_time_out",{},"Publishing timed out"),subContent:c.Ay.t("web_cover_text_publish_fail",{},"CapCut is unable to get your publish status because it is taking too long. You can check on TikTok to see if the video was posted."),icon:(0,n.jsx)(r.pxA,{size:100}),button:(0,n.jsx)(k.A,{type:"primary",className:"lv_resultPage-watch",disabled:!(null!=(v=I.context)&&v.shareId),onClick:D,size:"large",children:c.Ay.t("web_cover_button_tt",{},"Open TikTok")})},[_s.PrivacyNotMatch]:{content:c.Ay.t("failed_upload_try_again"),subContent:c.Ay.t("web_cover_text_not_match",{},"Your CapCut and Tiktok privacy settings didn\u2019t match. Please make sure they are consistent before publishing."),icon:(0,n.jsx)(r.pxA,{size:100}),button:(0,n.jsx)(k.A,{type:"primary",className:"lv_resultPage-watch",disabled:!(null!=(f=I.context)&&f.shareId),onClick:D,size:"large",children:c.Ay.t("web_cover_text_view_tt_setting",{},"View TikTok Settings")})}},V={[_s.ShareSuccess]:{content:c.Ay.t("video_uploaded_tiktok"),subContent:c.Ay.t("web_ttam_feedback_there",{"text-href":e=>(0,n.jsx)("a",{className:"a-target",onClick:B,children:e})}),icon:(0,n.jsx)(r.gyW,{size:100}),button:(0,n.jsx)(k.A,{type:"primary",className:"lv_resultPage-watch",onClick:D,size:"large",children:c.Ay.t("web_watch_on_tt_ads_manager")})},[_s.UploadSuccess]:{content:c.Ay.t("uploaded_review_passed_tiktok"),subContent:c.Ay.t("web_ttam_feedback_there",{"text-href":e=>(0,n.jsx)("a",{className:"a-target",onClick:B,children:e})}),icon:(0,n.jsx)(r.gyW,{size:100}),button:(0,n.jsx)(k.A,{type:"primary",className:"lv_resultPage-watch",onClick:D,size:"large",children:c.Ay.t("web_watch_on_tt_ads_manager")})},[_s.UploadFailed]:{content:null!=I&&I.context.failedAdvList?c.Ay.t("web_ttam_another_trial3",{placeholder0:null==I?void 0:I.context.failedAdvList.map((e=>`\u300c${e.advertiser_name}\u300d`)).join(",")}):c.Ay.t("web_could_not_to_tt_ads_manager"),subContent:c.Ay.t("web_ttam_feedback_there",{"text-href":e=>(0,n.jsx)("a",{className:"a-target",onClick:B,children:e})}),icon:(0,n.jsx)(r.pxA,{size:100}),button:(0,n.jsx)(k.A,{type:"primary",className:"lv_resultPage-watch",onClick:()=>{var e,t;return F(null!=(t=null==(e=null==I?void 0:I.context)?void 0:e.failedAdvList)&&t.length?void 0:"tryAgain")},size:"large",children:null!=(w=null==(y=null==I?void 0:I.context)?void 0:y.failedAdvList)&&w.length?c.Ay.t((null==(x=null==(b=null==I?void 0:I.context)?void 0:b.failedAdvList)?void 0:x.length)<2?"web_ttam_retry_failure":"web_ttam_retry_failures",{placeholder:null==(S=null==(A=null==I?void 0:I.context)?void 0:A.failedAdvList)?void 0:S.length}):c.Ay.t("try_again_web")})}},H={[_s.ShareSuccess]:{content:c.Ay.t("web_shareYouTube_toast_post_seccessfully"),subContent:c.Ay.t("web_shareYouTube_toast_report_to_us",{"text-href":e=>(0,n.jsx)("a",{className:"a-target",onClick:B,children:e})}),icon:(0,n.jsx)(r.gyW,{size:100}),button:(0,n.jsxs)("div",{children:[(0,n.jsxs)(k.A,{type:"primary",className:"lv_resultPage-watch",onClick:D,size:"large",long:!0,children:[(0,n.jsx)("div",{className:"lv_resultPage-watch-platformIcon",children:(0,n.jsx)(r.oTk,{size:18,name:"icon-logo-youtube2"})}),c.Ay.t("web_shareYouTube_button_open",{},"Watch on YouTube")]}),(0,n.jsxs)(k.A,{className:"lv_resultPage-copy",onClick:M,size:"large",long:!0,children:[(0,n.jsx)("div",{className:"lv_resultPage-watch-platformIcon",children:(0,n.jsx)(r.Zac,{size:18,name:"icon-logo-youtube2"})}),(0,n.jsx)("p",{children:c.Ay.t("web_shareYouTube_button_copy",{},"Copy YouTube link")})]})]})},[_s.UploadSuccess]:{content:c.Ay.t("web_shareYouTube_toast_post_seccessfully"),subContent:c.Ay.t("web_shareYouTube_toast_report_to_us",{"text-href":e=>(0,n.jsx)("a",{className:"a-target",onClick:B,children:e})}),icon:(0,n.jsx)(r.gyW,{size:100}),button:(0,n.jsxs)("div",{children:[(0,n.jsxs)(k.A,{type:"primary",className:"lv_resultPage-watch",onClick:D,size:"large",children:[(0,n.jsx)("div",{className:"lv_resultPage-watch-platformIcon",children:(0,n.jsx)(r.oTk,{size:18,name:"icon-logo-youtube2"})}),c.Ay.t("web_shareYouTube_button_open",{},"Watch on YouTube")]}),(0,n.jsxs)(k.A,{className:"lv_resultPage-copy",onClick:M,size:"large",children:[(0,n.jsx)("div",{className:"lv_resultPage-watch-platformIcon",children:(0,n.jsx)(r.Zac,{size:18,name:"icon-logo-youtube2"})}),(0,n.jsx)("p",{children:c.Ay.t("web_shareYouTube_button_copy",{},"Copy YouTube link")})]})]})},[_s.UploadFailed]:{content:c.Ay.t("web_shareYouTube_toast_post_fail"),subContent:G,icon:(0,n.jsx)(r.pxA,{size:100}),button:z}},q={[p.C.LV_SHARE_TT]:W,[p.C.LV_SHARE_TTAM]:V,[p.C.LV_SHARE_YT]:H};return(0,n.jsx)(ks,{openType:s,resultComponent:q[C.id],headTitle:t,uploadResult:o,handleBack:e})};var Ss=(e=>(e.PUBLIC_TO_EVERYONE="Public",e.MUTUAL_FOLLOW_FRIENDS="Friends",e.SELF_ONLY="Private",e.FOLLOWER_OF_CREATOR="Followers",e.Public="PUBLIC_TO_EVERYONE",e.Friends="MUTUAL_FOLLOW_FRIENDS",e.Private="SELF_ONLY",e.Followers="FOLLOWER_OF_CREATOR",e))(Ss||{});const Cs=({openType:e,fileInfo:t,platformsList:o,popUpContainer:a})=>{const{shareService:r}=Zn(),[i]=(0,g.B)(r),[s,l]=(0,g.B)(i.children.LvShareTt),d=(0,m.d)(i.children.LvShareTt,(e=>e.context.userInfo)),_={[u.c.TikTok]:[{serviceDisableKey:p.T.COMMENT_DISABLED,serviceKey:Nt.DISABLE_COMMENT,label:c.Ay.t("tiktok_comment"),value:"1",disabled:!1},{serviceDisableKey:p.T.DUET_DISABLED,serviceKey:Nt.DISABLE_DUET,label:c.Ay.t("duet"),value:"2",disabled:!1},{serviceDisableKey:p.T.STITCH_DISABLED,serviceKey:Nt.DISABLE_STITCH,label:c.Ay.t("stitch"),value:"3",disabled:!1}]},h={[u.c.TikTok]:{Public:{title:c.Ay.t("public"),key:"Public",content:"",disabled:!1},Friends:{title:c.Ay.t("friends"),key:"Friends",content:c.Ay.t("mutual_follow"),disabled:!1},Followers:{title:c.Ay.t("follower"),key:"Followers",content:c.Ay.t("visible_to_followers"),disabled:!1},Private:{title:c.Ay.t("private"),key:"Private",content:"",disabled:!1}}},v=()=>{const e={TikTok:{}};return Object.keys(_).forEach((e=>{null!=d&&d[e]&&_[e].forEach(((t,o)=>{_[e][o].disabled=d[e][t.serviceDisableKey]}))})),(()=>{var t,o,a;if(d){const t=null==(a=null==d?void 0:d[p.T.PRIVACY_LEVEL_OPTIONS])?void 0:a.map((e=>Ss[e]));e.TikTok=t.map((e=>{var t;return null==(t=null==h?void 0:h[u.c.TikTok])?void 0:t[e]})).filter((e=>!!e))}else{const a=null==(o=null==(t=p.d.TikTok)?void 0:t[p.T.PRIVACY_LEVEL_OPTIONS])?void 0:o.map((e=>Ss[e]));e.TikTok=a.map((e=>{var t;return null==(t=null==h?void 0:h[u.c.TikTok])?void 0:t[e]})).filter((e=>!!e))}})(),{checkBoxOption:_,selectOption:e}},f=[{state:"show.hasBind.shareSuccess",uploadResult:_s.ShareSuccess,fn:()=>l("BACK_CHOSEN_STATE")},{state:"show.hasBind.uploadFailed",uploadResult:_s.UploadFailed,fn:()=>l("BACK_CHOSEN_STATE")},{state:"show.hasBind.uploading.auditing",uploadResult:_s.UploadAuditing,fn:()=>l("BACK_CHOSEN_STATE")},{state:"show.hasBind.uploading.uploadSuccess",uploadResult:_s.UploadSuccess,fn:()=>l("BACK_CHOSEN_STATE")},{state:"show.hasBind.uploadAuditFailed",uploadResult:_s.UploadAuditFailed,fn:()=>l("BACK_CHOSEN_STATE")},{state:"show.hasBind.publishTimeOut",uploadResult:_s.PublishTimeOut,fn:()=>l("BACK_CHOSEN_STATE")},{state:"show.hasBind.privacyNotMatch",uploadResult:_s.PrivacyNotMatch,fn:()=>l("BACK_CHOSEN_STATE")}];return(0,n.jsxs)("div",{className:"lv_chosenPage-container-tt",children:[["show.hasBind.notUpload","show.hasBind.uploading","show.hasNotBind"].some(s.matches)&&(0,n.jsx)(xs,{openType:e,fileInfo:t,uploadProgress:s.context.uploadProgress,isDisable:!s.matches("show.hasBind.notUpload"),checkBoxOption:v().checkBoxOption,selectOption:v().selectOption,userInfo:d,platformsList:o,popUpContainer:a}),["show.hasBind.shareSuccess","show.hasBind.uploadFailed","show.hasBind.uploading.auditing","show.hasBind.uploading.uploadSuccess","show.hasBind.uploadAuditFailed"].some(null==s?void 0:s.matches)&&(()=>{let t;return f.forEach((o=>{null!=s&&s.matches(o.state)&&(t=(0,n.jsx)(As,{platform:u.c.TikTok,headTitle:c.Ay.t("upload_tiktok"),openType:e,uploadResult:o.uploadResult,handleBack:o.fn}))})),t||(0,n.jsx)(n.Fragment,{})})()]})},Is=["#2A4D8F","#00ADB5","#6A65D8","#6195C5","#AB8997","#52686A"],Es=({userName:e,userId:t="0"})=>{const o=e[0],a=Math.floor(Number(t[(null==t?void 0:t.length)-1])*Is.length/10);return(0,n.jsx)("div",{className:"defaultAvatar",style:{backgroundColor:Is[a]},children:o})},{Item:Ts}=L.A,{Option:Ps}=N.A,Ns=({onClick:e,itemContent:t,paratext:o,icon:a,headIcon:r})=>(0,n.jsx)("div",{className:"userListItem",children:(0,n.jsxs)("div",{className:"userListItem-container",children:[r&&(0,n.jsx)("div",{className:"userListItem-container-headIcon",onClick:()=>r.onClick&&r.onClick(),children:r.display}),(0,n.jsxs)("div",{className:"userListItem-container-context",onClick:e,children:[(0,n.jsx)("div",{className:"userListItem-container-content",children:t}),o&&(0,n.jsx)("div",{className:"userListItem-container-paratext",children:o})]}),a&&(0,n.jsx)("div",{className:"userListItem-container-unbind",onClick:a.onClick,children:a.display})]})}),js=e=>{var t;const{uploadProgress:o,openType:s,platformsList:d,fileInfo:p}=e,[_,v]=(0,i.useState)(!1),[f,y]=(0,i.useState)([]),[w,b]=(0,i.useState)(!1),[A,S]=(0,i.useState)(!1),[C,I]=(0,i.useState)(!1),{shareService:E,isNewShareExport:T,selectItemID:P}=Zn(),[j,R]=(0,g.B)(E),[O,U]=(0,g.B)(j.children.LvShareTtam),M="smart_tool_page"===(null==(t=O.context.reportExtra)?void 0:t.currentPage),B=(0,m.d)(j.children.LvShareTtam,(e=>e.context.preFormInfo)),G=(0,m.d)(j.children.LvShareTtam,(e=>e.context.advList)),W=(0,m.d)(j.children.LvShareTtam,(e=>e.context.switchAccount)),V=(0,m.d)(j.children.LvShareTtam,(e=>e.context.userInfo)),H=(0,m.d)(E,(e=>e.context.errorCode)),q=O.matches("show.hasBind.notUpload.loading"),{exportState:Y}=(0,i.useContext)(bv),K=e=>{(0,u.n)().report({action:e,panel_page:u.P.share_ttam_detail,core_user_id:null==W?void 0:W.tt4b_uid,adv_id:f.map((e=>e.advertiser_id)).join(","),upload_adv_cnt:f.length.toString()})};(0,i.useEffect)((()=>{var e,t;if(null!=G&&G.advertisers){const o=null==(e=null==G?void 0:G.advertisers)?void 0:e.filter((e=>{var t;return null==(t=null==B?void 0:B.adv_list)?void 0:t.includes(e.advertiser_id)})).map((e=>e.advertiser_id)),a=null==(t=null==G?void 0:G.advertisers)?void 0:t.map((e=>Object.assign(e,{checked:null==o||!o.length||o.includes(e.advertiser_id)})));y(a),(0,u.n)().setParam({adv_id:a.map((e=>e.advertiser_id)).join(","),upload_adv_cnt:a.length.toString()})}else y([])}),[B,G]),(0,i.useEffect)((()=>{f.filter((e=>!!e.checked)).length?b(!0):b(!1)}),[f]),(0,i.useEffect)((()=>{_&&v(!1)}),[W]);const J=O.matches("show.hasBind.uploading"),$=e=>{e&&(K(u.E.sign_out),U({type:"USER_UNBIND",tt4bUid:e}))},Q=()=>{var e,t;if((null==(t=null==(e=O.context)?void 0:e.userInfo)?void 0:t.length)<9){const e=d.filter((e=>e.platformName===u.c.TTAM));K(W?u.E.add_account:u.E.sign_in),R({type:"TTAM_INSIDE_CHOOSE_PLATFORM",data:{platform:u.c.TTAM,authUrl:e[0].authUrl}})}else S(!0)},Z=["show.hasBind.notUpload.loading","show.hasBind.uploading"].some(O.matches)||_||O.matches("show.hasNotBind");return(0,n.jsxs)("div",{children:[(0,n.jsx)($n,{visible:A,title:c.Ay.t("web_ttam_another_trial1"),content:c.Ay.t("web_ttam_another_trial2"),confirmContext:c.Ay.t("web_got_it"),onOk:()=>S(!1)}),(0,n.jsx)($n,{visible:C,title:c.Ay.t("web_confirm_cancel_upload_titie"),content:c.Ay.t("web_ttam_ad_account_cancel"),footer:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k.A,{onClick:()=>{K(u.E.upload_cancel_continue),I(!1)},children:c.Ay.t("web_ttam_continue _upload1")}),(0,n.jsx)(k.A,{onClick:()=>{K(u.E.upload_cancel_confirm),U({type:"CANCEL_UPLOAD",callback:()=>{v(!1),a.A.warning(c.Ay.t("web_upload_canceled"))},failedCallback:()=>{a.A.error(c.Ay.t("web_ttam_retry_failure4"))}}),I(!1)},children:c.Ay.t("web_ttam_cancel _upload1")})]})}),(0,n.jsx)(hs,{headTitle:c.Ay.t("web_upload_to_tt"),handleBack:()=>{U("BACK_CHOOSE_STATE")},visible:!P}),(0,n.jsxs)("div",{className:"lv_chosenPage",children:[(0,n.jsx)("div",{style:{marginBottom:"20px"},children:(0,n.jsx)(N.A,{placeholder:"Please select",className:"lv_chosenPage-form-userInfo",defaultValue:"userInfo",disabled:J,getPopupContainer:e=>(e.classList.add("lv_chosenPage-userDropdown"),e),onClick:()=>{},dropdownRender:()=>{var e;return(0,n.jsxs)(n.Fragment,{children:[(null==(e=null==V?void 0:V.filter((e=>e.tt4b_uid!==(null==W?void 0:W.tt4b_uid))))?void 0:e.length)>0&&(0,n.jsxs)("div",{className:"switchAccountList",children:[(0,n.jsx)("div",{className:"switchAccountList-title",children:c.Ay.t("web_switch_account")}),V.filter((e=>e.display_name!==(null==W?void 0:W.display_name))).map(((e,t)=>(0,n.jsx)(Ns,{itemContent:e.display_name,paratext:e.email,onClick:()=>{K(u.E.switch_account),U({type:"SWITCH_ACCOUNT",switchName:e.display_name})},icon:{display:(0,n.jsx)(x.A,{className:"lv_chosenPage-tooltip",content:c.Ay.t("web_sign_out1"),children:(0,n.jsx)(r.MpL,{size:16})}),onClick:()=>{$(e.tt4b_uid)}}},`userListItem-${t}`)))]}),(0,n.jsxs)("div",{className:"operateUserInfo",children:[(0,n.jsx)(Ns,{itemContent:W?c.Ay.t("add_account"):c.Ay.t("web_sign_in"),onClick:Q,headIcon:{display:(0,n.jsx)(r.gsD,{size:16})}}),W&&(0,n.jsx)(Ns,{itemContent:c.Ay.t("web_sign_out1"),onClick:()=>$(null==W?void 0:W.tt4b_uid),headIcon:{display:(0,n.jsx)(r.MpL,{size:16})}})]})]})},dropdownMenuStyle:{border:"1px solid rgba(255, 255, 255, 0.06)"},children:(0,n.jsx)(Ps,{value:"userInfo",children:(0,n.jsxs)("div",{className:"lv_chosenPage-form-userInfo-container",children:[(0,n.jsx)("div",{className:"lv_chosenPage-form-userInfo-container-headImg",children:W&&null!=W&&W.display_name?(0,n.jsx)(Es,{userName:null==W?void 0:W.display_name,userId:null==W?void 0:W.tt4b_uid}):(0,n.jsx)(r.W2v,{size:24})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"lv_chosenPage-form-userInfo-container-name",children:W?null==W?void 0:W.display_name:(null==V?void 0:V.length)>0?c.Ay.t("web_ttam_switch_or_sign"):c.Ay.t("web_sign_in")}),(0,n.jsx)("div",{className:"lv_chosenPage-form-userInfo-container-email",children:W?null==W?void 0:W.email:""})]})]})},"userInfo")})}),(0,n.jsx)("div",{className:l()("lv_chosenPage-form",Z&&"lv_chosenPage-form-disabled"),children:(0,n.jsxs)(L.A,{autoComplete:"off",layout:"vertical",disabled:Z,children:[(0,n.jsx)(Ts,{label:(null==f?void 0:f.length)>1?c.Ay.t("web_adv_ids"):c.Ay.t("web_adv_id"),className:l()("formItem-advList",{"detail-page-height":s},{"new-export-height":T}),children:(0,n.jsx)("div",{className:"advList",children:q?(0,n.jsxs)("div",{className:"advList-load",children:[(0,n.jsx)(D.A,{webp:!0,size:30}),(0,n.jsx)("div",{className:"advList-load-content",children:c.Ay.t("loading_web_capcut")})]}):f.length?f.map((e=>(0,n.jsx)(F.A,{value:e.advertiser_id,checked:e.checked,disabled:Z,onClick:()=>{!Z&&(e=>{const t=f.map((t=>t.advertiser_id===e.advertiser_id?Object.assign(t,{checked:!t.checked}):t));(0,u.n)().setParam({adv_id:t.map((e=>e.advertiser_id)).join(","),upload_adv_cnt:t.length.toString()}),y(t)})(e)},children:(0,n.jsxs)("div",{className:"advItem",children:[(0,n.jsx)("div",{className:"advItem-name",children:e.advertiser_name}),(0,n.jsxs)("div",{className:"advItem-id",children:["ID:",e.advertiser_id]})]})},`adv_${e.advertiser_id}`))):(0,n.jsx)(_t.A,{className:"noAdvItem",content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"context",children:H===u.g.GET_ADVERTISERS_FAILED?c.Ay.t("web_ttam_retry_failure3"):c.Ay.t("web_no_advertiser_account",{"text-href":e=>(0,n.jsx)("a",{className:"noAdvItem-a-target",href:"https://ads.tiktok.com/i18n/register",target:"_blank",rel:"noreferrer",onClick:()=>{K(u.E.create_ttam_account)},children:e})})}),(0,n.jsx)(k.A,{type:"secondary",size:"small",onClick:()=>{K(u.E.refresh),U("REFRESH_ADV_LIST")},children:c.Ay.t("web_ttam_refresh")})]})})})}),(0,n.jsx)(Ts,{children:(0,n.jsxs)("div",{className:"lv_chosenPage-form-upload",children:[(0,n.jsxs)("div",{style:{display:J?"flex":"none",justifyContent:"space-between"},children:[(0,n.jsx)("div",{className:"lv_chosenPage-form-upload-cancel",onClick:()=>{K(u.E.upload_cancel),I(!0)},children:(0,n.jsx)(r.zER,{size:16})}),(0,n.jsxs)("div",{className:"lv_chosenPage-form-upload-uploadProgress",style:{width:"100%"},children:[(0,n.jsx)("div",{className:"lv_chosenPage-form-upload-uploadProgress-uploadContent",children:`${c.Ay.t("uploading_x")} ${o}%`}),(0,n.jsx)(z.A,{percent:o,className:"lv_chosenPage-form-upload-uploadProgress-line",showText:!1,trailColor:"#008695",color:"#00B6C2"})]})]}),(0,n.jsx)(x.A,{disabled:!Y,content:Y?c.Ay.t("web_posttemplate_toast_exporting_video"):c.Ay.t("web_posttt_text_legal_copy4",{},"Select disclosed content type or turn off the toggle"),style:{zIndex:1e3},children:(0,n.jsx)(k.A,{className:"lv_chosenPage-form-upload-uploadButton",size:"large",style:{display:J?"none":"block"},disabled:Z||!w||Y,htmlType:"submit",type:"primary",long:!0,onClick:()=>{var e,t,o,a,n;try{if(M){const n=new u.S,r={core_user_id:null==W?void 0:W.tt4b_uid,adv_id:f.map((e=>e.advertiser_id)).join(","),upload_adv_cnt:f.length.toString(),tool_type:(null==(e=j.context.reportExtra)?void 0:e.toolType)||(0,h.g)(null==p?void 0:p.asset).tool_type,enter_from:(null==(t=j.context.reportExtra)?void 0:t.enterFrom)||"first_page",from_page:null==(o=j.context.reportExtra)?void 0:o.fromPage,current_page:null==(a=j.context.reportExtra)?void 0:a.currentPage,resolution:p.resolution,size:"Calculating..."===p.fileSize?void 0:Math.round(Number(p.fileSize)/1024/1024*100)/100,format:p.format,video_duration:Math.round(Number(p.duration)/1e3),platform:"ttam"};n.report({...r,action:"upload"})}}catch{}v(!0),U({type:"UPLOAD_TO_PLATFORM",data:{advertisers:f.filter((e=>e.checked)).map((e=>({advertiser_id:e.advertiser_id,advertiser_name:e.advertiser_name}))),uid:null==(n=j.context)?void 0:n.uid}})},children:c.Ay.t("tiktok_web_upload")})})]})})]})})]})]})},Rs=({openType:e,fileInfo:t,platformsList:o})=>{const{shareService:a}=Zn(),[r]=(0,g.B)(a),[i,s]=(0,g.B)(r.children.LvShareTtam),l=[{state:"show.hasBind.shareSuccess",uploadResult:_s.ShareSuccess,fn:()=>s("BACK_CHOSEN_STATE")},{state:"show.hasBind.uploadFailed",uploadResult:_s.UploadFailed,fn:()=>s("BACK_CHOSEN_STATE")},{state:"show.hasBind.uploading.auditing",uploadResult:_s.UploadAuditing,fn:()=>s("BACK_CHOSEN_STATE")},{state:"show.hasBind.uploading.uploadSuccess",uploadResult:_s.UploadSuccess,fn:()=>s("BACK_CHOSEN_STATE")},{state:"show.hasBind.uploadAuditFailed",uploadResult:_s.UploadAuditFailed,fn:()=>s("BACK_CHOSEN_STATE")}];return(0,n.jsxs)("div",{className:"lv_chosenPage-container-ttam",children:[["show.hasBind.notUpload","show.hasBind.uploading","show.hasNotBind"].some(i.matches)&&(0,n.jsx)(js,{openType:e,fileInfo:t,uploadProgress:i.context.uploadProgress,isDisable:!i.matches("show.hasBind.notUpload"),platformsList:o}),["show.hasBind.shareSuccess","show.hasBind.uploadFailed","show.hasBind.uploading.auditing","show.hasBind.uploading.uploadSuccess","show.hasBind.uploadAuditFailed"].some(null==i?void 0:i.matches)&&(()=>{let t;return l.forEach((o=>{null!=i&&i.matches(o.state)&&(t=(0,n.jsx)(As,{platform:u.c.TTAM,headTitle:c.Ay.t("web_upload_to_tt"),openType:e,uploadResult:o.uploadResult,handleBack:o.fn}))})),t||(0,n.jsx)(n.Fragment,{})})()]})},Ls="_form_1i86n_1",Os="_form-scrollview_1i86n_17",Fs="_form-content_1i86n_27",Ds="_youtube-channel_1i86n_32",Us="_form-overrides_1i86n_43",Ms="_caveats_1573m_1",Bs="_warn-alert_1573m_10",zs="_upload-button_1573m_23",Gs=e=>(0,n.jsx)(O.A.TextArea,{...e,className:"lv_share-custom-textarea"}),Ws="_popper_1cwi2_1",Vs="_option-container_1cwi2_16",Hs="_option-title_1cwi2_21",qs="_option-content_1cwi2_28";var Ys=(e=>(e.public="public",e.unlisted="unlisted",e.private="private",e))(Ys||{});const Ks=[{title:c.Ay.t("web_shareYouTube_button_public",{},"Public"),key:"public",content:c.Ay.t("web_shareYouTube_text_everyone_can_access",{},"Everyone can watch your video")},{title:c.Ay.t("web_shareYouTube_button_private",{},"Private"),key:"private",content:c.Ay.t("web_shareYouTube_text_people_you_choose",{},"Only you and people you choose can watch your video")},{title:c.Ay.t("web_shareYouTube_button_unlisted",{},"Unlisted"),key:"unlisted",content:c.Ay.t("web_shareYouTube_text_everyone_with_link",{},"Anyone with the video link can watch your video")}],Js=({onChange:e,value:t,disabled:o})=>((0,_e.A)((()=>{e("public")})),(0,n.jsx)(N.A,{disabled:o,dropdownMenuClassName:Ws,onChange:e,value:t,renderFormat:(e,t)=>{const o=Ks.find((e=>e.key===t));return o?`${o.title}: ${o.content}`:void 0},triggerProps:{updateOnScroll:!0,style:{zIndex:1001}},children:Ks.map((e=>(0,n.jsx)(N.A.Option,{value:e.key,children:(0,n.jsxs)("div",{className:Vs,children:[(0,n.jsx)("div",{className:Hs,children:e.title}),(0,n.jsx)("div",{className:qs,children:e.content})]})},e.key)))})),$s=(0,i.createContext)({fileInfo:{},extraData:{},openType:p.O.default,spaceInfo:{},platformItem:void 0}),Qs=()=>(0,i.useContext)($s),Zs=()=>{const{shareService:e}=Zn(),[t,o]=(0,g.B)(e),a=t.children.LvShareYt,[n,r]=(0,g.B)(a),i=(0,m.d)(a,(e=>e.context.userInfo)),s=(0,m.d)(a,(e=>e.context.uploadProgress)),l=n.matches("show.hasBind.uploading");return{userInfo:i,shareServiceState:t,shareServiceSend:o,youtubeState:n,youtubeSend:r,isUploading:l,uploadProgress:s,shareType:(0,m.d)(a,(e=>e.context.shareType)),businessType:t.context.businessType}},Xs="_login_z6x7p_1",el="_selector_z6x7p_20",tl="_popper_z6x7p_24",ol="_signout_z6x7p_24",al="_target-option_z6x7p_30",nl="_target-option-text_z6x7p_36",rl="_target-option-avatar_z6x7p_42",il=({picture:e,name:t,avatarStyle:o})=>(0,n.jsxs)("div",{className:al,children:[(0,n.jsx)(re.A,{size:20,className:rl,style:o,children:e?(0,n.jsx)("img",{alt:"avatar",crossOrigin:"anonymous",src:e}):t[0]}),(0,n.jsx)("div",{className:nl,children:(0,n.jsx)(G.A.Text,{ellipsis:{cssEllipsis:!0,showTooltip:{props:{style:{zIndex:9999}}}},children:t})})]}),sl=({signInText:e,signOutText:t,handleLogin:o,handleSignOut:a,hasBind:s=!1,unbinding:d=!1,children:u,style:p,className:_,...h})=>s?(0,n.jsxs)(N.A,{...h,style:p,placeholder:"Please select",unmountOnExit:!1,dropdownMenuClassName:tl,className:l()(el,_),triggerProps:{style:{zIndex:2e3},containerScrollToClose:!0},children:[i.Children.toArray(u),(0,n.jsxs)(k.A,{type:"text",className:l()("lv-select-option",ol),size:"small",long:!0,loading:d,onClickCapture:e=>{e.stopPropagation(),a()},children:[(0,n.jsx)(r.ZT9,{size:20}),t??c.Ay.t("web_sign_out",{},"Sign out")]})]}):(0,n.jsxs)("div",{style:p,className:l()(Xs,_),onClick:o,children:[(0,n.jsx)(r.W2v,{size:32,className:"login-avatar"}),(0,n.jsx)("span",{className:"login-text",children:e??c.Ay.t("log_in")})]}),ll=()=>{const{userInfo:e,isUploading:t,youtubeSend:o,youtubeState:a,shareServiceSend:r}=Zs(),{platformItem:i}=Qs(),s=a.matches("show.hasBind"),l=a.matches("show.hasBind.unbind.loading");return(0,n.jsx)(sl,{value:null==e?void 0:e.email,unbinding:l,hasBind:s,disabled:t,signInText:c.Ay.t("web_ytb_ins_button_youtube"),handleSignOut:()=>o("USER_UNBIND"),handleLogin:()=>{r({type:"CHOOSE_PLATFORM",data:{platform:u.c.YouTube,authUrl:null==i?void 0:i.authUrl}})},children:(0,n.jsx)(N.A.Option,{value:(null==e?void 0:e.email)||"",children:(0,n.jsx)(il,{picture:null==e?void 0:e.picture,name:(null==e?void 0:e.name)||(null==e?void 0:e.email)||""})},null==e?void 0:e.email)})},cl=500;function dl(e){return e.reduce(((e,t)=>{const o=2*(t.split(" ").length-1);return e+t.length+o}),e.length-1)}const ul=({value:e=[],onChange:t,disabled:o})=>{const[a,r]=(0,i.useState)(""),s=(0,i.useMemo)((()=>dl(e)),[e]);return(0,n.jsxs)("div",{className:"lv-youtube-input-tag-wrapper",children:[(0,n.jsx)(Ce.A,{disabled:o,inputValue:a,className:"lv-youtube-input-tag",placeholder:c.Ay.t("describe_post"),value:e,onChange:e=>{t(e),r("")},onInputChange:e=>{const t=dl([e]);t<=100&&s+t<cl&&r(e)}}),(0,n.jsx)("span",{className:"lv-word-number",children:`${dl([a])+s}/500`})]})},pl="_upload-button_6x40a_1",_l="_upload-title_6x40a_7",hl="_upload-progress_6x40a_18",ml=({onClick:e,errorMessage:t,uploading:o=!1,uploadingText:a,text:r,progress:s=0,disabled:d,className:u})=>{const{exportState:p}=(0,i.useContext)(bv),_=p?c.Ay.t("web_posttemplate_toast_exporting_video"):t,h=d||!!_;return(0,n.jsxs)("div",{className:l()(pl,u),children:[(0,n.jsxs)("div",{className:hl,style:{display:o?"block":"none"},children:[(0,n.jsx)("span",{className:_l,children:a}),(0,n.jsx)(z.A,{percent:s,showText:!1,trailColor:"#008695",color:"#00B6C2"})]}),(0,n.jsx)(x.A,{disabled:!h,content:_,getPopupContainer:e=>e,children:(0,n.jsx)(k.A,{style:{display:o?"none":"block"},disabled:h,htmlType:"submit",type:"primary",long:!0,size:"large",onClick:e,children:r})})]})},gl="b",vl=`${gl}ytevcloudapi`,fl=`${gl}yted`;function yl({region:e}){const t={imageHost:"",videoHost:"",videoFallbackHost:null,imageFallbackHost:null};switch(e){case"us":t.videoHost=`https://vod-us-east-1.${vl}.com`,t.imageHost=`https://imagex-us-east-1.${vl}.com`,t.videoFallbackHost=`https://open-us-east-1.${vl}.com`,t.imageFallbackHost=`https://open-us-east-1.${vl}.com`;break;case"gcp":t.videoHost=`https://vod-us-east-2.${vl}.com`,t.imageHost=`https://imagex-us-east-2.${vl}.com`,t.videoFallbackHost=`https://open-us-east-2.${vl}.com`,t.imageFallbackHost=`https://open-us-east-2.${vl}.com`;break;case"sg":t.videoHost=`https://vod-ap-singapore-1.${vl}.com`,t.imageHost=`https://imagex-ap-singapore-1.${vl}.com`,t.videoFallbackHost=`https://open-ap-singapore-1.${vl}.com`,t.imageFallbackHost=`https://open-ap-singapore-1.${vl}.com`;break;case"US-TTP":t.videoHost="https://api16-normal-useast5.us.tiktokv.com/top/v1",t.imageHost="https://api16-normal-useast5.us.tiktokv.com/top/v1",t.videoFallbackHost="https://api19-normal-useast5.us.tiktokv.com/top/v1";break;case"boe":t.videoHost=`https://staging-openapi-${gl}oe.${fl}.org`,t.imageHost=`https://staging-openapi-${gl}oe.${fl}.org`;break;case"boei18n":t.videoHost=`https://vas-${gl}oei18n.${fl}ance.net`,t.imageHost=`https://vas-${gl}oei18n.${fl}ance.net`;break;default:t.videoHost=`https://vod.${fl}anceapi.com`,t.imageHost=`https://imagex.${fl}anceapi.com`,t.videoFallbackHost="https://vas-lf-x.______________",t.imageFallbackHost=`https://open.${fl}anceapi.com`}return t}const wl="_wrapper_108og_1",bl="_container_108og_9",xl="_title_108og_21",kl="_subtitle_108og_30",Al="_select_mode_108og_40",Sl="_footer_108og_52",Cl="_pagination_108og_60",Il="_indicator_108og_76",El="_indicator_icon_108og_83",Tl="_list_108og_87",Pl="_list__current_108og_96",Nl="_otherList_108og_101",jl="_otherContainer_108og_123",Rl="_otherText_108og_134",Ll="_otherTextArea_108og_141",Ol="_item_108og_148",Fl="_item_checkbox_108og_167",Dl="_item__single_selected_108og_170",Ul="_item__multiple_selected_108og_173",Ml="_item_cover_108og_180",Bl="_item_cover__light_108og_188",zl="_item_cover__dark_108og_191",Gl="_item_body_108og_194",Wl="_skip_108og_220",Vl=({data:e,selected:t,mode:o,onClick:a})=>(0,n.jsxs)("li",{className:l()(Ol,{[Dl]:"single"===o&&t,[Ul]:"multiple"===o&&t}),onClick:a,children:[(0,n.jsx)("img",{className:l()(Ml,Bl),src:e.icon,alt:c.Ay.t(e.text_starling,{},e.text),crossOrigin:"anonymous"}),(0,n.jsx)("img",{className:l()(Ml,zl),src:e.deep_mode_icon,alt:c.Ay.t(e.text_starling,{},e.text),crossOrigin:"anonymous"}),(0,n.jsx)("div",{className:Gl,children:c.Ay.t(e.text_starling,{},e.text)}),"multiple"===o?(0,n.jsx)("div",{className:Fl,children:(0,n.jsx)(r.RsE,{fill:"var(--lvv-color-text-content-primary)"})}):null]}),Hl=({service:e})=>{const[t,o]=(0,g.B)(e),{questionList:s,question:d,questionCount:u,answers:p,answer:_}=t.context,[h,m]=(0,i.useState)(!1),[v,f]=(0,i.useState)("");const y=(0,he.A)(!h,100),w=e=>{e&&y&&e.scrollIntoView({behavior:"smooth",block:"end"})};return(0,n.jsxs)("div",{className:bl,children:[(0,n.jsx)("h2",{className:xl,children:c.Ay.t(d.title_starling,{},d.title)}),(0,n.jsx)("h3",{className:kl,children:c.Ay.t(d.description_starling,{},d.description)}),(0,n.jsx)("div",{className:Wl,onClick:function(){o({type:"SKIP",onError:()=>a.A.error(c.Ay.t("web_editor_sdk_error"))})},children:c.Ay.t("web_users_arouse_skip",{},"Skip")}),s.map((e=>(0,n.jsxs)("ul",{className:l()(Tl,{[Nl]:h},{[Pl]:e.key===d.key}),children:[(0,n.jsx)("p",{className:Al,children:"single"===d.type?c.Ay.t("select_only_one",{},"Select only one"):c.Ay.t("web_select_all_that_apply",{},"Select all that apply")}),e.answer_list.map((e=>(0,n.jsx)(Vl,{data:e,selected:!!_.find((t=>t===e.key)),mode:d.type,onClick:()=>function(e){"q2a8"===e.key&&m((e=>!e)),o({type:"CHECK",key:e.key,text:e.text_starling})}(e)},e.key))),h&&(0,n.jsxs)("div",{className:jl,ref:w,children:[(0,n.jsx)("div",{className:Rl,children:c.Ay.t("web_new_guide_title_decribe_what",{},"Describe what you feel like doing with CapCut")}),(0,n.jsx)(O.A,{className:Ll,maxLength:50,showWordLimit:!0,onChange:e=>{const t=e.slice(0,50);f(t)}})]})]},e.key))),(0,n.jsxs)("div",{className:Sl,children:[p.length>0?(0,n.jsxs)(k.A,{type:"default",size:"large",className:Il,onClick:function(){m(!1),o({type:"BACK"})},children:[(0,n.jsx)(r.lPV,{className:El}),c.Ay.t("web_check_new_user_button_back",{},"Back")]}):(0,n.jsx)("div",{}),(0,n.jsxs)("p",{className:Cl,children:[(0,n.jsx)("span",{children:t.context.answers.length+1})," / ",u]}),p.length<u-1?(0,n.jsxs)(k.A,{type:"primary",size:"large",className:Il,onClick:function(){h&&(m(!1),o({type:"INPUT",value:v})),o({type:"NEXT"})},disabled:0===_.length,children:[c.Ay.t("web_check_new_user_button_next",{},"Next"),(0,n.jsx)(r.Adi,{className:El})]}):(0,n.jsx)(k.A,{type:"primary",size:"large",disabled:0===_.length,onClick:function(){o({type:"SUBMIT",onError:()=>a.A.error(c.Ay.t("web_editor_sdk_error"))})},children:c.Ay.t("submit",{},"Submit")})]})]})};var ql=(e=>(e.OPEN="OPEN",e.EXPORT_WITH_SAVE="EXPORT_WITH_SAVE",e.RENDERING="rendering",e.RENDER_SUCCESS="renderSuccess",e.RENDER_FAILED="renderFailed",e.RENDER_FAILED_SPACE_FULL="renderFailedSpaceFull",e.UPLOADING="uploading",e.UPLOAD_SUCCESS="uploadSuccess",e.UPLOAD_FAILED="uploadFailed",e.UPLOAD_AUDITING="uploadAuditing",e))(ql||{});const Yl=({status:e,taskId:t,enterFrom:o})=>{window.open((0,h.n)(d.R.EDITOR_TOOLS.LONG_TO_SHORT.PATH,{pageStatus:"success"===e?"PreviewResult":"CreateLoading",taskId:t,toolsEnterFrom:o}))},Kl={allowed:c.Ay.t("web_sharereview_text_allow_comments_on",{},"Allow comments on"),notAllowed:c.Ay.t("web_sharereview_text_allow_comments_off",{},"Allow comments off")},Jl={allowed:c.Ay.t("web_sharereview_text_allow_download_on",{},"Allow download on"),notAllowed:c.Ay.t("web_sharereview_text_allow_download_off",{},"Allow download off")},$l={[Dt.public]:c.Ay.t("web_sharereview_text_anyone_can_access",{},"Anyone can open the link"),[Dt.space]:c.Ay.t("web_sharereview_title_only_members_access",{},"Only members of the space can open the link")},Ql={[Dt.public]:c.Ay.t("web_sharereview_title_public",{},"Everyone"),[Dt.space]:c.Ay.t("web_sharereview_title_space",{},"Space")},Zl={protected:`${c.Ay.t("web_sharereview_text_permission_password",{},"Password")}: `,notProtected:c.Ay.t("web_sharereview_text_password_protected_off",{},"Password protected sharing off")},Xl=[[49,57],[65,72],[74,78],[80,90],[97,104],[106,110],[112,122]],ec=(e=4)=>{let t="";for(let o=0;o<e;o++){const e=2*Math.floor(Math.random()*(Xl.length/2)),[o,a]=Xl[e],n=o+Math.floor(Math.random()*(a-o+1));t+=String.fromCharCode(n)}return t};var tc=(e=>(e.optionsPage="option-page",e.presentationPage="share-as-presentation-page",e.shareReviewMainPage="share-review-main-page",e.shareCodeEmbedPage="share-code-embed-page",e))(tc||{});const oc={allow_download:!0,presentation_share_link:"",owner:"",presentation_share_id:"",access_type:Dt.public,auto_subtitles:!1,auto_subtitles_config:{source_lang:"en-GB",display_by_default:!1},title:"",description:"",show_in_homepage:!1},ac={route:{page:"share-review-main-page"},setRoute:()=>{console.log("[setRoute] child component doesn\u2019t see the value from context provider")},settingsInfo:oc,setSettingsInfo:()=>{console.log("[setSettingsInfo] child component doesn\u2019t see the value from context provider")},params:{workspaceID:"0",fileID:"0"},report:()=>{console.log("[report] child component doesn\u2019t see the value from context provider")}},nc={"share-review-main-page":c.Ay.t("web_embedcode_title_share_for_review"),"share-as-presentation-page":c.Ay.t("web_embedcode_text_share_as_pre"),"share-code-embed-page":c.Ay.t("web_embedcode_text_complete_embed")},rc={"options-wrapper":"_options-wrapper_prglx_1","option-item-wrapper":"_option-item-wrapper_prglx_7","option-item-icon":"_option-item-icon_prglx_22","option-item-middle":"_option-item-middle_prglx_33","option-item-name":"_option-item-name_prglx_39","option-item-description":"_option-item-description_prglx_49","option-item-arrow-right":"_option-item-arrow-right_prglx_57"},ic="_third-platform_1d7c4_1",sc="_upload-to_1d7c4_6",lc="_platform-row_1d7c4_14",cc="_scheduleLogo_1d7c4_22",dc="_tryForFree_1d7c4_28",uc="_button-container_s95aq_1",pc="_text_s95aq_13",_c="_arrow_s95aq_19",hc=({onClick:e})=>(0,n.jsxs)("div",{className:uc,onClick:e,children:[(0,n.jsx)(r.VE2,{size:22}),(0,n.jsx)("div",{className:pc,children:c.Ay.t("download")}),(0,n.jsx)(r.Adi,{className:_c,size:20})]}),mc="_container_tp512_1",gc="_logo_tp512_14",vc="_logo-name_tp512_24",fc="_typography_tp512_31",yc=({item:e,onClick:t})=>(0,n.jsxs)("div",{className:mc,onClick:()=>null==t?void 0:t(e),children:[(0,n.jsx)("div",{className:gc,children:e.logo}),(0,n.jsx)("div",{className:vc,children:(0,n.jsx)(G.A.Text,{className:fc,ellipsis:{cssEllipsis:!0,rows:2,showTooltip:{props:{style:{maxWidth:"200px",whiteSpace:"normal",wordBreak:"break-all",zIndex:9999}}}},children:e.logoName})})]}),wc=(0,n.jsxs)("div",{className:cc,children:[(0,n.jsx)(r.On8,{className:dc,size:34}),(0,n.jsx)(r.Ja0,{size:22})]}),bc=({platformsItemList:e,choosePlatformFn:t,EverCloud:o,fileInfo:a,currentPage:r,reportExtra:i,downloadReport:s,downloadVisible:l,handleClickSchedule:d})=>(0,n.jsxs)("div",{className:ic,children:[(0,n.jsx)("div",{className:sc,children:c.Ay.t("web_embedcode_text_upload_video_to")}),(0,n.jsxs)("div",{className:lc,children:[e.map(((e,o)=>e.isShow?(0,n.jsx)(yc,{item:e,onClick:t},`platform-${o}`):(0,n.jsx)(n.Fragment,{}))),(0,n.jsx)(yc,{item:{logo:wc,logoName:c.Ay.t("web_timing_button_schedule_post",{},"Schedule post")},onClick:d},"platform-schedule")]}),l&&(0,n.jsx)(hc,{onClick:()=>{Lv(a,r,null==i?void 0:i.enterFrom,o),null==s||s()}})]});function xc({openType:e,EverCloud:t,platformsItemList:o,choosePlatformFn:a,fileInfo:s,reportExtra:l,currentPage:d,downloadVisible:p,handleClickSchedule:_}){const{setRoute:h,report:m}=(0,i.useContext)(ad),g=(0,i.useRef)(null),v=[{id:tc.shareReviewMainPage,icon:(0,n.jsx)(r.yNF,{size:24}),name:c.Ay.t("web_embedcode_text_share_as_review",{},"Share for review"),description:c.Ay.t("web_embedcode_text_comment_video",{},"Viewer can leave comments")},{id:tc.presentationPage,icon:(0,n.jsx)(r.MKO,{size:24}),name:c.Ay.t("web_embedcode_text_share_as_pre",{},"Share as presentation"),description:c.Ay.t("web_embedcode_text_view_only",{},"View-only link"),feature:{active:!0,text:c.Ay.t("web_share_translation_tooltip_auto_captions",{},"The auto captions feature is now available")}}];return(0,n.jsxs)("div",{ref:g,className:rc["options-wrapper"],children:[v.map((({icon:t,name:o,description:a,id:i})=>(0,n.jsxs)("div",{className:rc["option-item-wrapper"],onClick:()=>(t=>{h({page:t});const o={[tc.presentationPage]:"share_as_pre",[tc.shareReviewMainPage]:"share_review"};if((0,B.C5)(e))return void m({action:o[t],panel_page:"share"});const a={[tc.presentationPage]:u.P.share_pre_detail,[tc.shareReviewMainPage]:u.P.share_review_detail};m({action:o[t],panel_page:"export_finish"}),(0,u.n)().setParam({panel_page:a[t]})})(i),children:[(0,n.jsx)("div",{className:rc["option-item-icon"],children:t}),(0,n.jsxs)("div",{className:rc["option-item-middle"],children:[(0,n.jsx)("div",{className:rc["option-item-name"],children:o}),(0,n.jsx)("div",{className:rc["option-item-description"],children:a})]}),(0,n.jsx)(r.cwL,{size:10,color:"var(--lvv-color-text-1)",className:rc["option-item-arrow-right"]})]},i))),(0,n.jsx)(bc,{platformsItemList:o,choosePlatformFn:a,fileInfo:s,EverCloud:t,reportExtra:l,currentPage:d,downloadVisible:p,handleClickSchedule:_})]})}const kc="_share-presentation-wrapper_li2q8_1",Ac={"lv-review-header":"_lv-review-header_1t64y_1","go-back-wrapper":"_go-back-wrapper_1t64y_7",title:"_title_1t64y_24"};function Sc({title:e,handleClick:t}){return(0,n.jsxs)("div",{className:Ac["lv-review-header"],children:[(0,n.jsx)("div",{className:Ac["go-back-wrapper"],onClick:t,children:(0,n.jsx)(r.vdJ,{size:12})}),(0,n.jsx)("div",{className:Ac.title,children:e})]})}function Cc(e,t){const o={...(0,u.n)().getReportParam(),...e};if([p.O.uploadShare,p.O.modalWorkspace].includes(t))return delete o.panel_page,void ca().report(o);(0,B.C5)(t)?p.o.reportEvent(o):Sr.reportShareForReviewAction(e)}const Ic={share_name:"",password:"",allow_download:!0,allow_comment:!0,access_type:Dt.public,file_share_status:Mt.NO_SHARE,owner:"0"},Ec="share-main-page",Tc={eventParams:{},expandModal:{expandModalInstance:void 0,isShowVipEquityCard:!1},route:{page:Ec},setRoute:()=>{console.log("[setRoute] child component doesn\u2019t see the value from context provider")},settingsInfo:Ic,setSettingsInfo:()=>{console.log("[setSettingsInfo] child component doesn\u2019t see the value from context provider")},members:[],disabled:!1,isVisitant:!1,updateShareSettings:async()=>(console.log("[updateShareSettings] child component doesn\u2019t see the value from context provider"),Promise.resolve(!0)),requestCreateLink:async()=>(console.log("[requestCreateLink] child component doesn\u2019t see the value from context provider"),Promise.resolve(!0)),nickName:"",openType:p.O.taskList,report:()=>{console.log("[report] child component doesn\u2019t see the value from context provider")},submit:()=>(console.log("[report] child component doesn\u2019t see the value from context provider"),Promise.resolve(!1))},Pc=(0,i.createContext)(Tc);function Nc({id:e,selectedItemId:t,access:o,description:a,IconComponent:i}){return(0,n.jsxs)("div",{className:"item-wrapper",children:[i,(0,n.jsxs)("div",{className:"info",children:[(0,n.jsx)("div",{className:"access",children:o}),(0,n.jsx)("div",{className:"description",children:a})]}),e===t&&(0,n.jsx)(r.MMN,{size:16,className:"item-check"})]})}const jc=[{id:Dt.public,IconComponent:(0,n.jsx)(r.w4O,{className:"icon-color",size:20}),access:Ql[Dt.public],description:$l[Dt.public]},{id:Dt.space,IconComponent:(0,n.jsx)(r.Psc,{className:"icon-color",size:20}),access:Ql[Dt.space],description:$l[Dt.space]}];function Rc({disabled:e,access_type:t,workspaceID:o,getPopupContainer:s}){const[d,p]=(0,i.useState)(t),{updateShareSettings:_,settingsInfo:h,setSettingsInfo:m,openType:g}=(0,i.useContext)(Pc),v=jc.find((e=>e.id===d)),{access:f,description:y,IconComponent:w}=v;(0,i.useEffect)((()=>{p(t)}),[t]);const b=(0,n.jsx)($.A,{onClickMenuItem:e=>{const t=Number(e);p(t),m({...h,access_type:t}),(async e=>{if(h.file_share_status===Mt.NO_SHARE)return;const t=e===Dt.public?Ut.open:Ut.close;await _({op_type:t,access_type:e})?a.A.success(c.Ay.t("web_sharereview_toast_save_setting_success",{},"Settings saved")):a.A.error(c.Ay.t("web_sharereview_toast_save_setting_fail",{},"Couldn\u2019t save settings"))})(t),t===Dt.public?Cc({action:u.E.switch_share_view_range,panel_page:u.P.share_review_detail,review_range:"public"},g):Cc({action:u.E.switch_share_view_range,panel_page:u.P.share_review_detail,review_range:"space",space_id:o,share_member_cnt:0},g)},children:jc.map((({id:e,IconComponent:t,access:o,description:a})=>(0,n.jsx)($.A.Item,{className:"menu-item",children:(0,n.jsx)(Nc,{id:e,selectedItemId:d,IconComponent:t,access:o,description:a})},`${e}`)))});return(0,n.jsx)(J.A,{disabled:e,droplist:b,trigger:["hover"],getPopupContainer:s,triggerProps:{autoAlignPopupWidth:!0,autoAlignPopupMinWidth:!0,style:{zIndex:1001}},children:(0,n.jsxs)("div",{className:l()("access-info",{disabled:e}),children:[w,(0,n.jsx)("div",{className:"access-description",children:`${f}: ${y}`}),(0,n.jsx)(r._3r,{className:"icon icon-color"})]})})}function Lc({title:e,isEdited:t=!1,handleSave:o,handleCancel:a,handleClickGoBack:s}){const[l,d]=(0,i.useState)(!1),u=(0,i.useRef)(null);return(0,n.jsxs)("div",{className:"lv-review-header",ref:u,children:[(0,n.jsx)(oe.A,{position:"bl",popupVisible:l,icon:null,title:c.Ay.t("web_sharereview_toast_save_share_setting",{},"Do you want to save share settings"),cancelText:c.Ay.t("web_cancel",{},"Cancel"),onCancel:()=>(null==a||a(),d(!1),void s()),okText:c.Ay.t("web_sharereview_button_save_setting",{},"Save"),onOk:e=>{e.stopPropagation(),null==o||o(),d(!1),s()},getPopupContainer:e=>u.current??e,children:(0,n.jsx)("div",{className:"go-back-wrapper",onClick:()=>{t?d(!0):s()},children:(0,n.jsx)(r.vdJ,{size:12})})}),(0,n.jsx)("div",{className:"title",children:e})]})}const Oc="share-settings",Fc=L.A.Item;function Dc({handleCloseModal:e,expandModalInstance:t,isShowVipEquityCard:o,eventParams:a,showVipCard:s}){const[l]=L.A.useForm(),{settingsInfo:d,setRoute:p,submit:_,expandModal:h,openType:m}=(0,i.useContext)(Pc),g=o||(null==h?void 0:h.isShowVipEquityCard),v=t??(null==h?void 0:h.expandModalInstance),{allow_comment:f,allow_download:y,password:w}=d,[b,x]=(0,i.useState)(w),A=()=>{p({page:Ec})},S=()=>{l.setFieldsValue({allow_comment:f,allow_download:y,password:!!w}),x(w)};(0,i.useEffect)((()=>{S()}),[d]);const[C,I]=(0,i.useState)(!1),E=(0,ae.A)((async e=>{Cc({action:u.E.save_settings,panel_page:u.P.share_review_detail},m),I(!1),await _({...e,password:b})&&A()}),1e3,{trailing:!1});return(0,n.jsxs)("div",{className:"share-settings",children:[(0,n.jsxs)("div",{className:"share-settings-header-special-platform",children:[(0,n.jsx)("div",{className:"title",children:c.Ay.t("web_sharereview_toast_permissions_share_setting",{},"Share setting")}),(0,n.jsx)("div",{className:"close",onClick:()=>{null==e||e()},children:(0,n.jsx)(r.En0,{size:20,className:"icon-color"})})]}),(0,n.jsx)(Lc,{title:c.Ay.t("web_sharereview_toast_permissions_share_setting",{},"Share setting"),handleClickGoBack:A,isEdited:C,handleSave:()=>{l.submit()},handleCancel:()=>{S(),I(!1)}}),(0,n.jsxs)(L.A,{form:l,className:"share-setting-form",autoComplete:"off",onChange:e=>{void 0!==e.password&&x(e.password?ec():""),I(!0)},onSubmit:function(e){E(e)},children:[!(g||s)&&(0,n.jsxs)("div",{className:"share-review-settings-switch-wrapper",children:[(0,n.jsx)("div",{className:"switch-label",children:c.Ay.t("web_sharereview_button_permissions_allow_download",{},"Allow download")}),(0,n.jsx)(Fc,{field:"allow_download",initialValue:y??!0,triggerPropName:"checked",children:(0,n.jsx)(te.A,{})})]}),(g||s)&&(0,n.jsx)(Cr,{isDownloadCard:!0,isShowVipEquityCard:g,eventParams:{enter_from:"share_for_review",...a},expandModalInstance:v}),(0,n.jsxs)("div",{className:"share-review-settings-switch-wrapper",children:[(0,n.jsx)("div",{className:"switch-label",children:c.Ay.t("web_sharereview_button_permissions_allow_comment",{},"Allow comment")}),(0,n.jsx)(Fc,{field:"allow_comment",initialValue:f??!0,triggerPropName:"checked",children:(0,n.jsx)(te.A,{})})]}),(0,n.jsxs)("div",{className:"share-review-settings-switch-wrapper",children:[(0,n.jsx)("div",{className:"switch-label",children:c.Ay.t("web_sharereview_button_permissions_password_protection",{},"Password protection")}),(0,n.jsx)(Fc,{field:"password",initialValue:!!w,triggerPropName:"checked",children:(0,n.jsx)(te.A,{})})]}),b?(0,n.jsxs)("div",{className:"password",children:[(0,n.jsxs)("div",{className:"title",children:[c.Ay.t("web_sharereview_text_permission_password",{},"Password"),": ",b]}),(0,n.jsx)("div",{className:"description",children:c.Ay.t("web_sharereview_text_password_protection",{},"Password protection is only valid for users outside the group")})]}):null,(0,n.jsx)(Fc,{children:(0,n.jsx)(k.A,{type:"primary",htmlType:"submit",className:"save-setting",long:!0,children:c.Ay.t("web_sharereview_button_save_setting",{},"Save setting")})})]})]})}function Uc(e,t,o){var r,i;const{data:s}=e||{},{ret:l,data:d}=s||{};if(l===Bt.BatchSendNoticeByEmail&&d)return null!=(r=d.limit_err_list)&&r.length&&function(e){y.A.warning({title:c.Ay.t("web_supportEmail_button_send_failture",{},"Couldn\u2019t share"),content:(0,n.jsxs)("div",{className:"lv-email-limit-modal",children:[(0,n.jsx)("div",{children:c.Ay.t("web_supportEmail_button_failture_message",{},"You can share videos by email up to 10 times a day. Can\u2019t share to the following emails. Try again tomorrow.")}),(0,n.jsx)("ul",{children:e.map((e=>(0,n.jsx)("li",{children:e},e)))})]}),okText:c.Ay.t("web_supportEmail_button_i_know",{},"OK"),cancelText:null})}(d.limit_err_list),void(null!=(i=d.send_err_list)&&i.length&&d.send_err_list.forEach((e=>{var n;if("email"===t&&a.A.error(c.Ay.t("web_supportEmail_button_fail_email",{placeholder0:e},"Couldn\u2019t send email to {placeholder0}")),"member"===t){const t=(null==(n=null==o?void 0:o.find((t=>t.uid===e)))?void 0:n.nickname)||e;a.A.error(c.Ay.t("web_supportEmail_toast_cannot_send_number",{placeholder0:t},"Can\u2019t send email to {placeholder0}"))}})));a.A.error(c.Ay.t("web_supportEmail_toast_sth_went_wrong",{},"Something went wrong"))}const Mc="team-members";function Bc({avatar:e,nickname:t,checked:o,handleCheck:a}){return(0,n.jsxs)("div",{className:"member-item",children:[(0,n.jsx)("img",{crossOrigin:"anonymous",className:"img",src:e}),(0,n.jsx)("div",{className:"name",children:t}),(0,n.jsx)(F.A,{checked:o,onChange:a})]})}function zc({members:e,selected:t,handleCheck:o}){return(0,n.jsx)("div",{className:"member-list",children:e.map((({avatar:e,nickname:a,uid:r})=>(0,n.jsx)(Bc,{avatar:e,nickname:a,checked:t.includes(r),handleCheck:e=>{o(e,r)}},r)))})}function Gc({fileID:e,workspaceID:t}){const{members:o,requestCreateLink:s,route:l,setRoute:p,settingsInfo:_,openType:h}=(0,i.useContext)(Pc),[m,g]=(0,i.useState)([]),[v,f]=(0,i.useState)(!1);async function y(){try{await d.l.batchSendNoticeByEmail({fileId:e,workspaceId:t,users:m}),a.A.success(c.Ay.t("web_supportEmail_button_success_email",{num:m.length},"Email sent"))}catch(n){Uc(n,"member",o)}}const w=(0,ae.A)((async function(){Cc({action:u.E.notify,panel_page:u.P.share_review_detail,review_range:_.access_type===Dt.public?"public":"space",allow_download:_.allow_download?1:0,review_allow_comment:_.allow_comment?1:0,password_protection:_.password?1:0,space_id:t,share_member_cnt:m.length},h);try{f(!0),await s(),await Promise.all([d.l.batchSendMessage(e,0,t,m).then((()=>{a.A.success(c.Ay.t("web_sharereview_toast_notify_members_success",{},"Members notified"))})),y()]),p({...l})}catch(o){console.error(o)}finally{f(!1),g([])}}),1e3,{trailing:!1});return(0,n.jsxs)("div",{className:"lv-share-export-review_team-members",children:[(0,n.jsx)(Lc,{title:c.Ay.t("web_sharereview_text_share_to_team",{},"Share to team members"),handleClickGoBack:()=>p({page:Ec})}),(0,n.jsx)(zc,{selected:m,members:o,handleCheck:function(e,t){g(e?[...m,t]:m.filter((e=>e!==t)))}}),o.length?(0,n.jsx)(k.A,{type:"primary",htmlType:"submit",className:"notify",long:!0,onClick:w,disabled:0===m.length,loading:v,children:c.Ay.t("web_sharereview_text_notify_share_team",{placeholder0:m.length},"Notify {placeholder0} members")}):(0,n.jsxs)("div",{className:"empty",children:[(0,n.jsx)("div",{className:"icon",children:(0,n.jsx)(r.vaP,{size:100})}),(0,n.jsx)("div",{className:"text",children:c.Ay.t("web_exportlogic_text_no_other_members",{},"There are no other members in this space, please invite others to join first.")})]})]})}const Wc="share_review_recent_emails",Vc=e=>/^[^\s@,]+@[^\s@,]+\.[^\s@,]+$/.test(e),Hc=(e="anonymous")=>{const[t]=(0,i.useState)((()=>(e=>{const t=d.a.getString(`${Wc}_${e}`);if(t)try{const e=JSON.parse(t);return Array.isArray(e)?e.filter(Vc):[]}catch{return[]}return[]})(e)));return(0,i.useReducer)(((t,o)=>{const a=o.filter((e=>Vc(e))),n=t.filter((e=>!a.includes(e))),r=[...a].reverse().concat(n).slice(0,5);return((e,t)=>{const o=JSON.stringify(t.slice(0,5));d.a.setString(`${Wc}_${e}`,o)})(e,r),r}),t)},qc=(e=1e3)=>{const[t,o]=(0,i.useState)(),a=(0,i.useRef)(),n=(0,i.useCallback)((t=>{window.clearTimeout(a.current),o(t),a.current=window.setTimeout((()=>o(void 0)),e)}),[e]);return(0,i.useEffect)((()=>()=>{o(void 0),window.clearTimeout(a.current)}),[]),[t,n]},Yc=(e,t)=>{const{route:o}=(0,i.useContext)(Pc),{page:a}=o,n=e===a,r=(0,de.A)(t);return(0,i.useEffect)((()=>r(n)),[n]),n},Kc="share-email",Jc=10,$c="email_already_exist";function Qc({userId:e,fileID:t,workspaceID:o}){const{setRoute:s,requestCreateLink:p,openType:_}=(0,i.useContext)(Pc),[h,m]=Hc(e),[g,v]=(0,i.useState)([]),[f,y]=(0,i.useState)(),{state:w,add:b,delete:A}=(0,me.A)(),[S,C]=qc(),I=(0,i.useCallback)((e=>{var t,o;C(e),null==(o=null==(t=document.getElementById(`share_email_${e}`))?void 0:t.scrollIntoView)||o.call(t,{behavior:"smooth"}),a.A.error({id:$c,content:c.Ay.t("web_supportEmail_toast_already_exist",{},"This email already exists")})}),[]),E=(0,i.useMemo)((()=>g.filter((e=>!(0,Y.Q)(e)))),[g]),T=(0,i.useCallback)((e=>{var t,o;const a=e.trim().split(/\s*[,\s]+\s*/).filter(Y.R),n=(0,Ee.A)(a,Y.Q),r=(null==(t=n.true)?void 0:t.filter(Boolean))??[],i=(null==(o=n.false)?void 0:o.filter(Boolean))??[];return r.length?[r,i,a]:null}),[]),P=(0,i.useCallback)(((e,t=!0)=>{const[o,a,n]=e;t?(v((e=>{const t=(0,Te.A)(n).filter((t=>!e.includes(t)));return e.concat(t)})),y(void 0)):(v((e=>{const t=(0,Te.A)(o).filter((t=>!e.includes(t)));return e.concat(t)})),y(a.join(",")))}),[]),N=e=>{v((t=>t.filter((t=>t!==e))))},j=(0,i.useCallback)((e=>{if(e.clipboardData){const t=e.clipboardData.getData("text/plain"),o=T(t);if(o){e.preventDefault(),P(o);const[,,t]=o,a=(0,Te.A)(t).filter((e=>g.includes(e)));a.length&&I(a)}}}),[T,P,g]),[R,L]=(0,i.useState)(!1);(0,i.useEffect)((()=>{g.length>Jc?b("MAX_COUNT"):A("MAX_COUNT"),m(g)}),[g]),Yc(Kc,(e=>{})),(0,i.useEffect)((()=>{E.length>0?w.add("EMAIL_INVALID"):w.delete("EMAIL_INVALID")}),[E]);const O=(0,i.useRef)(null),F=e=>O.current||e;return(0,n.jsxs)("div",{className:"lv-share-email",children:[(0,n.jsx)(Lc,{title:c.Ay.t("web_supportEmail_text_invite_by_Email",{},"Share by email"),handleClickGoBack:()=>{s({page:Ec})}}),(0,n.jsx)(Ce.A,{className:"lv-share-email-input",validate:e=>!!e&&(!g.includes(e)||(I([e]),!1)),onPaste:j,value:g,onChange:e=>{v(e),y(void 0)},onRemove:N,inputValue:f,onInputChange:(e,t)=>{if("insertText"===t.nativeEvent.inputType&&","===t.nativeEvent.data){const t=T(e);if(t)return void P(t,!1)}y(e)},error:w.has("MAX_COUNT"),placeholder:c.Ay.t("web_supportEmail_enter_this_email",{},"Enter email"),renderTag:e=>(0,n.jsx)(Ie.A,{closable:!0,onClose:()=>N(e.value),className:l()({"lv-share-email-tag":!0,"lv-share-email-tag-animate-highlight":null==S?void 0:S.includes(e.value),"lv-share-email-tag-error":E.includes(e.value)}),id:`share_email_${e.value}`,children:e.label})}),w.has("MAX_COUNT")?(0,n.jsx)("div",{className:"lv-share-email-input-error",children:c.Ay.t("web_supportEmail_toast_up_to_ten",{},"Enter up to 10 emails")}):null,h.length>0&&(0,n.jsxs)("div",{className:"lv-share-email-recent",children:[(0,n.jsx)("div",{className:"lv-share-email-recent-caption",children:c.Ay.t("web_supportEmail_text_recent",{},"Recents")}),h.map((e=>(0,n.jsx)(x.A,{content:c.Ay.t("web_supportEmail_text_add_this_email",{},"Add"),getPopupContainer:F,children:(0,n.jsx)(Ie.A,{className:"lv-share-email-tag lv-share-email-recent-item",onClick:()=>(e=>{if(g.includes(e))return void I([e]);const t=T(e);t&&P(t)})(e),children:(0,n.jsxs)("span",{className:"lv-share-email-recent-item-text",children:[e,(0,n.jsx)(r.wwh,{size:10,color:"var(--lvv-color-text-secondary)"})]})})},e)))]}),(0,n.jsx)(k.A,{className:"lv-share-email-button",type:"primary",long:!0,onClick:async()=>{Cc({action:u.E.send_email_invite,panel_page:u.P.share_review_detail,send_email_cnt:g.length},_);try{L(!0),await p(),await d.l.batchSendNoticeByEmail({fileId:t,workspaceId:o,emails:g}),a.A.success(c.Ay.t("web_supportEmail_button_success_email",{num:g.length},"Email sent"))}catch(e){Uc(e,"email")}finally{L(!1),v([]),y(void 0)}},loading:R,disabled:w.size>0||g.length<=0,children:c.Ay.t("web_supportEmail_button_send_invite",{},"Share")})]})}const Zc=e=>{const{className:t,style:o,initialValue:a,disabled:r}=e,{submit:s}=(0,i.useContext)(Pc),[d,u]=(0,i.useState)(!1),[p,_]=(0,i.useState)(!1),[h]=L.A.useForm();return r?(0,n.jsx)("div",{className:l()(t,"form-item__share-name--readonly"),style:o,children:a}):(0,n.jsx)(L.A,{form:h,layout:"vertical",initialValues:{shareName:a},onSubmit:async e=>{try{_(!0),await s({share_name:e.shareName})&&u(!1)}finally{_(!1)}},onChange:()=>{u(!0)},onBlur:()=>{d&&h.submit()},children:(0,n.jsx)(L.A.Item,{style:{margin:0},field:"shareName",rules:[{required:!0,message:c.Ay.t("name_cannot_be_empty",{},"Name cannot be empty")},{maxLength:50,message:c.Ay.t("web_toast_rename_remind",{},"Name cannot be larger than 50 characters")}],children:(0,n.jsx)(O.A,{className:t,style:o,suffix:p?(0,n.jsx)(D.A,{webp:!0,size:16}):null})})})};function Xc({fileID:e,workspaceID:t,style:o,expandModalInstance:s,isShowVipEquityCard:d,eventParams:_,showVipCard:h,getPopupContainer:m}){const{setRoute:g,settingsInfo:v,disabled:f,requestCreateLink:y,nickName:w,openType:b}=(0,i.useContext)(Pc),{allow_comment:k,allow_download:A,password:S,access_type:C=Dt.public,share_name:I}=v,{exportState:E}=(0,i.useContext)(bv),T=(0,i.useMemo)((()=>{const e=[];return b===p.O.uploadShare?e.push(Jl.allowed,Kl.allowed,$l[Dt.public],Zl.notProtected):f?e.push(Jl.notAllowed,Kl.notAllowed,$l[Dt.space],Zl.notProtected):(e.push(A?Jl.allowed:Jl.notAllowed),e.push(k?Kl.allowed:Kl.notAllowed),e.push($l[C]),e.push(S?Zl.protected+S:Zl.notProtected)),e.join(" / ")}),[A,k,C,S,f]),P=()=>{navigator.clipboard.writeText((()=>{const o=`${location.origin}/view/${e}?workspaceId=${t}`;return`${c.Ay.t("web_sharereview_text_shareview_link",{placeholder0:w,placeholder1:I},"{placeholder0} shared a CapCut link with you {placeholder1}")} ${S?`${Zl.protected} ${S}`:""}  ${o}`})()).then((()=>{a.A.success(c.Ay.t("web_sharereview_toast_link_copied",{},"Link copied"))})).catch((()=>{a.A.error(c.Ay.t("web_sharereview_toast_link_copy_fail",{},"Link copy failed"))}))},N=(0,ae.A)((async()=>{f||(await y({},!0)&&P(),Cc({action:u.E.copy_link,panel_page:u.P.share_review_detail,review_range:v.access_type===Dt.public?"public":"space",allow_download:v.allow_download?1:0,review_allow_comment:v.allow_comment?1:0,password_protection:v.password?1:0},b))}),1e3,{trailing:!1}),j=[{id:"copy_link",name:c.Ay.t("web_embedcode_button_copy_link"),icon:(0,n.jsx)(r.RSn,{size:24}),backgroundColor:"var(--lvv-color-fill-bg-1)",textColor:E?"var(--lvv-color-text-disable)":"var(--lvv-color-text-primary)",disabled:E,disabledTips:E?c.Ay.t("web_posttemplate_toast_exporting_video"):c.Ay.t("web_sharereview_toast_not_initiate_sharing",{},"File creator did not initiate sharing"),onClick:N},{id:"members",name:c.Ay.t("web_supportEmail_text_team_members",{},"Members"),icon:(0,n.jsx)(r.Psc,{size:24}),backgroundColor:"var(--lvv-color-fill-bg-1)",textColor:E?"var(--lvv-color-text-disable)":"var(--lvv-color-text-primary)",disabled:E,disabledTips:E?c.Ay.t("web_posttemplate_toast_exporting_video"):c.Ay.t("web_sharereview_toast_not_initiate_sharing",{},"File creator did not initiate sharing"),onClick:()=>{g({page:Mc}),Cc({action:u.E.share_to_team,panel_page:u.P.share_review_detail},b)}},{id:"email",name:c.Ay.t("web_supportEmail_title_Email",{},"Email"),icon:(0,n.jsx)(r.zR8,{size:24}),backgroundColor:"var(--lvv-color-fill-bg-1)",textColor:E?"var(--lvv-color-text-disable)":"var(--lvv-color-text-primary)",disabled:E,disabledTips:E?c.Ay.t("web_posttemplate_toast_exporting_video"):c.Ay.t("web_sharereview_toast_not_initiate_sharing",{},"File creator did not initiate sharing"),onClick:()=>{g({page:Kc}),Cc({action:u.E.email,panel_page:u.P.share_review_detail},b)}}];return(0,n.jsxs)("div",{className:l()("share-wrapper",{disabled:f}),style:o,children:[(0,n.jsx)("div",{className:"share-link",style:{marginTop:0},children:c.Ay.t("web_sharereview_text_share_name",{},"Name for share")}),(0,n.jsx)(Zc,{className:"share-name",disabled:f,initialValue:I}),(0,n.jsx)("div",{className:"share-link",children:c.Ay.t("web_exportlogic_text_who_can_access",{},"Who can open link")}),(0,n.jsx)(Rc,{disabled:f,access_type:C,workspaceID:t,getPopupContainer:m}),(0,n.jsxs)("div",{className:"share-link share-setting-title",onClick:()=>{f||(g({page:Oc}),Cc({action:u.E.setting,panel_page:u.P.share_review_detail,no_vip_used_material:(h||d)&&s?1:0},b))},children:[c.Ay.t("web_exportlogic_more_setting",{},"Settings"),(0,n.jsx)("span",{className:"share-more-settings",children:(0,n.jsx)(r.Adi,{size:20})})]}),(0,n.jsx)("div",{className:"info",children:T}),(0,n.jsx)("div",{className:"share-link",children:c.Ay.t("web_supportEmail_text_share_to_friends",{},"Share video to")}),(0,n.jsx)("div",{className:"share-channels",children:j.map((e=>{if(!1===e.visible)return null;const t=l()("share-channel-item",e.disabled?"share-channel-item-disabled":null),o=e.disabled?void 0:()=>e.onClick(),a=(0,n.jsxs)("div",{className:t,onClick:o,children:[(0,n.jsx)("div",{className:"share-channel-item-icon",style:{color:e.textColor,backgroundColor:e.backgroundColor},children:e.icon}),(0,n.jsx)("div",{style:{color:e.textColor},children:e.name})]},e.id);return e.disabled?(0,n.jsx)(x.A,{position:"top",style:{zIndex:10001},content:e.disabledTips,children:a},e.id):a}))}),(h||d)&&s&&(0,n.jsx)(Cr,{isShowVipEquityCard:d,eventParams:{enter_from:"share_for_review",action:"join_pro",..._},expandModalInstance:s,style:{marginTop:"auto",boxSizing:"border-box",width:"100%"}})]})}function ed({fileID:e,workspaceID:t,disabled:o=!1,style:r,handleCloseModal:s,isVisitant:l=!1,openType:_,fileName:h,expandModalInstance:m,isShowVipEquityCard:g,eventParams:v,showVipCard:f,setShowMainTitle:y,getPopupContainer:w}){const b=s?Oc:Ec,[x,k]=(0,i.useState)({page:b}),A={...Ic,share_name:h,...Ti(f??g)},[S,C]=(0,i.useState)(A),{owner:I}=S,[E,T]=(0,i.useState)(""),[P,N]=(0,i.useState)(!1),j=(0,i.useMemo)((()=>(0,Y.O)()),[]),R={[Ec]:(0,n.jsx)(Xc,{isShowVipEquityCard:g,expandModalInstance:m,eventParams:v,workspaceID:t,showVipCard:f,fileID:e,style:r,openType:_,getPopupContainer:w}),[Oc]:(0,n.jsx)(Dc,{showVipCard:f,eventParams:v,isShowVipEquityCard:g,expandModalInstance:m,workspaceID:t,fileID:e,handleCloseModal:s,openType:_}),[Mc]:(0,n.jsx)(Gc,{isShowVipEquityCard:g,expandModalInstance:m,workspaceID:t,fileID:e,openType:_}),[Kc]:(0,n.jsx)(Qc,{isShowVipEquityCard:g,expandModalInstance:m,workspaceID:t,fileID:e,userId:j.uid,openType:_})},[L,O]=(0,i.useState)([]),[F,D]=(0,i.useState)([]);(0,i.useEffect)((()=>{let o=!1;async function a(){let e;try{e=await go.getAllWorkspaceMember({workspace_id:t})}catch(a){return void d.s.error("share--review fetchMembers",a)}o||D(e.data.member_list)}return _===p.O.uploadShare?(a(),N(!0)):Promise.all([async function(){if(!e||!t)return;let a=A;try{a=await d.l.getShareSettingsInfo(e,0,t)}catch(n){d.s.error("share--review startFetching",n)}o||C(a)}(),a()]),T((0,Y.O)().nickName),()=>{o=!0}}),[e,t,h]);const U=(e,t,o)=>{"2357"===e.data.ret?a.A.error(c.Ay.t("web_space_file_name_error")):a.A.error(c.Ay.t(t,{},o))};async function M(o){if((o.file_share_status??S.file_share_status)===Mt.NO_SHARE)return!1;const a={...S,...o,file_share_status:Mt.VALID_SHARE,op_type:Ut.modify};try{return await d.l.updateShareSetting(e,0,t,a),!0}catch(n){return U(n,"web_sharereview_toast_save_setting_fail","Couldn\u2019t save settings"),!1}}(0,i.useEffect)((()=>{const{uid:e}=(0,Y.O)();if(I!==e&&_!==p.O.uploadShare)return;const t=F.filter((t=>t.uid!==e));O(t)}),[I,F]),(0,i.useEffect)((()=>{const{uid:e}=(0,Y.O)();I===e&&N(!0)}),[I]),(0,i.useEffect)((()=>{null==y||y(x.page===Ec)}),[x]);const z=async(o,a)=>{if(S.file_share_status===Mt.VALID_SHARE)return!0;const n={...S,...o,file_share_status:Mt.NO_SHARE,op_type:Ut.open};try{return await d.l.createShare(e,0,t,n),C({...n,file_share_status:Mt.VALID_SHARE}),!0}catch(r){return a?U(r,"web_sharereview_toast_not_initiate_sharing","File creator did not initiate sharing"):U(r,"web_sharereview_toast_save_setting_fail","Couldn\u2019t save settings"),!1}},{exportState:G}=(0,i.useContext)(bv);return(0,i.useEffect)((()=>{(0,B.Ib)(_)&&(G||Cc({action:u.E.clickable,panel_page:u.P.share_review_detail,no_vip_used_material:(g||f)&&m?1:0},_))}),[G]),(0,n.jsx)(Pc.Provider,{value:{eventParams:v,expandModal:{expandModalInstance:m,isShowVipEquityCard:g},route:x,setRoute:k,settingsInfo:S,setSettingsInfo:C,members:L,disabled:o,isVisitant:!P||l,updateShareSettings:M,requestCreateLink:z,nickName:E,openType:_,submit:async e=>{const t={...S,...e};if(S.file_share_status===Mt.NO_SHARE){if(!await z(t))return!1}else if(!await M(t))return!1;return a.A.success(c.Ay.t("web_sharereview_toast_save_setting_success",{},"Settings saved")),C({...t,file_share_status:Mt.VALID_SHARE}),!0}},children:R[x.page]})}const td={header:"_header_16or2_1",title:"_title_16or2_8",close:"_close_16or2_19"};function od({platformHandleClose:e,fileName:t}){return(0,n.jsxs)("div",{className:td.header,children:[(0,n.jsx)("div",{className:td.title,children:c.Ay.t("web_sharereview_text_share_file_name",{placeholder0:t},`Share ${t}`)}),(0,n.jsx)("div",{className:td.close,children:(0,n.jsx)(r.En0,{size:20,onClick:()=>null==e?void 0:e()})})]})}const ad=(0,i.createContext)(ac),nd=(0,u.n)();function rd({workspaceID:e,fileID:t,disabled:o=!1,style:a,EverCloud:r,handleCloseModal:s,isVisitant:l=!1,openType:c,fileName:d,reportExtra:_,isShowVipEquityCard:h,expandModalInstance:m,eventParams:g,showVipCard:v,platformsItemList:f,choosePlatformFn:y,fileInfo:w,currentPage:b,platformHandleClose:x,downloadVisible:k,handleClickSchedule:A}){const S={...oc,...Ti(v||h)},[C,I]=(0,i.useState)(S),[E,T]=(0,i.useState)(!0),[P,N]=(0,i.useState)({page:tc.optionsPage}),j={[tc.optionsPage]:(0,n.jsxs)(n.Fragment,{children:[c===p.O.workspace||c===p.O.sharedLinks?(0,n.jsx)(od,{fileName:(null==w?void 0:w.fileName)??"",platformHandleClose:x}):null,(0,n.jsx)(xc,{EverCloud:r,openType:c,platformsItemList:f,choosePlatformFn:y,fileInfo:w,reportExtra:_,currentPage:b,downloadVisible:k,handleClickSchedule:A})]}),[tc.presentationPage]:(0,n.jsx)(Pi,{openType:c,showVipCard:v,fileID:t,workspaceID:e,isShowVipEquityCard:h,eventParams:g,expandModalInstance:m,setShowMainTitle:T}),[tc.shareReviewMainPage]:(0,n.jsx)(ed,{expandModalInstance:m,isShowVipEquityCard:h,eventParams:g,workspaceID:e,fileID:t,disabled:o,style:a,handleCloseModal:s,isVisitant:l,openType:c,fileName:d,reportExtra:_,setShowMainTitle:T})};return(0,n.jsx)(ad.Provider,{value:{route:P,setRoute:N,settingsInfo:C,setSettingsInfo:I,params:{workspaceID:e,fileID:t},report:t=>{const o=(0,Y.s)({...nd.getReportParam(),..._,space_id:e,...t});(0,B.C5)(c)?p.o.reportEvent(o):nd.reportEvent(o)}},children:(0,n.jsxs)("div",{className:kc,children:[P.page!==tc.optionsPage&&E&&(0,n.jsx)(Sc,{title:nc[P.page],handleClick:()=>{P.page===tc.shareCodeEmbedPage?N({page:tc.presentationPage}):(N({page:tc.optionsPage}),(0,u.n)().setParam({panel_page:u.P.export_finish}))}}),j[P.page]]})})}const{Option:id}=N.A,sd=({visible:e,ttamAgeGate:t,setVisible:o,confirmBirthday:a,updateBirthday:r,backToEditAge:s})=>{const l=["web_ttam_January","web_ttam_February","web_ttam_March","web_ttam_April","web_ttam_May","web_ttam_June","web_ttam_July","web_ttam_August","web_ttam_September","web_ttam_October","web_ttam_November","web_ttam_December"],d=new Array((new Date).getFullYear()-1930-1).fill(0).map(((e,t)=>(new Date).getFullYear()-t)),[u,_]=(0,i.useState)(),[h,m]=(0,i.useState)(),[g,v]=(0,i.useState)(),[f,w]=(0,i.useState)(!1),[b,x]=(0,i.useState)(!1),[A,S]=(0,i.useState)(!1),[C,I]=(0,i.useState)(new Array(31).fill(0).map(((e,t)=>t+1)));(0,i.useEffect)((()=>{if(h||u){const e=new Date(u??(new Date).getFullYear(),h?l.indexOf(h)+1:1,0),t=new Array(e.getDate()).fill(0).map(((e,t)=>t+1));I(t),g&&v(t.includes(g)?g:void 0)}}),[h,u]),(0,i.useEffect)((()=>{null!=t&&t.isShow&&e&&(null==t?void 0:t.limitStatus)===p.c.NORMAL&&(new oa).report({action:"show",platform:"ttam"})}),[e]);const E=e=>e.toString().length<2?`0${e}`:`${e}`,T=()=>{u&&h&&g?(a(`${u}-${E(l.indexOf(h)+1)}-${E(g)}`),(new oa).report({action:"confirm",platform:"ttam",age_year:Number(u),age_month:Number(E(l.indexOf(h)+1)),age_date:Number(E(g))})):(()=>{if(!u||!h||!g)w(!u),x(!h),S(!g)})()};return(0,n.jsxs)("div",{children:[(0,n.jsx)(y.A,{visible:(null==t?void 0:t.isShow)&&e&&(null==t?void 0:t.limitStatus)===p.c.NORMAL,autoFocus:!1,focusLock:!0,onCancel:()=>o(!1),className:"lv_modal_ageGate",okText:c.Ay.t("web_ttam_confirm1"),title:c.Ay.t("web_birthdate_confirm"),cancelButtonProps:{style:{display:"none"}},footer:()=>(0,n.jsx)(k.A,{type:"primary",onClick:T,disabled:!(u&&h&&g),children:c.Ay.t("web_ttam_confirm1")}),children:(0,n.jsxs)("div",{className:"lv_modal_ageGate-container",children:[(0,n.jsx)("div",{className:"lv_modal_ageGate-container-context",children:c.Ay.t("web_birthday_privacy1")}),(0,n.jsxs)("div",{children:[(0,n.jsx)(N.A,{dropdownMenuClassName:"dropdownMenu",className:"monthSelector",error:b,placeholder:"Month",onChange:e=>{b&&x(!1),m(e)},children:l.map(((e,t)=>(0,n.jsx)(id,{value:e,children:c.Ay.t(e)},`month_${t}`)))}),(0,n.jsx)(N.A,{dropdownMenuClassName:"dropdownMenu",className:"daySelector",error:A,placeholder:"Day",value:g,onChange:e=>{A&&S(!1),v(e)},children:C.map(((e,t)=>(0,n.jsx)(id,{value:e,children:e},`day_${t}`)))}),(0,n.jsx)(N.A,{dropdownMenuClassName:"dropdownMenu",className:"yearSelector",error:f,placeholder:"Year",onChange:e=>{f&&w(!1),_(e)},children:d.map(((e,t)=>(0,n.jsx)(id,{value:e,children:e},`year_${t}`)))})]})]})}),(null==t?void 0:t.diffStatus)===p.r.DIFFERENT&&(0,n.jsx)($n,{title:c.Ay.t("web_confirm_your_birthday"),content:c.Ay.t("web_birthdate_confirm1",{placeholder0:`${h&&c.Ay.t(h)} ${E(g??0)} ${u}`}),confirmContext:c.Ay.t("web_ttam_confirm1"),cancelContext:c.Ay.t("web_refuse_back"),onOk:()=>{h&&g&&((new ia).report({action:"confirm",type:"birthday_not_match"}),r(`${u}-${E(l.indexOf(h)+1)}-${E(g)}`))},onCancel:()=>{(new ia).report({action:"back_to_edit",type:"birthday_not_match"}),s()},visible:e,onComponentRender:()=>{(new ia).report({action:"show",type:"birthday_not_match"})}}),(null==t?void 0:t.limitStatus)===p.c.BALCK_LIST_24&&(0,n.jsx)($n,{content:c.Ay.t("web_ttam_another_trial4"),confirmContext:c.Ay.t("web_got_it"),onOk:()=>{(new ia).report({action:"confirm",type:"24h_retry"}),o(!1)},visible:e,onComponentRender:()=>{(new ia).report({action:"show",type:"24h_retry"})}}),(null==t?void 0:t.limitStatus)===p.c.BALCK_LIST_FOREVER&&(0,n.jsx)($n,{content:c.Ay.t("web_ttam_another_trial5",{"text-action":e=>(0,n.jsx)("a",{className:"a-target",onClick:()=>{(new ia).report({action:"feedback",type:"ban"}),Ji({type:Wt.AgeFeedback})},children:e})}),confirmContext:c.Ay.t("web_got_it"),onOk:()=>{(new ia).report({action:"confirm",type:"ban"}),o(!1)},visible:e,onComponentRender:()=>{(new ia).report({action:"show",type:"ban"})}}),(null==t?void 0:t.limitStatus)===p.c.UNDER_AGE_13&&(0,n.jsx)($n,{content:c.Ay.t("web_Couldn\u2019t_share_to_TikTok_Ads_Manager"),confirmContext:c.Ay.t("web_got_it"),onOk:()=>{o(!1),(new ia).report({action:"confirm",type:"age"})},visible:e,onComponentRender:()=>{(new ia).report({action:"show",type:"age"})}})]})},ld=({icon:e})=>e,cd=e=>(0,n.jsx)(ld,{platform:u.c.Shopify,icon:(0,n.jsx)(r.CbV,{...e})}),dd=e=>(0,n.jsx)(ld,{platform:u.c.EmbedShopify,icon:(0,n.jsx)(r.qpX,{...e})}),ud=e=>(0,n.jsx)(ld,{platform:u.c.Facebook,icon:(0,n.jsx)(r.$O4,{...e})}),pd=({size:e})=>(0,n.jsx)(ld,{platform:u.c.Facebook,icon:(0,n.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEkAAABICAYAAAC6L9h5AAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAABcISURBVHgBxZx7jB3VecC/78zcu7u216wVCngJcCnBNoTAGtzGqIlYNwghKH7QIgXyh41UMPkn2BWpCH/gJa2EqkbCTiulkFSYpjWK2mIMRCFRyt7QqqWJHzcqEOxQfA1h1yGAF6/tvY+Zc/qd9zlzZ13b2M6xPp25M2dmzvnN9zpnZo1wlsv2kf1D1W6lJgBGU+CXJAJqCfKRhAlIhKilIIChAFnT/maKMJUAn0oENlLGD6SAjYsaV9ThLBaEs1C21/YPZXP71iWcryIYI8RjKCUQCRixUMy2rP1xbo6Dqpk5Rr/riOKppJrXF7yytAlnsJwxSBLM9NyBdRUuVjHgo6kdIB2LwBQApQEoXfMeQPaY/M3kIBDqIMRT83cv3QpnoJx2SE8SnLR/zv3AxIZU8KFYU6AECo8AWZheoyCCYs3RAiqUJgPcmlX5U6dTu04bJAmHKTig4KjBqwFyBcdriATFe7THwenRKN1e1szWdKy848JuECzYOrh76SNwGsppgfTdJZOjAvFJGmAtCZ52At6XxBrFA1gegoNX0B6/rQGVFwEekt3mTfJbG+fv+uyz8DHKx4Ik/c7RgYFNCGKDdcKsxLQi89FRK4JU9DX23CSAjeXmBb1gisKBMbE5y9qPLGismIJTKKcM6eklkzU6e1xqDwsiFbNa4CKTNTkLgUcwmIlcaXAeQ38umxWOLBYQhzI48X7e5JyvIFBNOMlySpC2X/XOaM7ZdhrkEBrzYOAH7QAZYUGk8hDAAAzrsA035nW8MhskXhDaJ9SxKRT87vmNG0/K/E4a0o4rJu4XyDdrH4FGc7wz9QPNaV/uB13wK1Jz9Llo4EIAlStIWNrBcI8we8rhCLutmsnraWACs43n7L5lM5xgOSlIP7jynU10xhgimMFqSMyYmdqHZqBCAsr8oBUkNG0sWAzOA3ceSsClkDCoQ0Aaggdl69xvK03KwQKkrowN7r71hKLfCUP68VXv3C8E38zkQFEPDoMBotEWZnIfOVgmskCbQJ/n4CCghWT8EZmCAuTFhvrZdCpw2tjjg+LfQoLKINI05KRRa/5fjTohSC9/5s3VIJLtamAKEFOAtAhjat6cEsE1IKNNTGgnLBGhgsMMMPSgTcflORBAglJIwhwzELA8qun9Eo7RIGG3c3cuCrFisHFHHT4OpP8a2V/DnO+hhkNqUIxpQe2kFSQHivaRWjNhzI1Lv5T5Y6iuEMCykPSgrSZpSFYLoAQQjwbq2mGYKxmNwTJIoSmKqYoQSwcadzbhVCDtoRm7yLt7aEA1bVZyUAYSgx5AaqBcQ0IFiCtzs1HKYFEq6P/Zc70vQQcAIMiiC8fdICECFf62JihsHQIKIUMzF3OXLmisKc2jUjhOqfDuJgJRQ+VErXmgdqrKXGySpweEQoda7XyFSwuUWQYDtkDBQAIHybfpGXDkZ/J48D2AQGuVKEQ8DM8JocklmqlNtLERSsqsmvTmyOurucDtyqRAO1uFibSIUljjeLXqK83R9q06pszGTkiHK1C5YT4ki/uBDVeBLezTNx6kaw0mcLKFT7Q0jskZEIe7kO36EPJd7wPf+1HQKgBttMn5MCFTAwknCxy5PofakH+6pw4nCqk58vp+lNm0aWXjkgQExnEzA0Y6aVmj6YysK9fNg/7150FK9dkoElJn21vQff7t+IDxUyEkqYlCAcoAYtNu5tBHZnd3ZHalj3Ly2tc2URhfrRa3bHZswzYBUsoENsvmKpolNtSThgx85QKY89AnleacrYLn9kO6YiEw0s7sPycgjnw2kQz8Hvp0AMGmHoKCU7v96MEf1KNrF292aPmeWt5m43SkhkEzYScYVpPkXsFNJMvMjTjMfXoxJIsGSgfCJzpK1PZkp3C06HztdALiSDeYKjPFwQqZ8Dnl99l7CI7d+xKI6S4YM9CaJIIk06UCYe6ko10G/NIFjY1Om3ocN+uwtSCdNfhkzRqRNDE7FGtW+glkqu5/4JM9gLKdh6HzxCTk+8iHTPPgCAZAAGKnnEcDwSBTLorUnsqdl0O67Dw/hsULoO/eK6H1jZ06kgqE2ed1PfM8WgsTG2hjrNhTVz66dvd+qmrhk7UxTDDKi1FbqHbSNAChc6HKbZ+AgbHfja7V+kYTOk8fhHg6YeviHEz0AEIo+o0wbIdRjSLxXZfTQ7ouuv+xe16EfOdBFYn9fayGFh5InHeRNh0jbRpT2hRNsg9f+9N11LgGrnNalKag0RjskG/qUN2mk7UASfXO8wqA3iRAB9SxWDqBdJ2gExkEZG3bhOd2g35Rf4b7wZpMd9sv6J4/i/rQt/4aDVpkBRBUY1YCyclQBarr7HXilQjM10LUOT8g2WnELp0gt9tOZDu2qEr+wUexrP4eRZr/pc61A+kEdQiqbYCY+4kiyE4PWJlGzHniCzDvhdUw94VVdP8hpRndba8pzbElWUaOfHgO9GpLManMerYpTVjVA+nQyHhNiM6oG0RxULSNvEVPecaIzFdaanDpdYMR6+7zzQikl44Bq6+J8prqHjNG/DUdlKg/Wiuq668mAOfrAQzPgznfvglUwksuoPP47qgvyejF5YBEUXushro2o4dGxobkNZzjTlh3VCgHlwP22LyZeNjdyg96J5guG4o6lo0fCH6FfshOThj45Q4fWXB4QA1azdCn28DfeB+0ieXR9WRkCwsOVo2PoRWkvb+JIS0+l67AIQ4URThhBu8z/ArydbSx2Uc30VmLhU77JMtECHKAik0hIuE8n27xvR+C1gY/KF1Y8Ns77YSiUuWPahSlLuoZvJjuEPAmaeYbZEbvuvOyXe9S+0tcO9nGzuVk2OcThwn2fH03BV0GArNsEUXRwMxE5Lj1tQSsiiEBmVocCsFD8oOLw6FWW1R2b/ZMGx9UWoLMi55+/yM30GAvhtmKbFNZuUhJ97k3oP34T0FMHIHuPzUApmcooi6hKckE/f4fM2AzuIlpAAdpvgER9jyPYUXrTBCOfUSanII0vezpUZG3fcNo4qizIv0UGERqK/Kgc6ZQ52NNAogTRVBPeeDbq9zTPpFSWbmEtG4YZu55hiAchuy515SUpxPF4i3CtcHZlk6M6evrUJSbqilIPOuOYKSGRbNDo6560dV3Rjs7Nuwdt5g+BjEke0Oh/rHhcwjQ7T2A8p0HyFTfo6Tz1+p+bOE5kK78jGpvi4Z7O8x88R+UzzJ7wfs7q0lysnuhxjLYB16TMIAWigaF0fKLHaP8sEOVTi1Oz3kvJNkJoackIABiu/ZFZ+Gt4CZeZPTpW39zBEhMt6D98HZKG/a5K1jpPP4ygbqaotnn6JwhB6rvkZug9Wf/Cg6QfHgidA1+W0Pi/rpojot4nOgsgkOcSAutSTSoa4ohEguQ9CkJRE/DZa1hyU0oFz03TZZdRoMe8UOZ+BBaf/odqg9FcLx2UHq5YxfkP3sT5nzvPhpwvzovXbGIrnUhad/buk8CgnOPZ27BAxYhoNAHF30T2JWQ1hAUchqVq9hEkDRD77P+Rv+WWbdOBMOSuTZeZpRUVi6NWnb+7kcESJpXbwbuM3E5Kf4NtB7+l+jcym1Xw+xJoiiBFOZGfmqCJWbn0wQ5eRdXM82rM6SffpghFwaJlECihKNrIEBOejo0AyEcK8mKq3yriQ/I8f5HAKeY5VtQelqUjb9KmvOWOz9ZsSQYXDjHy2aHpLScOykun+giCvv0q3iZPdfcBaDM26tWoNTVviZxFywxNzXYYFlCrnMvvoTMxacKGlALYhMrSpiA0pD2TpCZ6Um0ND3p3GVOpPxkNMgCJOuv0JijewcnStqLYLwK46Wp3t0CDAYEPZHOnITGcVtITn3Dkilts5CEndHPi9f3+IRMDo8GQJKSOglA0bLevl9BmG6qHEj6MwUhnIbyQp/MbxFGNx1twzUz3WcfJS0o47jbAD2QTI12Yb2gSXK5FsscN9cmKOyKYK5BFX2Xmosd0yBQf8HkX3rLV5X2QVmINisOizWvUJPUxXv7FDn1UHvsQ4CSY+AhabX3kOJFLmGAolmVtCt9NkJk0NvxlukTaZLRNjERrz0nSy4mkzum4YiKXIEw3UlNH1ID15temDOp4UxTZq38VmiedqBlkIrHw/wqnE+KABEKq0lN6lBNwcHQLxlNUtcyb0rQ3sS0w8LTlb9ZR2tS8P6dT7yjBoWDOvFkiy+lth2AwnxJSwI6CQ2/aSNsK5cHgGaA7zsA3jSxMNAIp7tGXMsjzIHEEn9GkJqmhQ7nutNSqzomcgU1M5J0SKPaRsy+6KpctQHW1YI+8uQv/cQ1S5YtpXznDzRUzMzCvBUb7WzEaxGgz5ImnevOz8f3QHERzkuZJoF54MZdYDFIuG9fCsI+0ikAdhquQwpMIHKgSdfVQtXUqVSKORYWJsyxTLdjRjtJus9/P2ra9/WHgF14vvZtaLUyzJM0IJllV+/7k+jc7gsvU/vwIYSwyjQp9jPavyYFWEmPCEynrCYdiLRFaUzXQ0hiUGq/EVEpQiI/VMmUQIV8S0qdTqSQQe/ZRdMPr004OA8GnthCWnKThqk0z+dMMuqmK5bCwPe2ECi/PJw9X6fZ/8/Ba51dc7KOnB8fkv/aA4ra1Cv4c+2TWLepn6R5oszMkpn1R2jEvHBD72tUmD9CvmaemeTKY9XcJ7jMPlzdqfajfwFsySJgFyzUzYcvgL6xB2l+to407Ycg3v21Zr3oU+S3LiOzvCYaLp84SG9fvmvAeP+jvUw4AY/Ogji029+hj8KgvZ3jqfysqaNbwutKbdXT1M5aKEAiCBzMgCtAkm2Pekhy0FDlPs+U39yEiwmdaWht/DL0P/YtB0qdt/ACqN67Fo5X+MQktNZvNHO9fjcwtO+6VKGNwYHgnA/Bg7H5XW8u5OHEvykVaSjs3W63KZJsSpBpKCEzUT5FaoTcrnBfp0YqQksqeh6CyvikyAn4AB2XfZbSL9TY+CEa7Fe/DNmPXoATLVl9HGa+9CUVJb2ZFR2+eYtiJsK2O/Hk1cIxvkuIEkDe9AYbY3WlSQsa9anpG5Y3SFNGlYklQpua0yJjajYdKGineG8S4Lxhfavzqa7aJxb0T3XIfEUiFW1qAtpbvg7dl74PlRtvheT6GwDnxi8UZMqQ/2ScnPRz5IN26c5gRcMQYUaO4L8ioaQh0qQPTEKLEGuU/W36imXTI6zLQ275FpNsB2VNGpICBeG3fgVgljzTCeOHk65T7HeGAc+ZTy8/poPRBpvRhJuc+d6dkP+C3pd9k8695HLSNAKVkQm/+y7JhA9WykKMrzQroio7F2GCqG/EFl8cgD6mwaGehvi2RfUv1ipHeyqC1J2fbU277LF4KoWzzzudc2OQ/2pf9L6cXbaI5lnxq50oxyvkq/Z3/g4tvHWFEROdbXs7NrvEIWnzTF9Y+AEny66Mbpvv3Avu8xvUSaoA6M0SfO/BahpldnW7R5UFzzam6B1KXfsT1F+f21mC3LZ+xvoi+cGIlD662GsvR7ep3n6PNjk6Bv2BDATbc8zvAb8fZftqQSoY9QfJB0qhYGNysAxcrkR1uvLzBUhv6HmgGrcwzzZMB4obLnOvL2h8rRlBUof7xA7dKQMkxV5ADpxw+/n0Qcjf9JqTLLoOKjd9UUNSwmKxsObYbeYgooLGdG2BqmuAFvlgVADJtcgcjGUqdUnvuoUgjbp+8L1vg9jb1NqDdrJu/BaGTryHmDzjKTeeENJXf+/8Nxgk91HY7nef6adhbbQrweC3FjF1ECrLbnXXSq+4nsL9EeCTrweaUJCy65Og/V1Br8nuHGYWDjDsOqR3roa+B9ZH+zrffJrmd2+77zzD/MdnV9bx+6hGc8bmYOPP7y6F9FeNg62HrqPXqAmOOgAMy0EVBiwOH6SnPw+Si/zqY7p4ObBPLATRPUIJ58FgoNgL3f39RGBe1tSqhXvq752BzR+E5MpPQ99DD0Llj2+LAGXbXoDu1h1B8LEgQq1hAaTI6W559OCP62HLqBxaNzKUppX91JEhnzKgr51DRx8BzVVwYBAG1v0NsPMvh7LCD/6SVoYJ2MwRmnUc8QeEKCwGiHhRgAsXvZGgq9UbiqLsvIXl9/nlWzBzl/xGNNUpg5KqXpLhNB/jFZ1CWNHODrQWpU2KGSusPyqFJMv0fb8/RoPf5J5CEZDVAAsr0FopfTd+hUzvDvhtlOyfn4HO329T7+WEc6BVckcSkBaRyzWsVGfewrQxkEh1HxlsfG0svGYppEMbRoYqom8PRdaa0yIHKjYTDCEF6UH66Zuhcu0dwM79FJyNkr+6h153b4V896saAjeLeRKC0pwK+fYqvdGm3/a4yrNcJCJrTJvzGg9fWrw2znbT6QeWj9LRcZdAhj4jNY5TOlGGOqcMc6ggmkpIbHgEEhLsm0fZ8AXqEDP1yRTRIlNtTetU6YNJEO9PQn5gH+T//e+08vkeeWoypYw6mlc0CFlzXaPczowWSVDCAlLaoyAJTNbMb4w9e8KQFKgHr99M17g/+lMicqRonKeqEZ1JloIqS9rKjlm/xE2dBzWJTrL1tqplwmnePGGbLtilDLlDN+8aCFlFQ6JtzHQNXV2LPAkgpRoSplsGG3+5oaS3x/+LgKy/b6wiOqsEw5o1NwkGbeQJfRLDOEvvea1TAFQ8JrNmC0iKvJZb4pbaKvRDyOw9glUK0PeUqwEinF/KfMjOZU2mHn8X4N7gkrNOx2CWclxNkuXQ2PJaWkn2yGgn/Y/ybxUWR7nAuYvimnwIAmYB5EAF2qQ0CGLNsvukZklNkjlkR2oUmtVe6pTUpk5qpKI1q53qY0rLEmWKQmmSyoanMoSlCxqbm3CqkGSZ/uvPjRKecbR5ioRg85UwAga1wPjqWLybCe/CwrH7HJgSs+MekjY50LUCRBeXZichWSgtCSjxv6UYnyWEduy0PEt+6G+P++emJwRJliOPfX4DpjQBtg78eJCs+WHJncw7O1W4BiTCnEgUNCiszX7MtRaJYDIcgWpJMNSRGaYh2d8d46+UQ1eTz43zGk+cnj8KtGX6W6NjLMVNDlSYQ4VwWADE3qWgWT55FBCtffXAAW+GudATeuvACZBQmiTcewOhIJHekyhIMwZay0KSzptSAV6lfOgfx+AEyklBkuXIk3+4geZWj7mk0mXd6OsiFIQYmF2rCBcLAfz3mCa7tqCwqE2FKKc0ikAJCUu9YEHzjQeabzWYBiUhdasS0sZ5O585M3+obMvhbV9YnaTwJA18KDK1KPMuaFHxjm7KAYEa+WNCTdpL0gLrvDNuVnEtJFr8axutUh/DUH0M5ccwDpJopVPQrqwZfOXFOpxEOSVIssxsv7lG64rjLj0I/VDof45bRO9qhS0WXtE/FXMlY24SlGhzA8kILUrKr4TgmDK3ZnI0WTFQrzfhJAuDUywDa15stqG7lDOxRTtyFk9bwunMrILRckuvsHjRLQwYhVUKTHySC0GOqGYmVbFlbiVZeiqAZDllTQrL4R/etDpF9pjSqtN11WLexIV5GeKdts+8Zc2VT9J+iStNwpZoiqNw9+B3XqnDxyinBZItR//t5jFKONeSmdXsPiFKbKkk+8ZCIiWEiH2WhaNWaoWXrgakQClIyjdNQSffkh3p37xgc/2U/hOXsJxWSLLMjN9c44yto0GvpZ81tTPMqsscUOjkw6IceNFpFwCF2tQRU7xNcI6mmxeMfXw4rntwBsuRl29Zl5BmkVaMxqBm6UkxEhpNEnaaYnOkAiTs8jpvix1zq7AV7z59cMKunfEitStP2Cit+2lgs/WkmEIYnyTsVMT7oynKuhsKTF+2FdecfjDFrp31QtBG6fnLD7prxOIaTvkWdYRyLjJPC0glnaKptCmDBs/EAVIp+s3rc4/ObeKaZ88omLD8H53d4v5U70rAAAAAAElFTkSuQmCC",width:e,height:e})}),_d=e=>(0,n.jsx)(ld,{platform:u.c.YouTube,icon:(0,n.jsx)(r.Htw,{...e})}),hd=e=>(0,n.jsx)(ld,{platform:u.c.YouTube,icon:(0,n.jsx)(r.Htw,{...e})});function md(e){const{uid:t}=e||{};return{tiktok:(0,i.useMemo)((()=>({isShow:!0,logo:(0,n.jsx)(r.Dp6,{size:44,name:"icon-thirdpart-tiktok"}),logoName:c.Ay.t("web_embedcode_text_tiktok"),platformName:u.c.TikTok,platformKey:p.P.TT_USER_INFO,authUrl:Qr({uid:t})})),[t]),ttam:(0,i.useMemo)((()=>({isShow:!0,logo:(0,n.jsx)(r.xT5,{size:44,name:"icon-thirdpart-tiktok"}),logoName:c.Ay.t("web_embedcode_text_tiktok_ads_manager"),platformName:u.c.TTAM,platformKey:p.P.TT_USER_INFO,platformContent:c.Ay.t("web_sharereview_text_tiktok_ads_manager"),authUrl:Zr({uid:t})})),[t]),youtube:(0,i.useMemo)((()=>({isShow:!0,icon:(0,n.jsx)(Wn,{size:32,name:"icon-logo-youtube",className:"youtube-logo"}),logo:(0,n.jsx)(Wn,{size:44,name:"icon-logo-youtube",className:"youtube-logo"}),logoName:c.Ay.t("web_embedcode_text_youtube"),youtubeShareType:u.f.YouTube,platformName:u.c.YouTube,platformKey:p.P.TT_USER_INFO,platformContent:c.Ay.t("web_shareYouTube_title_share_to_YouTube"),authUrl:Xr({uid:t})})),[t]),ytbShorts:(0,i.useMemo)((()=>({isShow:!0,icon:(0,n.jsx)(Hn,{size:32}),logo:(0,n.jsx)(Hn,{size:44}),logoName:c.Ay.t("web_ytb_ins_text_ytb_cut",{},"YouTube Shorts"),youtubeShareType:u.f.YouTubeShorts,platformName:u.c.YouTube,platformKey:p.P.TT_USER_INFO,platformContent:c.Ay.t("web_ytb_ins_title_share",{},"Share to YouTube Shorts"),authUrl:Xr({uid:t})})),[t]),fbGroups:(0,i.useMemo)((()=>({isShow:!0,icon:(0,n.jsx)(Yn,{size:32}),logo:(0,n.jsx)(Yn,{size:44}),logoName:c.Ay.t("web_postfb_text_share_facebook_group",{},"Facebook Group"),platformName:u.c.Facebook,facebookShareType:u.d.GROUP,platformKey:p.P.FACEBOOK_USER_INFO,platformContent:c.Ay.t("web_postfb_text_post_facebook_group",{},"Share to Facebook Group"),authUrl:ei({uid:t})})),[t]),fbPages:(0,i.useMemo)((()=>({isShow:!0,icon:(0,n.jsx)(Jn,{size:32}),logo:(0,n.jsx)(Jn,{size:44}),logoName:c.Ay.t("web_postfb_text_share_facebook_page",{},"Facebook Page"),platformName:u.c.Facebook,facebookShareType:u.d.PAGE,platformKey:p.P.FACEBOOK_USER_INFO,platformContent:c.Ay.t("web_postfb_text_post_facebook_page",{},"Share to Facebook Page"),authUrl:ei({uid:t})})),[t]),reels:(0,i.useMemo)((()=>({isShow:!0,icon:(0,n.jsx)(pd,{size:32}),logo:(0,n.jsx)(pd,{size:44}),logoName:c.Ay.t("web_ytb_ins_text_ins_reel",{},"Instagram Reels"),platformName:u.c.Facebook,facebookShareType:u.d.INSTAGRAM,platformKey:p.P.FACEBOOK_USER_INFO,platformContent:c.Ay.t("web_ytb_ins_title_upload_ins",{},"Share to Instagram Reels"),authUrl:ei({uid:t})})),[t]),instagram:(0,i.useMemo)((()=>({isShow:!0,icon:(0,n.jsx)(pd,{size:32}),logo:(0,n.jsx)(pd,{size:44}),logoName:c.Ay.t("// TODO",{},"Instagram"),platformName:u.c.Facebook,facebookShareType:u.d.INSTAGRAM,platformKey:p.P.FACEBOOK_USER_INFO,platformContent:c.Ay.t("web_share_image_text_shared_ig",{},"Share to Instagram"),authUrl:ei({uid:t})})),[t]),shopify:(0,i.useMemo)((()=>({isShow:!1,icon:(0,n.jsx)(ud,{size:32}),logo:(0,n.jsx)(ud,{size:44}),logoName:c.Ay.t("// TODO",{},"Shopify"),platformName:u.c.Shopify,platformKey:u.c.Shopify,platformContent:c.Ay.t("web_shopify_text_back_sp",{},"Export to Shopify"),authUrl:""})),[t])}}var gd=(e=>(e.public="public",e.followers="followers",e.friends="friends",e.private="private",e))(gd||{}),vd=(e=>(e.comment="comment",e.duet="duet",e.stitch="stitch",e))(vd||{}),fd=(e=>(e.public="public",e.private="private",e.unlisted="unlisted",e))(fd||{});const yd={[u.q.FacebookPage]:0,[u.q.FacebookGroup]:1,[u.q.Instagram]:2};function wd(e){switch(e){case u.q.FacebookGroup:case u.q.FacebookPage:return{selectedAccountId:"",title:"",description:""};case u.q.InstagramReels:return{selectedAccountId:"",description:""};case u.q.YouTube:case u.q.YouTubeShorts:return{selectedAccountId:"",title:"",description:"",cover:"",tags:[],privacyLevel:fd.public};case u.q.TikTok:return{selectedAccountId:"",title:"",privacyLevel:void 0,disableComment:!0,disableDuet:!0,disableStitch:!0,isDiscloseVideoContent:!1,isPromoteOwnBrand:!1,isPromoteOtherBrand:!1};case u.q.TTAM:return{selectedAccountId:[]};default:return}}u.q.YouTube,u.q.YouTubeShorts;const bd=async()=>{try{return await p.u.getShareUserInfo({platforms:["TikTok","YouTube","Facebook"]})}catch(e){return console.error("==fetchShareUserInfo error==",e),null}};class xd{constructor(){bt(this,"accounts",[]),bt(this,"currentAccountId",""),bt(this,"_accountBindingListener",null),bt(this,"_unbindListeners",{})}get currentAccount(){return this.accounts.find((e=>e.id===this.currentAccountId))}bindAccount(e){const{popupHeight:t,popupWidth:o,iTop:a,iLeft:n}={popupWidth:800,popupHeight:750,iTop:(window.screen.height-30-750)/2,iLeft:(window.screen.width-800)/2};window.open(this.authUrl,"name=thirdparty_share_auth",`fullscreen=1,width=${o},height=${t},top=${a},left=${n}`),this._accountBindingListener&&this._resetAccountBindingListener(),this._accountBindingListener=async t=>{if(t.key!==p.a.THIRDPARTY_SHARE_AUTH||!t.newValue)return;const{status:o}=JSON.parse(t.newValue);if(window.localStorage.removeItem(p.a.THIRDPARTY_SHARE_AUTH),this._resetAccountBindingListener(),"success"===o){const t=await this.fetchPlatformAccounts();t.forEach((e=>{this.addPlatformAccount(e)})),e(o,t)}else e(o,[])},window.addEventListener("storage",this._accountBindingListener)}async unbindAccount(e=this.currentAccountId){const t=await this.unbindPlatformAccount(e);return t&&(this._removePlatformAccount(e),(this._unbindListeners[e]??[]).forEach((e=>e.apply(this)))),t?e:""}validateIfBind(){return this.accounts.length>0}listenUnbind(e=this.currentAccountId,t){this._unbindListeners[e]||(this._unbindListeners[e]=[]),this._unbindListeners[e].push(t)}async initPlatformAccount(){const e=await this.fetchPlatformAccounts();this.accounts=e,e.length>0&&(this.currentAccountId=e[0].id)}addPlatformAccount(e){e&&(this.currentAccountId=e.id,!this.accounts.some((t=>t.id===e.id))&&this.accounts.push(e))}addPlatformAccounts(e){Array.isArray(e)&&(this.currentAccountId=e[0].id,e.forEach((e=>{this.accounts.some((t=>t.id===e.id))||this.accounts.push(e)})))}changeAccount(e){this.accounts.some((t=>t.id===e))&&e!==this.currentAccountId&&(this.currentAccountId=e)}_removePlatformAccount(e){e&&this.accounts.some((t=>t.id===e))&&(this.accounts=this.accounts.filter((t=>t.id!==e)),e===this.currentAccountId&&(this.currentAccountId=""))}_resetAccountBindingListener(){this._accountBindingListener&&(window.removeEventListener("storage",this._accountBindingListener),this._accountBindingListener=null)}}const kd=(e,t)=>`${e}?${Object.entries(t).map((([e,t])=>`${e}=${t}`)).join("&")} `,Ad=e=>q()("sha256").update(e).digest("hex"),Sd=()=>{var e,t;try{const o=JSON.parse(window.__userInfoStringify);return null==(t=null==(e=null==o?void 0:o.data)?void 0:e.user_info)?void 0:t.user_id}catch{return}};var Cd;class Id extends xd{constructor(){super(...arguments),bt(this,"accounts",[]),bt(this,"authUrl",kd("https://www.facebook.com/v17.0/dialog/oauth",{response_type:"code",state:null==(Cd=Ad(Sd()??""))?void 0:Cd.slice(15,47),display:"popup",client_id:(0,Y.i)()?"1245762546309504":"284495260783513",redirect_uri:kd(`${location.origin}/lv/v1/user/web/third_party_platform_authorization`,{platform:"Facebook",auth_type:"rerequest",scope:["public_profile","pages_show_list","pages_read_engagement","pages_manage_posts","publish_to_groups","instagram_content_publish","instagram_basic","business_management"].join(",")})}))}async unbindPlatformAccount(){try{return await p.u.shareUserUnbind({platform:u.c.Facebook}),!0}catch{return!1}}async fetchPlatformAccounts(){const e=await bd(),{facebook_user_info:t}=e??{},{id:o="",name:a="",picture:n=""}=t??{};return o?[{id:o,name:a,picture:n,avatar:n}]:[]}}let Ed;const Td=()=>(Ed||(Ed=new Id),Ed);var Pd;class Nd extends xd{constructor(){super(...arguments),bt(this,"accounts",[]),bt(this,"authUrl",kd("https://www.tiktok.com/v2/auth/authorize",{client_key:(0,Y.i)()?"awila1aef2sl3rob":"awov7tein3o23v2a",scope:"user.info.basic%2Cvideo.publish",response_type:"code",state:JSON.stringify({state_id:null==(Pd=Ad(Sd()??""))?void 0:Pd.slice(15,47),platform:"TikTok"}),redirect_uri:`${location.origin}/lv/v1/user/web/third_party_platform_authorization`}))}async unbindPlatformAccount(){try{return await p.u.shareUserUnbind({platform:u.c.TikTok}),!0}catch{return!1}}async fetchPlatformAccounts(){const e=await bd(),{tt_user_info:t}=e??{};return t?[{...t,id:t.creator_username,name:t.creator_nickname,avatar:t.creator_avatar_url}]:[]}}let jd;const Rd=()=>(jd||(jd=new Nd),jd);var Ld;class Od extends xd{constructor(){super(...arguments),bt(this,"accounts",[]),bt(this,"authUrl",`https://accounts.google.com/o/oauth2/auth?access_type=offline&include_granted_scopes=true&client_id=${(0,Y.i)()?"1093504901008-cmpv0g4d9k4fd1g6aas7n2bpra6mulu5.apps.googleusercontent.com":"87571557143-g65pmu4h9fkv509ju9oa30vmqsckhgfo.apps.googleusercontent.com"}&prompt=consent&redirect_uri=https://${window.location.host}/lv/v1/user/web/third_party_platform_authorization?platform=YouTube&response_type=code&scope=https://www.googleapis.com/auth/userinfo.profile+https://www.googleapis.com/auth/userinfo.email+https://www.googleapis.com/auth/youtube.upload&state=${null==(Ld=Ad(Sd()??""))?void 0:Ld.slice(15,47)}`)}async unbindPlatformAccount(){try{return await p.u.shareUserUnbind({platform:u.c.YouTube}),!0}catch{return!1}}async fetchPlatformAccounts(){const e=await bd(),{youtube_user_info:t}=e??{};return t?[{...t,id:(null==t?void 0:t.email)??"",avatar:(null==t?void 0:t.picture)??""}]:[]}}let Fd;const Dd=()=>(Fd||(Fd=new Od),Fd);var Ud;class Md extends xd{constructor(){super(...arguments),bt(this,"accounts",[]),bt(this,"authUrl",`https://business-api.tiktok.com/portal/auth?app_id=7135340830805458946&redirect_key=${(0,Y.i)()?"capcut_web_boe":(0,Y.I)()?"capcut_web_ppe":"capcut_web_prod"}&state=${null==(Ud=Ad(Sd()??""))?void 0:Ud.slice(15,47)}&redirect_uri=https%3A%2F%2F${window.location.host}%2Flv%2Fv1%2Fuser%2Fweb%2Fthird_party_platform_authorization%3Fplatform%3DTTAM&rid=8azjb60a0ij`)}async fetchPlatformAccounts(){var e;try{const t=await p.v.getTt4bAccounts();return(null==(e=null==t?void 0:t.accounts)?void 0:e.length)>0?t.accounts.map((e=>({...e,id:e.tt4b_uid,avatar:"",name:e.display_name}))):[]}catch(t){return console.error("======\u62c9\u53d6 TTAM \u8d26\u53f7\u5931\u8d25======",t),[]}}async unbindPlatformAccount(e){try{return await p.v.unbindTt4bAccounts({tt4b_uid:e}),!0}catch(t){return console.error("======\u89e3\u7ed1 TTAM \u8d26\u53f7\u5931\u8d25======",t),!1}}}let Bd;const zd=()=>(Bd||(Bd=new Md),Bd),Gd=({size:e})=>(0,n.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEkAAABICAYAAAC6L9h5AAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAABcISURBVHgBxZx7jB3VecC/78zcu7u216wVCngJcCnBNoTAGtzGqIlYNwghKH7QIgXyh41UMPkn2BWpCH/gJa2EqkbCTiulkFSYpjWK2mIMRCFRyt7QqqWJHzcqEOxQfA1h1yGAF6/tvY+Zc/qd9zlzZ13b2M6xPp25M2dmzvnN9zpnZo1wlsv2kf1D1W6lJgBGU+CXJAJqCfKRhAlIhKilIIChAFnT/maKMJUAn0oENlLGD6SAjYsaV9ThLBaEs1C21/YPZXP71iWcryIYI8RjKCUQCRixUMy2rP1xbo6Dqpk5Rr/riOKppJrXF7yytAlnsJwxSBLM9NyBdRUuVjHgo6kdIB2LwBQApQEoXfMeQPaY/M3kIBDqIMRT83cv3QpnoJx2SE8SnLR/zv3AxIZU8KFYU6AECo8AWZheoyCCYs3RAiqUJgPcmlX5U6dTu04bJAmHKTig4KjBqwFyBcdriATFe7THwenRKN1e1szWdKy848JuECzYOrh76SNwGsppgfTdJZOjAvFJGmAtCZ52At6XxBrFA1gegoNX0B6/rQGVFwEekt3mTfJbG+fv+uyz8DHKx4Ik/c7RgYFNCGKDdcKsxLQi89FRK4JU9DX23CSAjeXmBb1gisKBMbE5y9qPLGismIJTKKcM6eklkzU6e1xqDwsiFbNa4CKTNTkLgUcwmIlcaXAeQ38umxWOLBYQhzI48X7e5JyvIFBNOMlySpC2X/XOaM7ZdhrkEBrzYOAH7QAZYUGk8hDAAAzrsA035nW8MhskXhDaJ9SxKRT87vmNG0/K/E4a0o4rJu4XyDdrH4FGc7wz9QPNaV/uB13wK1Jz9Llo4EIAlStIWNrBcI8we8rhCLutmsnraWACs43n7L5lM5xgOSlIP7jynU10xhgimMFqSMyYmdqHZqBCAsr8oBUkNG0sWAzOA3ceSsClkDCoQ0Aaggdl69xvK03KwQKkrowN7r71hKLfCUP68VXv3C8E38zkQFEPDoMBotEWZnIfOVgmskCbQJ/n4CCghWT8EZmCAuTFhvrZdCpw2tjjg+LfQoLKINI05KRRa/5fjTohSC9/5s3VIJLtamAKEFOAtAhjat6cEsE1IKNNTGgnLBGhgsMMMPSgTcflORBAglJIwhwzELA8qun9Eo7RIGG3c3cuCrFisHFHHT4OpP8a2V/DnO+hhkNqUIxpQe2kFSQHivaRWjNhzI1Lv5T5Y6iuEMCykPSgrSZpSFYLoAQQjwbq2mGYKxmNwTJIoSmKqYoQSwcadzbhVCDtoRm7yLt7aEA1bVZyUAYSgx5AaqBcQ0IFiCtzs1HKYFEq6P/Zc70vQQcAIMiiC8fdICECFf62JihsHQIKIUMzF3OXLmisKc2jUjhOqfDuJgJRQ+VErXmgdqrKXGySpweEQoda7XyFSwuUWQYDtkDBQAIHybfpGXDkZ/J48D2AQGuVKEQ8DM8JocklmqlNtLERSsqsmvTmyOurucDtyqRAO1uFibSIUljjeLXqK83R9q06pszGTkiHK1C5YT4ki/uBDVeBLezTNx6kaw0mcLKFT7Q0jskZEIe7kO36EPJd7wPf+1HQKgBttMn5MCFTAwknCxy5PofakH+6pw4nCqk58vp+lNm0aWXjkgQExnEzA0Y6aVmj6YysK9fNg/7150FK9dkoElJn21vQff7t+IDxUyEkqYlCAcoAYtNu5tBHZnd3ZHalj3Ly2tc2URhfrRa3bHZswzYBUsoENsvmKpolNtSThgx85QKY89AnleacrYLn9kO6YiEw0s7sPycgjnw2kQz8Hvp0AMGmHoKCU7v96MEf1KNrF292aPmeWt5m43SkhkEzYScYVpPkXsFNJMvMjTjMfXoxJIsGSgfCJzpK1PZkp3C06HztdALiSDeYKjPFwQqZ8Dnl99l7CI7d+xKI6S4YM9CaJIIk06UCYe6ko10G/NIFjY1Om3ocN+uwtSCdNfhkzRqRNDE7FGtW+glkqu5/4JM9gLKdh6HzxCTk+8iHTPPgCAZAAGKnnEcDwSBTLorUnsqdl0O67Dw/hsULoO/eK6H1jZ06kgqE2ed1PfM8WgsTG2hjrNhTVz66dvd+qmrhk7UxTDDKi1FbqHbSNAChc6HKbZ+AgbHfja7V+kYTOk8fhHg6YeviHEz0AEIo+o0wbIdRjSLxXZfTQ7ouuv+xe16EfOdBFYn9fayGFh5InHeRNh0jbRpT2hRNsg9f+9N11LgGrnNalKag0RjskG/qUN2mk7UASfXO8wqA3iRAB9SxWDqBdJ2gExkEZG3bhOd2g35Rf4b7wZpMd9sv6J4/i/rQt/4aDVpkBRBUY1YCyclQBarr7HXilQjM10LUOT8g2WnELp0gt9tOZDu2qEr+wUexrP4eRZr/pc61A+kEdQiqbYCY+4kiyE4PWJlGzHniCzDvhdUw94VVdP8hpRndba8pzbElWUaOfHgO9GpLManMerYpTVjVA+nQyHhNiM6oG0RxULSNvEVPecaIzFdaanDpdYMR6+7zzQikl44Bq6+J8prqHjNG/DUdlKg/Wiuq668mAOfrAQzPgznfvglUwksuoPP47qgvyejF5YBEUXushro2o4dGxobkNZzjTlh3VCgHlwP22LyZeNjdyg96J5guG4o6lo0fCH6FfshOThj45Q4fWXB4QA1azdCn28DfeB+0ieXR9WRkCwsOVo2PoRWkvb+JIS0+l67AIQ4URThhBu8z/ArydbSx2Uc30VmLhU77JMtECHKAik0hIuE8n27xvR+C1gY/KF1Y8Ns77YSiUuWPahSlLuoZvJjuEPAmaeYbZEbvuvOyXe9S+0tcO9nGzuVk2OcThwn2fH03BV0GArNsEUXRwMxE5Lj1tQSsiiEBmVocCsFD8oOLw6FWW1R2b/ZMGx9UWoLMi55+/yM30GAvhtmKbFNZuUhJ97k3oP34T0FMHIHuPzUApmcooi6hKckE/f4fM2AzuIlpAAdpvgER9jyPYUXrTBCOfUSanII0vezpUZG3fcNo4qizIv0UGERqK/Kgc6ZQ52NNAogTRVBPeeDbq9zTPpFSWbmEtG4YZu55hiAchuy515SUpxPF4i3CtcHZlk6M6evrUJSbqilIPOuOYKSGRbNDo6560dV3Rjs7Nuwdt5g+BjEke0Oh/rHhcwjQ7T2A8p0HyFTfo6Tz1+p+bOE5kK78jGpvi4Z7O8x88R+UzzJ7wfs7q0lysnuhxjLYB16TMIAWigaF0fKLHaP8sEOVTi1Oz3kvJNkJoackIABiu/ZFZ+Gt4CZeZPTpW39zBEhMt6D98HZKG/a5K1jpPP4ygbqaotnn6JwhB6rvkZug9Wf/Cg6QfHgidA1+W0Pi/rpojot4nOgsgkOcSAutSTSoa4ohEguQ9CkJRE/DZa1hyU0oFz03TZZdRoMe8UOZ+BBaf/odqg9FcLx2UHq5YxfkP3sT5nzvPhpwvzovXbGIrnUhad/buk8CgnOPZ27BAxYhoNAHF30T2JWQ1hAUchqVq9hEkDRD77P+Rv+WWbdOBMOSuTZeZpRUVi6NWnb+7kcESJpXbwbuM3E5Kf4NtB7+l+jcym1Xw+xJoiiBFOZGfmqCJWbn0wQ5eRdXM82rM6SffpghFwaJlECihKNrIEBOejo0AyEcK8mKq3yriQ/I8f5HAKeY5VtQelqUjb9KmvOWOz9ZsSQYXDjHy2aHpLScOykun+giCvv0q3iZPdfcBaDM26tWoNTVviZxFywxNzXYYFlCrnMvvoTMxacKGlALYhMrSpiA0pD2TpCZ6Um0ND3p3GVOpPxkNMgCJOuv0JijewcnStqLYLwK46Wp3t0CDAYEPZHOnITGcVtITn3Dkilts5CEndHPi9f3+IRMDo8GQJKSOglA0bLevl9BmG6qHEj6MwUhnIbyQp/MbxFGNx1twzUz3WcfJS0o47jbAD2QTI12Yb2gSXK5FsscN9cmKOyKYK5BFX2Xmosd0yBQf8HkX3rLV5X2QVmINisOizWvUJPUxXv7FDn1UHvsQ4CSY+AhabX3kOJFLmGAolmVtCt9NkJk0NvxlukTaZLRNjERrz0nSy4mkzum4YiKXIEw3UlNH1ID15temDOp4UxTZq38VmiedqBlkIrHw/wqnE+KABEKq0lN6lBNwcHQLxlNUtcyb0rQ3sS0w8LTlb9ZR2tS8P6dT7yjBoWDOvFkiy+lth2AwnxJSwI6CQ2/aSNsK5cHgGaA7zsA3jSxMNAIp7tGXMsjzIHEEn9GkJqmhQ7nutNSqzomcgU1M5J0SKPaRsy+6KpctQHW1YI+8uQv/cQ1S5YtpXznDzRUzMzCvBUb7WzEaxGgz5ImnevOz8f3QHERzkuZJoF54MZdYDFIuG9fCsI+0ikAdhquQwpMIHKgSdfVQtXUqVSKORYWJsyxTLdjRjtJus9/P2ra9/WHgF14vvZtaLUyzJM0IJllV+/7k+jc7gsvU/vwIYSwyjQp9jPavyYFWEmPCEynrCYdiLRFaUzXQ0hiUGq/EVEpQiI/VMmUQIV8S0qdTqSQQe/ZRdMPr004OA8GnthCWnKThqk0z+dMMuqmK5bCwPe2ECi/PJw9X6fZ/8/Ba51dc7KOnB8fkv/aA4ra1Cv4c+2TWLepn6R5oszMkpn1R2jEvHBD72tUmD9CvmaemeTKY9XcJ7jMPlzdqfajfwFsySJgFyzUzYcvgL6xB2l+to407Ycg3v21Zr3oU+S3LiOzvCYaLp84SG9fvmvAeP+jvUw4AY/Ogji029+hj8KgvZ3jqfysqaNbwutKbdXT1M5aKEAiCBzMgCtAkm2Pekhy0FDlPs+U39yEiwmdaWht/DL0P/YtB0qdt/ACqN67Fo5X+MQktNZvNHO9fjcwtO+6VKGNwYHgnA/Bg7H5XW8u5OHEvykVaSjs3W63KZJsSpBpKCEzUT5FaoTcrnBfp0YqQksqeh6CyvikyAn4AB2XfZbSL9TY+CEa7Fe/DNmPXoATLVl9HGa+9CUVJb2ZFR2+eYtiJsK2O/Hk1cIxvkuIEkDe9AYbY3WlSQsa9anpG5Y3SFNGlYklQpua0yJjajYdKGineG8S4Lxhfavzqa7aJxb0T3XIfEUiFW1qAtpbvg7dl74PlRtvheT6GwDnxi8UZMqQ/2ScnPRz5IN26c5gRcMQYUaO4L8ioaQh0qQPTEKLEGuU/W36imXTI6zLQ275FpNsB2VNGpICBeG3fgVgljzTCeOHk65T7HeGAc+ZTy8/poPRBpvRhJuc+d6dkP+C3pd9k8695HLSNAKVkQm/+y7JhA9WykKMrzQroio7F2GCqG/EFl8cgD6mwaGehvi2RfUv1ipHeyqC1J2fbU277LF4KoWzzzudc2OQ/2pf9L6cXbaI5lnxq50oxyvkq/Z3/g4tvHWFEROdbXs7NrvEIWnzTF9Y+AEny66Mbpvv3Avu8xvUSaoA6M0SfO/BahpldnW7R5UFzzam6B1KXfsT1F+f21mC3LZ+xvoi+cGIlD662GsvR7ep3n6PNjk6Bv2BDATbc8zvAb8fZftqQSoY9QfJB0qhYGNysAxcrkR1uvLzBUhv6HmgGrcwzzZMB4obLnOvL2h8rRlBUof7xA7dKQMkxV5ADpxw+/n0Qcjf9JqTLLoOKjd9UUNSwmKxsObYbeYgooLGdG2BqmuAFvlgVADJtcgcjGUqdUnvuoUgjbp+8L1vg9jb1NqDdrJu/BaGTryHmDzjKTeeENJXf+/8Nxgk91HY7nef6adhbbQrweC3FjF1ECrLbnXXSq+4nsL9EeCTrweaUJCy65Og/V1Br8nuHGYWDjDsOqR3roa+B9ZH+zrffJrmd2+77zzD/MdnV9bx+6hGc8bmYOPP7y6F9FeNg62HrqPXqAmOOgAMy0EVBiwOH6SnPw+Si/zqY7p4ObBPLATRPUIJ58FgoNgL3f39RGBe1tSqhXvq752BzR+E5MpPQ99DD0Llj2+LAGXbXoDu1h1B8LEgQq1hAaTI6W559OCP62HLqBxaNzKUppX91JEhnzKgr51DRx8BzVVwYBAG1v0NsPMvh7LCD/6SVoYJ2MwRmnUc8QeEKCwGiHhRgAsXvZGgq9UbiqLsvIXl9/nlWzBzl/xGNNUpg5KqXpLhNB/jFZ1CWNHODrQWpU2KGSusPyqFJMv0fb8/RoPf5J5CEZDVAAsr0FopfTd+hUzvDvhtlOyfn4HO329T7+WEc6BVckcSkBaRyzWsVGfewrQxkEh1HxlsfG0svGYppEMbRoYqom8PRdaa0yIHKjYTDCEF6UH66Zuhcu0dwM79FJyNkr+6h153b4V896saAjeLeRKC0pwK+fYqvdGm3/a4yrNcJCJrTJvzGg9fWrw2znbT6QeWj9LRcZdAhj4jNY5TOlGGOqcMc6ggmkpIbHgEEhLsm0fZ8AXqEDP1yRTRIlNtTetU6YNJEO9PQn5gH+T//e+08vkeeWoypYw6mlc0CFlzXaPczowWSVDCAlLaoyAJTNbMb4w9e8KQFKgHr99M17g/+lMicqRonKeqEZ1JloIqS9rKjlm/xE2dBzWJTrL1tqplwmnePGGbLtilDLlDN+8aCFlFQ6JtzHQNXV2LPAkgpRoSplsGG3+5oaS3x/+LgKy/b6wiOqsEw5o1NwkGbeQJfRLDOEvvea1TAFQ8JrNmC0iKvJZb4pbaKvRDyOw9glUK0PeUqwEinF/KfMjOZU2mHn8X4N7gkrNOx2CWclxNkuXQ2PJaWkn2yGgn/Y/ybxUWR7nAuYvimnwIAmYB5EAF2qQ0CGLNsvukZklNkjlkR2oUmtVe6pTUpk5qpKI1q53qY0rLEmWKQmmSyoanMoSlCxqbm3CqkGSZ/uvPjRKecbR5ioRg85UwAga1wPjqWLybCe/CwrH7HJgSs+MekjY50LUCRBeXZichWSgtCSjxv6UYnyWEduy0PEt+6G+P++emJwRJliOPfX4DpjQBtg78eJCs+WHJncw7O1W4BiTCnEgUNCiszX7MtRaJYDIcgWpJMNSRGaYh2d8d46+UQ1eTz43zGk+cnj8KtGX6W6NjLMVNDlSYQ4VwWADE3qWgWT55FBCtffXAAW+GudATeuvACZBQmiTcewOhIJHekyhIMwZay0KSzptSAV6lfOgfx+AEyklBkuXIk3+4geZWj7mk0mXd6OsiFIQYmF2rCBcLAfz3mCa7tqCwqE2FKKc0ikAJCUu9YEHzjQeabzWYBiUhdasS0sZ5O585M3+obMvhbV9YnaTwJA18KDK1KPMuaFHxjm7KAYEa+WNCTdpL0gLrvDNuVnEtJFr8axutUh/DUH0M5ccwDpJopVPQrqwZfOXFOpxEOSVIssxsv7lG64rjLj0I/VDof45bRO9qhS0WXtE/FXMlY24SlGhzA8kILUrKr4TgmDK3ZnI0WTFQrzfhJAuDUywDa15stqG7lDOxRTtyFk9bwunMrILRckuvsHjRLQwYhVUKTHySC0GOqGYmVbFlbiVZeiqAZDllTQrL4R/etDpF9pjSqtN11WLexIV5GeKdts+8Zc2VT9J+iStNwpZoiqNw9+B3XqnDxyinBZItR//t5jFKONeSmdXsPiFKbKkk+8ZCIiWEiH2WhaNWaoWXrgakQClIyjdNQSffkh3p37xgc/2U/hOXsJxWSLLMjN9c44yto0GvpZ81tTPMqsscUOjkw6IceNFpFwCF2tQRU7xNcI6mmxeMfXw4rntwBsuRl29Zl5BmkVaMxqBm6UkxEhpNEnaaYnOkAiTs8jpvix1zq7AV7z59cMKunfEitStP2Cit+2lgs/WkmEIYnyTsVMT7oynKuhsKTF+2FdecfjDFrp31QtBG6fnLD7prxOIaTvkWdYRyLjJPC0glnaKptCmDBs/EAVIp+s3rc4/ObeKaZ88omLD8H53d4v5U70rAAAAAAElFTkSuQmCC",width:e,height:e});const Wd=e=>{const t=function(e){return{[u.q.TikTok]:(0,i.useMemo)((()=>({id:u.q.TikTok,logo:(0,n.jsx)(r.Dp6,{size:36,name:"icon-thirdpart-tiktok"}),name:c.Ay.t("web_embedcode_text_tiktok")})),[e]),[u.q.TTAM]:(0,i.useMemo)((()=>({id:u.q.TTAM,logo:(0,n.jsx)(r.xT5,{size:36,name:"icon-thirdpart-tiktok"}),name:c.Ay.t("web_embedcode_text_tiktok_ads_manager")})),[e]),[u.q.YouTube]:(0,i.useMemo)((()=>({id:u.q.YouTube,logo:(0,n.jsx)(r.Htw,{size:36,name:"icon-logo-youtube",className:"youtube-logo"}),name:c.Ay.t("web_embedcode_text_youtube")})),[e]),[u.q.YouTubeShorts]:(0,i.useMemo)((()=>({id:u.q.YouTubeShorts,logo:(0,n.jsx)(r.Htw,{size:36}),name:c.Ay.t("web_ytb_ins_text_ytb_cut",{},"YouTube Shorts")})),[e]),[u.q.FacebookGroup]:(0,i.useMemo)((()=>({id:u.q.FacebookGroup,logo:(0,n.jsx)(r.$O4,{size:36}),name:c.Ay.t("web_postfb_text_share_facebook_group",{},"Facebook Group")})),[e]),[u.q.FacebookPage]:(0,i.useMemo)((()=>({id:u.q.FacebookPage,logo:(0,n.jsx)(r.$O4,{size:36}),name:c.Ay.t("web_postfb_text_share_facebook_page",{},"Facebook Page")})),[e]),[u.q.InstagramReels]:(0,i.useMemo)((()=>({id:u.q.InstagramReels,logo:(0,n.jsx)(Gd,{size:36}),name:c.Ay.t("web_ytb_ins_text_ins_reel",{},"Instagram Reels")})),[e]),[u.q.Instagram]:(0,i.useMemo)((()=>({id:u.q.Instagram,logo:(0,n.jsx)(Gd,{size:36}),name:c.Ay.t("// TODO",{},"Instagram")})),[e]),[u.q.Dropbox]:(0,i.useMemo)((()=>({id:u.q.Instagram,logo:(0,n.jsx)(Gd,{size:36}),name:c.Ay.t("// TODO",{},"Instagram")})),[e]),[u.q.Shopify]:(0,i.useMemo)((()=>({id:u.q.Instagram,logo:(0,n.jsx)(Gd,{size:36}),name:c.Ay.t("// TODO",{},"Instagram")})),[e])}}(e);return(0,i.useMemo)((()=>[t[u.q.TikTok],t[u.q.YouTube],t[u.q.YouTubeShorts],t[u.q.InstagramReels],t[u.q.FacebookPage],t[u.q.FacebookGroup]]),[e])},Vd={"platform-account-selector":"_platform-account-selector_do3ds_4","platform-account-selector-option-container":"_platform-account-selector-option-container_do3ds_8","platform-account-selector-option-name":"_platform-account-selector-option-name_do3ds_21","platform-account-selector-selected-account":"_platform-account-selector-selected-account_do3ds_28","platform-account-selector-selected-account-content":"_platform-account-selector-selected-account-content_do3ds_33","platform-account-selector-selected-account-name":"_platform-account-selector-selected-account-name_do3ds_37","platform-account-selector-selected-account-email":"_platform-account-selector-selected-account-email_do3ds_43","platform-account-selector-sign-out-option":"_platform-account-selector-sign-out-option_do3ds_50","platform-account-selector-switch-account-tip":"_platform-account-selector-switch-account-tip_do3ds_56","platform-account-selector-divider":"_platform-account-selector-divider_do3ds_66","platform-selector":"_platform-selector_do3ds_73","platform-selector-option-container":"_platform-selector-option-container_do3ds_77","platform-selector-option":"_platform-selector-option_do3ds_77","platform-selector-option-name":"_platform-selector-option-name_do3ds_92","form-item-time-picker":"_form-item-time-picker_do3ds_98","system-zone":"_system-zone_do3ds_105","picker-wrapper":"_picker-wrapper_do3ds_115",picker:"_picker_do3ds_115","account-selector":"_account-selector_do3ds_129","account-selector-simple-option-container":"_account-selector-simple-option-container_do3ds_133","account-selector-simple-option":"_account-selector-simple-option_do3ds_133","account-selector-simple-option-avatar":"_account-selector-simple-option-avatar_do3ds_146","account-selector-simple-option-name":"_account-selector-simple-option-name_do3ds_152","account-selector-sign-out-option":"_account-selector-sign-out-option_do3ds_156","account-selector-sign-in":"_account-selector-sign-in_do3ds_162","account-selector-sign-in-avatar":"_account-selector-sign-in-avatar_do3ds_173","account-selector-sign-in-text":"_account-selector-sign-in-text_do3ds_179","se-textarea-form-item":"_se-textarea-form-item_do3ds_186","se-textarea":"_se-textarea_do3ds_186","share-submit":"_share-submit_do3ds_197","share-submit-container":"_share-submit-container_do3ds_202","share-submit-title":"_share-submit-title_do3ds_219"},Hd=({name:e,logo:t})=>(0,n.jsxs)("div",{className:Vd["platform-selector-option"],children:[t,(0,n.jsx)("span",{className:Vd["platform-selector-option-name"],children:e})]}),qd=({value:e,onChange:t})=>{const o=Wd("");return(0,n.jsx)(L.A.Item,{layout:"vertical",label:c.Ay.t("web_timing_button_platform",{},"Share to"),children:(0,n.jsx)(N.A,{value:e,placeholder:c.Ay.t("web_timing_button_select",{},"Select"),className:Vd["platform-selector"],triggerProps:{containerScrollToClose:!0,style:{zIndex:1002}},onChange:t,getPopupContainer:()=>window.document.body,children:o.map((e=>(0,n.jsx)(N.A.Option,{value:e.id,className:Vd["platform-selector-option-container"],children:(0,n.jsx)(Hd,{name:e.name,logo:e.logo})},e.id)))})})};function Yd(e="en"){switch(e){case"ja-JP":return Ze.A;case"ko-KR":return He.A;case"es-LA":return $e.A;case"pt-BR":return Qe.A;case"fr-FR":return Ve.A;case"id-ID":return qe.A;case"vi-VN":return Ye.A;case"ms-MY":return Ke.A;default:return Je.A}}se().extend(et()),se().extend(ot());const Kd=({timestamp:e,onChange:t})=>{const o=`${c.Ay.t("web_timing_text_system",{},"System time zone")}: ${se().tz.guess()}`;return(0,n.jsxs)(L.A.Item,{className:l()(Vd["form-item"],Vd["form-item-time-picker"]),layout:"vertical",label:c.Ay.t("web_timing_title_time",{},"Share on"),children:[(0,n.jsx)("div",{className:Vd["system-zone"],children:o}),(0,n.jsx)("div",{className:Vd["picker-wrapper"],children:(0,n.jsxs)(ze.Ay,{locale:Yd(c.Ay.language),children:[(0,n.jsx)(Ge.A,{dayStartOfWeek:0,allowClear:!1,className:Vd.picker,value:e,format:"YYYY-MM-DD",onChange:(o,a)=>{const n=se()(e),r=se()().set("hour",n.get("hour")).set("minute",n.get("minute")).set("second",n.get("second")).set("year",a.get("year")).set("month",a.get("month")).set("date",a.get("date"));t(r.valueOf())},showNowBtn:!0,disabledDate:function(e){const t=se()().set("date",se()().get("date")-1),o=se()().set("date",se()().get("date")+30);return e.isBefore(t)||e.isAfter(o)},getPopupContainer:()=>window.document.body,triggerProps:{containerScrollToClose:!0,style:{zIndex:1002}}}),(0,n.jsx)(We.A,{allowClear:!1,value:e,className:Vd.picker,use12Hours:!0,format:"h:mm A",onChange:(o,a)=>{const n=se()(e),r=se()().set("hour",a.get("hour")).set("minute",a.get("minute")).set("second",a.get("second")).set("year",n.get("year")).set("month",n.get("month")).set("date",n.get("date"));t(r.valueOf())},getPopupContainer:()=>window.document.body,triggerProps:{containerScrollToClose:!0,style:{zIndex:1002}},showNowBtn:!1})]})})]})};let Jd=null;const $d=({avatar:e,name:t})=>(0,n.jsxs)("div",{className:Vd["account-selector-simple-option"],children:[(0,n.jsx)(re.A,{size:32,className:Vd["account-selector-simple-option-avatar"],children:e?(0,n.jsx)("img",{crossOrigin:"anonymous",src:e}):(null==t?void 0:t[0])??""}),(0,n.jsx)("span",{className:Vd["account-selector-simple-option-name"],children:t})]}),Qd=({onSignOut:e})=>(0,n.jsxs)(k.A,{type:"text",className:l()("lv-select-option",Vd["account-selector-sign-out-option"]),size:"small",long:!0,loading:!1,onClickCapture:t=>{t.stopPropagation(),e()},children:[(0,n.jsx)(r.ZT9,{size:20}),c.Ay.t("web_sign_out",{},"Sign out")]}),Zd=({onSignIn:e})=>(0,n.jsxs)("div",{className:Vd["account-selector-sign-in"],onClick:e,children:[(0,n.jsx)(r.W2v,{size:32,className:Vd["account-selector-sign-in-avatar"]}),(0,n.jsx)("span",{className:Vd["account-selector-sign-in-text"],children:c.Ay.t("log_in")})]}),Xd=({value:e,label:t,accounts:o=[],onChange:a,onDown:r,onSignIn:i,onSignOut:s})=>0===o.length?(0,n.jsx)(L.A.Item,{layout:"vertical",label:t??c.Ay.t("web_timing_title_account",{},"Select account"),children:(0,n.jsx)(Zd,{onSignIn:i})}):(0,n.jsx)(L.A.Item,{layout:"vertical",label:t??c.Ay.t("web_timing_title_account",{},"Select account"),children:(0,n.jsxs)(N.A,{value:e,placeholder:c.Ay.t("web_timing_title_account",{},"Select"),className:Vd["account-selector"],triggerProps:{containerScrollToClose:!0,style:{zIndex:1002}},onChange:e=>{a(e)},onVisibleChange:e=>{e&&(Jd||(r(),Jd=setTimeout((()=>{Jd=null}),1e4)))},getPopupContainer:()=>window.document.body,children:[o.map((e=>(0,n.jsx)(N.A.Option,{value:e.id,className:Vd["account-selector-simple-option-container"],children:(0,n.jsx)($d,{name:e.name,avatar:e.avatar})},e.id))),(0,n.jsx)(Qd,{onSignOut:s})]})}),eu=e=>{const{className:t,field:o,rules:a,value:r}=e,i=l()([Vd["se-textarea"]].concat(t));return(0,n.jsx)(L.A.Item,{className:Vd["se-textarea-form-item"],layout:"vertical",label:e.label,field:o,rules:a,children:(0,n.jsx)(O.A.TextArea,{...e,value:r,className:i,showWordLimit:!0,onChange:null==e?void 0:e.onChange})})};class tu{constructor(){bt(this,"platformAccountInstance"),bt(this,"accountFetching",!1)}validateIfBindPlatform(){return!!this.platformAccountInstance&&this.platformAccountInstance.validateIfBind()}bindPlatform(e){if(this.platformAccountInstance){if(this.ifSingleAccount&&this.platformAccountInstance.accounts.length>0)return void this.fetchAccounts();this.platformAccountInstance.bindAccount(((t,o)=>{e(t,o)}))}}async unbindPlatform(e){if(!this.platformAccountInstance)return;const t=await this.platformAccountInstance.unbindAccount(e);return t&&(this.accounts=[]),t}setPlatformAccount(e){this.platformAccountInstance=e}changePlatformAccount(e){this.platformAccountInstance&&this.platformAccountInstance.changeAccount(e)}}class ou extends tu{constructor(){super(),bt(this,"accounts",[]),bt(this,"ifSingleAccount",!0),(0,pt.Gn)(this,{accounts:pt.sH,accountFetching:pt.sH});const e=Td();e.listenUnbind(void 0,(()=>{this.accounts=[]})),this.setPlatformAccount(e)}async fetchAccounts(){this.accountFetching=!0;const e=await p.u.getFacebookShareList({id:this.platformAccountInstance.currentAccountId,type:yd[u.q.FacebookPage]});return this.accountFetching=!1,this.accounts=e,!0}}let au;const nu=()=>(au||(au=new ou),au);var ru=(e=>(e.update="update",e.overwrite="overwrite",e))(ru||{}),iu=(e=>(e.publish="publish",e.delete="delete",e))(iu||{});const su={"facebook-policy":"_facebook-policy_1nefu_2","no-account":"_no-account_1nefu_10","no-account-create":"_no-account-create_1nefu_17","tiktok-who-can-view":"_tiktok-who-can-view_1nefu_40","tiktok-who-can-view-select":"_tiktok-who-can-view-select_1nefu_49","tiktok-who-can-view-select-option":"_tiktok-who-can-view-select-option_1nefu_53","tiktok-who-can-view-select-option-title":"_tiktok-who-can-view-select-option-title_1nefu_63","tiktok-who-can-view-select-option-content":"_tiktok-who-can-view-select-option-content_1nefu_69","tiktok-allow-users-to":"_tiktok-allow-users-to_1nefu_76","tiktok-allow-users-to-item":"_tiktok-allow-users-to-item_1nefu_80","tiktok-disclose-video-content":"_tiktok-disclose-video-content_1nefu_84","tiktok-disclose-video-content-label":"_tiktok-disclose-video-content-label_1nefu_89","disclose-video-content-alert":"_disclose-video-content-alert_1nefu_97","disclose-video-content-alert-icon":"_disclose-video-content-alert-icon_1nefu_105","disclose-video-content-alert-text":"_disclose-video-content-alert-text_1nefu_109","disclose-video-content-tip":"_disclose-video-content-tip_1nefu_120","disclose-video-content-setting":"_disclose-video-content-setting_1nefu_131","disclose-video-content-setting-label":"_disclose-video-content-setting-label_1nefu_136","disclose-video-content-setting-left":"_disclose-video-content-setting-left_1nefu_142","disclose-video-content-setting-desc":"_disclose-video-content-setting-desc_1nefu_150","disclose-video-content-policy":"_disclose-video-content-policy_1nefu_161","disclose-video-content-policy-link":"_disclose-video-content-policy-link_1nefu_175","youtube-shorts-warn-tip":"_youtube-shorts-warn-tip_1nefu_183","youtube-privacy-level-select":"_youtube-privacy-level-select_1nefu_197","youtube-privacy-level-select-title":"_youtube-privacy-level-select-title_1nefu_202","youtube-privacy-level-select-content":"_youtube-privacy-level-select-content_1nefu_209","youtube-policy":"_youtube-policy_1nefu_217","instagram-reel-no-account-alert":"_instagram-reel-no-account-alert_1nefu_227","instagram-reel-no-account-step-title":"_instagram-reel-no-account-step-title_1nefu_241","instagram-reel-no-account-step-content":"_instagram-reel-no-account-step-content_1nefu_248","instagram-reel-no-account-step-link":"_instagram-reel-no-account-step-link_1nefu_255","instagram-reels-policy":"_instagram-reels-policy_1nefu_261","ttam-no-advertiser-account":"_ttam-no-advertiser-account_1nefu_271","ttam-no-advertiser-account-content":"_ttam-no-advertiser-account-content_1nefu_278","ttam-no-advertiser-account-link":"_ttam-no-advertiser-account-link_1nefu_285","ttam-advertiser-item":"_ttam-advertiser-item_1nefu_290","ttam-advertiser-item-name":"_ttam-advertiser-item-name_1nefu_306","ttam-advertiser-item-id":"_ttam-advertiser-item-id_1nefu_314"};class lu{constructor(){bt(this,"_paramsRecord")}set(e){this._paramsRecord=e}get paramsRecord(){return this._paramsRecord}clear(){this._paramsRecord=void 0}}let cu;const du=()=>(cu||(cu=new lu),cu);function uu(){const{fileInfo:e,spaceInfo:t,extraData:o}=du().paramsRecord??{};return!(null==e||!e.asset||!t||null==o||!o.currentPage||"smart_tool_page"===o.currentPage)}const pu=()=>(0,n.jsx)(L.A.Item,{layout:"vertical",children:(0,n.jsx)("div",{className:su["facebook-policy"],children:c.Ay.t("web_postfb_text_agree_with",{"text-href0":e=>(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://www.facebook.com/legal/terms",children:e}),"text-href1":e=>(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://transparency.fb.com/en-gb/policies/community-standards/",children:e})},"When you upload to Facebook, you certify that the content you are uploading complies with Facebook\u2019s Terms of Service. Please be sure not to violate others' copyright or privacy rights.Video release conditions can refer to the official rules of Facebook to avoid release failure.")})}),_u=()=>(0,n.jsx)("div",{className:su["no-account"],children:(0,n.jsxs)("div",{className:su["no-account-create"],children:[(0,n.jsx)(r.pxA,{size:100}),(0,n.jsx)("p",{children:c.Ay.t("web_postfb_toast_dont_have_page",{},"You don\u2019t have any Facebook Page")}),(0,n.jsx)("p",{children:c.Ay.t("web_postfb_toast_create_page_first",{},"To share videos, you need to create a Facebook Page first.")}),(0,n.jsx)(k.A,{type:"primary",href:"https://www.facebook.com/pages/create/",target:"_blank",onClick:()=>{},children:c.Ay.t("web_postfb_button_go_to_create",{},"Create in Facebook")})]})}),hu=(0,at.PA)((({formValue:e,dispatch:t,onSignIn:o,onSignOut:a})=>{const{title:r="",description:s="",selectedAccountId:l=""}=e,{accounts:d}=nu(),p=e=>{t({type:ru.update,data:{selectedAccountId:e}})},_=e=>{t({type:ru.update,data:{title:e}})},h=e=>{t({type:ru.update,data:{description:e}})},m=d.map((e=>({id:e.id,avatar:e.picture,name:e.name})));(0,i.useEffect)((()=>{m.length>0&&!l&&p(m[0].id)}),[m]),(0,i.useEffect)((()=>{_(r),h(s)}),[r,s]);const{fileInfo:g,spaceInfo:v,extraData:f}=du().paramsRecord??{};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Xd,{value:l,accounts:m,onDown:()=>nu().fetchAccounts(),onChange:p,onSignIn:()=>null==o?void 0:o(u.q.FacebookPage),onSignOut:()=>null==a?void 0:a(u.q.FacebookGroup)}),0===m.length&&(0,n.jsx)(_u,{}),m.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eu,{value:r,label:c.Ay.t("web_postfb_title_title"),maxLength:100,placeholder:c.Ay.t("caption"),autoSize:{maxRows:8,minRows:2},onChange:_}),(0,n.jsx)(eu,{value:s,label:c.Ay.t("web_postfb_title_description"),maxLength:5e3,placeholder:c.Ay.t("describe_post"),autoSize:{maxRows:8,minRows:2},onChange:h}),uu()&&(0,n.jsx)(L.A.Item,{layout:"vertical",children:(0,n.jsx)(jm,{platform:u.q.FacebookPage,fileInfo:g,spaceInfo:v,extraData:f,maxSize:2,onChange:e=>{t({type:ru.update,data:{cover:e}})},disabled:!1})}),(0,n.jsx)(pu,{})]})]})}));class mu extends tu{constructor(){super(),bt(this,"accounts",[]),bt(this,"ifSingleAccount",!0),(0,pt.Gn)(this,{accounts:pt.sH,accountFetching:pt.sH});const e=Td();e.listenUnbind(void 0,(()=>{this.accounts=[]})),this.setPlatformAccount(e)}async fetchAccounts(){this.accountFetching=!0;const e=await p.u.getFacebookShareList({id:this.platformAccountInstance.currentAccountId,type:yd[u.q.FacebookGroup]});return this.accountFetching=!1,this.accounts=e,!0}}let gu;const vu=()=>(gu||(gu=new mu),gu),fu=()=>(0,n.jsx)(L.A.Item,{layout:"vertical",children:(0,n.jsx)("div",{className:su["facebook-policy"],children:c.Ay.t("web_postfb_text_agree_with",{"text-href0":e=>(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://www.facebook.com/legal/terms",children:e}),"text-href1":e=>(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://transparency.fb.com/en-gb/policies/community-standards/",children:e})},"When you upload to Facebook, you certify that the content you are uploading complies with Facebook\u2019s Terms of Service. Please be sure not to violate others' copyright or privacy rights.Video release conditions can refer to the official rules of Facebook to avoid release failure.")})}),yu=()=>(0,n.jsx)("div",{className:su["no-account"],children:(0,n.jsxs)("div",{className:su["no-account-create"],children:[(0,n.jsx)(r.pxA,{size:100}),(0,n.jsx)("p",{children:c.Ay.t("web_postfb_text_no_group_yet",{},"No group yet.")}),(0,n.jsx)("p",{children:c.Ay.t("web_postfb_text_create_facebook_group",{},"You need to create a facebook group first.")}),(0,n.jsx)(k.A,{type:"primary",href:"https://www.facebook.com/groups/create/",target:"_blank",onClick:()=>{},children:c.Ay.t("web_postfb_button_go_to_create",{},"Create in Facebook")})]})}),wu=(0,at.PA)((({formValue:e,dispatch:t,onSignIn:o,onSignOut:a})=>{const{title:r="",description:s="",selectedAccountId:l=""}=e,{accounts:d}=vu(),p=e=>{t({type:ru.update,data:{selectedAccountId:e}})},_=d.map((e=>({id:e.id,avatar:e.picture,name:e.name})));return(0,i.useEffect)((()=>{_.length>0&&!l&&p(_[0].id)}),[_]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Xd,{value:l,accounts:_,onDown:()=>vu().fetchAccounts(),onChange:p,onSignIn:()=>null==o?void 0:o(u.q.FacebookGroup),onSignOut:()=>null==a?void 0:a(u.q.FacebookGroup)}),0===_.length&&(0,n.jsx)(yu,{}),_.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eu,{value:r,label:c.Ay.t("web_postfb_title_title"),maxLength:100,placeholder:c.Ay.t("caption"),autoSize:{maxRows:8,minRows:2},onChange:e=>{t({type:ru.update,data:{title:e}})}}),(0,n.jsx)(eu,{value:s,label:c.Ay.t("web_postfb_title_description"),maxLength:5e3,placeholder:c.Ay.t("describe_post"),autoSize:{maxRows:8,minRows:2},onChange:e=>{t({type:ru.update,data:{description:e}})}}),(0,n.jsx)(fu,{})]})]})}));class bu extends tu{constructor(){super(),bt(this,"accounts",[]),bt(this,"ifSingleAccount",!0),(0,pt.Gn)(this,{accounts:pt.sH,accountFetching:pt.sH,privacyLevelOptions:pt.EW,allowedOperations:pt.EW});const e=Rd();e.listenUnbind(void 0,(()=>{this.accounts=[]})),this.setPlatformAccount(e)}get privacyLevelOptions(){var e;const t={PUBLIC_TO_EVERYONE:gd.public,FOLLOWER_OF_CREATOR:gd.followers,MUTUAL_FOLLOW_FRIENDS:gd.friends,SELF_ONLY:gd.private},o=((null==(e=this.platformAccountInstance.currentAccount)?void 0:e.privacy_level_options)??[]).map((e=>t[e])).filter((e=>e));return 0===o.length?[gd.public,gd.friends,gd.private]:o}get allowedOperations(){var e,t,o;const a=[],n=null==(e=this.platformAccountInstance.currentAccount)?void 0:e.comment_disabled,r=null==(t=this.platformAccountInstance.currentAccount)?void 0:t.duet_disabled,i=null==(o=this.platformAccountInstance.currentAccount)?void 0:o.stitch_disabled;return n||a.push(vd.comment),r||a.push(vd.duet),i||a.push(vd.stitch),a}fetchAccounts(){return this.platformAccountInstance.currentAccount?this.accounts=[this.platformAccountInstance.currentAccount]:this.accounts=[],!0}}let xu;const ku=()=>(xu||(xu=new bu),xu);function Au(e){return{[gd.public]:c.Ay.t("public"),[gd.followers]:c.Ay.t("follower"),[gd.friends]:c.Ay.t("friends"),[gd.private]:c.Ay.t("private")}[e]??""}const Su=({privacyLevel:e,isPromoteOtherBrand:t,dispatch:o})=>{const{privacyLevelOptions:a}=ku(),r=((e,t)=>{const o={[gd.public]:{title:c.Ay.t("public"),content:"",key:gd.public,disabled:!1},[gd.followers]:{title:c.Ay.t("follower"),content:c.Ay.t("visible_to_followers"),key:gd.followers,disabled:!1},[gd.friends]:{title:c.Ay.t("friends"),content:c.Ay.t("mutual_follow"),key:gd.friends,disabled:!1},[gd.private]:{title:c.Ay.t("private"),content:"",key:gd.private,disabled:t}};return e.map((e=>o[e])).filter((e=>e))})(a,t);return(0,n.jsx)(L.A.Item,{className:su["tiktok-who-can-view"],layout:"vertical",label:c.Ay.t("tiktok_video_privacy"),extra:c.Ay.t("web_cover_text_sure_privacy",{},"Ensure your privacy settings are the same as those on your TikTok account."),children:(0,n.jsx)(N.A,{value:e,className:su["tiktok-who-can-view-select"],triggerProps:{style:{zIndex:1002,marginTop:"10px"}},renderFormat:(e,t)=>(0,n.jsx)(n.Fragment,{children:Au(t)}),onChange:e=>{o({type:ru.update,data:{privacyLevel:e}})},children:r.map((e=>(0,n.jsx)(N.A.Option,{value:e.key,disabled:e.disabled,children:(0,n.jsx)(x.A,{disabled:!e.disabled,content:c.Ay.t("web_posttt_text_content_videos"),style:{zIndex:1002},children:(0,n.jsxs)("div",{className:su["tiktok-who-can-view-select-option"],children:[(0,n.jsx)("div",{className:su["tiktok-who-can-view-select-option-title"],children:e.title}),(0,n.jsx)("div",{className:su["tiktok-who-can-view-select-option-content"],children:e.content})]})})},e.key)))})})},Cu=({disableComment:e,disableDuet:t,disableStitch:o,dispatch:a})=>{const{allowedOperations:r}=ku(),i=!r.includes(vd.comment),s=!r.includes(vd.duet),l=!r.includes(vd.stitch);return(0,n.jsxs)(L.A.Item,{label:c.Ay.t("allow_users_to"),layout:"vertical",className:su["tiktok-allow-users-to"],children:[(0,n.jsx)(F.A,{checked:!e,disabled:i,className:su["tiktok-allow-users-to-item"],onChange:()=>{a({type:ru.update,data:{disableComment:!e}})},children:c.Ay.t("tiktok_comment")}),(0,n.jsx)(F.A,{checked:!t,disabled:s,className:su["tiktok-allow-users-to-item"],onChange:()=>{a({type:ru.update,data:{disableDuet:!t}})},children:c.Ay.t("duet")}),(0,n.jsx)(F.A,{checked:!o,disabled:l,className:su["tiktok-allow-users-to-item"],onChange:()=>{a({type:ru.update,data:{disableStitch:!o}})},children:c.Ay.t("stitch")})]})},Iu=({isDiscloseVideoContent:e,dispatch:t})=>(0,n.jsxs)("div",{className:su["tiktok-disclose-video-content"],children:[(0,n.jsx)("div",{className:su["tiktok-disclose-video-content-label"],children:c.Ay.t("web_posttt_text_disclosed_video_content",{},"Disclose video content")}),(0,n.jsx)(te.A,{checked:e,onChange:()=>{t({type:ru.update,data:{isDiscloseVideoContent:!e,isPromoteOwnBrand:!1,isPromoteOtherBrand:!1}})}})]}),Eu=({isPromoteOwnBrand:e,isPromoteOtherBrand:t})=>{if(!e&&!t)return null;let o="";return o=e&&!t?c.Ay.t("web_posttt_text_video_labeled",{},'Your video will be labeled "Promotional content". This cannot be changed once the post is live.'):!e&&t?c.Ay.t("web_posttt_text_labeled_paid_partnership",{},'Your video will be labeled "Paid partnership" and cannot be set to private. This cannot be changed once the post is live.'):c.Ay.t("web_posttt_text_cannot_set_private",{},'Your video will be labeled "Paid partnership" and cannot be set to private. This cannot be changed once the post is live.'),(0,n.jsxs)("div",{className:su["disclose-video-content-alert"],children:[(0,n.jsx)(r.zaj,{size:16,className:su["disclose-video-content-alert-icon"]}),(0,n.jsx)("div",{className:su["disclose-video-content-alert-text"],children:o})]})},Tu=({isPromoteOwnBrand:e,isPromoteOtherBrand:t})=>{const o=()=>{y.A.info({icon:null,title:c.Ay.t("web_posttt_title_agree_music_confirmation"),content:c.Ay.t("web_posttt_text_legal_copy1"),okText:c.Ay.t("web_space_workspace_get_it"),cancelButtonProps:{style:{display:"none"}}})};return e||t?t?(0,n.jsx)("div",{className:su["disclose-video-content-policy"],children:c.Ay.t("web_posttt_text_by_posting",{"text-href0":e=>(0,n.jsx)("a",{target:"__blank",href:"https://www.tiktok.com/legal/bc-policy",className:su["disclose-video-content-policy-link"],children:e}),"text-href1":e=>(0,n.jsx)("span",{onClick:o,className:su["disclose-video-content-policy-link"],children:e})},"By posting, you agree to our <text-href0>Branded Content Policy</text-href0> and <text-href1>Music Usage Confirmation</text-href1>")}):(0,n.jsx)("div",{className:su["disclose-video-content-policy"],children:c.Ay.t("web_posttt_text_agree_music_confirmation",{"text-href0":e=>(0,n.jsx)("span",{onClick:o,className:su["disclose-video-content-policy-link"],children:e})},"By posting, you agree to our <text-href1>Music Usage Confirmation</text-href1>")}):null},Pu=({isDiscloseVideoContent:e,isPromoteOwnBrand:t,isPromoteOtherBrand:o,privacyLevel:a,dispatch:r})=>{if(!e)return null;const i=a===gd.private;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Eu,{isPromoteOwnBrand:t,isPromoteOtherBrand:o}),(0,n.jsx)("div",{className:su["disclose-video-content-tip"],children:c.Ay.t("web_posttt_text_legal_copy2",{},"Turn on to disclose that this video promotes goods or services in exchange for something of value. Your video could promote yourself, a third party, or both.")}),(0,n.jsxs)("div",{className:su["disclose-video-content-setting"],children:[(0,n.jsxs)("div",{className:su["disclose-video-content-setting-label"],children:[(0,n.jsx)("div",{className:su["disclose-video-content-setting-left"],children:c.Ay.t("web_posttt_text_your_brand",{},"Your brand")}),(0,n.jsx)(F.A,{size:"small",checked:t,onChange:()=>{r({type:ru.update,data:{isPromoteOwnBrand:!t}})}})]}),(0,n.jsx)("div",{className:su["disclose-video-content-setting-desc"],children:c.Ay.t("web_posttt_text__promoting_yourself")})]}),(0,n.jsxs)("div",{className:su["disclose-video-content-setting"],children:[(0,n.jsxs)("div",{className:su["disclose-video-content-setting-label"],children:[(0,n.jsx)("div",{className:su["disclose-video-content-setting-left"],children:c.Ay.t("web_posttt_text_branded_content",{},"Branded content")}),(0,n.jsx)(x.A,{disabled:!i,content:c.Ay.t("web_posttt_text_legal_copy3"),style:{zIndex:1001},children:(0,n.jsx)(F.A,{size:"small",checked:o,disabled:i,onChange:()=>{r({type:ru.update,data:{isPromoteOtherBrand:!o}})}})})]}),(0,n.jsx)("div",{className:su["disclose-video-content-setting-desc"],children:c.Ay.t("web_posttt_text_paid_partnership")})]}),(0,n.jsx)(Tu,{isPromoteOwnBrand:t,isPromoteOtherBrand:o})]})},Nu=(0,at.PA)((({formValue:e,dispatch:t,onSignIn:o,onSignOut:a})=>{const{selectedAccountId:r,title:s,privacyLevel:l,disableComment:d,disableDuet:p,disableStitch:_,isDiscloseVideoContent:h,isPromoteOwnBrand:m,isPromoteOtherBrand:g}=e,v=e=>{t({type:ru.update,data:{selectedAccountId:e}})},{accounts:f}=ku(),y=f.map((e=>({id:e.creator_username,avatar:e.creator_avatar_url,name:e.creator_nickname})));return(0,i.useEffect)((()=>{y.length>0&&!r&&v(y[0].id)}),[y]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Xd,{value:r,accounts:y,onDown:()=>ku().fetchAccounts(),onChange:v,onSignIn:()=>null==o?void 0:o(u.q.TikTok),onSignOut:()=>null==a?void 0:a(u.q.TikTok)}),(0,n.jsx)(eu,{value:s,label:c.Ay.t("web_postfb_title_title"),maxLength:2200,placeholder:c.Ay.t("caption"),autoSize:{maxRows:8,minRows:2},onChange:e=>{t({type:ru.update,data:{title:e}})}}),(0,n.jsx)(Su,{privacyLevel:l,isPromoteOtherBrand:g,dispatch:t}),(0,n.jsx)(Cu,{disableComment:d,disableDuet:p,disableStitch:_,dispatch:t}),(0,n.jsx)(Iu,{isDiscloseVideoContent:h,dispatch:t}),(0,n.jsx)(Pu,{isDiscloseVideoContent:h,isPromoteOwnBrand:m,isPromoteOtherBrand:g,privacyLevel:l,dispatch:t})]})}));class ju extends tu{constructor(){super(),bt(this,"accounts",[]),bt(this,"ifSingleAccount",!0),(0,pt.Gn)(this,{accounts:pt.sH,accountFetching:pt.sH});const e=Dd();e.listenUnbind(void 0,(()=>{this.accounts=[]})),this.setPlatformAccount(e)}fetchAccounts(){return this.platformAccountInstance.currentAccount?this.accounts=[this.platformAccountInstance.currentAccount]:this.accounts=[],!0}}let Ru;const Lu=()=>(Ru||(Ru=new ju),Ru),Ou=[{required:!0,message:c.Ay.t("share_error_no_title",{},"Enter a title")},{validator:(e,t)=>t(/[<>]/.test(e)?c.Ay.t("share_error_contain_angle_brackets",{},"Can't contain angle brackets"):void 0)}],Fu=[{validator:(e,t)=>t(/[<>]/.test(e)?c.Ay.t("share_error_contain_angle_brackets",{},"Can't contain angle brackets"):void 0)}],Du=[{title:c.Ay.t("web_shareYouTube_button_public",{},"Public"),key:fd.public,content:c.Ay.t("web_shareYouTube_text_everyone_can_access",{},"Everyone can watch your video")},{title:c.Ay.t("web_shareYouTube_button_private",{},"Private"),key:fd.private,content:c.Ay.t("web_shareYouTube_text_people_you_choose",{},"Only you and people you choose can watch your video")},{title:c.Ay.t("web_shareYouTube_button_unlisted",{},"Unlisted"),key:fd.unlisted,content:c.Ay.t("web_shareYouTube_text_everyone_with_link",{},"Anyone with the video link can watch your video")}],Uu=({selectedPrivacyLevel:e,setSelectedPrivacyLevel:t})=>(0,n.jsx)(L.A.Item,{label:c.Ay.t("web_shareYouTube_text_privacy_rights",{},"Privacy"),layout:"vertical",children:(0,n.jsx)(N.A,{value:e,dropdownMenuClassName:su.popper,renderFormat:(e,t)=>{const o=Du.find((e=>e.key===t));return o?`${o.title}: ${o.content}`:void 0},triggerProps:{updateOnScroll:!0,style:{zIndex:1001}},onChange:t,children:Du.map((e=>(0,n.jsx)(N.A.Option,{value:e.key,children:(0,n.jsxs)("div",{className:su["youtube-privacy-level-select"],children:[(0,n.jsx)("div",{className:su["youtube-privacy-level-select-title"],children:e.title}),(0,n.jsx)("div",{className:su["youtube-privacy-level-select-content"],children:e.content})]})},e.key)))})}),Mu=({tags:e,setTags:t})=>{const[o,a]=(0,i.useState)(""),r=(0,i.useMemo)((()=>dl(e)),[e]);return(0,n.jsxs)(L.A.Item,{label:c.Ay.t("web_shareYouTube_title_tag",{},"Tag"),layout:"vertical",className:su["tiktok-allow-users-to"],children:[(0,n.jsx)(Ce.A,{value:e,className:"lv-youtube-input-tag",inputValue:o,placeholder:c.Ay.t("describe_post"),onChange:e=>{t(e),a("")},onInputChange:e=>{const t=dl([e]);t<=100&&r+t<cl&&a(e)}}),(0,n.jsx)("span",{className:"lv-textarea-word-limit",children:`${r+dl([o])}/500`})]})},Bu=()=>(0,n.jsx)(L.A.Item,{layout:"vertical",children:(0,n.jsxs)("div",{className:su["youtube-policy"],children:["By continuing, you confirm that the video you share to YouTube complies with YouTube\u2019s\xa0",(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://www.youtube.com/t/terms",children:"Terms of Service"}),"\xa0and does not infringe upon other people\u2019s intellectual property rights and privacy. Check our\xa0",(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://www.capcut.com/resource/google-api-services-disclosure",children:"Google API Services Disclosure"}),"."]})}),zu=(0,at.PA)((({form:e,formValue:t,dispatch:o,onSignIn:a,onSignOut:r})=>{const{selectedAccountId:s,title:l,description:d,privacyLevel:p,tags:_=[]}=t;(0,i.useEffect)((()=>{e.setFieldsValue({title:l})}),[l]),(0,i.useEffect)((()=>{e.setFieldsValue({description:d})}),[d]);const h=e=>{o({type:ru.update,data:{selectedAccountId:e}})},{accounts:m}=Lu(),g=m.map((e=>({id:e.email,avatar:e.picture,name:e.name})));(0,i.useEffect)((()=>{g.length>0&&!s&&h(g[0].id)}),[g]);const{fileInfo:v,spaceInfo:f,extraData:y}=du().paramsRecord??{};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Xd,{value:s,accounts:g,onDown:()=>Lu().fetchAccounts(),onChange:h,onSignIn:()=>null==a?void 0:a(u.q.YouTube),onSignOut:()=>null==r?void 0:r(u.q.YouTube)}),(0,n.jsx)(eu,{value:l,label:c.Ay.t("web_postfb_title_title"),maxLength:100,placeholder:c.Ay.t("caption"),autoSize:{maxRows:8,minRows:2},field:"title",rules:Ou,onChange:e=>{o({type:ru.update,data:{title:e}})}}),(0,n.jsx)(eu,{value:d,label:c.Ay.t("web_postfb_title_description"),maxLength:5e3,placeholder:c.Ay.t("describe_post"),autoSize:{maxRows:8,minRows:2},field:"description",rules:Fu,onChange:e=>{o({type:ru.update,data:{description:e}})}}),uu()&&(0,n.jsx)(L.A.Item,{layout:"vertical",children:(0,n.jsx)(jm,{platform:u.q.YouTube,fileInfo:v,spaceInfo:f,extraData:y,maxSize:2,onChange:e=>{o({type:ru.update,data:{cover:e}})},disabled:!1})}),(0,n.jsx)(Uu,{selectedPrivacyLevel:p,setSelectedPrivacyLevel:e=>{o({type:ru.update,data:{privacyLevel:e}})}}),(0,n.jsx)(Mu,{tags:_,setTags:e=>{o({type:ru.update,data:{tags:e}})}}),(0,n.jsx)(Bu,{})]})}));class Gu extends tu{constructor(){super(),bt(this,"accounts",[]),bt(this,"ifSingleAccount",!0),(0,pt.Gn)(this,{accounts:pt.sH,accountFetching:pt.sH});const e=Dd();e.listenUnbind(void 0,(()=>{this.accounts=[]})),this.setPlatformAccount(e)}fetchAccounts(){return this.platformAccountInstance.currentAccount?this.accounts=[this.platformAccountInstance.currentAccount]:this.accounts=[],!0}}let Wu;const Vu=()=>(Wu||(Wu=new Gu),Wu),Hu=[{required:!0,message:c.Ay.t("share_error_no_title",{},"Enter a title")},{validator:(e,t)=>t(/[<>]/.test(e)?c.Ay.t("share_error_contain_angle_brackets",{},"Can't contain angle brackets"):void 0)}],qu=[{validator:(e,t)=>t(/[<>]/.test(e)?c.Ay.t("share_error_contain_angle_brackets",{},"Can't contain angle brackets"):void 0)}],Yu=({videoDuration:e,videoWidth:t,videoHeight:o})=>{let a="";return e/1e3>60&&(a=c.Ay.t("web_ytb_ins_text_shared_tyb")),t>o&&(a=c.Ay.t("web_ytb_ins_text_publish_to_ytb")),a?(0,n.jsx)(_t.A,{type:"warning",content:a,className:su["youtube-shorts-warn-tip"]}):null},Ku=[{title:c.Ay.t("web_shareYouTube_button_public",{},"Public"),key:fd.public,content:c.Ay.t("web_shareYouTube_text_everyone_can_access",{},"Everyone can watch your video")},{title:c.Ay.t("web_shareYouTube_button_private",{},"Private"),key:fd.private,content:c.Ay.t("web_shareYouTube_text_people_you_choose",{},"Only you and people you choose can watch your video")},{title:c.Ay.t("web_shareYouTube_button_unlisted",{},"Unlisted"),key:fd.unlisted,content:c.Ay.t("web_shareYouTube_text_everyone_with_link",{},"Anyone with the video link can watch your video")}],Ju=({selectedPrivacyLevel:e,setSelectedPrivacyLevel:t})=>(0,n.jsx)(L.A.Item,{label:c.Ay.t("web_shareYouTube_text_privacy_rights",{},"Privacy"),layout:"vertical",children:(0,n.jsx)(N.A,{value:e,dropdownMenuClassName:su.popper,renderFormat:(e,t)=>{const o=Ku.find((e=>e.key===t));return o?`${o.title}: ${o.content}`:void 0},triggerProps:{updateOnScroll:!0,style:{zIndex:1001}},onChange:t,children:Ku.map((e=>(0,n.jsx)(N.A.Option,{value:e.key,children:(0,n.jsxs)("div",{className:su["youtube-privacy-level-select"],children:[(0,n.jsx)("div",{className:su["youtube-privacy-level-select-title"],children:e.title}),(0,n.jsx)("div",{className:su["youtube-privacy-level-select-content"],children:e.content})]})},e.key)))})}),$u=({tags:e,setTags:t})=>{const[o,a]=(0,i.useState)(""),r=(0,i.useMemo)((()=>dl(e)),[e]);return(0,n.jsxs)(L.A.Item,{label:c.Ay.t("web_shareYouTube_title_tag",{},"Tag"),layout:"vertical",className:su["tiktok-allow-users-to"],children:[(0,n.jsx)(Ce.A,{value:e,className:"lv-youtube-input-tag",inputValue:o,placeholder:c.Ay.t("describe_post"),onChange:e=>{t(e),a("")},onInputChange:e=>{const t=dl([e]);t<=100&&r+t<cl&&a(e)}}),(0,n.jsx)("span",{className:"lv-textarea-word-limit",children:`${r+dl([o])}/500`})]})},Qu=()=>(0,n.jsx)(L.A.Item,{layout:"vertical",children:(0,n.jsxs)("div",{className:su["youtube-policy"],children:["By continuing, you confirm that the video you share to YouTube complies with YouTube\u2019s\xa0",(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://www.youtube.com/t/terms",children:"Terms of Service"}),"\xa0and does not infringe upon other people\u2019s intellectual property rights and privacy. Check our\xa0",(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://www.capcut.com/resource/google-api-services-disclosure",children:"Google API Services Disclosure"}),"."]})}),Zu=(0,at.PA)((({videoDuration:e,videoWidth:t,videoHeight:o,form:a,formValue:r,dispatch:s,onSignIn:l,onSignOut:d})=>{const{selectedAccountId:p,title:_,description:h,privacyLevel:m,tags:g=[]}=r;(0,i.useEffect)((()=>{a.setFieldsValue({title:_})}),[_]),(0,i.useEffect)((()=>{a.setFieldsValue({description:h})}),[h]);const v=e=>{s({type:ru.update,data:{selectedAccountId:e}})},{accounts:f}=Vu(),y=f.map((e=>({id:e.email,avatar:e.picture,name:e.name})));(0,i.useEffect)((()=>{y.length>0&&!p&&v(y[0].id)}),[y]);const{fileInfo:w,spaceInfo:b,extraData:x}=du().paramsRecord??{};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Yu,{videoDuration:e,videoWidth:t,videoHeight:o}),(0,n.jsx)(Xd,{value:p,accounts:y,onDown:()=>Vu().fetchAccounts(),onChange:v,onSignIn:()=>null==l?void 0:l(u.q.YouTubeShorts),onSignOut:()=>null==d?void 0:d(u.q.YouTubeShorts)}),(0,n.jsx)(eu,{value:_,label:c.Ay.t("web_postfb_title_title"),maxLength:100,placeholder:c.Ay.t("caption"),autoSize:{maxRows:8,minRows:2},field:"title",rules:Hu,onChange:e=>{s({type:ru.update,data:{title:e}})}}),(0,n.jsx)(eu,{value:h,label:c.Ay.t("web_postfb_title_description"),maxLength:5e3,placeholder:c.Ay.t("describe_post"),autoSize:{maxRows:8,minRows:2},field:"description",rules:qu,onChange:e=>{s({type:ru.update,data:{description:e}})}}),uu()&&(0,n.jsx)(L.A.Item,{layout:"vertical",children:(0,n.jsx)(jm,{platform:u.q.YouTubeShorts,fileInfo:w,spaceInfo:b,extraData:x,maxSize:2,onChange:e=>{s({type:ru.update,data:{cover:e}})},disabled:!1})}),(0,n.jsx)(Ju,{selectedPrivacyLevel:m,setSelectedPrivacyLevel:e=>{s({type:ru.update,data:{privacyLevel:e}})}}),(0,n.jsx)($u,{tags:g,setTags:e=>{s({type:ru.update,data:{tags:e}})}}),(0,n.jsx)(Qu,{})]})}));class Xu extends tu{constructor(){super(),bt(this,"accounts",[]),bt(this,"ifSingleAccount",!0),(0,pt.Gn)(this,{accounts:pt.sH,accountFetching:pt.sH});const e=Td();e.listenUnbind(void 0,(()=>{this.accounts=[]})),this.setPlatformAccount(e)}async fetchAccounts(){this.accountFetching=!0;const e=await p.u.getFacebookShareList({id:this.platformAccountInstance.currentAccountId,type:2});return this.accountFetching=!1,this.accounts=e,!0}}let ep;const tp=()=>(ep||(ep=new Xu),ep),op=()=>(0,n.jsx)(_t.A,{className:su["instagram-reel-no-account-alert"],type:"warning",content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{children:c.Ay.t("web_ytb_ins_text_can_not_find",{},"We couldn\u2019t find an Instagram Business account connected to your Facebook page.")}),(0,n.jsx)("div",{children:c.Ay.t("web_ytb_ins_text_try_again",{},"Please follow the instructions below, check your permissions, and try again.")})]})}),ap=()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:su["instagram-reel-no-account-step"],children:(0,n.jsx)(G.A.Title,{className:su["instagram-reel-no-account-step-title"],children:c.Ay.t("web_ytb_ins_text_connect_ins",{},"Before you connect to Instagram...")})}),(0,n.jsxs)("div",{className:su.item,children:[(0,n.jsx)(G.A.Title,{className:su["instagram-reel-no-account-step-title"],children:c.Ay.t("web_ytb_ins_text_step_one",{},"Step 1: Make sure you have an Instagram Business account.")}),(0,n.jsx)(G.A.Paragraph,{className:su["instagram-reel-no-account-step-content"],children:c.Ay.t("web_ytb_ins_text_have_one",{},"If you don\u2019t have one, go to your Instagram settings and follow these steps to convert it to a business account.")}),(0,n.jsx)(G.A.Paragraph,{className:su["instagram-reel-no-account-step-link"],children:c.Ay.t("web_ytb_ins_button_instr",{href0:e=>(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://help.instagram.com/502981923235522",children:e})})})]}),(0,n.jsxs)("div",{className:su.item,children:[(0,n.jsx)(G.A.Title,{className:su["instagram-reel-no-account-step-title"],children:c.Ay.t("web_ytb_ins_text_link_ins",{},"Step 2: Link your Instagram Business account to a Facebook page.")}),(0,n.jsx)(G.A.Paragraph,{className:su["instagram-reel-no-account-step-content"],children:c.Ay.t("web_ytb_ins_text_facebook",{},"You must have admin access to the Facebook page.")}),(0,n.jsx)(G.A.Paragraph,{className:su["instagram-reel-no-account-step-link"],children:c.Ay.t("web_ytb_ins_button_view_ins",{href0:e=>(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://help.instagram.com/570895513091465",children:e})})})]})]}),np=()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(op,{}),(0,n.jsx)(ap,{})]}),rp=(0,at.PA)((({formValue:e,dispatch:t,onSignIn:o,onSignOut:a})=>{const{selectedAccountId:r,description:s}=e,l=e=>{t({type:ru.update,data:{selectedAccountId:e}})},{accounts:d}=tp(),p=d.map((e=>({id:e.id,avatar:e.picture,name:e.name})));if((0,i.useEffect)((()=>{p.length>0&&!r&&l(p[0].id)}),[p]),0===d.length)return(0,n.jsx)(np,{});const{fileInfo:_,spaceInfo:h,extraData:m}=du().paramsRecord??{};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Xd,{value:r,accounts:p,onDown:()=>tp().fetchAccounts(),onChange:l,onSignIn:()=>null==o?void 0:o(u.q.InstagramReels),onSignOut:()=>null==a?void 0:a(u.q.InstagramReels)}),(0,n.jsx)(eu,{value:s,label:c.Ay.t("web_ytb_ins_text_caption"),maxLength:2200,placeholder:c.Ay.t("web_ytb_ins_text_view_video"),autoSize:{maxRows:8,minRows:2},onChange:e=>{t({type:ru.update,data:{description:e}})}}),uu()&&(0,n.jsx)(L.A.Item,{layout:"vertical",children:(0,n.jsx)(jm,{platform:u.q.YouTube,fileInfo:_,spaceInfo:h,extraData:m,maxSize:2,onChange:e=>{t({type:ru.update,data:{cover:e}})},disabled:!1})}),(0,n.jsx)(L.A.Item,{className:su["instagram-reels-policy"],layout:"vertical",children:c.Ay.t("web_ytb_ins_text_term_of_use",{href:e=>(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://help.instagram.com/581066165581870",children:e})},"When you share to Instagram, you certify that the content you are sharing complies with Instagram\u2019s <href>Terms of Use</href>.")})]})}));class ip extends tu{constructor(){super(),bt(this,"accounts",[]),bt(this,"ifSingleAccount",!1),(0,pt.Gn)(this,{accountFetching:pt.sH,accounts:pt.sH}),this.setPlatformAccount(zd())}async fetchAccounts(){this.accountFetching=!0;const e=this.platformAccountInstance.currentAccountId,{advertisers:t}=await p.v.getAdvertisers({tt4b_uid:e});return this.accountFetching=!1,this.accounts=t,!0}}let sp;const lp=()=>(sp||(sp=new ip),sp),cp=({onSignOut:e})=>(0,n.jsxs)(k.A,{type:"text",className:l()("lv-select-option",Vd["platform-account-selector-sign-out-option"]),size:"small",long:!0,loading:!1,onClickCapture:t=>{t.stopPropagation(),e()},children:[(0,n.jsx)(r.ZT9,{size:16}),c.Ay.t("web_sign_out",{},"Sign out")]}),dp=({onSignIn:e})=>(0,n.jsxs)(k.A,{type:"text",className:l()("lv-select-option",Vd["platform-account-selector-sign-out-option"]),size:"small",long:!0,loading:!1,onClickCapture:t=>{t.stopPropagation(),e()},children:[(0,n.jsx)(r.gsD,{size:16}),c.Ay.t("add_account")]}),up=({onSignIn:e})=>(0,n.jsxs)("div",{className:Vd["account-selector-sign-in"],onClick:e,children:[(0,n.jsx)(r.W2v,{size:32,className:Vd["account-selector-sign-in-avatar"]}),(0,n.jsx)("span",{className:Vd["account-selector-sign-in-text"],children:c.Ay.t("web_sign_in")})]}),pp=({selectedAccountId:e,allAccounts:t})=>{const o=t.find((t=>t.id===e));if(!o)return null;const{name:a,avatar:r,email:i}=o;return(0,n.jsxs)("div",{className:Vd["platform-account-selector-selected-account"],children:[(0,n.jsx)(re.A,{size:32,className:Vd["account-selector-simple-option-avatar"],children:r?(0,n.jsx)("img",{crossOrigin:"anonymous",src:r}):(null==a?void 0:a[0])??""}),(0,n.jsxs)("div",{className:Vd["platform-account-selector-selected-account-content"],children:[(0,n.jsx)("div",{className:Vd["platform-account-selector-selected-account-name"],children:a}),(0,n.jsx)("div",{className:Vd["platform-account-selector-selected-account-email"],children:i})]})]})},_p=()=>(0,n.jsx)("div",{className:Vd["platform-account-selector-switch-account-tip"],children:c.Ay.t("web_switch_account")}),hp=(0,at.PA)((({channelAccountInstance:e,onChange:t,onBind:o,onUnbind:a})=>{const s=e.platformAccountInstance.accounts,l=e.platformAccountInstance.currentAccountId,d=s.length>1,p=e=>{t(e)},_=()=>{e.bindPlatform(((e,t)=>{"success"===e&&(p(t[t.length-1]),null==o||o(u.q.TTAM,t))}))},h=async t=>{const o=await e.unbindPlatform(t);null==a||a(u.q.TTAM,o)};if((0,i.useEffect)((()=>{s.length>0&&!l&&p(s[0])}),[s]),0===s.length)return(0,n.jsx)(L.A.Item,{layout:"vertical",children:(0,n.jsx)(up,{onSignIn:_})});const m=s.filter((e=>e.id!==l));return(0,n.jsx)(L.A.Item,{layout:"vertical",children:(0,n.jsxs)(N.A,{value:l,placeholder:"Select",className:Vd["platform-account-selector"],triggerProps:{style:{zIndex:1002}},renderFormat:(e,t)=>(0,n.jsx)(pp,{selectedAccountId:t,allAccounts:s}),onChange:(e,t)=>{p(t.extra)},children:[d&&(0,n.jsx)(_p,{}),m.map((e=>(0,n.jsxs)(N.A.Option,{value:e.id,className:Vd["platform-account-selector-option-container"],extra:e,children:[(0,n.jsx)("span",{className:Vd["platform-account-selector-option-name"],children:e.name}),(0,n.jsx)(x.A,{className:"lv_chosenPage-tooltip",content:c.Ay.t("web_sign_out1"),children:(0,n.jsx)(r.MpL,{className:"platform-account-selector-option-icon",size:16,color:"#46464c",onClick:()=>h(e.id)})})]},e.id))),d&&(0,n.jsx)(ne.A,{className:Vd["platform-account-selector-divider"]}),(0,n.jsx)(dp,{onSignIn:_}),(0,n.jsx)(cp,{onSignOut:()=>h(l)})]})})})),mp=({noAccount:e})=>{const t=e?c.Ay.t("web_no_advertiser_account",{"text-href":e=>(0,n.jsx)("a",{className:su["ttam-no-advertiser-account-link"],href:"https://ads.tiktok.com/i18n/register",target:"_blank",rel:"noreferrer",onClick:()=>{},children:e})}):c.Ay.t("web_ttam_retry_failure3");return(0,n.jsx)(_t.A,{className:su["ttam-no-advertiser-account"],content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:su["ttam-no-advertiser-account-content"],children:t}),(0,n.jsx)(k.A,{type:"secondary",size:"small",onClick:()=>{},children:c.Ay.t("web_ttam_refresh")})]})})},gp=({accounts:e,selectedAccountIds:t,setSelectedAccountIds:o})=>(0,n.jsx)(n.Fragment,{children:e.map((e=>(0,n.jsxs)("div",{className:su["ttam-advertiser-item"],onClick:()=>(e=>{t.includes(e)?o(t.filter((t=>t!==e))):o(Array.from(new Set(t.concat(e))))})(e.advertiser_id),children:[(0,n.jsxs)("div",{className:su["ttam-advertiser-item-content"],children:[(0,n.jsx)("div",{className:su["ttam-advertiser-item-name"],children:e.advertiser_name}),(0,n.jsxs)("div",{className:su["ttam-advertiser-item-id"],children:["ID: ",e.advertiser_id]})]}),(0,n.jsx)("div",{className:su["ttam-advertiser-item-checkbox"],children:(0,n.jsx)(F.A,{checked:t.includes(e.advertiser_id)})})]},e.advertiser_id)))}),vp=(0,at.PA)((({formValue:e,dispatch:t,onSignIn:o,onSignOut:a})=>{const{selectedAccountId:r=[]}=e,{accounts:s}=lp();return(0,i.useEffect)((()=>{0===r.length&&s.length>0&&t({type:ru.update,data:{selectedAccountId:s.map((e=>e.advertiser_id))}})}),[s]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(hp,{channelAccountInstance:lp(),onChange:e=>{lp().changePlatformAccount(e.id),lp().fetchAccounts()},onBind:o,onUnbind:a}),(0,n.jsxs)(L.A.Item,{layout:"vertical",label:s.length>1?c.Ay.t("web_adv_ids"):c.Ay.t("web_adv_id"),children:[0===s.length&&(0,n.jsx)(mp,{noAccount:!0}),s.length>0&&(0,n.jsx)(gp,{accounts:s,selectedAccountIds:r,setSelectedAccountIds:e=>{t({type:ru.update,data:{selectedAccountId:e}})}})]})]})}));class fp extends tu{constructor(){super(),bt(this,"accounts",[]),bt(this,"ifSingleAccount",!0),(0,pt.Gn)(this,{}),this.setPlatformAccount(Td())}fetchAccounts(){return!0}}let yp;const wp=e=>({[u.q.TikTok]:ku(),[u.q.YouTube]:Lu(),[u.q.YouTubeShorts]:Vu(),[u.q.Instagram]:(yp||(yp=new fp),yp),[u.q.InstagramReels]:tp(),[u.q.FacebookPage]:nu(),[u.q.FacebookGroup]:vu(),[u.q.TTAM]:lp()}[e]),bp="_form-schedule_orv3a_3",xp="_header_orv3a_47",kp="_form-schedule-forms_orv3a_52",Ap="_form-schedule-actions_orv3a_61",Sp="_form-action-schedule-publish_orv3a_86",Cp="_form-action-schedule-left-space_orv3a_94",Ip="_form-action-schedule-update_orv3a_100",Ep="_form-action-schedule-delete_orv3a_106",Tp="_schedule-result_orv3a_113",Pp="_schedule-result-icon_orv3a_121",Np="_schedule-result-title_orv3a_127",jp="_schedule-result-context_orv3a_135",Rp="_schedule-result-operation_orv3a_145",Lp="_schedule-result-active_orv3a_150",Op="_schedule-result-view-btn_orv3a_154",Fp=({container:e,selectedShareChannel:t,scheduleTime:o,fileInfo:r,formValue:i,extraData:s,setSelectedShareChannel:l,setScheduleTime:d,dispatch:_,onSignIn:h,onSignOut:m})=>{var g,v;const[f]=L.A.useForm(),y=async e=>{const t=wp(e);if(!t)return;const o=await t.unbindPlatform();null==m||m(e,o),o?a.A.success(c.Ay.t("sign_out_success")):a.A.error(c.Ay.t("failed_sign_out_try_later"))},w=e=>{const t=wp(e);t&&t.bindPlatform(((o,a)=>{"success"===o&&(t.fetchAccounts(),null==h||h(e,a))}))};return(0,n.jsx)("div",{className:kp,children:(0,n.jsxs)(L.A,{form:f,scrollToFirstError:!0,children:[(0,n.jsx)(qd,{value:t,onChange:e=>{l(e);const t=wp(e);t&&(t.validateIfBindPlatform()?t.fetchAccounts():(t.bindPlatform(((o,a)=>{"success"===o&&(t.fetchAccounts(),null==h||h(e,a)),(new p.x).report({status:o,platform:e,current_page:s.currentPage,facebookShareType:u.J[e],youtubeShareType:u.K[e],businessType:u.F.FilmVideo})})),(new p.y).report({platform:e,current_page:s.currentPage,facebookShareType:u.J[e],youtubeShareType:u.K[e],businessType:u.F.FilmVideo})))}}),(0,n.jsx)(Kd,{container:e,onChange:e=>{d(e)},timestamp:o}),t===u.q.FacebookPage&&(0,n.jsx)(hu,{formValue:i,dispatch:_,onSignOut:y,onSignIn:w}),t===u.q.FacebookGroup&&(0,n.jsx)(wu,{formValue:i,dispatch:_,onSignOut:y,onSignIn:w}),t===u.q.TikTok&&(0,n.jsx)(Nu,{formValue:i,dispatch:_,onSignOut:y,onSignIn:w}),t===u.q.YouTube&&(0,n.jsx)(zu,{form:f,formValue:i,dispatch:_,onSignOut:y,onSignIn:w}),t===u.q.YouTubeShorts&&(0,n.jsx)(Zu,{videoDuration:null==r?void 0:r.duration,videoWidth:null==(g=null==r?void 0:r.asset)?void 0:g.width,videoHeight:null==(v=null==r?void 0:r.asset)?void 0:v.height,form:f,formValue:i,dispatch:_,onSignOut:y,onSignIn:w}),t===u.q.InstagramReels&&(0,n.jsx)(rp,{formValue:i,dispatch:_,onSignOut:y,onSignIn:w}),t===u.q.TTAM&&(0,n.jsx)(vp,{formValue:i,dispatch:_,onSignOut:y,onSignIn:w})]})})},Dp=({disabled:e,content:t,children:o})=>(0,n.jsx)(x.A,{disabled:e,content:t,style:{zIndex:10001},children:o}),Up=({deleteLoading:e,updateLoading:t,publishLoading:o,mode:a,disabled:i,onPublish:s,onDelete:l,onUpdate:d,toolTipText:u})=>a===iu.delete?(0,n.jsxs)("div",{className:Ap,children:[(0,n.jsx)(k.A,{className:Ep,loading:e,disabled:i,icon:(0,n.jsx)(r.aYw,{size:20}),onClick:l}),(0,n.jsx)("div",{className:Cp,children:(0,n.jsx)(Dp,{disabled:!i||!u,content:u??"",children:(0,n.jsx)(k.A,{long:!0,type:"primary",className:Ip,onClick:d,loading:t,disabled:i,children:c.Ay.t("web_timing_text_update",{},"Update settings")})})})]}):(0,n.jsx)("div",{className:Ap,children:(0,n.jsx)(Dp,{disabled:!i||!u,content:u??"",children:(0,n.jsx)(k.A,{long:!0,type:"primary",className:Sp,loading:o,disabled:i,icon:(0,n.jsx)(r._vE,{size:20}),onClick:s,children:c.Ay.t("web_timing_button_set_to_publish",{},"Schedule")})})});var Mp=(e=>(e.Success="success",e.CreateFail="createFail",e.UpdateFail="updateFail",e))(Mp||{});const Bp=e=>{const t={icon:(0,n.jsx)(r.P5J,{size:100}),title:c.Ay.t("web_timing_text_not_set",{},"Couldn\u2019t schedule"),context:c.Ay.t("web_timing_text_feedback",{action0:t=>(0,n.jsx)("a",{className:Lp,onClick:e.triggerFeedback,children:t})},"You can <action0>give us feedback</action0>."),buttons:(0,n.jsx)(k.A,{size:"large",onClick:e.goBack,children:c.Ay.t("web_timing_text_back_settings",{},"Go back")})},o={success:{icon:(0,n.jsx)(r.CAy,{size:100}),title:c.Ay.t("web_timing_button_button_schedule_set",{},"Scheduled"),context:e.scheduleTime?c.Ay.t("web_timing_text_video_will",{string0:"platform",string1:se()(e.scheduleTime).format("YYYY-MM-DD"),string2:se()(e.scheduleTime).format("H:mm"),string3:se()(e.scheduleTime).format("A")},"Your video will be shared to {string0} on {string1} at {string2} {string3}."):"",buttons:(0,n.jsxs)(k.A,{size:"large",onClick:e.goCalendar,className:Op,type:"primary",children:[(0,n.jsx)(r._vE,{size:20}),c.Ay.t("web_timing_text_view",{},"View schedule")]})},createFail:t,updateFail:t},{icon:a,title:i,context:s,buttons:l}=o[e.status],d=![p.O.uploadShare,p.O.modalWorkspace].includes(e.openType)&&(!(0,B.Ib)(e.openType)||(0,B.vN)(e.openType));return(0,n.jsxs)("div",{className:bp,children:[(0,n.jsx)("div",{className:xp,children:(0,n.jsx)(hs,{headTitle:c.Ay.t("web_timing_title_schedule_Post",{},"Schedule"),handleBack:e.goBack,visible:d})}),(0,n.jsxs)("div",{className:Tp,children:[(0,n.jsx)("div",{className:Pp,children:a}),(0,n.jsx)("div",{className:Np,children:i}),(0,n.jsx)("div",{className:jp,children:s}),(0,n.jsx)("div",{className:Rp,children:l})]})]})};class zp{constructor(){bt(this,"_mediaRecord")}set(e){this._mediaRecord=e}get mediaRecord(){return this._mediaRecord}clear(){this._mediaRecord=void 0}}let Gp;function Wp(e){return(0,Fe.A)(e,((e,t,o,a)=>{e[(0,De.A)(a)?o:(0,Be.A)(o)]=(0,Ue.A)(t)?Wp(t):t}))}const Vp={[u.q.TikTok]:1,[u.q.YouTube]:2,[u.q.TTAM]:3,[u.q.YouTubeShorts]:2,[u.q.FacebookGroup]:4,[u.q.FacebookPage]:4,[u.q.InstagramReels]:4};function Hp(e,t){let o;try{o=Wp(JSON.parse(t))}catch(a){return d.s.error("formatFormValueByObject",a),wd(e)}if(e===u.q.FacebookGroup||e===u.q.FacebookPage){const{title:e="",describe:t=""}=o;return{title:e,description:t}}if(e===u.q.InstagramReels){const{describe:e=""}=o;return{description:e}}if(e===u.q.YouTube||e===u.q.YouTubeShorts){const{title:e="",describe:t="",cover:a="",privacy_level:n,tags:r=[]}=o;return{title:e,description:t,cover:a,tags:r,privacyLevel:n}}if(e===u.q.TikTok){const{title:e="",privacy_level:t,disable_comment:a,disable_duet:n,disable_stitch:r,brand_content_toggle:i,brand_organic_toggle:s}=o;return{title:e,privacyLevel:{PUBLIC_TO_EVERYONE:gd.public,FOLLOWER_OF_CREATOR:gd.followers,MUTUAL_FOLLOW_FRIENDS:gd.friends,SELF_ONLY:gd.private}[t]??gd.public,disableComment:typeof a>"u"||a,disableDuet:typeof n>"u"||n,disableStitch:typeof r>"u"||r,isDiscloseVideoContent:i||s,isPromoteOwnBrand:!!s,isPromoteOtherBrand:!!i}}if(e===u.q.TTAM){const{adv_list:e}=o;return{selectedAccountId:e||[]}}return wd(e)}const qp=(e,t,o)=>{const[a,n]=(0,i.useState)(!1),[r,s]=(0,i.useState)();return(0,i.useEffect)((()=>{if(t){if(o&&t===o.shareChannel)return void s(function(e,t){const{formInfo:o}=t;return Hp(e,o)}(t,o));s(wd(t)),n(!0),async function(e,t){const o=Vp[t];if(o)try{const{form_info:a}=await p.t.getShareFormInfo({id:e,share_type:u.F.FilmVideo,platform:o});return a?Hp(t,a):(d.s.error("fetchFormValue",new Error("formInfo is empty")),wd(t))}catch(a){return d.s.error("fetch form value error",a),wd(t)}}(e,t).then((e=>{s(e)})).finally((()=>{n(!1)}))}}),[e,t,o]),{loading:a,formValue:r}},Yp=(e,t)=>{if(!e)return{};if(e===u.q.TikTok){const{title:e,privacyLevel:o,disableComment:a,disableDuet:n,disableStitch:r,isPromoteOwnBrand:i,isPromoteOtherBrand:s}=t;return{title:e,privacy_level:{[gd.public]:"PUBLIC_TO_EVERYONE",[gd.followers]:"FOLLOWER_OF_CREATOR",[gd.friends]:"MUTUAL_FOLLOW_FRIENDS",[gd.private]:"SELF_ONLY"}[o??gd.public],disable_comment:a,disable_duet:n,disable_stitch:r,brand_organic_toggle:i,brand_content_toggle:s}}if(e===u.q.TTAM){const{selectedAccountId:e=[]}=t,{accounts:o=[]}=lp();return{advertisers:o.filter((t=>e.includes(t.advertiser_id))),video_name:""}}if(e===u.q.FacebookGroup){const{title:e,description:o,selectedAccountId:a}=t,{accounts:n=[]}=vu(),{id:r}=n.find((e=>e.id===a))??{};return{access_token:"",cover:"",id:r,title:e,describe:o,type:1}}if(e===u.q.FacebookPage){const{title:e,description:o,selectedAccountId:a}=t,{accounts:n=[]}=nu();return{...n.find((e=>e.id===a))??{},title:e,describe:o,type:0}}if(e===u.q.InstagramReels){const{description:e,selectedAccountId:o}=t,{accounts:a=[]}=tp();return{...a.find((e=>e.id===o))??{},describe:e,type:2}}if(e===u.q.YouTube){const{title:e,description:o,cover:a,privacyLevel:n,tags:r}=t;return{title:e,describe:o,cover:a,privacyLevel:n,tags:r,youtube_share_type:0}}if(e===u.q.YouTubeShorts){const{title:e,description:o,cover:a,privacyLevel:n,tags:r}=t;return{title:e,describe:o,cover:a,privacyLevel:n,tags:r,youtube_share_type:1}}return{}},Kp=(e,t)=>{var o,a,n;switch(e){case u.q.TikTok:{const{title:e,privacyLevel:a,disableComment:n,disableDuet:r,disableStitch:i}=t,s={[gd.public]:"public",[gd.followers]:"followers",[gd.friends]:"friends",[gd.private]:"private"};return{share_account:null==(o=Rd().accounts[0])?void 0:o.name,share_caption:e,share_caption_words_cnt:e.length,platform:"tiktok",share_view_range:s[a],allow_comment:+!n,allow_duet:+!r,allow_stitch:+!i}}case u.q.FacebookGroup:{const{title:e,description:o}=t;return{platform:"facebook",description:o,share_account:"",share_caption:e,share_caption_words_cnt:o.length}}case u.q.FacebookPage:{const{title:e,description:o}=t;return{platform:"facebook",description:o,share_account:"",share_caption:e,share_caption_words_cnt:o.length}}case u.q.InstagramReels:{const{description:e}=t;return{platform:"ins",description:e,share_account:"",share_caption:e,share_caption_words_cnt:e.length}}case u.q.YouTube:{const{title:e,description:o,cover:n,privacyLevel:r}=t;return{platform:"youtube",share_caption:e,share_caption_words_cnt:o.length,share_view_range:r,share_email:null==(a=Lu().accounts[0])?void 0:a.email,is_cover_added:n?"1":"0"}}case u.q.YouTubeShorts:{const{title:e,description:o,cover:a,privacyLevel:r}=t;return{platform:"ytb_shorts",share_email:null==(n=Lu().accounts[0])?void 0:n.email,share_caption:e,share_caption_words_cnt:o.length,share_view_range:r,is_cover_added:a?"1":"0"}}default:return{}}},Jp=({currentPage:e,usedTtLiveMaterial:t})=>{var o,a,n;const r=null==(a=null==(o=(0,u.r)())?void 0:o.getConfig())?void 0:a.header;return{header:r,client_ip:"",params:{scenario:"custom",current_page:e,is_pwa:(0,p.i)()?1:0,pwa_from:(0,p.w)(),open_from_pwa:(0,p.e)()?1:0,used_ttlive_material:t?1:0},user:{user_id:"uid",user_id_login:!0,user_unique_id:"uid",web_id:null==(n=null==r?void 0:r.custom)?void 0:n.web_id}}},$p=(0,u.n)();function Qp(e,{type:t,data:o}){return t===ru.update?{...e,...o}:t===ru.overwrite?{...o}:{}}const Zp=({fileInfo:e,spaceInfo:t,extraData:o,mediaRecord:r,platformAccount:s,defaultScheduleTime:l,scheduleTask:_,disabled:m,scheduleCb:g,onSignIn:v,onSignOut:f,handleBack:w,openType:b,selectItemID:x})=>{const k=(0,i.useRef)(null),[A,S]=(0,i.useState)(),[C,I]=(0,i.useState)(Date.now()+3e5),[E,T]=(0,i.useReducer)(Qp,{}),[P,N]=(0,i.useState)(),[j,R]=(0,i.useState)(!1),[L,O]=(0,i.useState)(!1),[F,D]=(0,i.useState)(!1);(0,i.useEffect)((()=>{!function(e){var t;(0,Oe.A)(null==e?void 0:e.facebook_user_info)?Td().addPlatformAccount({...e.facebook_user_info,avatar:e.facebook_user_info.picture}):Td().initPlatformAccount(),(0,Oe.A)(null==e?void 0:e.youtube_user_info)?Dd().addPlatformAccount({...e.youtube_user_info,id:e.youtube_user_info.email,avatar:e.youtube_user_info.picture}):Dd().initPlatformAccount(),(0,Oe.A)(null==e?void 0:e.tt_user_info)?Rd().addPlatformAccount({...e.tt_user_info,id:e.tt_user_info.creator_username,name:e.tt_user_info.creator_nickname,avatar:e.tt_user_info.creator_avatar_url}):Rd().initPlatformAccount(),Array.isArray(null==(t=null==e?void 0:e.TTAM)?void 0:t.accounts)?zd().addPlatformAccounts(e.TTAM.accounts.map((e=>({...e,id:e.tt4b_uid,avatar:"",name:e.display_name})))):zd().initPlatformAccount()}(s)}),[s]),(0,i.useEffect)((()=>{(Gp||(Gp=new zp),Gp).set(r)}),[r]),(0,i.useEffect)((()=>{du().set({fileInfo:e,spaceInfo:t,extraData:o})}),[e,t,o]);const{formValue:U}=qp(e.fileId,A,_);(0,i.useEffect)((()=>{T({type:ru.overwrite,data:U??{}})}),[A,U]),((e,t,o)=>{(0,i.useEffect)((()=>{(()=>{if(se()().isSame(se()(e),"day"))return;const a=(null==t?void 0:t.scheduleTime)??e;a&&o(a)})()}),[e,t,o])})(l,_,I),(0,i.useEffect)((()=>{if(!_)return;const{shareChannel:e,status:t}=_;"Scheduled"!==t&&N(Mp.UpdateFail),S(e);const o=wp(e);o&&o.fetchAccounts()}),[_]);const M=(e,t)=>{!function({openType:e,action:t,shareChannel:o,formValue:a,moreParams:n}){if(!a)return;const r={...n,...Kp(o,a),action:t};if((0,B.ij)(e)){const t=e===p.O.modalWorkspace?"schedule_from_space":"schedule_from_local";ca().report({...r,enter_from:t})}else(0,B.C5)(e)?p.o.reportEvent({...$p.getReportParam(),...r}):$p.report(r)}({openType:b,shareChannel:A,formValue:E,action:e,moreParams:t})};(0,i.useEffect)((()=>{M(u.E.show,{video_id:e.fileId})}),[]);const z=()=>{!_||!("id"in _)||(e=>{const t={title:c.F2.t("confirm_deletion",{},"\u786e\u8ba4\u5220\u9664"),content:c.F2.t("please_confirm_whether_to_delete",{},"\u8bf7\u786e\u8ba4\u662f\u5426\u5220\u9664"),okText:c.F2.t("web_confirm",{},"\u786e\u8ba4"),cancelText:c.F2.t("web_cancel",{},"\u53d6\u6d88")},o=Object.assign(t,e);y.A.confirm({className:`lv-confirm-modal_container ${o.className||""}`,mask:null==e?void 0:e.mask,wrapClassName:o.wrapClassName,title:o.title,content:o.content,okText:o.okText,cancelText:o.cancelText,cancelButtonProps:{size:"large",...o.cancelButtonProps},okButtonProps:{status:"danger",size:"large",style:{marginLeft:16},...o.okButtonProps},maskClosable:o.maskClosable,onOk:async e=>{var t;return o.onBeforeOk&&await o.onBeforeOk(),null==(t=o.onOk)?void 0:t.call(o,e)},onCancel:o.onCancel})})({mask:!0,title:c.Ay.t("web_timing_button_remove",{},"Remove from calendar"),content:c.Ay.t("web_timing_text_sure_want",{},"This video won\u2019t be shared."),okText:c.Ay.t("web_timing_text_remove_post",{},"Remove"),cancelText:c.Ay.t("web_timing_button_cancel",{},"Cancel"),onOk:async()=>{var e,t;try{D(!0),await Lo.cancel({id:_.id,cancel_type:zt.scheduleID}),D(!1),null==(e=Ev())||e.close(),null==(t=null==g?void 0:g.onRemove)||t.call(g,_.id),a.A.success(c.Ay.t("web_timing_text_removed",{},"Video removed from schedule"))}catch{D(!1),a.A.error(c.Ay.t("web_timing_text_remove_failed",{},"Couldn\u2019t remove video from schedule"))}}})};if((e=>{const t=(0,u.n)(),o=ca();(0,i.useEffect)((()=>{e?(t.setParam({panel_page:u.P.schedule_result}),o.setParam({panel_page:u.P.schedule_detail})):(t.setParam({panel_page:u.P.schedule_detail}),o.setParam({panel_page:u.P.schedule_detail}))}),[e])})(P),P)return(0,n.jsx)(Bp,{status:P,scheduleTime:C,goCalendar:()=>{(0,h.r)(d.R.WORKSPACE.CHILD.PUBLISH_CALENDAR.PATH),M(u.E.view_calender)},goBack:()=>N(void 0),triggerFeedback:()=>Ji({}),openType:b});const G=((e,t,o)=>{if(e)return{isValidate:!1,errorReason:c.Ay.t("web_posttemplate_toast_exporting_video")};if(!t||null==o||!o.selectedAccountId)return{isValidate:!1};if(t===u.q.TikTok){const{isDiscloseVideoContent:e,isPromoteOwnBrand:t,isPromoteOtherBrand:a,privacyLevel:n}=o;return n?e?t||a?{isValidate:!0}:{isValidate:!1,errorReason:c.Ay.t("web_posttt_text_legal_copy4",{},"Select disclosed content type or turn off the toggle")}:{isValidate:!0}:{isValidate:!1,errorReason:c.Ay.t("web_cover_text_sure_privacy",{},"Make sure your privacy settings here are consistent with that on your TikTok app.")}}return{isValidate:!0}})(m,A,E),W=!G.isValidate,V=G.errorReason??"";return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:bp,ref:k,children:[(0,n.jsx)("div",{className:xp,children:(0,n.jsx)(hs,{headTitle:c.Ay.t("web_timing_title_schedule_Post",{},"Schedule"),handleBack:()=>null==w?void 0:w(),visible:!x&&![p.O.uploadShare,p.O.modalWorkspace].includes(b)})}),(0,n.jsx)(Fp,{container:k,selectedShareChannel:A,scheduleTime:C,fileInfo:e,formValue:E,setSelectedShareChannel:S,setScheduleTime:I,dispatch:T,extraData:o,onSignIn:function(e,t){null==v||v(e,t),M(u.E.sign_in)},onSignOut:function(e,t){null==f||f(e,t),M(u.E.sign_out)}}),(0,n.jsx)(Up,{disabled:W,toolTipText:V,mode:_?iu.delete:iu.publish,updateLoading:j,publishLoading:L,deleteLoading:F,onPublish:()=>{M(u.E.set_to_publish),(async()=>{var e;O(!0);try{const t=Jp({currentPage:o.currentPage,usedTtLiveMaterial:!1}),{shareType:a,assetIdList:n}=r,i={platform:To(A),shareType:a,assetIdList:n,scheduleTime:C,formInfo:Yp(A,E),customInfo:JSON.stringify(t)},{id:s}=await Lo.create(i);null==(e=null==g?void 0:g.onCreate)||e.call(g,{...i,id:s,shareChannel:A,status:Et}),N(Mp.Success)}catch{N(Mp.CreateFail)}finally{O(!1)}})()},onUpdate:()=>{M(u.E.set_to_publish),(async()=>{var e;R(!0);const t=Jp({currentPage:o.currentPage,usedTtLiveMaterial:!1});try{const{shareType:o,assetIdList:a}=r,n={id:_.id,platform:To(A),shareType:o,assetIdList:a,scheduleTime:C,formInfo:Yp(A,E),customInfo:JSON.stringify(t)};await Lo.update(n),null==(e=null==g?void 0:g.onUpdate)||e.call(g,_.id,{id:_.id,shareChannel:A,scheduleTime:C,formInfo:JSON.stringify(E),status:Et}),N(Mp.Success)}catch{N(Mp.UpdateFail)}finally{R(!1)}})()},onDelete:()=>{M(u.E.remove_post),z()}})]})})};function Xp(e){const t=window.location.href;return["tools","create","resource"].find((e=>t.includes(`/${e}/`)))||(null==e?void 0:e.get("article_type"))||""}const e_=e=>{const{options:t,customLoginReportParams:o,fixedTheme:a,fallback:r,currentPage:s}=e,l=Cn(),c=typeof window<"u"?new URLSearchParams(l):void 0,d=(0,i.useRef)(null),u=(0,f.F)(vn,{context:{...t,loginReportParams:{...o,statusEnterFrom:(null==c?void 0:c.get("enter_from"))??"",pageEnterFrom:(null==c?void 0:c.get("enter_from"))??"",currentPage:(null==c?void 0:c.get("current_page"))??s??"",articleType:Xp(c),articleTitle:(null==c?void 0:c.get("article_title"))??"",toolType:(null==c?void 0:c.get("tool_type"))??""},showRestoreModal:wn,noCareerCb:()=>{var e;return null==(e=d.current)?void 0:e.call(d)}}}),[p]=(0,g.B)(u),_=["unknown","fetchingLocation"].some(p.matches),h=(null==t?void 0:t.shouldFetchLocation)&&_,[m,v]=function(e=!0){const[t,o]=(0,i.useState)(St.Light);return(0,i.useEffect)((()=>e?xn.init(o):()=>{}),[]),[t,function(t){e&&(xn.apply(t,!0),o(t))}]}(!a);(0,i.useEffect)((()=>{var e;null==(e=null==t?void 0:t.onContextChange)||e.call(t,p.context)}),[t,p.context]),(0,i.useEffect)((()=>{null!=t&&t.shouldShowCareerModal&&null===d.current&&p.children.LvUserCareerMachine&&(d.current=()=>(e=>y.A.info({maskClosable:!1,escToExit:!1,backspaceToExit:!1,alignCenter:!1,wrapStyle:{zIndex:1101},modalRender:()=>(0,n.jsx)("div",{className:wl,children:(0,n.jsx)(Hl,{service:e})})}))(p.children.LvUserCareerMachine))}),[null==t?void 0:t.shouldShowCareerModal,p]);const w=(0,i.useMemo)((()=>kn()),[]);return h?r??null:(0,n.jsx)(bn.Provider,{value:{userService:u,theme:a??m,setTheme:v,locale:w},children:e.children})},t_=e=>{const{renderInServer:t}=e;return t?e.children||null:(0,n.jsx)(e_,{...e})},o_="324442",a_=0,n_=-1;class r_{constructor(){bt(this,"uploader",null),bt(this,"stsToken",{})}async auth(){const e=await oo.getUploadToken(Qt.image);this.stsToken={AccessKeyId:e.access_key_id,SecretAccessKey:e.secret_access_key,SessionToken:e.session_token,ExpiredTime:e.expired_time,CurrentTime:e.current_time}}async init(e=""){if(!this.uploader){await this.auth();let t="us",o="danaa4gfht";const{data:a}=await Y.a.getLocation();switch(a.web_idc){case"useast2a":t="gcp";break;case"sg1":t="sg",o="tnf8g33v4j";break;default:t="us"}this.uploader=new(rt())({userId:e,appId:Number(o_),region:t,imageConfig:{serviceId:o},...yl({region:t})})}return this.uploader}async upload(e,t="image",o){const a=await this.init(),n=e.name.includes(".")?e.name.split(".")[0]:e.name,r=n.replace(/\#|\?|\//g,"-").trim(),i=a.addFile({file:e,stsToken:this.stsToken,storeKey:n?`${Date.now()}.${r}`:void 0,type:t});return a.start(i),new Promise((t=>{a.on("progress",(e=>{null==o||o(e.percent)})),a.on("complete",(o=>{const a=o;if(e.name!==a.fileName)return;const r=a.uploadResult;(0,Se.A)(r,{fileName:n}),t({data:r,code:a_})})),a.on("error",(e=>{t({code:n_,msg:null==e?void 0:e.extra.message})}))}))}}let i_;async function s_(e){return i_||(i_=new r_),(await i_.upload(e)).data}var l_=(e=>(e.upload="upload",e.video="video",e.highlight="highlight",e.staticCover="staticCover",e))(l_||{}),c_=(e=>(e.edit="Edit",e.selectFrame="SelectFrame",e))(c_||{});const d_=(0,i.createContext)({}),u_="selectType",p_="modalType,",__="frameList",h_="selectLocalFile",m_="cancelUpload",g_="videoParam",v_="seekTo",f_="videoLoading",y_="highlightParam",w_="selectedIndex",b_="isSettingCover",x_="isOpeningGraphic",k_="isAddingFramesToGraphic",A_="showEditorGraphic",S_="graphicEditorManager",C_="graphicEditorIframe",I_="closeGraphic",E_="selectFramesForGraphicParams";function T_(e,t){const{videoParam:o,highlightParam:a}=e;switch(t.type){case u_:return{...e,selectType:t.payload.selectType};case p_:return{...e,modalType:t.payload.modalType};case __:return{...e,frameList:t.payload.frameList,smallFrameList:t.payload.smallFrameList};case b_:return{...e,isSettingCover:t.payload.isSettingCover};case h_:return{...e,selectLocalFile:t.payload.selectLocalFile};case m_:return{...e,selectType:t.payload.selectType,selectLocalFile:t.payload.selectLocalFile};case g_:return{...e,videoParam:t.payload.videoParam};case v_:return{...e,videoParam:{...o,seekTo:t.payload.seekTo}};case f_:return{...e,videoParam:{...o,loading:t.payload.loading}};case y_:return{...e,highlightParam:t.payload.highlightParam};case w_:return{...e,highlightParam:{...a,selectedIndex:t.payload.selectedIndex}};case I_:return{...e,...t.payload};case x_:return{...e,isOpeningGraphic:t.payload.isOpeningGraphic};case A_:return{...e,showEditorGraphic:t.payload.showEditorGraphic};case S_:return{...e,graphicEditorManager:t.payload.graphicEditorManager};case C_:return{...e,graphicEditorIframe:t.payload.graphicEditorIframe};case k_:return{...e,isAddingFramesToGraphic:t.payload.isAddingFramesToGraphic};case E_:return{...e,selectFramesForGraphicParams:t.payload.selectFramesForGraphicParams};default:return e}}const P_="share_cover_image";function N_(e,t){return(0,i.useCallback)((async()=>{let o=null,a=e.frameSize.width,n=e.frameSize.height,r="";switch(e.selectType){case l_.upload:if(e.selectLocalFile){const{file:t,width:i,height:s,url:l}=e.selectLocalFile;o=t,r=l,a=i,n=s}break;case l_.video:o=await function(e,t){return new Promise((o=>{e.toBlob((e=>{const a=new File([e],t);o(a)}))}))}(e.videoCanvas,P_),r=e.videoCanvas.toDataURL();break;case l_.highlight:const{candidateFrameList:i,selectedIndex:s}=e.highlightParam,l=(null==i?void 0:i[s].url)??"";o=await L_(l,P_,e.upscalerSize.width,e.upscalerSize.height),r=l;break;case l_.staticCover:if(!t.coverInfo)break;const{url:c,width:d,height:u,file:p}=t.coverInfo;let _=p;p||(_=await L_(c,P_,d,u)),o=_,a=d,n=u,r=c}return{file:o,url:r,width:a,height:n}}),[e.selectType,e.videoCanvas,e.highlightParam,e.selectLocalFile])}const j_=/^data:image\/(png|jpeg|heif|heic);base64,/g;function R_(e){return e.replace(j_,"")}function L_(e,t,o,a){return new Promise(((n,r)=>{const i=document.createElement("canvas");i.width=o,i.height=a;const s=i.getContext("2d"),l=new Image;l.src=e,l.onload=function(){s.drawImage(l,0,0,o,a),i.toBlob((e=>{const o=new File([e],t);n(o)}))},l.onerror=()=>r()}))}const O_={coverGraphicEditorMask:"_coverGraphicEditorMask_wz64z_1",active:"_active_wz64z_11",loadingMask:"_loadingMask_wz64z_15",loadingTips:"_loadingTips_wz64z_20",tips:"_tips_wz64z_34",coverGraphicEditorContainer:"_coverGraphicEditorContainer_wz64z_37","logo-TopLeft":"_logo-TopLeft_wz64z_53"},F_=i.forwardRef((({store:e,managers:t},o)=>{const{showEditorGraphic:a,isOpeningGraphic:r,graphicEditorIframe:s}=e,d=a,[u,p]=(0,i.useState)(0),{graphicEditorManager:_}=t,[,h]=(0,i.useReducer)((e=>e+1),1);(0,i.useImperativeHandle)(o,(()=>({forceRender:h}))),(0,i.useEffect)((()=>{if(d){p(0);const e=((e,t)=>{const o={throttle:300,max:.9,...t||{}},a=Date.now();let n=!1;const r=()=>{const t=Date.now()-a,i=Math.min(t/e,o.max);o.onprogress(i),i>=o.max?n=!0:window.requestAnimationFrame(r)};return window.requestAnimationFrame(r),()=>{n=!0}})(6e3,{onprogress:e=>{p(e)},max:.9});return()=>{null==e||e()}}p(0)}),[d]);const[m,g]=(0,i.useState)(!(null==_?void 0:_.isReady)||r);(0,i.useEffect)((()=>{a&&_?(g(!(null==_?void 0:_.isReady)||r),null!=_&&_.isReady||null==_||_.ready().then((()=>{g(!1)}))):g(!0)}),[a,_,r]);const v=window.document.body,f=(0,i.useRef)(null);return(0,i.useEffect)((()=>{var e;return s&&(null==(e=f.current)||e.appendChild(s)),()=>{s&&s.remove()}}),[s]),(0,i.useEffect)((()=>{function e(e){e.preventDefault(),e.returnValue=""}return d&&window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[d]),(0,Le.createPortal)((0,n.jsxs)("div",{className:l()(O_.coverGraphicEditorMask,d&&O_.active),children:[m?(0,n.jsx)("div",{className:O_.loadingMask,children:(0,n.jsxs)("div",{className:O_.loadingTips,children:[(0,n.jsx)(zn,{className:O_.logoTopLeft,width:80,height:80}),(0,n.jsxs)("div",{children:[(0,n.jsx)(z.A,{animation:!0,showText:!1,percent:100*u,width:"100%"}),(0,n.jsx)("span",{className:O_.tips,children:c.Ay.t("web_graphic_cover_loading_editing_cover",{},"Opening image editor...")})]})]})}):null,(0,n.jsx)("div",{ref:f,className:l()(O_.coverGraphicEditorContainer,d&&!m&&O_.active)})]}),v)})),D_="_skeletonLoading_92yu5_9",U_="_coverTypeSelectorWrapper_17lfx_1",M_="_coverTypeSelector_17lfx_1",B_="_coverTypeItem_17lfx_11",z_="_selected_17lfx_19",G_=({selectType:e,changeSelectType:t})=>(0,n.jsx)("div",{className:U_,children:(0,n.jsxs)("div",{className:M_,children:[(0,n.jsx)("div",{className:l()(B_,l_.video===e&&z_),onClick:()=>t(l_.video),children:c.F2.t("web_modal_cover_video_item",{},"From video")}),(0,n.jsx)("div",{className:l()(B_,l_.highlight===e&&z_),onClick:()=>t(l_.highlight),children:c.F2.t("web_modal_cover_highlight_item",{},"Highlighted")})]})}),W_="_highlightWrapper_qx8x3_1",V_="_highlightMain_qx8x3_6",H_="_selectedImg_qx8x3_13",q_="_selectedImgSkeleton_qx8x3_14",Y_="_selectedImgEmpty_qx8x3_15",K_="_highlightErrorWrapper_qx8x3_35",J_="_emptyError_qx8x3_51",$_="_highlightList_qx8x3_54",Q_="_highlightItem_qx8x3_62",Z_="_highlightSketetonItem_qx8x3_63",X_="_selected_qx8x3_13",eh=({aspectRatio:e,staticHeight:t,className:o,children:a})=>{const[r,{height:s}]=(0,ge.A)(),l=(0,i.useMemo)((()=>Math.min(Math.max(e,.5),2)),[e]);return(0,n.jsx)("div",{className:o,ref:r,style:{height:(t&&`${t}px`)??"100%",width:`${Math.floor((t??s)*l)}px`},children:a})},th=({style:e,loading:t,selectType:o,aspectRatio:a,candidateFrameList:i,highlightList:s,selectedIndex:d,changeSelectType:u,errorStatus:p,handleSelectHighlight:_,handleGetHighlightFrame:h})=>{var m;return(0,n.jsxs)("div",{className:W_,style:e,children:[(0,n.jsx)("div",{className:V_,children:(0,n.jsx)(eh,{staticHeight:248,aspectRatio:a,children:"success"!==p?(0,n.jsx)("div",{className:Y_,children:(0,n.jsx)(Dn,{size:36})}):(0,n.jsx)(n.Fragment,{children:t?(0,n.jsx)("div",{className:l()(D_,q_)}):(0,n.jsx)("img",{src:null==(m=null==i?void 0:i[d])?void 0:m.url,className:H_,crossOrigin:"anonymous"})})})}),(0,n.jsx)(G_,{selectType:o,changeSelectType:u}),["error","empty"].includes(p)?(0,n.jsxs)("div",{className:l()(K_,"empty"===p&&J_),onClick:"error"===p?h:void 0,children:[(0,n.jsx)(n.Fragment,{children:"error"===p&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.YUV,{size:18,style:{marginRight:"4px"}}),c.Ay.t("web_found_frame_failure",{},"Failed to found video frame. Please check the network.")]})}),(0,n.jsx)(n.Fragment,{children:"empty"===p&&c.Ay.t("web_cover_download_text_no_highlight_in_project",{},"Add a video to get highlighted images.")})]}):(0,n.jsx)("div",{className:$_,children:t?new Array(5).fill(0).map(((e,t)=>(0,n.jsx)(eh,{staticHeight:76,className:l()(D_,Z_),aspectRatio:a},t))):null==s?void 0:s.map((e=>{var t;return(0,n.jsx)(eh,{staticHeight:76,aspectRatio:a,children:(0,n.jsx)("img",{src:null==(t=null==i?void 0:i[e])?void 0:t.url,draggable:!1,className:l()(Q_,e===d&&X_),crossOrigin:"anonymous",onClick:()=>_(e)})},e)}))})]})},oh="_uploadWrapper_ddmpl_1",ah="_container_iwlf0_1",nh="_image_iwlf0_8",rh=({picUrl:e})=>(0,n.jsx)("div",{className:ah,children:(0,n.jsx)("div",{className:"cover-wrapper",children:(0,n.jsx)("img",{className:nh,draggable:!1,src:e,crossOrigin:"anonymous"})})}),ih=({store:e})=>{const{selectLocalFile:t}=e;let{aspectRatio:o}=e;return t&&(o=t.width/t.height),(0,n.jsx)("div",{className:oh,children:(0,n.jsx)(eh,{aspectRatio:o,staticHeight:412,children:(0,n.jsx)(rh,{picUrl:t.url})})})},sh="_videoMain_1r483_1";function lh(e){return Number(e.replace("px",""))}const ch=({videoCanvas:e,visible:t})=>{const[o,{height:a}]=(0,ge.A)(void 0,{dimension:"height"});return(0,i.useEffect)((()=>{var a;t&&e&&(null==(a=o.current)||a.appendChild(e))}),[t,e]),(0,i.useEffect)((()=>{if(!t||!a||!e)return;const o=lh(e.style.height);if(o!==a){const t=lh(e.style.width)/o;e.style.height=`${a}px`,e.style.width=`${Math.floor(a*t)}px`}}),[t,a,e]),(0,n.jsx)("div",{className:sh,ref:o})},dh="_videoFrameSelector_1obym_1",uh="_videoFrameWrapper_1obym_8",ph="_videoFrameWrapperDragging_1obym_17",_h="_videoFrameItem_1obym_25",hh="_videoFrameItemSkeleton_1obym_32",mh="_previewCursor_1obym_36",gh="_frameCursor_1obym_48",vh="_cursorHead_1obym_59",fh="_vLine_1obym_63",yh=({frameCount:e=10,frameWidth:t,frameHeight:o})=>{const a=(0,i.useContext)(d_),{videoParam:r,visible:s,selectType:c}=a,d=(0,i.useRef)(null),u=(0,i.useRef)([]),[p,_]=(0,i.useState)([]),h=()=>{var a,n;const r=d.current,i=null==(a=d.current)?void 0:a.getContext("2d");if(!i||!r)return;i.clearRect(0,0,r.width,r.height);const s=window.devicePixelRatio||1;r.width=t*e*s,r.height=o*s,i.scale(s,s),i.imageSmoothingEnabled=!0;for(let l=0;l<=e;l++){const{img:e,loaded:a}=(null==(n=u.current)?void 0:n[l])??{};if(e&&a){const a=Math.max(t/e.width,o/e.height),n=e.width*a,r=e.height*a,s=l*t,c=0,d=s+(t-n)/2,u=c+(o-r)/2;i.save(),i.beginPath(),i.rect(s,c,t,o),i.clip(),i.drawImage(e,d,u,n,r),i.restore()}}};return(0,i.useEffect)((()=>{var t;if(s&&c===l_.video)for(let o=0;o<=e;o++){const e=null==(t=null==r?void 0:r.frameList)?void 0:t[o];if(!u.current[o]&&e){const t=new Image;t.src=e,t.onload=()=>{var e;null!=(e=u.current[o])&&e.img&&(u.current[o].loaded=!0),_((e=>[...e,o])),h()},u.current[o]={img:t,loaded:!1}}}}),[null==r?void 0:r.getFrameCount,s,c]),(0,i.useEffect)((()=>{null!=r&&r.loading&&(u.current.forEach((e=>e.img.remove())),u.current=[],_([]))}),[null==r?void 0:r.loading]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("canvas",{ref:d,style:{width:t*e,height:o},width:t*e,height:o}),new Array(e).fill(0).map(((e,o)=>(0,n.jsx)("div",{style:{left:o*t,width:t,display:p.includes(o)?"none":void 0},className:l()(D_,hh,_h)},`skeleton_${o}`)))]})};function wh(e){return new(st())(String(e))}function bh(e,t="number",o="floor"){switch(t){case"bigint":let a;if("round"===o){const[t,o]=e.toString().split(".");a=/^\d/.test(o)&&Number(o[0])>=8?e.integerValue(st().ROUND_CEIL).toString():t}else a="ceil"===o?e.integerValue(st().ROUND_CEIL).toString():e.integerValue(st().ROUND_FLOOR).toString();return BigInt(a);case"number":return e.toNumber();case"string":return e.toString();default:throw new Error(`returnType invalid: ${t}`)}}function xh(e,t,o,a){const n=wh(e),r=wh(t);return bh(n.times(r),o,a)}function kh(e,t,o,a){const n=wh(e),r=wh(t);return bh(n.div(r),o,a)}const Ah={plus:function(e,t,o,a){const n=wh(e),r=wh(t);return bh(n.plus(r),o,a)},minus:function(e,t,o,a){const n=wh(e),r=wh(t);return bh(n.minus(r),o,a)},times:xh,div:kh,mod:function(e,t,o,a){const n=wh(e),r=wh(t);return bh(n.mod(r),o,a)},max:function(e,t,o){const a=e.map(wh);return bh(st().max(...a),t,o)},min:function(e,t,o){const a=e.map(wh);return bh(st().min(...a),t,o)},scopeEE:function(e,[t,o],a,n){const r=wh(e),i=wh(t),s=wh(o);return bh(st().max(i,st().min(r,s)),a,n)},roundDecimal:function(e,t,o="round"){const a=10**t;return kh(Math[o](xh(e,a)),a)}},Sh=(e,t,o,a)=>{const n=t.getBoundingClientRect();let r=e.clientX+t.scrollLeft-n.left-a;return r<o.left&&(r=o.left),r>o.right&&(r=o.right),{x:r,y:0}},Ch=({bounds:e,onMouseDown:t,onDrag:o,onStop:a,onReset:n,setRef:r,children:s,operationWidth:l=0})=>{const c=(0,i.useRef)(),[d,u]=(0,i.useState)(!1),p=(0,i.useRef)(!1),_=(0,i.useCallback)((e=>{t(e),u(!0),p.current=!1}),[t,u]),h=(0,i.useMemo)((()=>(0,ae.A)((t=>{var a;if(!d||p.current)return;const n=null==(a=c.current)?void 0:a.parentElement;n&&o(t,Sh(t,n,e,l))}),10)),[o,d,e]),m=(0,i.useCallback)((t=>{var o;if(p.current=!0,!d)return;const n=null==(o=c.current)?void 0:o.parentElement;n&&a(t,Sh(t,n,e,l)),u(!1)}),[a,d,u,e]),g=(0,i.useCallback)((()=>{d&&(n(),u(!1))}),[n,d,u]);return(0,i.useEffect)((()=>(document.body.addEventListener("mousemove",h),document.body.addEventListener("mouseup",m),document.body.addEventListener("mouseleave",g),()=>{document.body.removeEventListener("mousemove",h),document.body.removeEventListener("mouseup",m),document.body.removeEventListener("mouseleave",g)})),[h,m,g]),(0,i.useEffect)((()=>{null==r||r(c.current)}),[c.current]),i.cloneElement(i.Children.only(s),{ref:c,onMouseDown:_})},Ih="_cursorHdIcon_8otbn_1",Eh="_iconBg_8otbn_1",Th="_iconBorder_8otbn_4",Ph="_dragging_8otbn_7",Nh="_adsorb_8otbn_10",jh=({dragging:e,adsorb:t})=>(0,n.jsxs)("svg",{className:l()({[Ih]:!0,[Ph]:e,[Nh]:t}),width:"12",height:"18",viewBox:"0 0 12 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("mask",{id:"path-1-inside-1_1578_341598",fill:"white",children:(0,n.jsx)("path",{d:"M0 3C0 1.34314 1.34315 0 3 0H9C10.6569 0 12 1.34315 12 3V11.8287C12 12.7494 11.5772 13.6191 10.8531 14.1879L6 18L1.14686 14.1879C0.422795 13.6191 0 12.7494 0 11.8287V3Z"})}),(0,n.jsx)("path",{className:Eh,d:"M0 3C0 1.34314 1.34315 0 3 0H9C10.6569 0 12 1.34315 12 3V11.8287C12 12.7494 11.5772 13.6191 10.8531 14.1879L6 18L1.14686 14.1879C0.422795 13.6191 0 12.7494 0 11.8287V3Z"}),(0,n.jsx)("path",{className:Th,d:"M6 18L4.76457 19.5728L6 20.5432L7.23543 19.5728L6 18ZM1.14686 14.1879L-0.0885728 15.7607L1.14686 14.1879ZM10.8531 14.1879L12.0886 15.7607L10.8531 14.1879ZM3 2H9V-2H3V2ZM10 3V11.8287H14V3H10ZM2 11.8287V3H-2V11.8287H2ZM9.61771 12.6151L4.76457 16.4272L7.23543 19.5728L12.0886 15.7607L9.61771 12.6151ZM7.23543 16.4272L2.38228 12.6151L-0.0885728 15.7607L4.76457 19.5728L7.23543 16.4272ZM-2 11.8287C-2 13.3632 -1.29534 14.8128 -0.0885728 15.7607L2.38228 12.6151C2.14093 12.4255 2 12.1356 2 11.8287H-2ZM10 11.8287C10 12.1356 9.85907 12.4255 9.61771 12.6151L12.0886 15.7607C13.2953 14.8128 14 13.3632 14 11.8287H10ZM9 2C9.55228 2 10 2.44772 10 3H14C14 0.238577 11.7614 -2 9 -2V2ZM3 -2C0.238579 -2 -2 0.23857 -2 3H2C2 2.44771 2.44771 2 3 2V-2Z",fill:"#090C14",mask:"url(#path-1-inside-1_1578_341598)"})]}),Rh=new Array(10).fill(0),Lh=({seekTo:e=0,duration:t,handleSeekTo:o,handleStopPreviewing:a,handlePreviewTo:r})=>{const[s,{width:c}]=(0,ge.A)(void 0,{dimension:"width"}),d=(0,ve.A)(!1),u=(0,i.useRef)(void 0),[p,_]=(0,fe.A)(void 0,{throttle:20}),h=c||734,{run:m}=(0,ye.A)(o,50,[],{immediately:!0,trailing:!0}),{run:g}=(0,ye.A)(r,50,[r],{immediately:!0,trailing:!0}),v=(0,ve.A)(!1);(0,i.useEffect)((()=>{const e=Date.now();if(_.x<0||!h){if(v.state){v.setFalse();const e=setTimeout((()=>{a(),clearTimeout(e)}),70)}return void(u.current=void 0)}v.setTrue();const o=Ah.div(Ah.times(t,_.x,"bigint"),h,"bigint"),{lastUs:n,lastPx:r,lastTime:i}=u.current??{};if(void 0!==i&&void 0!==n&&void 0!==r){const t=o-n,a=_.x-r,s=e-i,l=Ah.div(t,s,"number");g(o,l,a/s)}u.current={lastTime:e,lastUs:o,lastPx:_.x}}),[_.x,t,h,a,g]);const f=(0,ve.A)(!1),y=(0,i.useMemo)((()=>Ah.div(Ah.times(h,e,"bigint"),t)),[h,e,t]),w=(0,i.useCallback)((e=>{f.setTrue()}),[]),b=(0,i.useCallback)(((e,{x:o})=>{e.stopPropagation(),m(Ah.div(Ah.times(t,o,"bigint"),h,"bigint"))}),[t,h,m]),x=(0,i.useCallback)(((e,{x:a})=>{f.setFalse(),o(Ah.div(Ah.times(t,a,"bigint"),h,"bigint"))}),[t,h,o]),k=(0,i.useCallback)((()=>{f.setFalse()}),[]),A=(0,i.useCallback)((()=>{}),[]),S=(0,i.useCallback)((e=>{var a;const n=null==(a=s.current)?void 0:a.getBoundingClientRect(),r=e.clientX-n.x;o(Ah.div(Ah.times(t,r,"bigint"),h,"bigint"))}),[t,h,o]);return(0,n.jsxs)("div",{ref:s,className:dh,onClick:S,children:[(0,n.jsx)("div",{ref:p,className:l()(uh,f.state&&ph),children:(0,n.jsx)(yh,{frameCount:Rh.length,frameWidth:73.4,frameHeight:76})}),_.x>-1&&!d.state&&!f.state&&(0,n.jsx)("div",{className:mh,style:{transform:`translateX(${_.x-1.5}px)`}}),(0,n.jsx)(Ch,{bounds:{left:0,top:0,right:h,bottom:0},onMouseDown:w,onDrag:b,onStop:x,onReset:k,setRef:A,children:(0,n.jsxs)("div",{className:gh,style:{transform:`translateX(${y}px)`},onMouseEnter:()=>d.setTrue(),onMouseLeave:()=>d.setFalse(),children:[(0,n.jsx)("div",{className:vh,children:(0,n.jsx)(jh,{dragging:f.state})}),(0,n.jsx)("div",{className:fh})]})})]})},Oh="_videoWrapper_1sg7m_1",Fh="_videoMainWrapper_1sg7m_6",Dh="_videoMain_1sg7m_6",Uh="_videoFrameSelectorSkeleton_1sg7m_19",Mh=Ah.div(1000000n,30,"bigint"),Bh=({style:e,visible:t,selectType:o,duration:a,videoCanvas:r,seekTo:s,aspectRatio:c,frameList:d,changeSelectType:u,loading:p,handleSeekTo:_,handlePreviewTo:h,handleStopPreviewing:m})=>((0,i.useEffect)((()=>{if(p||!t)return;const e=e=>{"ArrowLeft"===e.key?_(Ah.max([s-Mh,0n],"bigint")):"ArrowRight"===e.key&&_(Ah.min([s+Mh,a],"bigint")),e.preventDefault(),e.stopPropagation()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[p,t,s,a,_]),(0,n.jsxs)("div",{className:Oh,style:e,children:[(0,n.jsx)("div",{className:Fh,children:(0,n.jsx)(eh,{staticHeight:248,aspectRatio:c,children:p?(0,n.jsx)("div",{className:l()(D_,Dh)}):(0,n.jsx)(ch,{visible:t,videoCanvas:r})})}),(0,n.jsx)(G_,{selectType:o,changeSelectType:u}),p?(0,n.jsx)("div",{className:l()(D_,Uh)}):(0,n.jsx)(Lh,{seekTo:s,duration:a,frameList:d,handleSeekTo:_,handlePreviewTo:h,handleStopPreviewing:m})]})),zh="_wrapper_1c5yc_1",Gh="_mask_1c5yc_10",Wh="_imgWrapper_1c5yc_13",Vh="_img_1c5yc_13",Hh="_btn_1c5yc_40",qh=({selectType:e,cover:t,aspectRatio:o,dispatchStore:a})=>(t&&(o=t.width/t.height),(0,n.jsx)("div",{className:zh,style:{display:e===l_.staticCover?void 0:"none"},children:(0,n.jsx)(eh,{aspectRatio:o,staticHeight:412,children:(0,n.jsxs)("div",{className:Wh,children:[(0,n.jsx)("img",{className:Vh,src:null==t?void 0:t.url,crossOrigin:"anonymous"}),(0,n.jsx)("div",{className:Gh,children:(0,n.jsx)(k.A,{className:Hh,type:"secondary",onClick:()=>{a({type:u_,payload:{selectType:l_.video}})},children:c.Ay.t("web_graphic_cover_button_reselect_cover",{},"Reselect cover")})})]})})})),Yh="_innerEditor_194t9_1",Kh="_modal_194t9_5",Jh="_content_194t9_9",$h="_footer_194t9_13",Qh="_footerRight_194t9_18",Zh="_panelTitle_194t9_27",Xh="_iconBtn_194t9_41";const em=(0,i.forwardRef)((({store:e,managers:t,methods:o,reporter:s,maxSize:d},p)=>{const{openGraphicEditor:_,dispatchStore:h,closeModal:m}=o,{coverSelectorManager:g,storeManager:v}=t,[,f]=(0,i.useReducer)((e=>e+1),1),[w,b]=(0,i.useState)(!1);(0,i.useEffect)((()=>{!async function(){const e=await(0,u.r)().getABTestConfig("edit_more_entry",0);b(1===e&&"function"==typeof SharedArrayBuffer)}()}),[]),(0,i.useImperativeHandle)(p,(()=>({forceRender:f})));const{selectType:A,aspectRatio:S,visible:C,duration:I,uploadMaterial:E,modalType:T,highlightParam:P,coverPosition:N,isLogin:j}=e,R=(0,i.useMemo)((()=>{var t,o;const a=(null==(t=e.selectLocalFile)?void 0:t.file)||(null==(o=e.cover)?void 0:o.file);return(null==a?void 0:a.size)/1024/1024>d}),[e.selectLocalFile,e.cover]),L=(0,i.useCallback)((t=>{var o;if(t!==e.selectType)switch(t){case l_.video:s.report({action:va,action_type:"click"}),v.selectTypeSet(l_.video),null!=(o=e.videoParam)&&o.inited||g.startVideoSelect();break;case l_.highlight:s.report({action:fa,action_type:"click"}),v.selectTypeSet(l_.highlight),"success"!==(null==P?void 0:P.errorStatus)&&(null==P||!P.loading)&&g.getHighlightFrame()}}),[P,g]),O=(0,i.useCallback)((e=>{g.seekToSet(e)}),[e]),F=(0,i.useCallback)(((e,t,o)=>{g.previewToSet(e,t,o)}),[e]),D=(0,i.useCallback)((()=>{var t;g.seekToSet(null==(t=e.videoParam)?void 0:t.seekTo)}),[e]),U=async()=>{if(!g.checkIfNeedLogin())return;const e=await function(e){return new Promise((t=>{const o=document.createElement("input");o.type="file",o.accept=e,o.addEventListener("change",(e=>{var o;const a=null==e?void 0:e.target,n=null==(o=null==a?void 0:a.files)?void 0:o[0];t(n)})),o.click()}))}(".jpeg,.jpg,.png,.heif,.heic");e&&v.setSelectLocalFile(e)},M=(0,i.useCallback)((e=>{g.highlightIndexSet(e)}),[e]),B=({title:e,onClick:t})=>(0,n.jsxs)("div",{className:Zh,children:[(0,n.jsx)(k.A,{type:"secondary",icon:(0,n.jsx)(r.lPV,{size:16}),onClick:()=>t()}),(0,n.jsx)("p",{className:"title",children:e})]}),z=(()=>{var t,o,a,n;if(e.isSettingCover||e.isOpeningGraphic)return!0;switch(e.selectType){case l_.upload:return!(null!=(t=e.selectLocalFile)&&t.file);case l_.highlight:return(null==(o=e.highlightParam)?void 0:o.loading)??"error"===(null==(a=e.highlightParam)?void 0:a.errorStatus);case l_.video:return null==(n=e.videoParam)?void 0:n.loading;default:return!1}})(),G=(0,n.jsxs)("div",{className:$h,children:[T===c_.edit&&(0,n.jsx)(x.A,{position:"bottom",getPopupContainer:()=>window.document.body,content:j?"":c.Ay.t("web_login_to_edit_cover_tips",{},"Log in to edit more editing"),children:(0,n.jsx)(k.A,{className:Xh,size:"large",type:"secondary",disabled:e.isSettingCover||e.isOpeningGraphic,icon:(0,n.jsx)(Rn,{size:20,style:{verticalAlign:"-4px"}}),onClick:()=>U(),children:A!==l_.upload?c.Ay.t("web_modal_cover_button_upload",{},"Upload"):c.Ay.t("web_modal_cover_button_reupload",{},"Reupload")})}),(0,n.jsx)("div",{className:Qh,children:T===c_.selectFrame?(0,n.jsx)(k.A,{size:"large",type:"primary",disabled:z,loading:e.isAddingFramesToGraphic,onClick:async()=>{s.report({action:ba,action_type:"click"});try{v.setIsAddingFramesToGraphic(!0),await g.addCoverToGraphic(),v.setIsAddingFramesToGraphic(!1)}catch(e){throw v.setIsAddingFramesToGraphic(!1),a.A.error(c.Ay.t("web_network_error",{},"An error occurred. Try again later.")),e}},children:c.Ay.t("web_cover_download_button_select_video_add",{},"Select")}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x.A,{position:"bottom",getPopupContainer:()=>window.document.body,content:R?c.Ay.t("web_cover_toast_cover_size_limit",{string0:d+""},"Couldn\u2019t set cover. The image size needs to be no larger than {string0} MB.."):"",children:(0,n.jsx)(k.A,{size:"large",type:"secondary",disabled:R||!e.isSettingCover&&z,loading:e.isSettingCover,onClick:async()=>{s.report({action:ya,action_type:"click",cover_type:A}),v.isSettingCoverSet(!0);try{await g.setStaticCoverWithoutEditor()}catch(e){throw a.A.error(c.Ay.t("web_network_error",{},"An error occurred. Try again later.")),e}finally{v.isSettingCoverSet(!1)}},children:c.Ay.t("web_modal_cover_button_set",{},"Set as cover")})}),w&&(0,n.jsx)(x.A,{position:"bottom",getPopupContainer:()=>window.document.body,content:R?c.Ay.t("web_cover_toast_cover_size_limit",{string0:d+""},"Couldn\u2019t set cover. The image size needs to be no larger than {string0} MB.."):"",children:(0,n.jsx)(k.A,{size:"large",icon:(0,n.jsx)(Mn,{size:20,style:{verticalAlign:"-4px"}}),type:R||!e.isOpeningGraphic&&z?"secondary":"primary",disabled:R||!e.isOpeningGraphic&&z,loading:e.isOpeningGraphic,onClick:async()=>{s.report({action:wa,action_type:"click"});try{v.toggleIsOpeningGraphic(!0),v.switchEditorGraphic(!0),await _(!0)}catch(e){throw a.A.error(c.Ay.t("web_network_error",{},"An error occurred. Try again later.")),v.toggleIsOpeningGraphic(!1),v.switchEditorGraphic(!1),e}},children:c.Ay.t("web_modal_cover_button_edit",{},"Edit cover")})})]})})]});return(0,n.jsx)(y.A,{className:l()("workbench-cover-select-modal",Kh),wrapClassName:T===c_.selectFrame?Yh:void 0,maskStyle:{zIndex:T===c_.selectFrame?1002:void 0},visible:C,closable:!0,escToExit:!1,maskClosable:!1,autoFocus:!1,title:(()=>{if(T!==c_.edit)return c.Ay.t("web_cover_download_title_select_video",{},"Select from video");switch(A){case l_.upload:return B({title:c.Ay.t("web_modal_cover_title_upload",{},"Upload from device"),onClick:()=>{v.cancelUpload()}});case l_.staticCover:return B({title:c.Ay.t("web_graphic_cover_title_current_cover",{},"Current cover"),onClick:()=>{v.selectTypeSet(l_.video)}});default:return c.Ay.t("web_modal_cover_title",{},"Add cover")}})(),footer:G,onCancel:()=>o.closeModal(),afterOpen:()=>{s.report({action:ga,action_type:"show"})},afterClose:()=>{},children:(0,n.jsxs)("div",{className:Jh,children:[A===l_.upload&&(0,n.jsx)(ih,{store:e,onRetry:()=>{var t;null==(t=e.selectLocalFile)||t.file}}),(0,n.jsx)(Bh,{style:{display:A===l_.video?void 0:"none"},...e.videoParam,visible:C,videoCanvas:e.videoCanvas,selectType:A,aspectRatio:S,duration:I,changeSelectType:L,handleSeekTo:O,handlePreviewTo:F,handleStopPreviewing:D}),(0,n.jsx)(th,{style:{display:A===l_.highlight?void 0:"none"},...e.highlightParam,selectType:A,aspectRatio:S,changeSelectType:L,handleSelectHighlight:M,handleGetHighlightFrame:()=>g.getHighlightFrame()}),(0,n.jsx)(qh,{dispatchStore:h,selectType:A,aspectRatio:S,cover:e.cover})]})})}));var tm=(e=>(e[e.Success=0]="Success",e))(tm||{});class om{constructor(e){bt(this,"callbacks",new Map),bt(this,"listener",this._handlerMsgFromEditor.bind(this)),this.props=e,window.addEventListener("message",this.listener)}get isParent(){return!this.props.iframe}get sender(){return this.isParent?window.parent:this.props.iframe.contentWindow}dispose(){this.callbacks.clear(),window.removeEventListener("message",this.listener)}on(e,t){let o=this.callbacks.get(e);o||(o=[]),o.push({cb:t}),this.callbacks.set(e,o)}off(e,t){const o=this.callbacks.get(e);o&&this.callbacks.set(e,o.filter((e=>e.cb!==t)))}once(e,t){let o=this.callbacks.get(e);o||(o=[]),o.push({cb:t,once:!0}),this.callbacks.set(e,o)}action(e,t){var o;e.actionId=(null==t?void 0:t.actionId)??`action-${this._genActionId()}`,e.requireResponse=!1,null==(o=this.sender)||o.postMessage(JSON.stringify(e),window.location.origin)}awaitAction(e){return new Promise((t=>{var o;e.actionId=`awaitAction-${this._genActionId()}`,e.requireResponse=!0,this.once(e.event,(o=>{o.actionId===e.actionId&&t(o.data)})),null==(o=this.sender)||o.postMessage(JSON.stringify(e),window.location.origin)}))}_genActionId(){return`${Date.now().valueOf()}-${Math.floor(1e3*Math.random())}`}_handlerMsgFromEditor(e){const t=[];if(this.isParent||e.source===this.sender)try{const o=JSON.parse(e.data),a=this.callbacks.get(o.event);a||console.warn("unRegister event:",o),null==a||a.forEach((e=>{e.cb(o),e.once&&t.push(e.cb)})),t.forEach((e=>{this.off(o.event,e)}))}catch{console.warn("invalid event",e.data)}}}class am{constructor(e,t,o){bt(this,"_isReady",!1),bt(this,"_initialPromise"),bt(this,"_initialResolve"),bt(this,"_initialReject"),bt(this,"_iframe"),bt(this,"_bridge"),bt(this,"_prefetchMaterialMap",new Map),this._coverPersistenceManager=e,this.storeManager=t,this.props=o,this._initialPromise=new Promise(((e,t)=>{this._initialResolve=e,this._initialReject=t}));const a=window.document.createElement("iframe");a.setAttribute("style","height: 100%;width: 100%;border: none;"),a.setAttribute("crossOrigin","anonymous"),t.setGraphicEditorIframe(a),this._iframe=a;let n="";const r={enter_from:"share_panel",from_page:"workspace",workspaceId:o.shareInfo.spaceInfo.workspaceId,spaceId:o.shareInfo.spaceInfo.spaceId,width:o.width,height:o.height,unit:o.unit??"px"};for(const i in r)r[i]&&(n+=`&${i}=${r[i]}`);a.src=`/editor-graphic${o.draftId?`/${o.draftId}`:""}/?editorType=web${n}`,this._bridge=new om({iframe:a}),this._bridge.on("READY",(()=>{var e;this._isReady=!0,null==(e=o.onReady)||e.call(o),this._initialResolve()})),this._bridge.on("CANCEL_GRAPHIC",(()=>{this.props.onClose()})),o.coverId&&this._prefetchMaterialAsset(o.coverId),this._handlerGetMaterialAsset(),this._handlerGetDraftResource(),this._handlerGetDraftAction(),this._handlerSaveAction(),this._handlerSelectVideoFrame()}get isReady(){return this._isReady}get element(){return this._iframe}async ready(){await this._initialPromise}async insertCoverByInit(e){await this._initialPromise,this._bridge.action({event:"INSERT_COVER_TO_CANVAS",data:e})}dispose(){this._bridge.dispose()}_handlerGetDraftResource(){this._bridge.on("GET_DRAFT_RESOURCE",(async e=>{try{const t=await this.props.prefetchDraftResource;this._bridge.action({event:"GET_DRAFT_RESOURCE",data:{code:tm.Success,msg:"success",data:t.value}},{actionId:e.actionId})}catch(t){this._bridge.action({event:"GET_DRAFT_RESOURCE",data:{code:-1,msg:`unexpected error:${null==t?void 0:t.message}`}},{actionId:e.actionId})}}))}_prefetchMaterialAsset(e){const t=this._prefetchMaterialMap.get(e);if(t)return t;if(!this.props.prefetchMaterialAsset)throw new Error("not found prefetchMaterialAsset props");const o=this.props.prefetchMaterialAsset({md5:e});return this._prefetchMaterialMap.set(e,o),o}_handlerGetMaterialAsset(){this._bridge.on("GET_MATERIAL_ASSET",(async e=>{try{const t=await this._prefetchMaterialAsset(e.data.md5);this._bridge.action({event:"GET_MATERIAL_ASSET",data:{code:tm.Success,msg:"success",data:t}},{actionId:e.actionId})}catch(t){this._bridge.action({event:"GET_MATERIAL_ASSET",data:{code:-1,msg:`unexpected error:${null==t?void 0:t.message}`}},{actionId:e.actionId})}}))}_handlerGetDraftAction(){this._bridge.on("GET_VIDEO_COVER_DRAFT",(async e=>{try{const t=await this._coverPersistenceManager.getDraftJsonString();this._bridge.action({event:"GET_VIDEO_COVER_DRAFT",data:{code:tm.Success,msg:"success",data:{draft:t}}},{actionId:e.actionId})}catch(t){this._bridge.action({event:"GET_VIDEO_COVER_DRAFT",data:{code:-1,msg:`unexpected error:${null==t?void 0:t.message}`}},{actionId:e.actionId})}}))}_handlerSaveAction(){this._bridge.on("SAVE_COVER",(e=>{this.props.onSave(e).then((()=>{this._bridge.action({event:"SAVE_COVER",data:{code:tm.Success,msg:"success"}},{actionId:e.actionId})})).catch((t=>{this._bridge.action({event:"SAVE_COVER",data:{code:-1,msg:`unexpected error:${null==t?void 0:t.message}`}},{actionId:e.actionId})}))}))}_handlerSelectVideoFrame(){this._bridge.on("SELECT_VIDEO_FRAME",(async e=>{const t=e=>({event:"SELECT_VIDEO_FRAME",data:{code:-1,msg:`unexpected error:${(null==e?void 0:e.message)??e}`}});try{const o=await this.props.selectFrameFromVideo();o?this._bridge.action((e=>({event:"SELECT_VIDEO_FRAME",data:{code:tm.Success,msg:"success",data:{md5:e}}}))(o),{actionId:e.actionId}):this._bridge.action(t("not found md5"),{actionId:e.actionId})}catch(o){a.A.error(c.Ay.t("web_network_error",{},"An error occurred. Try again later.")),this._bridge.action(t(o),{actionId:e.actionId})}}))}}let nm=null;function rm(e,t){const{url:o,width:a,height:n}=e;return new Promise(((e,r)=>{const i={asset_id:R_(o),workspace_id:t.workspaceId,platform:3,smart_tool_type:6,sync_call:1,scene:1,use_base64:1,params:{width:a,height:n}};Co.createAiTask(i).then((t=>{e(t.task_detail[0])})).catch((e=>r(e)))}))}async function im(e){return nm||(nm=await lt.QO.init().then((()=>lt.QO.getSdkInstance({spaceId:e.spaceId,dcName:e.spaceIdc??"",netconf:{base:e.spaceHost??"",media:e.spaceResHost??""},autoDestroy:!0}).then((e=>e)))),nm)}function sm(e){return Object.values(e).reduce(((e,t)=>{const{width:o,height:a,preview_url:n,key:r}=t;return e[`${o}x${a}`]={full_url:n,width:o??0,height:a??0,aesKey:r??""},e}),{})}const lm=[lt.N8.P720,lt.N8.P1080,lt.N8.ORIGIN];function cm(e){a.A.error(c.Ay.t("web_network_error",{},"An error occurred. Try again later.")),e.toggleIsOpeningGraphic(!1),e.switchEditorGraphic(!1),e.closeGraphic()}function dm({width:e,height:t,coverPersistenceManager:o={},storeManager:n,shareInfo:r,extraConfig:i={}}){const{coverResource:s}=r;return new am(o,n,{...i,shareInfo:r,width:e,height:t,unit:"px",trackerReport(){throw new Error("Function not implemented.")},onUpdatePackageAssets(){throw new Error("Function not implemented.")},prefetchMaterialAsset:()=>{throw new Error("Function not implemented")},selectFrameFromVideo:()=>new Promise((e=>{n.openSelectFrame({onSelectFrame:t=>{e(t)},onCancelSelect:()=>{e()}})})),onSave(e){return new Promise(((t,o)=>{const{data:i,width:l,height:d}=e.data.cover;L_(i,P_,l,d).then((async u=>{if(u.size/1024/1024>r.maxSize)return a.A.error(c.Ay.t("web_cover_toast_cover_size_limit",{string0:r.maxSize+""},"Couldn\u2019t set cover. The image size needs to be no larger than {string0} MB..")),void o(new Error(""));const p=await s_(u);s.setCoverInfo({file:u,uri:p.Uri,url:i,width:l,height:d}),s.setDraftResource(e.data),n.closeGraphic(),t(!0)}))}))},onClose:()=>{n.closeGraphic()}})}async function um({imgFileInfo:e,selectType:t,shareInfo:o,storeManager:a,dispatchStore:n}){const{spaceInfo:r}=o,{width:i,height:s}=e;a.switchEditorGraphic(!0);try{const[l,c]=await Promise.all([im(r),rm(e,r)]),u=await function(e,{maxRetries:t=4,delay:o=1e3}){return new Promise(((a,n)=>{let r=0;const i=async()=>{try{const t=await e();a(t)}catch(s){if(r++,r<t)setTimeout(i,o);else{const t=new Error(`Max retries exceeded. Last error: ${s.message}`);d.s.error("LvOpenGraphicEditor-UploadAssetFail",t),n(t)}}};i()}))}((()=>l.getAssetByMd5((null==c?void 0:c.md5)||"")),{maxRetries:5,delay:400}),p=await Promise.race(lm.map((e=>u.getPreviewInfo([e]).then((t=>({width:i,height:s,coverKey:t[e].key,url:t[e].preview_url,md5:null==c?void 0:c.md5,transcodeInfo:sm(t)})))))),_=dm({width:i,height:s,shareInfo:o,storeManager:a});return n({type:S_,payload:{graphicEditorManager:_}}),setTimeout((()=>{_.isReady||cm(a)}),15e3),await _.insertCoverByInit({background:[l_.upload].includes(t)?"#000000":void 0,material:p}),a.toggleIsOpeningGraphic(!1),_}catch{return cm(a),null}}function pm(e,t,o,a){const n=document.createElement("canvas");n.width=o,n.height=t*a;const r=n.getContext("2d");r.drawImage(e,0,0,o,t*a);const i=[];for(let s=0;s<t;s++){const e=r.getImageData(0,s*a,o,a),t=document.createElement("canvas");t.width=o,t.height=a;const n=t.getContext("2d");null==n||n.putImageData(e,0,0),i.push(t.toDataURL())}return i}function _m(e,t,o){return(0,i.useCallback)((async()=>{const{fileInfo:n,spaceInfo:r}=t,{fileId:i}=n,{workspaceId:s}=r;if(e.loading)return;let l;o({type:g_,payload:{videoParam:{inited:!1,loading:!0}}});try{l=await d.l.getShareSettingsInfo(i,0,s);const[e,t]=await async function(e){const t=e.asset,{sprit:o}=t;if(!o)throw a.A.error(c.Ay.t("web_network_error",{},"An error occurred. Try again later.")),new Error("sprit img not exist");const{common_info:n,detail_infos:r}=o,{single_frame_width:i,single_frame_height:s,total_set_num:l}=n,d=[],u=[];return await Promise.all(r.map((e=>{const{url:t,encrypt_key:o,frame_count:a}=e;return new Promise((async e=>{let n="";n=o?await Ei().fetchDecryptImage({url:t,key:o,skipCache:!1}):t;const r=new Image;r.src=n,r.crossOrigin="anonymous",r.onload=function(){const t=pm(r,a,i,s),o=pm(r,a,i/10,s/10);d.push(...t),u.push(...o),e(!0)}}))}))),[d,u]}(n),r=e.length;if(r<10){const t=r-10,o=Array.from({length:t}).fill(e[r-1]);e.push(...o)}const u=r>10?Math.floor((r-2)/8):1,p=[e[0]];for(let o=u;o<r-1;o+=u)p.push(e[o]);p[9]=e[r-1],o({type:__,payload:{frameList:e,smallFrameList:t}}),o({type:g_,payload:{videoParam:{inited:!0,loading:!1,seekTo:0,previewTo:0,frameList:p,getFrameCount:e.length}}})}catch{return void a.A.error(c.Ay.t("web_network_error",{},"An error occurred. Try again later."))}}),[t.fileInfo,e.loading])}const hm=({shareInfo:e,unmountComponent:t})=>{const{fileInfo:o,spaceInfo:r,coverResource:s,reporter:l}=e,[d,u]=(0,i.useState)(!s.coverInfo||null===s.draftResource),{asset:p}=o,{width:_,height:h}=p,m={width:_,height:h},g=(0,i.useMemo)((()=>{const e=document.createElement("canvas");return e.width=_,e.height=h,e}),[]),v={isLogin:!0,modalType:c_.edit,videoCanvas:g,aspectRatio:_/h,duration:BigInt(o.duration),upscalerSize:m,frameSize:m,highlightFrameSize:m,selectType:s.coverInfo?l_.staticCover:l_.video,videoParam:{inited:!1,loading:!1,seekTo:0n,previewTo:0n},highlightParam:{inited:!1,loading:!1},cover:s.coverInfo,isOpeningGraphic:!1,showEditorGraphic:!1,visible:!0,coverLoading:!1,isSettingCover:!1,isAddingFramesToGraphic:!1},[f,y]=(0,i.useReducer)(T_,v),w=_m(f.videoParam,e,y),b=function(e,t,o){const{spaceInfo:a}=t;return(0,i.useCallback)((async()=>{if(e.highlightParam.loading)return;o({type:y_,payload:{highlightParam:{inited:!1,loading:!0}}});const{frameList:t,smallFrameList:n}=e;if(!t||!n)return;const r=await Co.imageHighlightAnalyse({workspace_id:a.workspaceId,image_base64_list:n.map((e=>R_(e))),top_k:5});o({type:y_,payload:{highlightParam:{inited:!0,loading:!1,errorStatus:0===r.status?"success":"error",candidateFrameList:t.map(((e,t)=>({url:e,process:t}))),highlightList:r.highlight_image_index,selectedIndex:r.highlight_image_index[0]}}})}),[e.highlightParam,e.frameList,a])}(f,e,y),x=function(e,t,o){const{fileInfo:n,coverResource:r,maxSize:s}=t,{asset:l}=n;let{width:d,height:u}=l;return(0,i.useCallback)((async()=>{const{selectType:t,highlightParam:n,selectLocalFile:i}=e;let l,p;switch(t){case l_.upload:p=null==i?void 0:i.file,l=null==i?void 0:i.url,d=null==i?void 0:i.width,u=null==i?void 0:i.height;break;case l_.highlight:const{candidateFrameList:t,selectedIndex:a}=n;l=null==t?void 0:t[a].url,p=await L_(l,P_,d,u);break;case l_.video:l=e.videoCanvas.toDataURL(),p=await L_(l,P_,d,u);break;case l_.staticCover:return void o();default:throw new Error("invalid type")}if(!l)return void a.A.error(c.Ay.t("web_network_error",{},"An error occurred. Try again later."));if(p.size/1024/1024>s)return void a.A.error(c.Ay.t("web_cover_toast_cover_size_limit",{string0:s+""},"Couldn\u2019t set cover. The image size needs to be no larger than {string0} MB.."));const _=await s_(p);r.setCoverInfo({file:p,url:l,uri:_.Uri,width:d,height:u}),o()}),[e])}(f,e,t),k=N_(f,s),A=(0,i.useCallback)((async()=>{var e,t,o;if(null==(e=null==f?void 0:f.selectFramesForGraphicParams)||!e.onSelectFrame)return;const a=await k();if(!a.file)return;const n=await rm(a,r);null==(o=null==(t=null==f?void 0:f.selectFramesForGraphicParams)?void 0:t.onSelectFrame)||o.call(t,null==n?void 0:n.md5),y({type:p_,payload:{modalType:c_.edit}})}),[f.selectFramesForGraphicParams,k]),S=(0,i.useCallback)((()=>{var e,o;const{modalType:a}=f;a!==c_.edit?(y({type:p_,payload:{modalType:c_.edit}}),null==(o=null==(e=null==f?void 0:f.selectFramesForGraphicParams)?void 0:e.onCancelSelect)||o.call(e)):t()}),[f.selectFramesForGraphicParams,f.modalType]),C=(0,i.useCallback)((e=>{if(!f.frameList||!f.videoCanvas)return;const{frameList:t}=f,a=Math.round(Number(e)/o.duration*t.length),n=f.videoCanvas.getContext("2d"),r=t[a],i=new Image;i.src=r,i.onload=function(){null==n||n.drawImage(i,0,0,_,h)}}),[f.frameList,f.videoCanvas]);(0,i.useEffect)((()=>{d&&w()}),[d]),(0,i.useEffect)((()=>{f.frameList&&C(f.videoParam.seekTo)}),[f.frameList,f.videoParam.seekTo,C]);const I={storeManager:{selectTypeSet(e){y({type:u_,payload:{selectType:e}})},toggleIsOpeningGraphic(e){y({type:x_,payload:{isOpeningGraphic:e}})},switchEditorGraphic(e){y({type:A_,payload:{showEditorGraphic:e}})},isSettingCoverSet(e){y({type:b_,payload:{isSettingCover:e}})},setGraphicEditorIframe(e){y({type:C_,payload:{graphicEditorIframe:e}})},closeGraphic(){y({type:I_,payload:{showEditorGraphic:!1,graphicEditorManager:null,graphicEditorIframe:null}}),t()},setSelectLocalFile(e){(async function(e){const[t,o]=await Promise.all([new Promise(((t,o)=>{const a=URL.createObjectURL(e),n=new Image;n.src=a,n.onload=function(){t({width:n.width,height:n.height})},n.onerror=()=>o()})),new Promise(((t,o)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=function(e){e.target?t(e.target.result):o(new Error("load file error"))}}))]);return{file:e,url:o,width:t.width,height:t.height}})(e).then((e=>{y({type:h_,payload:{selectLocalFile:{...e}}}),y({type:u_,payload:{selectType:l_.upload}})}))},cancelUpload(){y({type:m_,payload:{selectType:l_.video,selectLocalFile:void 0}})},openSelectFrame(e){d||u(!0),y({type:p_,payload:{modalType:c_.selectFrame}}),y({type:u_,payload:{selectType:l_.video}}),y({type:E_,payload:{selectFramesForGraphicParams:e}})},setIsAddingFramesToGraphic(e){y({type:k_,payload:{isAddingFramesToGraphic:e}})}},coverSelectorManager:{startVideoSelect:w,seekToSet:e=>{void 0!==e&&(C(e),y({type:v_,payload:{seekTo:e}}))},previewToSet:C,highlightIndexSet(e){y({type:w_,payload:{selectedIndex:e}})},getHighlightFrame:b,checkIfNeedLogin(){return!0},setStaticCoverWithoutEditor:x,addCoverToGraphic:A}};(0,i.useEffect)((()=>{d||async function({shareInfo:e,storeManager:t,dispatchStore:o}){const{spaceInfo:a,coverResource:n}=e;if(!n.draftResource||!n.coverInfo)return;o({type:A_,payload:{showEditorGraphic:!0}});const r=JSON.parse(n.draftResource.draft),i=r.packageId,s={workspaceId:a.workspaceId,referencedAssets:r.draftUsedEverAsserts.map((e=>({md5:e.md5,sourcePath:e.source_path,materials:r.materials}))),materials:r.materials},l={getDraftJsonString(){return n.draftResource.draft}},c=await Co.getDraftCover(s),{width:d,height:u}=n.coverInfo,p=dm({width:d,height:u,coverPersistenceManager:l,shareInfo:e,storeManager:t,extraConfig:{draftId:i,prefetchDraftResource:{value:{...c}}}});o({type:S_,payload:{graphicEditorManager:p}}),t.toggleIsOpeningGraphic(!1)}({shareInfo:e,dispatchStore:y,storeManager:I.storeManager})}),[]);const E=(0,i.useCallback)((async()=>{const t=await k();t.file&&um({imgFileInfo:t,selectType:f.selectType,shareInfo:e,storeManager:I.storeManager,dispatchStore:y})}),[f.selectType,k]);return(0,n.jsxs)(d_.Provider,{value:f,children:[d&&(0,n.jsx)(em,{store:f,maxSize:e.maxSize,managers:I,methods:{openGraphicEditor:E,closeModal:S,dispatchStore:y},reporter:l}),(0,n.jsx)(F_,{store:f,managers:{graphicEditorManager:f.graphicEditorManager}})]})},mm="_container_131p3_1",gm="_left_131p3_5",vm="_title_131p3_12",fm="_desc_131p3_22",ym="_right_131p3_34",wm="_cover_131p3_43",bm="_btn_131p3_54",xm="_emptyPlus_131p3_57",km="_coverImg_131p3_63",Am="_isEmpty_131p3_69",Sm="_btnEdit_131p3_72",Cm="_isLandscape_131p3_76",Im="_noLandscape_131p3_85",Em="_btnClose_131p3_112",Tm="_loading_131p3_124",Pm="_hide_131p3_144";function Nm(e,t){return e?{[u.q.YouTube]:c.Ay.t("web_cover_text_image_used_Youtube",{},"This image will be used as your Youtube video cover"),[u.q.TikTok]:c.Ay.t("web_cover_text_image_used_tt",{},"This image will be used as your tiktok video cover"),[u.q.FacebookPage]:c.Ay.t("web_cover_text_image_used_fb",{},"This image will be used as your facebook video cover"),[u.q.FacebookGroup]:c.Ay.t("web_cover_text_image_used_fb",{},"This image will be used as your facebook video cover"),[u.q.InstagramReels]:c.Ay.t("web_cover_text_image_used_ig",{},"This image will be used as your Instagram video cover"),[u.q.TTAM]:c.Ay.t("web_cover_text_image_used_ttads",{},"This image will be used as your tiktok ads manager video cover")}[t]:c.Ay.t("web_cover_text_no_cover",{},"No cover yet")}const jm=({platform:e,fileInfo:t,spaceInfo:o,extraData:s,disabled:u,maxSize:p,onChange:_})=>{const[h,m]=(0,i.useState)(!0),[g,v]=(0,i.useState)(!1),[f,w]=(0,i.useState)(!1),[b,A]=(0,i.useState)(null),[S,C]=(0,i.useState)(null),I=(0,i.useMemo)((()=>({coverInfo:b,draftResource:S,setCoverInfo:A,setDraftResource:C})),[b,S]),{fileId:E}=t,{workspaceId:T}=o,P=(0,i.useMemo)((()=>new ma(s.currentPage)),[]),N=(0,i.useMemo)((()=>{var e,o;return b?b.width>b.height:(null==(e=t.asset)?void 0:e.width)>(null==(o=t.asset)?void 0:o.height)}),[b]),j=(0,i.useMemo)((()=>b?`${b.width} / ${b.height}`:"106 / 58"),[b]);(0,i.useEffect)((()=>{b&&_(b.uri)}),[b]),(0,i.useEffect)((()=>{!async function(){if(!E||!T||u||g)return;v(!0);const e=await d.l.getShareSettingsInfo(E,0,T),t=(await d.l.getShareDetail({fileId:E,workspaceId:T,password:e.password})).cover_data;if(null==t||!t.image_meta)return A(null),void m(!1);const{image_meta:o,width:n,height:r}=t,i=await Promise.race([Ei().fetchDecryptImage({url:o.preview_1080_url,key:o.key,skipCache:!1}),Ei().fetchDecryptImage({url:o.preview_720_url,key:o.key,skipCache:!1}),new Promise((e=>{setTimeout((()=>{e("")}),1e4)}))]);if(i){const e=await function(e,t,o,n){return new Promise(((r,i)=>{const s=new Image;s.src=e,s.onload=function(){const e=document.createElement("canvas");e.width=t,e.height=o,e.getContext("2d").drawImage(s,0,0,t,o),e.toBlob((async i=>{const s=new File([i],P_);let l={Uri:""};s.size/1024/1024>n?a.A.error(c.Ay.t("web_cover_toast_cover_size_limit",{string0:n+""},"Couldn\u2019t set cover. The image size needs to be no larger than {string0} MB..")):l=await s_(s),r({file:s,url:e.toDataURL(),uri:l.Uri,width:t,height:o})}))},s.onerror=()=>i()}))}(i,n,r,p);A(e)}else A(null);m(!1)}()}),[E,T,u,g]);const R=(0,i.useCallback)((()=>{if(u||h)return;const e=new xa(s.currentPage);!function(e){const t="share-cover-selector-container";let o;o=document.getElementById(t),o||(o=window.document.createElement("div"),o.id=t,window.document.body.append(o)),Le.render((0,n.jsx)(t_,{children:(0,n.jsx)(hm,{shareInfo:e,unmountComponent:()=>{o&&(Le.unmountComponentAtNode(o),o=null)}})}),o)}({fileInfo:t,spaceInfo:o,reporter:e,extraData:s,coverResource:I,maxSize:p})}),[I,u,h,t,b]);return(0,n.jsxs)("div",{className:mm,children:[(0,n.jsxs)("div",{className:gm,children:[(0,n.jsx)("p",{className:vm,children:c.Ay.t("web_cover_title_video_cover",{},"Video cover")}),(0,n.jsx)("p",{className:fm,children:Nm(!(null==b||!b.url),e)})]}),(0,n.jsxs)("div",{className:l()(ym,N?Cm:Im),children:[(0,n.jsx)("div",{className:h?Tm:Pm,children:(0,n.jsx)(D.A,{webp:!0,style:{height:"20px"}})}),(0,n.jsx)(x.A,{disabled:h,position:"bottom",content:b?"":c.Ay.t("web_add_cover_tips",{},"Add cover"),style:{zIndex:10001},children:(0,n.jsx)("div",{className:l()(wm,!b&&!h&&Am),style:{aspectRatio:j,cursor:b?void 0:"pointer"},onClick:()=>{P.report({action:ua}),R()},children:b?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("img",{className:km,src:b.url,alt:"",crossOrigin:"anonymous"}),(0,n.jsx)("div",{className:l()(bm,Em),onClick:e=>{u||(e.stopPropagation(),w(!0),P.report({action:pa}))},children:(0,n.jsx)(On,{size:12,fill:u?"rgba(178, 213, 230, 0.2":""})}),(0,n.jsx)(x.A,{position:"bottom",disabled:h,content:c.Ay.t("web_edit_cover_tips",{},"Edit cover"),children:(0,n.jsx)("div",{className:l()(bm,Sm),children:(0,n.jsx)(r.SaW,{size:12,fill:u?"rgba(178, 213, 230, 0.2":""})})})]}):(0,n.jsx)(r.SaW,{className:l()(xm,h&&Pm),size:20})})})]}),(0,n.jsx)(y.A,{visible:f,closable:!1,wrapClassName:"delete-text-modal",maskClosable:!1,title:c.Ay.t("web_cover_delete_modal_title",{},"Discard Cover?"),simple:!0,footer:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k.A,{type:"secondary",style:{boxShadow:"none"},onClick:()=>{P.report({action:ha}),w(!1)},children:c.Ay.t("web_cancel",{},"Cancel")}),(0,n.jsx)(k.A,{type:"primary",status:"danger",onClick:()=>{P.report({action:_a}),A(null),C(null),w(!1)},children:c.Ay.t("web_graphic_unsave_notify_btn_discard",{},"Discard")})]}),children:c.Ay.t("web_cover_delete_modal_desc",{},"This cannot be undone.")})]})},Rm=({show:e=!0})=>{var t;const{exportState:o}=(0,i.useContext)(bv),[a]=L.A.useForm(),{fileInfo:r,platformItem:s,spaceInfo:d,extraData:p}=Qs(),{selectItemID:_}=Zn(),{userInfo:m,uploadProgress:g,isUploading:v,youtubeState:f,youtubeSend:y,shareServiceState:w,shareType:b,businessType:x}=Zs(),k="smart_tool_page"===(null==(t=w.context.reportExtra)?void 0:t.currentPage),A=f.matches("show.hasBind"),S=!A||!1,{description:C,setDescription:I,descLimit:E,formDesc:T}=(e=>{const t=e===u.f.YouTubeShorts,o=c.Ay.t("web_upload_improve_text_made_with_cc",{URL:"https://www.capcut.com/s/CTtk_OftECn683Mb/"},"Made with Capcut:{URL}"),a=t?`${c.Ay.t("web_shareYouTube_capcut_tag")} #shorts`:c.Ay.t("web_shareYouTube_capcut_tag"),[n,r]=(0,i.useState)(`${o} ${a}`);return{descLimit:5e3,description:n,formDesc:n,setDescription:r}})(b),[P,N]=(0,i.useState)((null==r?void 0:r.fileName)??c.Ay.t("web_shareYouTube_text_untitled_project")),[j,R]=(0,i.useState)(),[O,F]=(0,i.useState)(Ys.public),[U,B]=(0,i.useState)([c.Ay.t("web_shareYouTube_capcut_name"),c.Ay.t("web_shareYouTube_title_online_video_editing"),c.Ay.t("web_shareYouTube_title_video_template")]),[z,G]=(0,i.useState)(1),[W,V]=(0,i.useState)(1),H=x===u.F.FilmVideo&&r.asset&&!k,q=(0,i.useMemo)((()=>{var e,t;return Math.round(r.duration/1e3)>60?c.Ay.t("web_ytb_ins_text_shared_tyb"):(null==(e=r.asset)?void 0:e.width)>(null==(t=r.asset)?void 0:t.height)?c.Ay.t("web_ytb_ins_text_publish_to_ytb"):void 0}),[r]),Y=()=>{const e=c.Ay.t("share_error_too_long",{},"Character limit exceeded"),t={validator:(e,t)=>t(/[<>]/.test(e)?c.Ay.t("share_error_contain_angle_brackets",{},"Can't contain angle brackets"):void 0)};return{title:[{required:!0,message:c.Ay.t("share_error_no_title",{},"Enter a title")},{maxLength:100,message:e},t],describe:[{maxLength:E,message:e},t],tags:[{validator:(t,o)=>o(dl(t)>500?e:void 0)}]}},{lastFormInfo:K,loading:J}=tr({fileId:null==r?void 0:r.fileId,platform:u.i.Youtube});(0,i.useEffect)((()=>{(0,dt.A)(K)||a.setFieldsValue({...(0,M.A)(K,(e=>!!e)),title:P})}),[K]),(0,i.useEffect)((()=>{(0,u.n)().setParam({share_caption:P,share_caption_words_cnt:P.length,share_view_range:O,default_tag:z,default_describe:W,is_cover_added:j?"1":"0"})}),[W,z,O,P,j]);return(0,n.jsxs)(D.A,{webp:!0,className:Ls,loading:J,style:e?void 0:{display:"none"},children:[(0,n.jsxs)("div",{className:Os,children:[(0,n.jsx)(hs,{headTitle:(null==s?void 0:s.platformContent)??"",handleBack:()=>{y("BACK_CHOOSE_STATE")},visible:!_}),(0,n.jsxs)("div",{className:l()("lv_share-form-content",Fs),children:[q&&b===u.f.YouTubeShorts&&(0,n.jsx)(_t.A,{type:"warning",content:q,className:Bs}),(0,n.jsx)("div",{className:Ds,children:c.Ay.t("web_upload_improve_text_channel_youtube",{},"Youtube channel")}),(0,n.jsx)(ll,{}),!1,(0,n.jsxs)(L.A,{className:Us,scrollToFirstError:!0,autoComplete:"off",layout:"vertical",form:a,initialValues:{title:P,describe:C,cover:j,[jt.PRIVACY_LEVEL]:O,tags:U},children:[(0,n.jsx)(L.A.Item,{field:"title",label:c.Ay.t("web_shareYouTube_title_title"),rules:Y().title,children:(0,n.jsx)(Gs,{value:P,disabled:v,placeholder:c.Ay.t("describe_post"),maxLength:{length:100,errorOnly:!0},showWordLimit:!0,autoSize:{maxRows:8,minRows:2},onChange:N})}),(0,n.jsx)(L.A.Item,{field:"describe",label:c.Ay.t("web_shareYouTube_title_description",{},"Description"),rules:Y().describe,children:(0,n.jsx)(Gs,{value:C,disabled:v,placeholder:c.Ay.t("describe_post"),showWordLimit:!0,maxLength:{length:E,errorOnly:!0},autoSize:{maxRows:8,minRows:2},onChange:e=>{I(e),V(0)}})}),H&&(0,n.jsx)(L.A.Item,{field:"cover",children:(0,n.jsx)(jm,{platform:u.q.YouTube,fileInfo:r,spaceInfo:d,extraData:p,maxSize:2,onChange:e=>R(e),disabled:o||!A||v})}),(0,n.jsx)(L.A.Item,{field:jt.PRIVACY_LEVEL,label:c.Ay.t("web_shareYouTube_text_privacy_rights",{},"Privacy"),children:(0,n.jsx)(Js,{disabled:v,value:O,onChange:F})}),(0,n.jsx)(L.A.Item,{field:"tags",label:c.Ay.t("web_shareYouTube_title_tag",{},"Tag"),children:(0,n.jsx)(ul,{value:U,disabled:v,onChange:e=>{B(e),G(0)}})}),(0,n.jsxs)(L.A.Item,{className:Ms,children:["By continuing, you confirm that the video you share to YouTube complies with YouTube\u2019s\xa0",(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://www.youtube.com/t/terms",children:"Terms of Service"}),"\xa0and does not infringe upon other people\u2019s intellectual property rights and privacy. Check our\xa0",(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://www.capcut.com/resource/google-api-services-disclosure",children:"Google API Services Disclosure"}),"."]})]})]})]}),(0,n.jsx)(ml,{className:zs,uploading:v,progress:g,text:c.Ay.t("web_shareYouTube_button_post"),uploadingText:`${c.Ay.t("web_shareYouTube_text_posting")} ${g}%`,disabled:S,onClick:async()=>{var e,t,o,n,i;try{k&&(new u.S).report({share_caption:P,share_caption_words_cnt:P.length,share_view_range:O,tool_type:(0,h.g)(r.asset).tool_type||(null==(e=w.context.reportExtra)?void 0:e.toolType),enter_from:(null==(t=w.context.reportExtra)?void 0:t.enterFrom)||"first_page",from_page:null==(o=w.context.reportExtra)?void 0:o.fromPage,current_page:null==(n=w.context.reportExtra)?void 0:n.currentPage,resolution:r.resolution,size:"Calculating..."===r.fileSize?void 0:Math.round(Number(r.fileSize)/1024/1024*100)/100,format:r.format,video_duration:Math.round(Number(r.duration)/1e3),platform:"youtube",action:"upload"})}catch{}try{const e=await a.validate();e.describe=T,y({type:"UPLOAD_TO_PLATFORM",data:{fileInfo:r,formInfo:e,default_tag:z,default_describe:W,uid:null==(i=w.context)?void 0:i.uid}})}catch{}}})]})},Lm="_container_8pryi_1",Om="_result-container_8pryi_7",Fm=({openType:e,fileInfo:t,platformsList:o,spaceInfo:a,extraData:r})=>{var i;const{youtubeSend:s,youtubeState:c,shareType:d}=Zs(),p=o.find((e=>e.platformName===u.c.YouTube&&e.youtubeShareType===d)),_=null==(i=[{state:"show.hasBind.uploaded.success",uploadResult:_s.ShareSuccess},{state:"show.hasBind.uploaded.failed",uploadResult:_s.UploadFailed}].find((e=>c.matches(e.state))))?void 0:i.uploadResult;return(0,n.jsx)($s.Provider,{value:{openType:e,platformItem:p,fileInfo:t,spaceInfo:a,extraData:r},children:(0,n.jsxs)("div",{className:l()("lv_share-form",Lm),children:[(0,n.jsx)(Rm,{show:!_}),_&&(0,n.jsx)("div",{className:Om,children:(0,n.jsx)(As,{platform:u.c.YouTube,headTitle:(null==p?void 0:p.platformContent)||"",openType:e,uploadResult:_,authUrl:null==p?void 0:p.authUrl,handleBack:()=>s("BACK_CHOSEN_STATE")})})]})})},Dm=(0,i.createContext)({shareType:u.d.GROUP,fileInfo:{},spaceInfo:{},graphicInfo:{},extraData:{},openType:p.O.default,platformItem:void 0,loading:!1}),Um=()=>(0,i.useContext)(Dm),Mm=()=>{const{shareService:e}=Zn(),[t,o]=(0,g.B)(e),a=t.children.LvShareFacebook,[n,r]=(0,g.B)(a),i=(0,m.d)(a,(e=>e.context.userInfo)),s=(0,m.d)(a,(e=>e.context.uploadProgress)),l=n.matches("show.hasBind.uploading");return{LvShareFacebook:a,userInfo:i,shareServiceState:t,shareServiceSend:o,fbState:n,fbSend:r,isUploading:l,uploadProgress:s,shareType:(0,m.d)(a,(e=>e.context.shareType)),shareId:(0,m.d)(a,(e=>e.context.shareId)),businessType:(0,m.d)(a,(e=>e.context.businessType))}},Bm="_container_pgmco_1",zm="_button-group_pgmco_6",Gm={get WatchOnIns(){return c.Ay.t("web_ytb_ins_button_watch_ins",{},"Watch on Instagram")},get CopyInsLink(){return c.Ay.t("web_ytb_ins_button_copy_ins_link",{},"Copy Instagram link")},get WatchOnFb(){return c.Ay.t("web_postfb_text_watch_on_fb",{},"Watch on Facebook")},get CopyFbLink(){return c.Ay.t("web_postfb_text_copy_fb_link",{},"Copy Facebook link")},get SharedToFb(){return c.Ay.t("web_postfb_toast_post_successfully",{},"Video shared to Facebook")},get VideoSuccess(){return c.Ay.t("web_ytb_ins_title_video_share",{},"Video shared")},get VideoFail(){return c.Ay.t("web_postfb_toast_upload_fail")},get TryAgain(){return c.Ay.t("web_postfb_button_retry",{},"Try again")},get ImageSuccess(){return c.Ay.t("web_share_image_title_image_shared",{},"Image(s) uploaded")},get ImageFail(){return c.Ay.t("web_share_image_toast_not_shared",{},"Failed to upload image(s)")},get FbGroupFailContent(){return c.Ay.t("web_share_image_desc_add_capcut",{href0:e=>(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://www.facebook.com/help/261149227954100",children:e})},"To publish your project to Facebook Group, add the \u201cCapCut Online\u201d app to your group first. Check out the <href0>help doc</href0>.")},get InsFailContent(){return c.Ay.t("web_ytb_ins_toast_reel_specification",{href0:e=>(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://developers.facebook.com/docs/instagram-api/reference/ig-user/media/#reels-specs",children:e})},"Check if your video meets Instagram\u2019s <href0>Reel Specifications</href0> and try again.")},get FbNoAccess(){return c.Ay.t("couldnot_share_popup_desc_fb_no_access",{href0:e=>(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://www.facebook.com/help/261149227954100",children:e})},"To share CapCut videos to a Facebook group, add the \u201cCapCut Online\u201d app to your group first. View the <href0>help doc</href0> for instructions.")},get FbAccountLimit(){return c.Ay.t("couldnot_share_popup_desc_fb_limited_access",{},"Your account has limited access to Facebook, please contact Facebook's Help Center for guidance.")},get FbViolateRules(){return c.Ay.t("couldnot_share_popup_desc_fb_violate_policy",{},"Your post violates Facebook policies,please review Facebook's policies and guidelines.")}},Wm=({businessType:e})=>e===u.F.Graphic?(0,n.jsx)(r.zy3,{size:100},"share-image-success"):(0,n.jsx)(r.gyW,{size:100},"share-video-successfully"),Vm=({businessType:e})=>e===u.F.Graphic?(0,n.jsx)(r.wIg,{size:100},"share-image-error"):(0,n.jsx)(r.pxA,{size:100},"share-video-error"),Hm=({uploadResult:e,platformItem:t})=>{const{fbSend:o,businessType:i,LvShareFacebook:s}=Mm(),{openType:l,shareType:d}=Um(),p=(0,m.d)(s,(e=>e.context.failReason)),_=(e=>e===u.d.INSTAGRAM?{watch:Gm.WatchOnIns,copy:Gm.CopyInsLink}:{watch:Gm.WatchOnFb,copy:Gm.CopyFbLink})(d),{successTitle:h,failTitle:g}=((e,t)=>({successTitle:t===u.F.Graphic?Gm.ImageSuccess:[u.d.GROUP,u.d.PAGE].includes(e)?Gm.SharedToFb:Gm.VideoSuccess,failTitle:t===u.F.Graphic?Gm.ImageFail:Gm.VideoFail}))(d,i),{copy:v}=(0,pe.A)(),f=(0,m.d)(s,(e=>{const t=d===u.d.INSTAGRAM?"https://www.instagram.com":"";return e.context.platformLink||t})),y=()=>{Ji({}),o("REPORT_FEEDBACK")},w=e=>c.Ay.t(e,{"text-href":e=>(0,n.jsx)("a",{className:"a-target",onClick:y,children:e})}),b=((e,t,o)=>{var a;const n={"limited access":Gm.FbAccountLimit,"violates Facebook policies":Gm.FbViolateRules,"Subject does not have permission to post videos on this target":Gm.FbNoAccess,"The user has not authorized application":Gm.FbNoAccess,"No permission to publish the video":Gm.FbNoAccess,"Error validating access token":Gm.FbNoAccess};return(null==(a=Object.entries(n).find((([e])=>null==t?void 0:t.includes(e))))?void 0:a[1])||(e===u.d.INSTAGRAM?Gm.InsFailContent:e===u.d.GROUP?Gm.FbGroupFailContent:o)})(d,p,w("web_ttam_feedback_there")),x={[_s.ShareSuccess]:{content:h,subContent:w("web_shareYouTube_toast_report_to_us"),icon:(0,n.jsx)(Wm,{businessType:i}),button:(0,n.jsxs)("div",{className:zm,children:[(0,n.jsxs)(k.A,{type:"primary",onClick:()=>{o("REPORT_WATCH"),window.open(f)},size:"large",children:[d===u.d.INSTAGRAM?(0,n.jsx)(r.DfL,{size:18,fill:"white"}):(0,n.jsx)(r.GAq,{size:18,fill:"white"}),(0,n.jsx)("span",{children:_.watch})]}),(0,n.jsxs)(k.A,{onClick:()=>{o("REPORT_COPY"),v(f),a.A.success(c.Ay.t("web_shareYouTube_button_copy_successfully",{},"Copy success"))},size:"large",children:[(0,n.jsx)(r.Zac,{size:18}),(0,n.jsx)("span",{children:_.copy})]})]},"upload-success")},[_s.UploadFailed]:{content:g,subContent:b,icon:(0,n.jsx)(Vm,{businessType:i}),button:(0,n.jsx)("div",{className:zm,children:(0,n.jsx)(k.A,{type:"primary",onClick:()=>{o("RETRY")},size:"large",children:Gm.TryAgain})},"upload-failed")}};return(0,n.jsx)("div",{className:Bm,children:(0,n.jsx)(ks,{openType:l,uploadResult:e,resultComponent:x,headTitle:null==t?void 0:t.platformContent,handleBack:()=>o("BACK_CHOSEN_STATE")})})},qm="_container_1bfl8_1",Ym="_gotocreate_1bfl8_8",Km={[u.d.GROUP]:"groups",[u.d.PAGE]:"pages"},Jm={[u.d.GROUP]:{empty:c.Ay.t("web_postfb_text_no_group_yet",{},"No group yet."),create:c.Ay.t("web_postfb_text_create_facebook_group",{},"You need to create a facebook group first.")},[u.d.PAGE]:{empty:c.Ay.t("web_postfb_toast_dont_have_page",{},"You don\u2019t have any Facebook Page"),create:c.Ay.t("web_postfb_toast_create_page_first",{},"To share videos, you need to create a Facebook Page first.")}},$m=()=>{const{shareType:e,businessType:t,fbSend:o}=Mm(),{empty:a,create:i}=Jm[e]||{},s=t===u.F.Graphic?r.wIg:r.pxA;return(0,n.jsx)("div",{className:qm,children:(0,n.jsxs)("div",{className:Ym,children:[(0,n.jsx)(s,{size:100}),(0,n.jsx)("p",{children:a}),(0,n.jsx)("p",{children:i}),(0,n.jsx)(k.A,{type:"primary",href:`https://www.facebook.com/${Km[e]}/create/`,target:"_blank",onClick:()=>o({type:"USER_UNBIND",data:{report:!1}}),children:c.Ay.t("web_postfb_button_go_to_create",{},"Create in Facebook")})]})})},Qm=({onChange:e,value:t,onListChange:o})=>{const{fbState:a,fbSend:r,isUploading:s,userInfo:l,shareServiceSend:d}=Mm(),{shareType:p,platformItem:_}=Um(),h=a.matches("show.hasBind.unbind.loading"),m=(0,i.useMemo)((()=>(null==l?void 0:l.id)||""),[l]),g=a.matches("show.hasBind"),{loading:v,data:f,refresh:y}=er({userId:m,shareType:p,onChange:o});return(0,i.useEffect)((()=>{!g&&e()}),[g,e]),(0,n.jsx)(sl,{value:null==t?void 0:t.id,signOutText:c.Ay.t("web_postfb_button_log_out",{},"Sign out"),loading:v,disabled:s,unbinding:h,hasBind:g,onVisibleChange:e=>e&&y(),handleLogin:()=>{d({type:"CHOOSE_PLATFORM",data:{platform:u.c.Facebook,facebookShareType:p,authUrl:null==_?void 0:_.authUrl}})},handleSignOut:()=>r("USER_UNBIND"),onChange:(t,{extra:o})=>{e({id:t,access_token:o})},children:null==f?void 0:f.map((e=>(0,n.jsx)(N.A.Option,{value:e.id,extra:e.access_token,children:(0,n.jsx)(il,{name:e.name,picture:e.picture,avatarStyle:{backgroundColor:p===u.d.GROUP?"var(--lvv-color-info-primary)":void 0}})},e.id)))})},Zm="_form_4bzx7_1",Xm="_form-scrollview_4bzx7_17",eg="_form-content_4bzx7_27",tg="_form-target-empty_4bzx7_35",og=c.Ay.t("web_share_image_text_add_capcut",{href0:e=>(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://www.facebook.com/help/261149227954100",children:e})},"To share your project to a Facebook group, you need to add the \u201cCapCut Online\u201d app to your group first. View the <href0>help doc</href0> for instructions."),ag=({show:e})=>{const{exportState:t}=(0,i.useContext)(bv),[o,a]=(0,i.useState)(""),[r,s]=(0,i.useState)((()=>`${c.Ay.t("web_upload_improve_text_made_with_cc",{URL:"https://www.capcut.com/s/CdPbsjHe5o766dcX/"},"Made with Capcut:{URL}")} ${c.Ay.t("web_shareYouTube_capcut_tag")}`)),[d,p]=(0,i.useState)(""),[_,h]=(0,i.useState)(),[m,g]=(0,i.useState)(!1),{shareType:v,openType:f,fileInfo:y,spaceInfo:w,platformItem:b,extraData:x,loading:k}=Um(),A="smart_tool_page"===(null==x?void 0:x.currentPage),{fbSend:S,isUploading:C,uploadProgress:I,businessType:E}=Mm(),T=(0,i.useMemo)((()=>({title:o,describe:r,cover:d,type:v,id:null==_?void 0:_.id,access_token:null==_?void 0:_.access_token})),[_,d,r,o,v]),P=(0,i.useMemo)((()=>{var e;return null==(e=[{cond:()=>o.length>100,message:c.Ay.t("web_postfb_toast_title_maximum_words")},{cond:()=>r.length>5e3,message:c.Ay.t("web_postfb_toast_description_maximum_words")},{cond:()=>!_,message:c.Ay.t("web_postfb_toast_complete_required_fields")},{cond:()=>(e=>(null==e?void 0:e.duration)>144e5||(e=>e/1073741824)(null==e?void 0:e.fileSize)>10)(y),message:c.Ay.t("web_postfb_toast_video_size_exceed")}].find((e=>e.cond())))?void 0:e.message}),[y,o,r,_]),N=v===u.d.GROUP?og:void 0,j=E===u.F.FilmVideo&&v===u.d.PAGE&&y.asset&&!A,{lastFormInfo:R,loading:O}=tr({fileId:null==y?void 0:y.fileId,platform:u.i.Facebook}),F=(0,ht.A)((e=>{if(g(!e.length),e.length&&!_){const t=e.find((e=>e.id===(null==R?void 0:R.id)))??e[0];h((0,ee.A)(t,["id","access_token"]))}}));(0,i.useEffect)((()=>{R&&(a(R.title),s(R.describe))}),[R]);return(0,n.jsxs)(D.A,{webp:!0,className:l()(Zm,{[tg]:m}),style:e?{}:{display:"none"},loading:O,block:!0,children:[(0,n.jsxs)("div",{className:Xm,children:[(0,n.jsx)(hs,{headTitle:null==b?void 0:b.platformContent,handleBack:()=>{S("BACK_CHOOSE_STATE")},visible:!(0,B.Ib)(f)||(0,B.vN)(f)}),(0,n.jsxs)("div",{className:l()("lv_share-form-content",eg),children:[N&&(0,n.jsx)(_t.A,{type:"warning",className:Bs,content:N}),(0,n.jsx)(Qm,{value:_,onChange:h,onListChange:F}),(0,n.jsxs)(L.A,{layout:"vertical",disabled:C,children:[(0,n.jsx)(L.A.Item,{label:c.Ay.t("web_postfb_title_title"),children:(0,n.jsx)(Gs,{value:o,placeholder:c.Ay.t("caption"),maxLength:{length:100,errorOnly:!0},autoSize:{maxRows:8,minRows:2},showWordLimit:!0,onChange:a})}),(0,n.jsx)(L.A.Item,{label:c.Ay.t("web_postfb_title_description"),children:(0,n.jsx)(Gs,{value:r,placeholder:c.Ay.t("describe_post"),maxLength:{length:5e3,errorOnly:!0},showWordLimit:!0,autoSize:{maxRows:8,minRows:2},onChange:s})}),j&&(0,n.jsx)(L.A.Item,{field:"cover",children:(0,n.jsx)(jm,{platform:u.q.FacebookGroup,fileInfo:y,spaceInfo:w,extraData:x,maxSize:10,onChange:e=>p(e),disabled:t||k||C})}),(0,n.jsx)(L.A.Item,{className:Ms,children:c.Ay.t("web_postfb_text_agree_with",{"text-href0":e=>(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://www.facebook.com/legal/terms",children:e}),"text-href1":e=>(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://transparency.fb.com/en-gb/policies/community-standards/",children:e})},"When you upload to Facebook, you certify that the content you are uploading complies with Facebook\u2019s Terms of Service. Please be sure not to violate others' copyright or privacy rights.Video release conditions can refer to the official rules of Facebook to avoid release failure.")})]})]}),m&&(0,n.jsx)($m,{})]}),!m&&(0,n.jsx)(ml,{className:zs,uploading:C,progress:I,disabled:k,text:c.Ay.t("web_postfb_button_post"),uploadingText:`${c.Ay.t("web_postfb_toast_uploading")} ${I}%`,errorMessage:P,onClick:()=>{S({type:"UPLOAD_TO_PLATFORM",data:T})}})]})},ng="_form_lcli0_1",rg="_form-scrollview_lcli0_17",ig="_form-content_lcli0_27",sg=({onChange:e,value:t,onListChange:o})=>{const{fbState:a,fbSend:r,isUploading:s,userInfo:l,shareServiceSend:c}=Mm(),{platformItem:d}=Um(),p=a.matches("show.hasBind.unbind.loading"),_=(0,i.useMemo)((()=>(null==l?void 0:l.id)||""),[l]),h=a.matches("show.hasBind"),{loading:m,data:g,refresh:v}=er({userId:_,shareType:u.d.INSTAGRAM,onChange:o});return(0,i.useEffect)((()=>{!h&&e()}),[h,e]),(0,n.jsx)(sl,{value:null==t?void 0:t.id,loading:m,disabled:s,unbinding:p,hasBind:h,onVisibleChange:e=>e&&v(),handleLogin:()=>{c({type:"CHOOSE_PLATFORM",data:{platform:u.c.Facebook,facebookShareType:u.d.INSTAGRAM,authUrl:null==d?void 0:d.authUrl}})},handleSignOut:()=>r("USER_UNBIND"),onChange:(t,{extra:o})=>{e({id:t,access_token:o})},children:null==g?void 0:g.map((e=>(0,n.jsx)(N.A.Option,{value:e.id,extra:e.access_token,children:(0,n.jsx)(il,{name:e.name,picture:e.picture,avatarStyle:{backgroundColor:"var(--lvv-color-info-primary)"}})},e.id)))})},lg="_container_vdrk4_1",cg="_information_vdrk4_6",dg="_item_vdrk4_9",ug="_title_vdrk4_12",pg="_content_vdrk4_13",_g="_link_vdrk4_14",hg=[{title:c.Ay.t("web_ytb_ins_text_connect_ins",{},"Before you connect to Instagram...")},{title:c.Ay.t("web_ytb_ins_text_step_one",{},"Step 1: Make sure you have an Instagram Business account."),content:c.Ay.t("web_ytb_ins_text_have_one",{},"If you don\u2019t have one, go to your Instagram settings and follow these steps to convert it to a business account."),link:c.Ay.t("web_ytb_ins_button_instr",{href0:e=>(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://help.instagram.com/502981923235522",children:e})})},{title:c.Ay.t("web_ytb_ins_text_link_ins",{},"Step 2: Link your Instagram Business account to a Facebook page."),content:c.Ay.t("web_ytb_ins_text_facebook",{},"You must have admin access to the Facebook page."),link:c.Ay.t("web_ytb_ins_button_view_ins",{href0:e=>(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://help.instagram.com/570895513091465",children:e})})}],mg=()=>(0,n.jsx)(_t.A,{type:"warning",className:Bs,content:(0,n.jsxs)(i.Fragment,{children:[(0,n.jsx)("div",{children:c.Ay.t("web_ytb_ins_text_can_not_find",{},"We couldn\u2019t find an Instagram Business account connected to your Facebook page.")}),(0,n.jsx)("div",{children:c.Ay.t("web_ytb_ins_text_try_again",{},"Please follow the instructions below, check your permissions, and try again.")})]})}),gg=({className:e,onStateChange:t})=>{const{shareServiceState:o,shareServiceSend:a,fbSend:r,userInfo:s,shareType:d}=Mm(),{platformItem:p}=Um(),[_,h]=(0,i.useState)(!0),m=["auth.loading","user.loading"].some(o.matches),{loading:g,refresh:v}=er({userId:null==s?void 0:s.id,shareType:d,auto:!1,onChange(e){const o=!e.length;h(o),null==t||t(o),a({type:"AUTH_STATUS_REPORT",data:{order:u.h.Second,status:e.length?"success":"fail"}})}});(0,i.useEffect)((()=>{!m&&!_&&v()}),[m,_,v]);const f=g||m;return(0,n.jsxs)("div",{className:l()(lg,e),children:[_&&(0,n.jsx)(mg,{}),(0,n.jsx)("div",{className:cg,children:hg.map(((e,t)=>(0,n.jsxs)("div",{className:dg,children:[(0,n.jsx)(G.A.Title,{className:ug,children:e.title}),e.content&&(0,n.jsx)(G.A.Paragraph,{className:pg,children:e.content}),e.link&&(0,n.jsx)(G.A.Paragraph,{className:_g,children:e.link})]},t)))}),(0,n.jsx)(k.A,{type:"primary",long:!0,loading:f,onClick:()=>{h(!1),r({type:"CONNECT_ACCOUNT",data:{authUrl:null==p?void 0:p.authUrl}})},children:f?c.Ay.t("web_ytb_ins_text_connect_insta"):c.Ay.t("web_ytb_ins_button_login_ins")})]})},vg=({show:e})=>{const{openType:t,platformItem:o,fileInfo:a,shareType:r,loading:s,extraData:d,spaceInfo:p}=Um(),_="smart_tool_page"===(null==d?void 0:d.currentPage),{exportState:h}=(0,i.useContext)(bv),{isUploading:m,fbSend:g,uploadProgress:v,businessType:f}=Mm(),y=f===u.F.FilmVideo&&a.asset&&!_,[w,b]=(0,i.useState)((()=>`${c.Ay.t("web_upload_improve_text_made_with_cc",{URL:"https://www.capcut.com/s/Cb_1G2i2wDCySXQP/"},"Made with Capcut:{URL}")} ${c.Ay.t("web_shareYouTube_capcut_tag")}`)),[x,k]=(0,i.useState)(""),[A,S]=(0,i.useState)(),[C,I]=(0,i.useState)(!1),E=(0,i.useMemo)((()=>({describe:w,cover:x,type:r,id:null==A?void 0:A.id,access_token:null==A?void 0:A.access_token})),[A,w,x]),T=(0,i.useMemo)((()=>{if(f!==u.F.FilmVideo||0===a.duration)return"";const e=Math.round(a.duration/1e3),t=Math.round(Number(a.fileSize)/1024/1024/1024*100)/100;return e>900||e<3||t>1?c.Ay.t("web_ytb_ins_toast_video_requirement",{},"Couldn\u2019t share. Video shared to Instagram Reels needs to be 3 seconds to 15 minutes long and no larger than 1 GB."):""}),[a]),{loading:P,lastFormInfo:N}=tr({fileId:null==a?void 0:a.fileId,platform:u.i.Facebook});(0,i.useEffect)((()=>{N&&N.describe&&b(N.describe)}),[N]);const j=(0,n.jsx)(hs,{headTitle:null==o?void 0:o.platformContent,handleBack:()=>{g("BACK_CHOOSE_STATE")},visible:!(0,B.Ib)(t)||(0,B.vN)(t)}),R={className:ng,style:e?{}:{display:"none"}};return C?(0,n.jsx)("div",{...R,children:(0,n.jsxs)("div",{className:rg,children:[j,(0,n.jsx)(gg,{className:ig,onStateChange:I})]})}):(0,n.jsxs)(D.A,{webp:!0,loading:P,block:!0,...R,children:[(0,n.jsxs)("div",{className:rg,children:[j,(0,n.jsxs)("div",{className:l()("lv_share-form-content",ig),children:[T&&(0,n.jsx)(_t.A,{type:"warning",className:Bs,content:T}),(0,n.jsxs)(L.A,{layout:"vertical",disabled:m,children:[(0,n.jsx)(L.A.Item,{children:(0,n.jsx)(sg,{value:A,onChange:S,onListChange:e=>{if(I(!e.length),e.length&&!A){const t=e.find((e=>e.id===(null==N?void 0:N.id)))??e[0];S((0,ee.A)(t,["id","access_token"]))}}})}),(0,n.jsx)(L.A.Item,{label:c.Ay.t("web_ytb_ins_text_caption"),children:(0,n.jsx)(Gs,{value:w,placeholder:c.Ay.t("web_ytb_ins_text_view_video"),maxLength:2200,autoSize:{maxRows:8,minRows:2},showWordLimit:!0,onChange:b})}),(0,n.jsx)(L.A.Item,{className:Ms,children:c.Ay.t("web_ytb_ins_text_term_of_use",{href:e=>(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://help.instagram.com/581066165581870",children:e})},"When you share to Instagram, you certify that the content you are sharing complies with Instagram\u2019s <href>Terms of Use</href>.")}),y&&(0,n.jsx)(L.A.Item,{field:"cover",children:(0,n.jsx)(jm,{platform:u.q.InstagramReels,fileInfo:a,spaceInfo:p,extraData:d,maxSize:10,onChange:e=>k(e),disabled:h||s||m})})]})]})]}),(0,n.jsx)(ml,{className:zs,uploading:m,disabled:!A||!!T||s,progress:v,text:c.Ay.t("web_shopify_text_back_to",{},"Export"),uploadingText:`${c.Ay.t("web_postfb_toast_uploading")} ${v}%`,onClick:()=>{g({type:"UPLOAD_TO_PLATFORM",data:E})}})]})},fg="_facebook-form_9h9vv_1",yg=({platformList:e,loading:t,spaceInfo:o={},openType:a,extraData:r,...i})=>{const{shareType:s,fbState:c}=Mm(),d=c.matches("show.hasBind.uploaded.success")?_s.ShareSuccess:c.matches("show.hasBind.uploaded.failed")?_s.UploadFailed:void 0,p=e.find((e=>e.platformName===u.c.Facebook&&e.facebookShareType===s)),_=u.d.INSTAGRAM===s?vg:ag;return(0,n.jsx)(Dm.Provider,{value:{...i,openType:a,shareType:s,platformItem:p,loading:t,spaceInfo:o,extraData:r},children:(0,n.jsxs)("div",{className:l()("lv_share-form",fg),children:[(0,n.jsx)(_,{show:!d}),d&&(0,n.jsx)(Hm,{uploadResult:d,platformItem:p})]})})},wg=(0,i.createContext)({fileInfo:{},graphicInfo:{},openType:p.O.default,platformItem:void 0,loading:!1}),bg=()=>(0,i.useContext)(wg),xg=()=>{var e;const{shareService:t}=Zn(),[o,a]=(0,g.B)(t),n=o.children.LvShareShopify,[r,i]=(0,g.B)(n),s=(0,m.d)(n,(e=>e.context.userInfo)),l=(0,m.d)(n,(e=>e.context.uploadProgress)),c=(0,m.d)(n,(e=>e.context.selectedUserId))||(null==(e=null==s?void 0:s.accounts[0])?void 0:e.user_id),d=(0,m.d)(n,(e=>e.context.fileInfo)),u=r.matches("show.hasBind.uploading"),p=(0,m.d)(n,(e=>e.context.formInfo)),_=(0,m.d)(n,(e=>e.context.businessType));return{fileInfo:d,LvShareShopify:n,userInfo:s,selectedUserId:c,shareServiceState:o,shareServiceSend:a,shopifyState:r,shopifySend:i,isUploading:u,uploadProgress:l,thirdpartyMetaInfo:(0,m.d)(n,(e=>e.context.thirdpartyMetaInfo)),businessType:_,formInfo:p}},kg="_container_1jap7_1",Ag="_button-group_1jap7_6",Sg={TryAgain:c.Ay.t("web_shopify_button_retry",{},"Retry"),ImageSuccess:c.Ay.t("web_shopify_text_image_upload",{},"Image saved"),ImagesSuccess:c.Ay.t("web_shopify_text_images_upload",{},"Images saved"),ImageFail:c.Ay.t("web_shopify_text_upload_no",{},"Couldn\u2019t save image"),ImagesFail:c.Ay.t("web_shopify_text_images_not_upload",{},"Couldn\u2019t save images"),BackSetting:c.Ay.t("web_shopify_text_back_setting",{},"Go back"),Watch:c.Ay.t("web_shopify_text_edit_shop",{},"Open Shopify"),Copy:c.Ay.t("web_shopify_text_copy_file",{},"Copy link")},Cg=({businessType:e})=>e===u.F.Graphic?(0,n.jsx)(r.zy3,{size:100},"share-image-success"):(0,n.jsx)(r.gyW,{size:100},"share-video-successfully"),Ig=({businessType:e})=>e===u.F.Graphic?(0,n.jsx)(r.wIg,{size:100},"share-image-error"):(0,n.jsx)(r.pxA,{size:100},"share-video-error"),Eg=({uploadResult:e,platformItem:t,fileType:o})=>{var a;const{shopifySend:i,businessType:s,LvShareShopify:l,fileInfo:d,formInfo:p}=xg(),{openType:_}=bg(),h=(0,m.d)(l,(e=>e.context.failReason)),g=h?c.Ay.t(h,{},"Couldn\u2019t save some images"):"",v=(null==(a=null==d?void 0:d.assetIdList)?void 0:a.length)&&(null==d?void 0:d.assetIdList.length)>1,f=()=>{var e,t;i("REPORT_WATCH"),window.open(`https://admin.shopify.com/store/${null==(e=null==p?void 0:p.account_id)?void 0:e.replace(".myshopify.com","")}/products/${null==(t=null==p?void 0:p.path)?void 0:t.replace("gid://shopify/Product/","")}`)},y=()=>{Ji({}),i("REPORT_FEEDBACK")},w=()=>{i("RETRY")},b={[_s.ShareSuccess]:{content:v?Sg.ImagesSuccess:Sg.ImageSuccess,subContent:c.Ay.t("web_shopify_text_click_feedback",{action0:e=>(0,n.jsx)("a",{className:"a-target",onClick:y,children:e})},"You can <action0>give feedback</action0>."),icon:(0,n.jsx)(Cg,{businessType:s}),button:(0,n.jsx)("div",{className:Ag,children:(0,n.jsxs)(k.A,{type:"primary",onClick:f,size:"large",children:[(0,n.jsx)(r.Qyq,{size:20,color:"#fff"}),(0,n.jsx)("span",{style:{marginLeft:"4px"},children:Sg.Watch})]})},"upload-success")},[_s.UploadFailed]:{content:v?Sg.ImagesFail:Sg.ImageFail,subContent:g,icon:(0,n.jsx)(Ig,{businessType:s}),button:(0,n.jsxs)("div",{className:Ag,children:[(0,n.jsx)(k.A,{type:"primary",onClick:w,size:"large",children:Sg.TryAgain}),(0,n.jsx)(k.A,{onClick:()=>i("BACK_CHOSEN_STATE"),size:"large",children:Sg.BackSetting})]},"upload-failed")}},x={[_s.ShareSuccess]:{content:c.Ay.t("web_shopify_text_been_uploaded",{},"Video uploaded"),subContent:c.Ay.t("web_shopify_text_click_feedback",{action0:e=>(0,n.jsx)("a",{className:"a-target",onClick:y,children:e})},"You can <action0>give feedback</action0>."),icon:(0,n.jsx)(Cg,{businessType:s}),button:(0,n.jsx)("div",{className:Ag,children:(0,n.jsxs)(k.A,{type:"primary",onClick:f,size:"large",children:[(0,n.jsx)(r.Qyq,{size:20,color:"#fff"}),(0,n.jsx)("span",{style:{marginLeft:"4px"},children:Sg.Watch})]})},"upload-success")},[_s.UploadFailed]:{content:c.Ay.t("web_shopify_text_video_export_fail",{},"Video uploading failure"),subContent:c.Ay.t("web_shopify_text_click_feedback",{action0:e=>(0,n.jsx)("a",{className:"a-target",onClick:y,children:e})},"You can <action0>click here</action0> to give us feedback."),icon:(0,n.jsx)(Ig,{businessType:s}),button:(0,n.jsxs)("div",{className:Ag,children:[(0,n.jsx)(k.A,{type:"primary",onClick:w,size:"large",children:c.Ay.t("web_shopify_button_retry",{},"Try again")}),(0,n.jsx)(k.A,{onClick:()=>i("BACK_CHOSEN_STATE"),size:"large",children:c.Ay.t("web_shopify_text_back_setting",{},"Go back")})]},"upload-failed")}};return(0,n.jsx)("div",{className:kg,children:(0,n.jsx)(ks,{openType:_,uploadResult:e,resultComponent:o===u.F.FilmVideo?x:b,headTitle:null==t?void 0:t.platformContent,handleBack:()=>i("BACK_CHOSEN_STATE")})})},Tg={selector:"_selector_i932c_1","option-wrapper":"_option-wrapper_i932c_5","target-option":"_target-option_i932c_9","target-option-text":"_target-option-text_i932c_15","target-option-text-name":"_target-option-text-name_i932c_18","target-option-text-email":"_target-option-text-email_i932c_24","target-option-avatar":"_target-option-avatar_i932c_33"},Pg=({name:e,email:t})=>(0,n.jsx)("div",{className:Tg["target-option"],children:(0,n.jsxs)("div",{className:Tg["target-option-text"],children:[(0,n.jsx)(G.A.Text,{className:Tg["target-option-text-name"],ellipsis:{cssEllipsis:!0,showTooltip:{props:{style:{zIndex:9999}}}},children:e}),(0,n.jsx)(G.A.Text,{className:Tg["target-option-text-email"],ellipsis:{cssEllipsis:!0,showTooltip:{props:{style:{zIndex:9999}}}},children:t})]})}),Ng=({onChange:e,value:t})=>{var o;const{userInfo:a}=xg();return(0,n.jsx)(N.A,{placeholder:"Please select",unmountOnExit:!1,dropdownMenuClassName:Tg.popper,className:l()(Tg.selector),triggerProps:{style:{zIndex:2e3},containerScrollToClose:!0},value:t,onChange:e,children:null==(o=null==a?void 0:a.accounts)?void 0:o.map((e=>(0,n.jsx)(N.A.Option,{className:l()(Tg["option-wrapper"]),value:e.user_id,children:(0,n.jsx)(Pg,{name:e.name,email:e.email})},e.user_id)))})},jg="_selector_4340t_1",Rg="_option-wrapper_4340t_5",Lg="_option-item_4340t_9",Og="_option-item-disabled_4340t_13",Fg="_radio-group_4340t_17",Dg="_radio-item_4340t_20",Ug="_radio-item-label_4340t_31",Mg="_radio-item-label-disabled_4340t_39",Bg=({onChange:e,value:t,selectedUserId:o,defaultProductId:a,setLoading:r})=>{const[s,l]=(0,i.useState)([]);return(0,i.useEffect)((()=>{r(!0),d.f.getFileList({path:"",cursor:"",page_size:99,platform:p.f.Shopify,account_id:o}).then((t=>{var o;const n=(null==(o=null==t?void 0:t.data)?void 0:o.entries)||[];l(n),a&&n.find((e=>e.id===a))?e(a):e((null==n?void 0:n[0].id)||"")})).finally((()=>{r(!1)}))}),[o,a,r]),(0,n.jsx)(N.A,{className:jg,onChange:e,value:t,placeholder:"Please select",unmountOnExit:!1,triggerProps:{style:{zIndex:2e3},containerScrollToClose:!0},children:s.map((e=>(0,n.jsx)(N.A.Option,{className:Rg,value:e.id,children:(0,n.jsx)(G.A.Text,{className:Lg,ellipsis:{cssEllipsis:!0,showTooltip:{props:{style:{zIndex:9999}}}},style:{marginBottom:0},children:e.name})},e.id)))})},zg=[{key:"media",label:c.Ay.t("web_shopify_text_product_media",{},"Product media")},{key:"description",label:c.Ay.t("web_shopify_text_description_section",{},"Product description")}],Gg=({onChange:e,value:t,formInfo:o})=>{const[a,r]=(0,i.useState)(!1);return(0,i.useEffect)((()=>{r(!(null==o||!o.need_replace_media)),null!=o&&o.need_replace_media&&e("media")}),[null==o?void 0:o.need_replace_media]),(0,n.jsx)(N.A,{className:jg,onChange:e,value:t,disabled:a,placeholder:"Please select",unmountOnExit:!1,triggerProps:{style:{zIndex:2e3},containerScrollToClose:!0},children:zg.map((e=>(0,n.jsx)(N.A.Option,{className:Rg,value:e.key,children:(0,n.jsx)(G.A.Text,{className:l()(Lg,{[Og]:a}),ellipsis:{cssEllipsis:!0,showTooltip:{props:{style:{zIndex:9999}}}},style:{marginBottom:0},children:e.label})},e.key)))})},Wg="_form_1xn1g_1",Vg="_form-scrollview_1xn1g_17",Hg="_form-content_1xn1g_27",qg="_form-line_1xn1g_45",Yg="_form-item_1xn1g_50",Kg="_radios_1xn1g_59";var Jg=(e=>(e.New="new",e.Replace="replace",e))(Jg||{});const $g=[{key:"new",label:c.Ay.t("web_shopify_text_as_new",{},"Export as new image")},{key:"replace",label:c.Ay.t("web_shopify_text_use_original",{},"Replace original image")}],Qg=({onChange:e,value:t,formInfo:o})=>{const{thirdpartyMetaInfo:a}=xg(),r=(0,i.useRef)(null),s=(0,i.useMemo)((()=>!(a&&a.thirdparty_shop===(null==o?void 0:o.account_id)&&a.thirdparty_productid===(null==o?void 0:o.path)&&"description"!==(null==o?void 0:o.to_scene))),[a,o]);function d(){return null!=r&&r.current?null==r?void 0:r.current:document.body}return(0,i.useEffect)((()=>{s&&null!=o&&o.need_replace_media&&e("new")}),[s]),(0,n.jsx)("div",{ref:r,children:(0,n.jsx)(W.A.Group,{className:Fg,direction:"vertical",type:"radio",size:"small",name:"projectType",value:t,onChange:e,children:$g.map((e=>(0,n.jsx)(x.A,{trigger:"hover",content:s&&"replace"===e.key?c.Ay.t("web_shopify_text_only_single_same_position",{},"Only available when 1 file is uploaded as product media"):"",position:"bl",getPopupContainer:d,style:{whiteSpace:"pre-wrap",zIndex:9999},children:(0,n.jsx)(W.A,{disabled:s,className:l()(Dg),value:e.key,children:(0,n.jsx)("div",{className:l()(Ug,{[Mg]:s&&"replace"===e.key}),children:e.label})},e.key)})))})})},Zg=({show:e,fileType:t})=>{const[o,a]=(0,i.useState)(),[r,s]=(0,i.useState)("media"),[d,_]=(0,i.useState)(!1),[h,m]=(0,i.useState)(Jg.New),{shopifySend:g,isUploading:v,uploadProgress:f,selectedUserId:y,thirdpartyMetaInfo:w}=xg(),{openType:b,platformItem:x,loading:k}=bg(),A=(0,i.useMemo)((()=>({account_id:y||"",path:o||"",to_scene:r,need_replace_media:h===Jg.Replace})),[y,o,r,h]);(0,i.useEffect)((()=>{g({type:"SAVE_SHARE_TYPE",data:{businessType:t}})}),[]);return(0,i.useEffect)((()=>{k||(t===u.F.Graphic?(0,p.g)().report({action:p.q.clickable,panel_page:p.z.saveShopifyDetail}):(0,u.n)().report({action:u.E.clickable,panel_page:u.P.save_shopify_detail}))}),[k]),(0,n.jsxs)(D.A,{webp:!0,className:l()(Wg),style:e?{}:{display:"none"},loading:k||!y||d,block:!0,children:[(0,n.jsxs)("div",{className:Vg,children:[(0,n.jsx)(hs,{headTitle:null==x?void 0:x.platformContent,handleBack:()=>{g("BACK_CHOOSE_STATE")},visible:(0,B.C5)(b)}),(0,n.jsx)("div",{className:l()("lv_share-form-content",Hg),children:(0,n.jsxs)(L.A,{layout:"vertical",disabled:v,children:[(0,n.jsx)(L.A.Item,{className:Yg,label:c.Ay.t("web_shopify_text_select_store",{},"Select store"),children:(0,n.jsx)(Ng,{value:y,onChange:e=>{g({type:"UPDATE_SELECTED_USER_ID",data:{selectedUserId:e}})}})}),(0,n.jsx)("div",{className:qg}),(0,n.jsx)(L.A.Item,{className:Yg,label:c.Ay.t("web_shopify_text_home_product",{},"Product Page"),children:(0,n.jsx)(Bg,{value:o,onChange:a,selectedUserId:y,setLoading:_,defaultProductId:null==w?void 0:w.thirdparty_productid})}),(0,n.jsx)(L.A.Item,{className:Yg,label:c.Ay.t("web_shopify_text_post_to",{},"Export to"),children:(0,n.jsx)(Gg,{value:r,onChange:s,formInfo:A})}),t===u.F.Graphic&&(0,n.jsx)(L.A.Item,{className:l()(Kg,Yg),label:c.Ay.t("web_shopify_text_exporting_method",{},"Export options"),children:(0,n.jsx)(Qg,{value:h,onChange:m,formInfo:A})}),(0,n.jsx)(L.A.Item,{className:l()(Ms,Yg),children:c.Ay.t("web_shopify_text_agree_terms",{strong0:e=>(0,n.jsx)("strong",{children:e}),href0:e=>(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://www.shopify.com/legal/terms",children:e}),href1:e=>(0,n.jsx)("a",{className:"a-target",target:"_blank",href:"https://www.shopify.com/legal/privacy",children:e})},"By clicking <strong0>Export</strong0>, you agree to the <href0>Shopify Terms of Service</href0> and acknowledge that you have read <href1>Shopify Privacy Policy</href1>.")})]})})]}),(0,n.jsx)(ml,{className:zs,uploading:v,progress:f,disabled:k,text:c.Ay.t("web_shopify_text_back_to",{},"Save"),uploadingText:`${c.Ay.t("web_shopify_text_exporting_percent",{},"Saving")} ${f}%`,onClick:()=>{g({type:"SHOW"}),g({type:"UPLOAD_TO_PLATFORM",data:A})}})]})},Xg="_facebook-form_9h9vv_1",ev=({platformList:e,openType:t,loading:o,fileType:a,fileInfo:r,...s})=>{const{shopifyState:c,shopifySend:d}=xg(),p=c.matches("show.hasBind.uploaded.success")?_s.ShareSuccess:c.matches("show.hasBind.uploaded.failed")?_s.UploadFailed:void 0,_=e.find((e=>e.platformName===u.c.Shopify));return(0,i.useEffect)((()=>{d({type:"SAVE_FILE_INFO",fileInfo:r})}),[r]),(0,n.jsx)(wg.Provider,{value:{...s,openType:t,platformItem:_,loading:o},children:(0,n.jsxs)("div",{className:l()("lv_share-form",Xg),children:[(0,n.jsx)(Zg,{show:!p,fileType:a}),p&&(0,n.jsx)(Eg,{uploadResult:p,platformItem:_,fileType:a})]})})};const tv=({handleClose:e,platformList:t,fileInfo:o,loading:a})=>{const{shareService:r,selectItemID:s}=Zn(),l=function(e,t){const o=(0,m.d)(e,(e=>e.context.selectedPlatform)),a=(0,m.d)(e,(e=>e.context.youtubeShareType)),n=(0,m.d)(e,(e=>e.context.facebookShareType));return(0,i.useMemo)((()=>t.find((e=>o===u.c.Shopify&&o===e.platformName||o===e.platformName&&[[e.facebookShareType,n],[e.youtubeShareType,a]].some((e=>"number"==typeof e[0]&&e[0]===e[1]))))),[o,n,a,t])}(r,t);return(0,n.jsx)("div",{className:Fi,children:(0,n.jsxs)("div",{className:Di,children:[(0,n.jsx)($i,{handleClose:e,title:(null==l?void 0:l.platformContent)||""}),(0,n.jsxs)("div",{className:Ui,children:[(0,n.jsx)("div",{className:Mi,children:(0,n.jsx)(ps,{})}),(0,n.jsx)("div",{className:Bi,children:(null==l?void 0:l.platformName)===u.c.Shopify?(0,n.jsx)(ev,{openType:p.O.graphicEditor,platformList:t,fileInfo:o,loading:a,fileType:u.F.Graphic}):(0,n.jsx)(yg,{openType:p.O.graphicEditor,platformList:t,fileInfo:o,loading:a,extraData:{currentPage:"work_space"}})})]})]})})},ov=({cookieConsent:e,handleClose:t})=>{En(e);const{shareService:o}=Zn(),a=function(e){const t=Xn(e),[o]=(0,g.B)(t),a=(0,m.d)(e,(e=>e.context.facebookShareType));return["show.hasBind.shareSuccess","show.hasBind.uploadFailed","show.hasBind.uploading.auditing","show.hasBind.uploading.uploadSuccess","show.hasBind.uploadAuditFailed","show.hasBind.uploaded"].some(o.matches)?a===u.d.INSTAGRAM?u.P.share_ins_result:u.P.share_fb_result:["show"].some(o.matches)?a===u.d.INSTAGRAM?u.P.share_ins_detail:u.P.share_fb_detail:""}(o);(0,p.g)().setParams({panel_page:a});const[,r]=(0,g.B)(o),s=(e=>{const{fbGroups:t,fbPages:o,instagram:a,shopify:n}=md(e);return(0,i.useMemo)((()=>[t,o,a,n]),[t,o,a,n])})({uid:(0,m.d)(o,(e=>e.context.uid))}),{panelShowParams:l}=(0,i.useContext)(ls),{data:c,loading:d}=(0,ce.Ay)((()=>Promise.all(l.graphicInfoList.map((e=>{var t;return null==(t=e.uploadAsset)?void 0:t.call(e)})))),{auto:!0,refreshDeps:[l.graphicInfoList]});return(0,i.useEffect)((()=>{if(!c)return;const e=c.map((e=>null==e?void 0:e.assetId));r({type:"SAVE_FILE_INFO",fileInfo:{fileId:e[0],assetIdList:e}})}),[r,c]),(0,n.jsx)(tv,{handleClose:t,platformList:s,fileInfo:l.graphicInfoList,loading:d})},av="_modal-title_nxf3u_1",nv="_modal-title-text_nxf3u_7",rv="_modal-footer_nxf3u_11";class iv extends(C()){constructor(){super(...arguments),bt(this,"shareService"),bt(this,"modalInstance"),bt(this,"cookieConsent")}init({reqDomain:e,uid:t,workspaceId:o,cookieConsent:n,reportExtra:r}){e&&d.b.updateRequestDomain({domain:e}),n&&(this.cookieConsent=n),this.shareService=(0,T.U4)(p.L.withContext({userInfo:{},everCloudInstance:void 0,errorCode:"-1",reportExtra:r,retryShareFailedCallback:()=>{a.A.warning(c.Ay.t("retry_share_failed"))},uid:t,isNewShareExport:!0,detailPageOpenCallback:void 0,currentPage:"picture_edit",businessType:u.F.Graphic,workspaceId:o,openType:p.O.default})).start(),this.shareService.send({type:"SAVE_SPACE_INFO",spaceInfo:{workspaceId:o}})}getShareService(){return this.shareService}handleClose(){this.shareService.send("INIT_SERVICE"),this.modalInstance.close()}show({draftId:e,graphicInfoList:t,thirdpartyMetaInfo:o}){var a,r,i,s,l;void 0!==o&&(this.getShareService().send({type:"UPDATE_SHOPIFY_META_INFO",data:{thirdpartyMetaInfo:o}}),null==(l=null==(s=null==(i=null==(r=null==(a=this.getShareService())?void 0:a.getSnapshot())?void 0:r.children)?void 0:i.LvShareShopify)?void 0:s.send)||l.call(s,{type:"UPDATE_SELECTED_USER_ID",data:{selectedUserId:null==o?void 0:o.thirdparty_shop}})),this.modalInstance=y.A.info({alignCenter:!0,modalRender:()=>(0,n.jsx)(Qn.Provider,{value:{shareService:this.shareService,isNewShareExport:!0},children:(0,n.jsx)(ls.Provider,{value:{panelShowParams:{draftId:e,graphicInfoList:t}},children:(0,n.jsx)(ov,{cookieConsent:this.cookieConsent,handleClose:()=>this.handleClose()})})})});const{enter_from:c}=(0,p.g)().getParams();let d;c===p.G.fbGroups||c===p.G.fbPages?d=p.z.shareFbDetail:c===p.G.ins?d=p.z.shareInsDetail:c===p.G.saveShopify&&(d=p.z.saveShopifyDetail),(0,p.g)().setParams({draft_id:e,format:null==t?void 0:t.map((e=>null==e?void 0:e.format)),size:null==t?void 0:t.map((e=>null==e?void 0:e.size)),resolution:null==t?void 0:t.map((e=>null==e?void 0:e.resolution)),page_id:null==t?void 0:t.map((e=>null==e?void 0:e.pageId)),page_cnt:null==t?void 0:t.length,panel_page:d}),(0,p.g)().report({action:p.q.show})}showShareResult({status:e,panelShowParams:t,shareInfo:o}){this.shareService.send({type:e,data:{...o,platform:u.c.Facebook,businessType:u.F.Graphic}});const{draftId:a,graphicInfoList:n}=t;this.show({draftId:a,graphicInfoList:n})}}const sv=async({fileInfo:e,fileName:t,assetId:o})=>{let a,i,s=!1;const u=()=>s,p=y.A.info({title:(0,n.jsx)("span",{className:l()(nv),children:c.Ay.t("web_dropbox_text_preparing_material",{},"Preparing your work...")}),simple:!1,autoFocus:!1,maskClosable:!1,onCancel:()=>{p.close(),s=!0},footer:(0,n.jsxs)("div",{className:l()(rv),children:[(0,n.jsx)(k.A,{type:"secondary",size:"large",onClick:()=>{p.close(),s=!0},children:c.Ay.t("web_ai_cancel",{},"Cancel")}),(0,n.jsx)(k.A,{type:"secondary",size:"large",loading:!0,disabled:!0,children:c.Ay.t("web_dropbox_text_uploading_db",{},"Uploading")})]})});if(t&&o)i=t,a=o;else if(e){const{uploadAsset:t}=e,o=await t(),{assetId:n,fileName:r}=o;a=n,i=r}const _=()=>{p.update({icon:null,title:(0,n.jsxs)("div",{className:l()(av),children:[(0,n.jsx)(r.duN,{size:24,fill:"#FF303D"}),(0,n.jsx)("span",{className:l()(nv),children:c.Ay.t("web_dropbox_text_fail_upload_material",{},"Sync fail")})]}),footer:(0,n.jsxs)("div",{className:l()(rv),children:[(0,n.jsx)(k.A,{size:"large",type:"secondary",onClick:()=>{p.close(),s=!0},children:c.Ay.t("web_ai_cancel",{},"Cancel")}),(0,n.jsx)(k.A,{type:"primary",size:"large",onClick:()=>{p.close(),sv({fileInfo:e,fileName:t,assetId:o})},children:c.Ay.t("web_dropbox_button_retry",{},"Retry")})]})})};try{if(console.warn("get asset",a,i),a&&i){const e=await(0,d.m)(i,a,u);if(e)return void p.update({icon:null,title:(0,n.jsxs)("div",{className:l()(av),children:[(0,n.jsx)(r.l1g,{size:24,fill:"#2DD196"}),(0,n.jsx)("span",{className:l()(nv),children:c.Ay.t("web_dropbox_text_upload_success",{},"sync success")})]}),footer:(0,n.jsxs)("div",{className:l()(rv),children:[(0,n.jsx)(k.A,{type:"secondary",size:"large",onClick:()=>p.close(),children:c.Ay.t("web_ai_cancel",{},"Cancel")}),(0,n.jsx)(k.A,{type:"primary",size:"large",onClick:()=>window.open(e),children:c.Ay.t("web_dropbox_text_check_go",{},"Go check")})]})})}_()}catch{_()}},lv=(new iv,"_downloadBtn_1vqqg_1"),cv="_shadowAnchor_1vqqg_4",dv=e=>{const{autoDownload:t,handleAutoDownload:o,className:a,renderService:r}=e,[s,d]=(0,i.useState)(""),[u,p]=(0,i.useState)(""),[_,h]=(0,i.useState)(0),g=(0,i.useRef)(),v=(0,i.useRef)(null),{start:f,reset:y}=(0,we.A)(348e4,{onComplete:()=>{var e;null==(e=g.current)||e.call(g)},auto:!1}),w=(0,m.d)(r,(e=>e.context.fileId)),b=(0,m.d)(r,(e=>e.context.everCloudInstance)),x=(0,m.d)(r,(e=>{var t,o,a,n,r,i,s,l;return(null==(n=null==(a=null==(o=null==(t=e.context.fileInfo)?void 0:t.asset)?void 0:o.meta)?void 0:a.coverInfo)?void 0:n.coverImageFileID)??(null==(l=null==(s=null==(i=null==(r=e.context.fileInfo)?void 0:r.asset)?void 0:i._meta)?void 0:s.coverInfo)?void 0:l.coverImageFileID)})),A=(0,m.d)(r,(e=>{var t;return null==(t=e.context.fileInfo)?void 0:t.fileName})),S=(0,ve.A)(!1),C=(0,i.useCallback)((()=>{if(!w||!b)return;const e=[w],t=[""];if(x){e.push(x);const o=(null==A?void 0:A.split("."))??[""];t.push(`${o[0]}_${c.Ay.t("web_download_file_name_ext",{},"cover")}`)}null==b||b.getDownloadUrl({ids:e,names:t,ttl:3600,maxTime:5}).then((e=>{var t,o;d(null==(t=e.urlMap[w])?void 0:t.url),x&&p(null==(o=e.urlMap[x])?void 0:o.url),y(),f()}))}),[x,w,b]);g.current=C,(0,i.useEffect)((()=>{C()}),[C]);return(0,i.useEffect)((()=>{var e;_>3&&(h(0),null==(e=g.current)||e.call(g))}),[_]),(0,i.useEffect)((()=>{!t||S.state||!o||(S.setTrue(),o())}),[t,o]),(0,n.jsxs)(k.A,{className:l()(lv,a),onClick:()=>{var a,n;if(!s&&!u)return t&&(null==o||o()),void(null==(a=g.current)||a.call(g));h((e=>e+1)),null==(n=e.anchorClick)||n.call(e)},children:[c.Ay.t("space_files_menu_download",{},"Download"),s&&(0,n.jsx)("a",{className:cv,download:!0,href:s,target:"_blank",onClick:()=>setTimeout((()=>{var e;return null==(e=v.current)?void 0:e.click()}))}),u&&(0,n.jsx)("a",{ref:v,style:{display:"none"},download:!0,href:u,target:"_blank"})]})},uv=({renderService:e,handleCloseCallback:t,shareModalHideCallback:o})=>{var s,_,h,v,f,y;const[x,A]=(0,g.B)(e),S=x.matches("open.save"),C=x.matches("open.save.fail"),I=x.matches("open.save.saving"),E=(0,m.d)(e,(e=>e.context.presetProgressLimit)),T=(0,m.d)(e,(e=>e.context.isSaveStateInit)),P=["open.rendering","open.renderSuccess","open.renderFailed"].some(x.matches)&&!x.matches("open.renderSuccess.requestSuccess"),N=x.matches("open.renderSuccess"),j=x.matches("open.renderSuccess.requestSuccess"),R=(0,m.d)(e,(e=>{var t;return null==(t=e.context)?void 0:t.errorTitle})),L=(0,m.d)(e,(e=>{var t;return null==(t=e.context)?void 0:t.customContent})),O=(0,m.d)(e,(e=>e.context.fileInfo.coverImg)),F=(0,m.d)(e,(e=>e.context.currentPage)),D=(0,m.d)(e,(e=>{var t;return null==(t=e.context)?void 0:t.errorCode})),U=(0,m.d)(e,(e=>{var t;return null==(t=e.context)?void 0:t.errorMessage})),{spaceInfo:M}=x.context,B=null==(_=null==(s=Ev())?void 0:s.expandInstanceInfo)?void 0:_.isSupportExpand,z=(0,m.d)(e,(e=>{var t;return null==(t=e.context)?void 0:t.saveStateOperatesCallback})),W=(0,m.d)(e,(e=>e.context.taskId)),V=(0,m.d)(e,(e=>e.context.fileId)),H=(0,m.d)(e,(e=>e.context.fileInfo)),q=In(),[K,J]=(0,i.useState)(!0),$=(0,m.d)(e,(e=>{var t;return null==(t=e.context)?void 0:t.customText})),Q=(0,m.d)(e,(e=>{var t;return null==(t=e.context)?void 0:t.customResultView})),Z=(0,m.d)(e,(e=>{var t;return null==(t=e.context)?void 0:t.disableCancelConfirm})),X=null==(v=null==(h=x.context)?void 0:h.selectItemData)?void 0:v.selectItemID,ee=S||P||!!Q&&j||X===p.S.Download||X===p.S.SaveDropbox,te=Q&&j,oe=!Q&&j,ae=async(e=!1)=>{var t,o,r,i,s,l,p,_,h,m,g,v,f,y,k,A,S,C,I,E;if(null==(t=x.context)||!t.everCloudInstance)return;Sr.reportDownloadAction({action:u.E.download,panel_page:u.P.export_finish});try{const t=await(null==(r=null==(o=null==x?void 0:x.context)?void 0:o.everCloudInstance)?void 0:r.downloadAssetUrlV2({ids:[V||""]}));if(null!=t&&t.length)throw new Error("get DownloadAssetUrl failure, not link to download");const a=(null==(_=null==(p=null==(l=null==(s=null==(i=null==x?void 0:x.context)?void 0:i.fileInfo)?void 0:s.asset)?void 0:l.meta)?void 0:p.coverInfo)?void 0:_.coverImageFileID)??(null==(f=null==(v=null==(g=null==(m=null==(h=null==x?void 0:x.context)?void 0:h.fileInfo)?void 0:m.asset)?void 0:g._meta)?void 0:v.coverInfo)?void 0:f.coverImageFileID),n=(null==(A=null==(k=null==(y=null==x?void 0:x.context)?void 0:y.fileInfo)?void 0:k.fileName)?void 0:A.split("."))??[""];if(a){const e=await(null==(C=null==(S=null==x?void 0:x.context)?void 0:S.everCloudInstance)?void 0:C.downloadAssetUrlV2({ids:[a||""],names:[`${n[0]}_${c.F2.t("web_download_file_name_ext",{},"cover")}`]}));if(null!=e&&e.length)throw new Error("get DownloadAssetUrl failure, not link to download")}(new Zo).report({assets:[null==H?void 0:H.asset],page_from:F,download_start_type:e?"export_finish_auto":"click_download"})}catch(P){J(!1),d.s.error("ExportAndShareModal-FailedDownloadFiles",P,{toGroup:"true"}),a.A.error(c.F2.t("file_failed_to_download",{},"\u6587\u4ef6\u4e0b\u8f7d\u5931\u8d25"))}if(!V)return void J(!1);try{await(0,b.a)(await co.createTask({type:u.k.Download,file_id:V,file_type:H.type,size:(null==(E=null==(I=H.size)?void 0:I.toString)?void 0:E.call(I))??"",file_name:H.fileName??"",format:(0,b.g)(H.format),resolution:H.resolution}))}catch{}const T={base_info:{task_type:u.k.Download,cover_url:H.coverImg,video_name:H.fileName,video_id:H.videoId}};w.A.success({...Tv,id:Pv(T),content:(0,n.jsx)(Rv,{task:T})})},ne=(0,i.useMemo)((()=>{if(x.matches("open.renderSuccess.requesting"))return Wa.load;if(x.matches("open.renderFailed.normal"))return Wa.failed;if(x.matches("open.renderFailed.hadCancel"))return Wa.hadCancel;if(x.matches("open.renderFailed.fallSpace"))return Wa.spaceFull;if(x.matches("open.renderSuccess.requestFailed"))return Wa.loadFileFailed;if(x.matches("open.rendering")){const{errCode:e,ignoreErrCodeSet:t}=x.context.renderPendingInfo;if(e===u.b.UploadFailed&&!t.has(e))return Wa.exportWithUploadFailed}return Wa.export}),[x]),[re,ie]=(0,i.useState)();(0,i.useEffect)((()=>{P&&!re&&ie(new Y.L)}),[P]);const se=(0,m.d)(e,(e=>e.matches("open.rendering")?"exporting":e.matches("open.renderFailed")?"fail":e.matches("open.save.fail")?"saveFail":e.matches("open.renderSuccess")?"success":null));return(0,i.useEffect)((()=>{const e=setTimeout((()=>{"exporting"===se&&Sr.reportExportingAction({action:u.E.show,panel_page:u.P.exporting}),"fail"===se&&Sr.reportExportFailAction({action:u.E.show,panel_page:u.P.export_fail}),"saveFail"===se&&Sr.reportSaveFailAction({action:u.E.show,panel_page:u.P.save_fail})}),100);return()=>clearTimeout(e)}),[se]),(0,i.useEffect)((()=>{oe&&(X===p.S.Download||X===p.S.SaveDropbox)&&Sr.reportDownloadAction({action:u.E.show,panel_page:u.P.export_finish})}),[oe,X]),(0,n.jsx)("div",{className:l()("lv_share_export-container-body-render",X===p.S.Download||X===p.S.SaveDropbox?"lv_share_export-container-body-download":""),children:(0,n.jsxs)("div",{className:"lv_share_export-container-body-render-video",children:[ee&&(0,n.jsx)("div",{className:"coverImg",children:(0,n.jsx)("img",{src:O,crossOrigin:"anonymous",alt:""})}),S&&(0,n.jsx)(Li,{isSaveFail:C,isSaving:I,errorCode:D,errorTitle:R,errorMessage:U,isSupportExpand:B,process:x.context.renderProgress,precision:x.context.precision,handleClose:()=>{t(),A({type:"CLOSE",reportHide:!1})},saveStateOperatesCallback:z,disableCancelConfirm:Z}),P&&(0,n.jsx)(Ri,{taskId:W,customContent:L,renderSimulateProgress:re,isSaveStateInit:T,allowCloseWindow:x.context.allowCloseWindow,presetProgressLimit:E,isRenderSuccess:N,handleRenderCancel:e=>{A({type:"CANCEL_RENDER",cancelExportPromiseResolve:e})},handleIgnoreRenderingErr:()=>{const e=x.context.renderPendingInfo.errCode;e&&A({type:"IGNORE_RENDERING_PROCESS_ERR",errCode:e})},type:ne,errorCode:D,renderStateOperatesCallback:x.context.renderStateOperatesCallback,renderPendingErrCode:x.context.renderPendingInfo.errCode,ignoreErrCodeSet:x.context.renderPendingInfo.ignoreErrCodeSet,createTime:x.context.createTime,expectFinishTime:x.context.expectFinishTime,process:x.context.renderProgress,allowCancelRender:x.context.allowCancelRender,coverImg:null==(y=null==(f=x.context)?void 0:f.fileInfo)?void 0:y.coverImg,precision:x.context.precision,retry:()=>{W?A("RETRY_RENDER"):(t(),A("CLOSE"),null==o||o())},duplicate:()=>{W?A("DUPLICATE_RENDER"):(t(),A("CLOSE"),null==o||o())},goToCloud:()=>{(0,u.n)().report({action:u.E.cloud}),location.href=q(`${location.origin}${d.R.WORKSPACE.CHILD.MY_CLOUD.PATH}/${null==M?void 0:M.workspaceId}`)},handlePureTransitionRenderSuccess:()=>{A("PURE_TRANSITION_RENDER_SUCCESS")},isSupportExpand:B,customText:null==$?void 0:$.progress,disableCancelConfirm:Z,handleProcessChange:x.context.exportProcessCb}),te&&(0,i.cloneElement)(Q,{loadingIcon:(0,n.jsx)(ji,{})}),oe&&(X!==p.S.Download&&X!==p.S.SaveDropbox?(0,n.jsx)(Oi,{renderService:e}):K?(0,n.jsxs)("div",{className:"downloadContainer",children:[(0,n.jsxs)("div",{className:"downloadText",children:[(0,n.jsxs)(G.A.Text,{className:"text1",children:[(0,n.jsx)(r.TAn,{size:16}),c.F2.t("export_successfully",{},"Export successfully")]}),(0,n.jsx)(G.A.Text,{className:"text2",children:X===p.S.SaveDropbox?c.F2.t("web_dropbox_text_back_dropbox",{},"Sync to Dropbox"):c.F2.t("web_exportlogic_text_download_device",{},"Click the button to save to local")})]}),X===p.S.SaveDropbox?(0,n.jsx)(k.A,{className:"downloadButton",onClick:()=>{(0,u.n)().report({action:u.E.dropbox}),Sr.reportExportingAction({action:u.E.dropbox,panel_page:u.P.exporting}),sv({fileName:H.fileName,assetId:H.asset.id})},children:c.F2.t("web_dropbox_button_sync",{},"Sync")}):(0,n.jsx)(dv,{renderService:e,autoDownload:!0,handleAutoDownload:()=>ae(!0),className:"downloadButton",anchorClick:()=>{Sr.reportDownloadAction({action:u.E.download,panel_page:u.P.export_finish}),(new Zo).report({assets:[null==H?void 0:H.asset],page_from:F,download_start_type:"click_download"})}})]}):(0,n.jsxs)("div",{className:"downloadContainer",children:[(0,n.jsxs)("div",{className:"downloadText",children:[(0,n.jsxs)(G.A.Text,{className:"failedText1",children:[(0,n.jsx)(r.QnA,{size:16}),c.F2.t("export_failed",{},"could not export")]}),(0,n.jsx)(G.A.Text,{className:"text2",children:c.F2.t("web_exportlogic_text_download_device",{},"Reason why export failed")})]}),(0,n.jsx)(k.A,{className:"downloadButton",onClick:()=>{ae()},children:c.F2.t("retry_web",{},"Retry")})]}))]})})},pv="_shopify-embed_hhdby_1",_v="_shopify-embed-title_hhdby_22",hv="_shopify-embed-code_hhdby_31",mv="_shopify-embed-button_hhdby_50",gv="_shopify-embed-privacy_hhdby_55",vv="_a-target_hhdby_66";const fv=()=>(0,n.jsxs)("div",{className:pv,children:[(0,n.jsx)(V.A,{className:"line0",text:{width:"36%",rows:1},animation:!0}),(0,n.jsx)(V.A,{className:"line1",text:{width:"100%",rows:1},animation:!0}),(0,n.jsx)(V.A,{className:"line2",text:{width:"100%",rows:1},animation:!0}),(0,n.jsx)(V.A,{className:"line3",text:{width:"100%",rows:2},animation:!0})]}),yv=({fileId:e,workspaceId:t,showHeader:o,headTitle:r})=>{const[s,l]=(0,i.useState)(""),{embedShopifySend:p}=(()=>{const{shareService:e}=Zn(),[t,o]=(0,g.B)(e),a=t.children.LvShareEmbedShopify,[n,r]=(0,g.B)(a);return{embedShopifySend:r}})();(0,i.useEffect)((()=>{(async()=>{try{const o=await d.l.getPresentationSettingsInfo(e,t),a=function(e="",t){return e&&t?`${location.origin}/player/${e}?workspaceId=${t}&clear=1`:""}(null==o?void 0:o.presentation_share_id,t);let n="";a&&(n=`<iframe src="${a}" allow="clipboard-write" frameborder="0" width="400px" height="400px" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>`),l(n)}catch(o){console.error("=========err",o)}})()}),[e,t]);return s?(0,n.jsxs)("div",{className:pv,children:[(0,n.jsx)(hs,{headTitle:r,handleBack:()=>{p("BACK_CHOOSE_STATE")},visible:o}),(0,n.jsx)("div",{className:_v,children:c.Ay.t("web_shopify_text_copy_code_embed",{},"Copy embedded code")}),(0,n.jsx)("div",{className:hv,children:s}),(0,n.jsx)(k.A,{type:"primary",className:mv,long:!0,onClick:()=>{navigator.clipboard.writeText(s).then((()=>{a.A.success(c.Ay.t("web_embedcode_toast_copy_code_success",{},"copied"))})).catch((()=>{a.A.error(c.Ay.t("web_embedcode_toast_copy_code_fail",{},"copy failed"))})),(0,u.n)().report({action:u.E.clickable,panel_page:u.P.save_shopify_detail})},disabled:!s,children:c.Ay.t("web_shopify_text_copy_code",{},"Copy code")}),(0,n.jsx)("div",{className:gv,children:c.Ay.t("web_embedcode_text_privacy_policy",{"text-href0":e=>(0,n.jsx)("a",{target:"__blank",href:d.P.TERMS_OF_CAPCUT(c.Ay.language),className:vv,children:e},"terms-of-user"),"text-href1":e=>(0,n.jsx)("a",{target:"_blank",href:d.P.PRIVACY_POLICY(c.Ay.language),className:vv,children:e},"privacy-policy")},"By signing up, you accept the <text-href0>Terms of Use</text-href0> and <text-href1>Privacy Policy</text-href1>")})]}):(0,n.jsx)(fv,{})},wv=({renderService:e,shareService:t,expandModalInstance:o,shareModalHideCallback:a,eventParams:r,extraData:s,cookieConsent:l})=>{var c,d,h,v,f,y,w,b,x,k,A,S,C,I,E,T,P,N;En(l);const[j]=(0,g.B)(e),R=(0,m.d)(e,(e=>{var t;return null==(t=e.context)?void 0:t.errorCode})),L=(0,m.d)(e,(e=>{var t,o,a,n;return null==(n=null==(a=null==(o=null==(t=e.context)?void 0:t.fileInfo)?void 0:o.asset)?void 0:a.meta)?void 0:n.disableDownload})),O=(0,m.d)(e,(e=>{var t;return null==(t=e.context)?void 0:t.showVipCard})),[F]=(0,g.B)(t),[D]=(0,g.B)(F.children.LvShareTt),[U]=(0,g.B)(F.children.LvShareTtam),[M]=(0,g.B)(F.children.LvShareYt),z=D.matches("show.hasBind")&&!D.matches("show.hasBind.notUpload"),G=M.matches("show.hasBind")&&!M.matches("show.hasBind.notUpload"),W=U.matches("show.hasBind")&&!U.matches("show.hasBind.notUpload"),[V,H]=(0,i.useState)(!1),{openModalType:q}=j.context,Y=(q!==_.Gj.FromCloud||q===_.Gj.FromCloud&&V)&&!j.matches("open.save.fail"),K=null==(d=null==(c=j.context)?void 0:c.selectItemData)?void 0:d.selectItemID,J=null==(f=null==(v=null==(h=j.context)?void 0:h.selectItemData)?void 0:v.payload)?void 0:f.scheduleTask,$=null==(b=null==(w=null==(y=j.context)?void 0:y.selectItemData)?void 0:w.payload)?void 0:b.scheduleCb,Q=!(0,m.d)(e,(e=>{var t;return null==(t=e.context)?void 0:t.customResultView}))&&K!==p.S.SaveDropbox,Z=(e=>{const{tiktok:t,ttam:o,youtube:a,ytbShorts:n,fbGroups:r,fbPages:i,reels:s}=md(e);return[t,o,a,n,r,i,s]})({uid:(0,m.d)(t,(e=>e.context.uid))});Tn(" "),(0,i.useEffect)((()=>{(z||W||G)&&!V&&H(!0)}),[z,W,G,V]),(0,i.useEffect)((()=>{R===_.Ts.SAVE_TIMEOUT?H(!1):H(!0)}),[R]);const X=()=>{var e,t;let o;o=null!=j&&j.matches("open.save.fail")?"saveFail":null!=j&&j.matches("open.rendering")?"exporting":null!=j&&j.matches("open.renderSuccess")?"exported":"",null==(t=null==(e=Ev())?void 0:e.onCloseCallback)||t.call(e,o)},ee=(0,i.useMemo)((()=>{const{fileId:e,fileInfo:t}=(null==j?void 0:j.context)||{};return{asset:(null==t?void 0:t.asset)??{},format:(null==t?void 0:t.format)??"",downloadUrl:(null==t?void 0:t.downloadUrl)??"",fileName:(null==t?void 0:t.fileName)??"",fileId:e??"",fileSize:null!=t&&t.size?`${t.size}`:"",fileType:null==t?void 0:t.type,resolution:(null==t?void 0:t.resolution)??"",duration:(null==t?void 0:t.duration)??0,videoId:null==t?void 0:t.videoId,coverImg:null==t?void 0:t.coverImg}}),[null==j?void 0:j.context]),te=(0,i.useMemo)((()=>{var e,t;return null==(t=null==(e=null==j?void 0:j.context)?void 0:e.spaceInfo)?void 0:t.workspaceId}),[null==(k=null==(x=null==j?void 0:j.context)?void 0:x.spaceInfo)?void 0:k.workspaceId]),{setExportState:oe}=(0,i.useContext)(bv),ae=(0,m.d)(e,(e=>e.tags.has("renderComplete")));(0,i.useEffect)((()=>{oe(!ae)}),[ae]);const ne=(0,i.useMemo)((()=>{var e;return null==(e=null==j?void 0:j.context)?void 0:e.fileId}),[null==(A=null==j?void 0:j.context)?void 0:A.fileId]),re=(0,i.useMemo)((()=>{var e,t;return null==(t=null==(e=null==j?void 0:j.context)?void 0:e.fileInfo)?void 0:t.fileName}),[null==(C=null==(S=null==j?void 0:j.context)?void 0:S.fileInfo)?void 0:C.fileName]),ie=(0,i.useMemo)((()=>{var e;return null==(e=null==j?void 0:j.context)?void 0:e.spaceInfo}),[null==(I=null==j?void 0:j.context)?void 0:I.spaceInfo]);return(0,n.jsx)("div",{className:"lv_share_export",children:(0,n.jsxs)("div",{className:"lv_share_export-container",children:[(0,n.jsx)(nr,{renderService:e,shareModalHideCallback:a,showHideUi:Y,handleCloseCallback:X}),(0,n.jsxs)("div",{className:"lv_share_export-container-body",children:[(0,n.jsx)(uv,{renderService:e,handleCloseCallback:X,shareModalHideCallback:a}),Q&&(0,n.jsxs)("div",{className:"lv_share_export-container-body-lv-share-video",children:[K===p.S.Review&&(0,n.jsx)(ed,{expandModalInstance:o,showVipCard:O,isShowVipEquityCard:L,eventParams:r,fileID:ne,workspaceID:te,fileName:re,openType:(0,B.NZ)(s.currentPage,K)}),K===p.S.SharePresentation&&(0,n.jsx)(Pi,{showVipCard:O,fileID:ne,workspaceID:te,isShowVipEquityCard:L,eventParams:r,expandModalInstance:o,openType:(0,B.NZ)(s.currentPage,K)}),K===p.S.ShareShopify&&(0,n.jsx)(Qn.Provider,{value:{shareService:t,isNewShareExport:!0},children:(0,n.jsx)(ev,{openType:(0,B.NZ)(s.currentPage,K),platformList:Z,fileInfo:ee,loading:!1,fileType:u.F.FilmVideo})}),K===p.S.EmbedShopify&&(0,n.jsx)(yv,{fileId:ne,workspaceId:te}),K!==p.S.Review&&K!==p.S.SharePresentation&&K!==p.S.Download&&K!==p.S.SaveDropbox&&K!==p.S.ShareShopify&&K!==p.S.EmbedShopify&&(0,n.jsx)(Uv,{showVipCard:O,expandModalInstance:o,isShowVipEquityCard:L,eventParams:r,isNewShareExport:!0,reportExtra:{currentPage:null==(T=null==(E=Ev())?void 0:E.extraData)?void 0:T.currentPage,enterFrom:null==(N=null==(P=Ev())?void 0:P.extraData)?void 0:N.enterFrom},spaceInfo:ie,fileInfo:ee,openModalType:q,extraData:s,shareServiceProp:t,selectItemID:K,openType:(0,B.NZ)(s.currentPage,K),scheduleTask:J,scheduleCb:$,cookieConsent:l})]})]})]})})},bv=(0,i.createContext)({exportState:!1,setExportState:()=>{}}),xv=e=>{const{initialExportState:t,children:o}=e,[a,r]=(0,i.useState)(t??!0),s={exportState:a,setExportState:r};return(0,n.jsx)(bv.Provider,{value:s,children:o})},kv={platforms:{TikTok:{}}};var Av=(e=>(e[e.null=0]="null",e[e.TikTok=1]="TikTok",e[e.YouTube=2]="YouTube",e[e.TTAM=3]="TTAM",e[e.Facebook=4]="Facebook",e))(Av||{}),Sv=(e=>(e.uploading="TRANSITION_UPLOADING",e.uploadSuccess="TRANSITION_UPLOAD_SUCCESS",e.uploadFailed="TRANSITION_UPLOAD_FAILED",e.uploadAuditing="TRANSITION_AUDITING",e))(Sv||{});class Cv extends(C()){constructor(e){super(),bt(this,"extraData"),bt(this,"userInfo"),bt(this,"thirdUserInfo"),bt(this,"rendering"),bt(this,"openModalType"),bt(this,"eventParams"),bt(this,"modal"),bt(this,"shareService"),bt(this,"renderService"),bt(this,"region"),bt(this,"expandInfo"),bt(this,"saveToExportReportTimer",null),bt(this,"editTypeParams"),bt(this,"onCloseCallback"),bt(this,"renderTask",(e=>{const{taskId:t,fileName:o,resolution:a,format:n}=e.data;this.renderService.send("OPEN",{taskId:t,fileName:o,resolution:a,format:n,hideModal:!0})})),bt(this,"show",(e=>{var t,o,a,n,r,i,s,l,c,p,_;if(this.clearReportTimer(),e.type===ql.OPEN){const{showVipCard:t,taskId:o,fileName:a,resolution:n,format:r,customContent:i,customText:s,customResultView:l,hideHeaderBtn:c,disableCancelConfirm:p,precision:_,extraData:h,selectItemData:m,allowCloseWindow:g,presetProgressLimit:v,reportExtra:f}=e.data;f&&((0,u.n)().setParam(f),Sr.updateDigitalHuman(f)),this.renderService.send("OPEN",{showVipCard:t,taskId:o,fileName:a,resolution:n,format:r,customContent:i,exportSuccessCb:e.data.exportSuccessCb,exportCancelCb:e.data.exportCancelCb,customText:s,customResultView:l,hideHeaderBtn:c,allowCloseWindow:g,presetProgressLimit:v,disableCancelConfirm:p,precision:_,extraData:h,exportProcessCb:e.data.exportProcessCb,customGetRenderProcessParams:e.data.customGetRenderProcessParams,selectItemData:m}),d.s.log("ExportModal-ExportStatus",{taskId:o,fileName:a??""}),(0,d.g)().setTikTokReflowTaskList(o)}if(e.type===ql.EXPORT_WITH_SAVE){const{fileName:t,resolution:o,format:a,coverImg:n,customText:r,hideHeaderBtn:i,disableCancelConfirm:s,showVipCard:l,selectItemData:c,reportExtra:p,presetProgressLimit:_=u.D}=e;p&&((0,u.n)().setParam(p),Sr.updateDigitalHuman(p)),this.saveToExportReportTimer=setTimeout((()=>{d.s.error("ExportModalUnExport",new Error(JSON.stringify(e)),{toGroup:"true"})}),6e4),this.renderService.send("TRANSITION_SAVING_STATE",{showVipCard:l,fileName:t,resolution:o,format:a,coverImg:n,customText:r,hideHeaderBtn:i,disableCancelConfirm:s,selectItemData:c,presetProgressLimit:_})}e.type===ql.RENDER_SUCCESS&&this.renderService.send("SCENE_FILE_LIST_OPEN_RENDER_SUCCESS",{fileId:e.data.fileId,fileInfo:e.data.fileInfo,spaceInfo:e.data.spaceInfo,reportExtra:e.data.reportExtra,openModalType:e.data.openModalType}),e.type===ql.RENDERING&&this.renderService.send("SCENE_FILE_LIST_OPEN_RENDING",{taskId:e.data.taskId,fileInfo:e.data.fileInfo,reportExtra:e.data.reportExtra,renderProgress:e.data.renderProgress??0,presetProgressLimit:e.data.presetProgressLimit??u.D}),e.type===ql.RENDER_FAILED&&this.renderService.send("SCENE_FILE_LIST_OPEN_RENDER_FAILED",{fileInfo:e.data.fileInfo,taskId:e.data.taskId,reportExtra:e.data.reportExtra}),e.type===ql.RENDER_FAILED_SPACE_FULL&&this.renderService.send("SCENE_FILE_LIST_OPEN_RENDER_FAILED_SPACE_FULL",{fileInfo:e.data.fileInfo,taskId:e.data.taskId,reportExtra:e.data.reportExtra,spaceInfo:e.data.spaceInfo}),e.type===ql.UPLOADING&&(this.renderService.send("SCENE_FILE_LIST_OPEN_RENDER_SUCCESS",{fileId:e.data.fileId,fileInfo:e.data.fileInfo,spaceInfo:e.data.spaceInfo,reportExtra:e.data.reportExtra}),this.shareService.send({type:"TRANSITION_UPLOADING",data:{...e.data.shareInfo,platform:Av[e.data.platform],reportExtra:e.data.reportExtra}})),e.type===ql.UPLOAD_SUCCESS&&(this.renderService.send("SCENE_FILE_LIST_OPEN_RENDER_SUCCESS",{fileId:e.data.fileId,fileInfo:e.data.fileInfo,spaceInfo:e.data.spaceInfo,reportExtra:e.data.reportExtra}),this.shareService.send({type:"TRANSITION_UPLOAD_SUCCESS",data:{...e.data.shareInfo,platform:Av[e.data.platform],reportExtra:e.data.reportExtra}})),e.type===ql.UPLOAD_FAILED&&(this.renderService.send("SCENE_FILE_LIST_OPEN_RENDER_SUCCESS",{fileId:e.data.fileId,fileInfo:e.data.fileInfo,spaceInfo:e.data.spaceInfo,reportExtra:e.data.reportExtra}),this.shareService.send({type:"TRANSITION_UPLOAD_FAILED",data:{...e.data.shareInfo,platform:Av[e.data.platform],reportExtra:e.data.reportExtra,failedAdvList:(null==(t=e.data)?void 0:t.failedAdvList)??[],platformOpenId:null==(o=e.data)?void 0:o.platformOpenId}})),e.type===ql.UPLOAD_AUDITING&&(this.renderService.send("SCENE_FILE_LIST_OPEN_RENDER_SUCCESS",{fileId:e.data.fileId,fileInfo:e.data.fileInfo,spaceInfo:e.data.spaceInfo,reportExtra:e.data.reportExtra}),this.shareService.send({type:"TRANSITION_AUDITING",data:{platform:Av[e.data.platform],shareId:e.data.shareInfo.shareId,platformLink:e.data.shareInfo.platformLink,reportExtra:e.data.reportExtra}})),d.s.dataEvent("ExportModalShowEvent",{eventData:JSON.stringify(e)}),this.setEnterFromAndCurrentPage(null==(n=null==(a=null==e?void 0:e.data)?void 0:a.reportExtra)?void 0:n.enterFrom);const h={1:{[ql.UPLOADING]:u.P.share_tiktok_detail,[ql.UPLOAD_AUDITING]:u.P.share_tiktok_result,[ql.UPLOAD_FAILED]:u.P.share_tiktok_result,[ql.UPLOAD_SUCCESS]:u.P.share_tiktok_result},3:{[ql.UPLOADING]:u.P.share_ttam_detail,[ql.UPLOAD_AUDITING]:u.P.share_ttam_result,[ql.UPLOAD_FAILED]:u.P.share_ttam_result,[ql.UPLOAD_SUCCESS]:u.P.share_ttam_result},2:{[ql.UPLOADING]:u.P.share_youtube_detail,[ql.UPLOAD_AUDITING]:u.P.share_youtube_result,[ql.UPLOAD_FAILED]:u.P.share_youtube_result,[ql.UPLOAD_SUCCESS]:u.P.share_youtube_result},4:{[ql.UPLOADING]:u.P.share_fb_detail,[ql.UPLOAD_FAILED]:u.P.share_fb_result,[ql.UPLOAD_SUCCESS]:u.P.share_fb_result},render:{[ql.EXPORT_WITH_SAVE]:u.P.exporting,[ql.OPEN]:u.P.exporting,[ql.RENDERING]:u.P.exporting,[ql.RENDER_FAILED]:u.P.export_fail,[ql.RENDER_FAILED_SPACE_FULL]:u.P.save_fail,[ql.RENDER_SUCCESS]:u.P.export_finish}},{reportExtra:m}=null==(r=this.renderService.state)?void 0:r.context;Sr.updateEditType({...this.editTypeParams,is_smart_tool:null==m?void 0:m.isSmartTool,is_smart_crop:null==m?void 0:m.isSmartCrop,template_is_smart_crop:null==m?void 0:m.isTemplateSubjectCrop,is_cover_added:null==m?void 0:m.isCoverAdded,tool_type:null==m?void 0:m.toolType}),(0,u.n)().setParam({panel_page:null!=(i=null==e?void 0:e.data)&&i.platform?h[null==(s=null==e?void 0:e.data)?void 0:s.platform][e.type]:h.render[e.type],is_smart_tool:null==(c=null==(l=null==e?void 0:e.data)?void 0:l.extraData)?void 0:c.isSmartTool,is_smart_crop:null==(_=null==(p=null==e?void 0:e.data)?void 0:p.extraData)?void 0:_.isSmartCrop})})),bt(this,"setSaveStatus",(e=>{d.s.dataEvent("ExportModalSaveStatus",{eventData:JSON.stringify(e)}),"saving"===e.status&&this.renderService.send({type:"TRANSITION_SAVING_STATE",progress:e.progress,precision:e.precision}),"success"===e.status&&(this.clearReportTimer(),this.renderService.send("TRANSITION_SAVE_SUCCESS_STATE",{taskId:e.taskId})),"fail"===e.status&&(this.clearReportTimer(),this.renderService.send("TRANSITION_SAVE_FAIL_STATE",{errorCode:e.errorCode,errorMessage:e.errorMessage,errorTitle:e.errorTitle})),this.setPanelPage(e.status),this.setEnterFromAndCurrentPage()})),bt(this,"showScheduler",(e=>{const{fileInfo:t,spaceInfo:o,scheduleTask:a}=e,n=null==a?void 0:a.status;if(n===Pt||n===Tt||n===Et)return this.renderService.send("SCENE_FILE_LIST_OPEN_RENDER_SUCCESS",{fileId:null==t?void 0:t.fileId,spaceInfo:o}),this.renderService.send({type:"SAVE_SELECT_ITEM_DATA",selectItemData:{selectItemID:p.S.Schedule,payload:{...e,enterFrom:"schedule_calender"}}}),void this.shareService.send({type:"CHOOSE_PLATFORM",data:{platform:u.c.Schedule}});const r=null==a?void 0:a.shareChannel;this.show({type:ql.UPLOAD_SUCCESS,data:{fileId:t.fileId,platform:u.N[r??u.q.TikTok],shareInfo:{platformLink:null==a?void 0:a.link},fileInfo:t,spaceInfo:o}})})),bt(this,"setPanelPage",(e=>{const t={saving:u.P.exporting,success:u.P.exporting,fail:u.P.save_fail};(0,u.n)().setParam({panel_page:t[e]})})),bt(this,"setEnterFromAndCurrentPage",(e=>{var t,o,a;const n=e??(null==(a=null==(o=null==(t=this.renderService.state)?void 0:t.context)?void 0:o.selectItemData)?void 0:a.payload.enterFrom);this.extraData.enterFrom=n,Sr.updateEntry({enter_from:n,current_page:this.extraData.currentPage}),(0,u.n)().setParam({enter_from:n,current_page:this.extraData.currentPage})})),bt(this,"clearReportTimer",(()=>{this.saveToExportReportTimer&&(clearTimeout(this.saveToExportReportTimer),this.saveToExportReportTimer=null)})),bt(this,"saveStateOperatesCallback",(e=>{this.renderService.send("SET_SAVE_FAILED_OPERATES_CALLBACK",{callback:e})})),bt(this,"renderStateOperatesCallback",(e=>{this.renderService.send("SET_RENDER_STATE_OPERATES_CALLBACK",{callback:e})})),bt(this,"onClose",(e=>{this.onCloseCallback=e})),bt(this,"renderRetry",(()=>{this.renderService.send("RETRY")})),bt(this,"cancelRender",(()=>{this.renderService.send("CANCEL_RENDER")})),bt(this,"choosePlatform",(e=>{this.renderService.send({type:"CHOOSE_PLATFORM",platform:e})})),bt(this,"getService",(e=>"shareService"===e?this.shareService:this.renderService)),bt(this,"shareSuccessCallback",(e=>{this.shareService?this.shareService.send({type:"SAVE_SHARE_SUCCESS_CALLBACK",callback:e}):setTimeout((()=>{this.shareSuccessCallback(e)}),3e3)})),bt(this,"detailPageOpenModal",(({fileInfo:e,type:t,shareInfo:o,platform:a,reportExtra:r,openType:i,failedAdvList:s,spaceInfo:l,isShowVipEquityCard:c=!1,eventParams:d,showVipCard:p})=>{var _,m,g,v,f,w;if(null!=e&&e.asset)try{this.editTypeParams={...(0,h.g)(e.asset),template_id:null==(_=e.asset.meta)?void 0:_.templateId,video_type_id:(0,h.p)(null==(g=null==(m=e.asset)?void 0:m.meta)?void 0:g.templateProducerAppId)??h.v[null==(v=e.asset.meta)?void 0:v.itemType],video_type_list:null==(w=null==(f=e.asset)?void 0:f.meta)?void 0:w.videoTypeList},Sr.updateEditType(this.editTypeParams),(0,u.n)().setParam(this.editTypeParams)}catch{}"renderSuccess"!==t&&a&&this.shareService.send({type:Sv[t],data:{...o,platform:Av[a],reportExtra:r}}),3===a&&"uploadFailed"===t&&this.shareService.send({type:"SAVE_FAILED_ADV_LIST_AND_SWITCH_ID",data:{failedAdvList:s}});const b=y.A.info({closable:!0,maskClosable:!0,alignCenter:!0,wrapClassName:"share_record-share-modal-wrapper-new",modalRender:()=>{var t;return(0,n.jsx)("div",{className:"share_record-share-modal-new",children:(0,n.jsx)(Uv,{showVipCard:p,expandModalInstance:null==(t=this.expandInfo)?void 0:t.expandModal,isShowVipEquityCard:c,eventParams:d,changeShareModalVisible:()=>{null==b||b.close()},platformHandleClose:()=>{var e;null==(e=null==b?void 0:b.close)||e.call(b)},reportExtra:r,fileInfo:e,openType:i,spaceInfo:l,openModalType:this.openModalType,extraData:this.extraData,shareServiceProp:this.shareService})})},onCancel:()=>{this.shareService.send("INIT_SERVICE")}})})),bt(this,"showShareSettings",(({isShowVipEquityCard:e,workspaceID:t,fileID:o,openType:a,reportExtra:r,eventParams:i})=>{const s=y.A.info({closable:!0,maskClosable:!0,alignCenter:!0,wrapClassName:"share_record-setting-modal-wrapper",modalRender:()=>{var l;return(0,n.jsx)("div",{className:"share_record-setting-modal",children:(0,n.jsx)(ed,{expandModalInstance:null==(l=this.expandInfo)?void 0:l.expandModal,isShowVipEquityCard:!!e,eventParams:i,workspaceID:t,fileID:o,handleCloseModal:()=>{null==s||s.close()},openType:a,reportExtra:r})})}})}));const{EverCloud:t,region:o,extraData:r,expandInfo:i,uid:s,reqDomain:l,shareModalHideCallback:m,eventParams:g,cookieConsent:v}=e;l&&d.b.updateRequestDomain({domain:l}),d.a.removeItem(p.a.THIRDPARTY_SHARE_AUTH),this.expandInfo=i,this.extraData=r||{currentPage:"editor"},this.region=o,this.eventParams=g,this.shareService=(0,T.U4)(p.L.withContext({userInfo:{[p.P.TT_USER_INFO]:p.d.TikTok},everCloudInstance:t,detailPageOpenCallback:void 0,errorCode:"-1",currentPage:this.extraData.currentPage,reportExtra:{toolType:null==r?void 0:r.toolType,smartScriptId:null==r?void 0:r.smart_script_id,scriptRequestId:null==r?void 0:r.script_request_id,scriptId:null==r?void 0:r.script_id,taskId:null==r?void 0:r.taskId,intelligentRequestId:null==r?void 0:r.intelligentRequestId,autocutTemplateId:null==r?void 0:r.autocutTemplateId,currentPage:null==r?void 0:r.currentPage,fromPage:null==r?void 0:r.fromPage,isSmartTool:null==r?void 0:r.isSmartTool,isSmartCrop:null==r?void 0:r.isSmartCrop,isTemplateSubjectCrop:null==r?void 0:r.isTemplateSubjectCrop,isCoverAdded:null==r?void 0:r.isCoverAdded},retryShareFailedCallback:()=>{a.A.warning(c.F2.t("retry_share_failed"))},uid:s,isNewShareExport:!0,businessType:u.F.FilmVideo,openType:p.O.default})).start().onTransition((e=>{var t;this.thirdUserInfo=null==(t=null==e?void 0:e.context)?void 0:t.userInfo})),this.renderService=(0,T.U4)(p.A.withContext({showVipCard:!1,isSaveStateInit:!1,taskId:"",fileId:"",spaceInfo:{spaceId:"",spaceHost:"",spaceResHost:"",spaceIdc:"",workspaceId:""},userRegion:o,createTime:0,expectFinishTime:0,renderProgress:0,allowCancelRender:!1,allowCloseWindow:!0,exportType:_.vY.UNKNOW,fileInfo:{fileName:"-",size:"Calculating...",coverImg:"-",resolution:"-",format:"mp4",type:u.F.FilmVideo,fileType:u.F.FilmVideo},videoPlayInfo:{currentTime:0,playStatus:!1,fullscreen:!1,duration:0,videoInstance:null},platform:kv.platforms,isRequestUserBind:!1,everCloudInstance:t,reportExtra:{toolType:null==r?void 0:r.toolType,currentPage:null==r?void 0:r.currentPage,fromPage:null==r?void 0:r.fromPage,smartScriptId:null==r?void 0:r.smart_script_id,scriptRequestId:null==r?void 0:r.script_request_id,scriptId:null==r?void 0:r.script_id,taskId:null==r?void 0:r.taskId,intelligentRequestId:null==r?void 0:r.intelligentRequestId,autocutTemplateId:null==r?void 0:r.autocutTemplateId,isSmartTool:null==r?void 0:r.isSmartTool,isSmartCrop:null==r?void 0:r.isSmartCrop,isTemplateSubjectCrop:null==r?void 0:r.isTemplateSubjectCrop,isCoverAdded:null==r?void 0:r.isCoverAdded},retryCallback:()=>{a.A.warning(c.F2.t("export_cancelled"))},fallSpaceRetryFailCallback:()=>{a.A.warning(c.F2.t("web_enough_storage_try_again",{},"Make sure you have enough storage in cloud space first"))},renderSuccessCallbacks:[],currentPage:A.M.Editor,presetProgressLimit:u.D,renderPendingInfo:{errCode:0,ignoreErrCodeSet:new Set}})).start().onTransition((e=>{var t,o,a,r,i,s,l,c,d,p;this.openModalType=e.context.openModalType;const _=null==(t=e.context.fileInfo)?void 0:t.asset;if(_)try{this.editTypeParams={...(0,h.g)(_),template_id:(null==(a=null==(o=null==_?void 0:_.meta)?void 0:o.draft)?void 0:a.templateId)||(null==(r=null==_?void 0:_.meta)?void 0:r.templateId),video_type_id:(0,h.p)(null==(i=null==_?void 0:_.meta)?void 0:i.templateProducerAppId)??h.v[null==(s=null==_?void 0:_.meta)?void 0:s.itemType],video_type_list:null==(l=null==_?void 0:_.meta)?void 0:l.videoTypeList},Sr.updateEditType(this.editTypeParams),(0,u.n)().setParam(this.editTypeParams)}catch{}const{reportExtra:f}=null==e?void 0:e.context;Sr.updateEditType({...this.editTypeParams,is_smart_tool:null==f?void 0:f.isSmartTool,is_smart_crop:null==f?void 0:f.isSmartCrop,template_is_smart_crop:null==f?void 0:f.isTemplateSubjectCrop,is_cover_added:null==f?void 0:f.isCoverAdded,tool_type:null==f?void 0:f.toolType});const w=null==(d=null==(c=null==e?void 0:e.context)?void 0:c.selectItemData)?void 0:d.payload.enterFrom;if(w&&(this.extraData.enterFrom=w),e.matches("open.renderSuccess.requestSuccess")){const{videoId:t,duration:o,format:a,size:n,resolution:r}=e.context.fileInfo,i={"video/mp4":"mp4"},s={video_id:t,video_duration:Math.round((o??0)/1e3),format:i[a],size:Math.round(Number(n)/1024/1024*100)/100,resolution:r};Sr.updateVideo(s),(0,u.n)().setParam(s)}e.matches("close")&&Sr.removeVideo(),(e.matches("open.renderSuccess.requestSuccess")||e.matches("open.renderSuccess.requestImgSuccess"))&&this.emit("render-success"),(e.matches("open.rendering")||e.matches("open.rendering.requesting"))&&this.emit("rendering",e.context.renderProgress),e.matches("open")&&!this.modal&&!e.context.hideModal&&(this.modal=y.A.info({alignCenter:!0,modalRender:()=>{var t,o,a,r,i,s,l;return(0,n.jsx)(xv,{children:(0,n.jsx)(wv,{expandModalInstance:null==(t=this.expandInfo)?void 0:t.expandModal,isShowVipEquityCard:null==(i=null==(r=null==(a=null==(o=e.context)?void 0:o.fileInfo)?void 0:a.asset)?void 0:r.meta)?void 0:i.disableDownload,shareService:this.shareService,eventParams:{...g,pageFromExtra:null==(l=null==(s=e.context)?void 0:s.reportExtra)?void 0:l.pageFromExtra},renderService:this.renderService,shareModalHideCallback:m,extraData:this.extraData,cookieConsent:v})})},onCancel:()=>{this.renderService.send("CLOSE"),null==m||m()}})),e.matches("close")&&(this.editTypeParams={},this.clearReportTimer(),this.modal&&this.modal.close(),"CLOSE"===e.event.type&&(null==(p=this.shareService)||p.send("INIT_SERVICE")),this.modal=null)})),p.u.checkAgeGate().then((e=>{var t,o,a;null==(a=null==(o=null==(t=this.shareService)?void 0:t.state)?void 0:o.children)||a[p.C.LV_SHARE_TTAM].send({type:"SAVE_AGE_GATE",data:e})}))}close(){var e;null==(e=null==this?void 0:this.renderService)||e.send("CLOSE")}get userRegion(){return this.region}get expandInstanceInfo(){return this.expandInfo}get thirdpartyUserInfo(){return this.thirdUserInfo}get editTypeReportParams(){return this.editTypeParams}}let Iv;const Ev=e=>Iv||(e?(Iv=new Cv(e),Iv):void 0),Tv={id:"FILM_TASK_NOTIFICATION",duration:3800,showIcon:!1,closable:!1,btn:null,style:{width:"376px",padding:"16px"}},Pv=e=>{var t;return`${Tv.id}-${null==(t=null==e?void 0:e.base_info)?void 0:t.id}`},Nv={1:"export_finish",2:"export_fail",3:"export_fail",4:"upload_finish",6:"upload_fail",5:"review_fail",7:"upload_finish",8:"upload_fail",9:"upload_finish",10:"upload_fail",12:"success",13:"fail"},jv={4:"tiktok",6:"tiktok",5:"tiktok",8:"ttam",7:"ttam",9:"youtube",10:"youtube"},Rv=({task:e,onRetry:t,onOpenDetail:o,expandModal:s,currentPage:p,isSupportExpand:_})=>{var h,m,g,v,f,y,b,A,S;const C=(0,i.useRef)(!1),I=In(),E=null==(h=null==e?void 0:e.base_info)?void 0:h.file_workspace_id,T=(0,i.useMemo)((()=>{var t,o,a,n,r,i,s,l,c,d,p,_;let h=0;if((null==(t=e.base_info)?void 0:t.task_type)===u.k.Export&&e.render_info)switch(e.render_info.render_task_status){case u.o.Fail:h=2;break;case u.o.Success:h=1;break;case u.o.LackSpace:h=3}if((null==(o=e.base_info)?void 0:o.task_type)===u.k.Share&&(null==(a=e.share_info)?void 0:a.platform)===u.i.Tiktok)switch(e.share_info.share_status){case u.m.AuditFail:h=5;break;case u.m.ShareSuccess:h=4;break;case u.m.Fail:h=6}if((null==(n=e.base_info)?void 0:n.task_type)===u.k.Share&&(null==(r=e.share_info)?void 0:r.platform)===u.i.Ttam)switch(e.share_info.share_status){case u.m.ShareSuccess:h=7;break;case u.m.Fail:h=8}if((null==(i=e.base_info)?void 0:i.task_type)===u.k.Share&&(null==(s=e.share_info)?void 0:s.platform)===u.i.Youtube)switch(e.share_info.share_status){case u.m.ShareSuccess:h=9;break;case u.m.Fail:h=10}return(null==(l=e.base_info)?void 0:l.task_type)===u.k.Download&&(h=11),(null==(c=e.base_info)?void 0:c.task_type)===u.k.Long2Short&&""===(null==(d=null==e?void 0:e.clip_info)?void 0:d.result_code)&&(h=12),(null==(p=e.base_info)?void 0:p.task_type)===u.k.Long2Short&&""!==(null==(_=null==e?void 0:e.clip_info)?void 0:_.result_code)&&(h=13),h}),[e]),P=t=>{var o,a;try{(new na).taskTooltip({...null==(o=Ev())?void 0:o.editTypeParams,action:t,video_id:null==(a=null==e?void 0:e.base_info)?void 0:a.video_id,type:Nv[T],platform:jv[T]})}catch{}},N={2:{titleIcon:(0,n.jsx)(r.qgF,{}),title:c.Ay.t("failed_export",{},"Couldn\u2019t export."),action:(0,n.jsx)(x.A,{position:"tr",content:c.Ay.t("retry_web",{},"Try again"),style:{zIndex:1004},children:(0,n.jsx)(r.lSF,{onClick:()=>{null==t||t(e),P("retry")}})})},3:{titleIcon:(0,n.jsx)(r.qgF,{}),title:c.Ay.t("web_ttam_export_failure"),action:(0,n.jsx)(x.A,{position:"tr",content:c.Ay.t("retry_web",{},"Try again"),style:{zIndex:1004},children:(0,n.jsx)(r.lSF,{onClick:()=>{null==t||t(e),P("retry")}})})},1:{titleIcon:(0,n.jsx)(r.MOf,{fill:"#2DD196"}),title:c.Ay.t("web_exported",{},"Exported"),action:(0,n.jsx)(x.A,{position:"tr",content:c.Ay.t("show_details",{},"See details"),style:{zIndex:1004},children:(0,n.jsx)(r.EhB,{onClick:()=>{null==o||o(e),P("detail_page")}})})},6:{titleIcon:(0,n.jsx)(r.qgF,{}),title:c.Ay.t("web_failed_upload_tiktok",{},"Couldn\u2019t upload to TikTok"),action:(0,n.jsx)(x.A,{position:"tr",content:c.Ay.t("retry_web",{},"Try again"),style:{zIndex:1004},children:(0,n.jsx)(r.lSF,{onClick:()=>{null==t||t(e),P("retry")}})})},4:{titleIcon:(0,n.jsx)(r.MOf,{fill:"#2DD196"}),title:c.Ay.t("uploaded_tiktok",{},"Uploaded to TikTok"),action:(0,n.jsx)(x.A,{position:"tr",content:c.Ay.t("watch_on_tiktok",{},"Watch video on TikTok"),style:{zIndex:1004},children:(0,n.jsx)(r.cse,{onClick:()=>{null==o||o(e),P("third_party")}})})},5:{titleIcon:(0,n.jsx)(r.qgF,{}),title:c.Ay.t("review_exception_tiktok",{},"TikTok review error"),action:(0,n.jsx)(x.A,{position:"tr",content:c.Ay.t("check_on_tiktok",{},"Check on TikTok"),style:{zIndex:1004},children:(0,n.jsx)(r.cse,{onClick:()=>{null==o||o(e),P("third_party")}})})},10:{titleIcon:(0,n.jsx)(r.qgF,{}),title:c.Ay.t("web_shareYouTube_toast_post_fail",{},"Couldn\u2019t share to YouTube"),action:(0,n.jsx)(x.A,{position:"tr",content:c.Ay.t("retry_web",{},"Try again"),style:{zIndex:1004},children:(0,n.jsx)(r.lSF,{onClick:()=>{null==t||t(e),P("retry")}})})},9:{titleIcon:(0,n.jsx)(r.MOf,{fill:"#2DD196"}),title:c.Ay.t("web_shareYouTube_toast_post_seccessfully",{},"Shared to YouTube"),action:(0,n.jsx)(x.A,{position:"tr",content:c.Ay.t("web_shareYouTube_button_open",{},"Watch on Youtube"),style:{zIndex:1004},children:(0,n.jsx)(r.cse,{onClick:()=>{null==o||o(e),P("third_party")}})})},8:{titleIcon:(0,n.jsx)(r.qgF,{}),title:c.Ay.t("web_could_not_to_tt_ads_manager",{},"Couldn\u2019t upload to Tiktok Ads Manager."),action:(0,n.jsx)(x.A,{position:"tr",content:c.Ay.t("retry_web",{},"Try again"),style:{zIndex:1004},children:(0,n.jsx)(r.lSF,{onClick:()=>{null==t||t(e),P("retry")}})})},7:{titleIcon:(0,n.jsx)(r.MOf,{fill:"#2DD196"}),title:c.Ay.t("web_uploaded_to_tt",{},"Upload to TikTok Ads Manager"),action:(0,n.jsx)(x.A,{position:"tr",content:c.Ay.t("web_watch_on_tt_ads_manager",{},"Check on TikTok Ads Manager"),style:{zIndex:1004},children:(0,n.jsx)(r.cse,{onClick:()=>{null==o||o(e),P("third_party")}})})},11:{titleIcon:(0,n.jsx)(r.H5x,{fill:"#597EFF"}),title:c.Ay.t("will_download_browser",{},"Video will be downloaded in browser."),action:null},12:{titleIcon:(0,n.jsx)(r.MOf,{fill:"#2DD196"}),title:c.Ay.t("web_ai_clip_shorts_text_number_found",{number0:(null==(m=null==e?void 0:e.clip_info)?void 0:m.clip_count)??0,num:(null==(g=null==e?void 0:e.clip_info)?void 0:g.clip_count)??0},"{number0} shorts created"),action:(0,n.jsx)(x.A,{position:"tr",content:c.Ay.t("web_ai_clip_shorts_button_check",{},"View"),style:{zIndex:1004},children:(0,n.jsx)(r.cse,{onClick:()=>{var t;Yl({status:"success",taskId:(null==(t=e.clip_info)?void 0:t.id)??"",enterFrom:p??""})}})})},13:{titleIcon:(0,n.jsx)(r.qgF,{}),title:c.Ay.t("web_ai_clip_shorts_text_fault_reason",{},"Couldn\u2019t create shorts."),action:(0,n.jsx)(x.A,{position:"tr",content:c.Ay.t("web_ai_clip_shorts_button_check",{},"View"),style:{zIndex:1004},children:(0,n.jsx)(r.cse,{onClick:()=>{var t;Yl({status:"fail",taskId:(null==(t=e.clip_info)?void 0:t.id)??"",enterFrom:p??""})}})})}};return(0,i.useEffect)((()=>{P("show")}),[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"Lv_Task-notification-detail",children:[(0,n.jsx)(or,{url:null==(v=e.base_info)?void 0:v.cover_url}),(0,n.jsxs)("div",{className:"Lv_Task-notification-info",children:[(0,n.jsxs)("div",{className:"notification-info-title",children:[null==(f=N[T])?void 0:f.titleIcon,(0,n.jsx)("h3",{className:l()({fail:[6,13].some((e=>e===T))}),children:null==(y=N[T])?void 0:y.title})]}),(0,n.jsx)("div",{className:"notification-info-filename",children:null==(b=null==e?void 0:e.base_info)?void 0:b.video_name})]}),(0,n.jsxs)("div",{className:"Lv_Task-notification-action",children:[(null==(A=N[T])?void 0:A.action)&&(0,n.jsx)("div",{className:"notification-action-more",children:null==(S=N[T])?void 0:S.action}),(0,n.jsx)("div",{className:"notification-info-action-hide",children:(0,n.jsx)(x.A,{position:"tr",content:"Hide",style:{zIndex:1004},children:(0,n.jsx)(r.lq4,{onClick:()=>{(e=>{var t;const o=`${Tv.id}-${null==(t=null==e?void 0:e.base_info)?void 0:t.id}`;w.A.remove(o)})(e),P("close")}})})})]})]}),3===T&&_&&(0,n.jsxs)("div",{className:"Lv_Task-notification-lackSpace-action",children:[(0,n.jsx)(k.A,{type:"secondary",className:"action-open-cloud",onClick:()=>{const e=I(`${location.origin}${d.R.WORKSPACE.CHILD.MY_CLOUD.PATH}`);window.open(e,"_blank"),P("cloud")},children:c.Ay.t("web_Manage_in_Cloud")}),(0,n.jsx)(k.A,{type:"primary",onClick:()=>{null==s||s.show({type:"CAPACITY_BUY",reporterParams:{enterFrom:"task_tooltip",currentPage:p,pageFrom:"export_upgrade_to_pro"},onCurrentShowPayStatus:(o,n)=>{console.log(o,"===callBack=status=="),"success"===o&&!C.current&&(C.current=!0,setTimeout((()=>{console.log("===expand==callBack=onRetry=="),null==t||t(e),a.A.info(c.Ay.t("web_cloud_add_success5"))}),3e3)),n&&(console.log(o,"===expand==callBack=close==",n),C.current=!1)}}),P("upgrade")},children:c.Ay.t("web_ttam_enlarge")})]}),3===T&&!_&&(0,n.jsx)("div",{className:"Lv_Task-notification-lackSpace-action notSupport",children:(0,n.jsx)(k.A,{type:"secondary",size:"small",className:"action-open-cloud",onClick:()=>{const e=I(`${location.origin}${d.R.WORKSPACE.CHILD.MY_CLOUD.PATH}/${E}`);window.open(e,"_blank"),P("cloud")},children:c.Ay.t("web_Manage_in_Cloud")})})]})},Lv=async(e,t,o,r)=>{var i,s,l,_,m,g,v,f;try{await Promise.all([(async()=>{if((await r.downloadAssetUrlV2({ids:[(null==e?void 0:e.fileId)??""]})).length)throw new Error("get DownloadAssetUrl failure, not link to download")})(),(async()=>{var t,o,a,n,i;const s=(null==(o=null==(t=null==e?void 0:e.asset)?void 0:t.meta)?void 0:o.coverInfo)??(null==(n=null==(a=null==e?void 0:e.asset)?void 0:a._meta)?void 0:n.coverInfo),l=(null==(i=null==e?void 0:e.fileName)?void 0:i.split("."))??[""];if(null!=s&&s.coverImageFileID&&(await r.downloadAssetUrlV2({ids:[s.coverImageFileID||""],names:[`${l[0]}_${c.Ay.t("web_download_file_name_ext",{},"cover")}`]})).length)throw new Error("get DownloadAssetUrl failure, not link to download")})()])}catch(x){d.s.error("ExportAndShareModal-FailedDownloadFiles",x,{toGroup:"true"}),a.A.error(c.Ay.t("file_failed_to_download",{},"\u6587\u4ef6\u4e0b\u8f7d\u5931\u8d25"))}if(!e)return;try{await(0,b.a)(await co.createTask({type:u.k.Download,file_id:e.fileId,file_type:e.fileType,size:null==(s=null==(i=e.fileSize)?void 0:i.toString)?void 0:s.call(i),file_name:e.fileName,format:(0,b.g)(e.format),resolution:e.resolution}))}catch{}(0,u.n)().report({action:u.E.download,panel_page:u.P.export_finish});try{(new p.B).report({...(0,h.g)(null==e?void 0:e.asset),template_id:null==(_=null==(l=e.asset)?void 0:l.meta)?void 0:_.templateId,video_type_id:(0,h.p)(null==(g=null==(m=null==e?void 0:e.asset)?void 0:m.meta)?void 0:g.templateProducerAppId)??h.v[null==(f=null==(v=null==e?void 0:e.asset)?void 0:v.meta)?void 0:f.itemType],platform:"download",enter_from:o,video_id:(null==e?void 0:e.videoId)||"",current_page:t,resolution:String(null==e?void 0:e.resolution),size:Number((null==e?void 0:e.fileSize)??0),format:null==e?void 0:e.format,video_duration:Math.round((null==e?void 0:e.duration)/1e3)})}catch{}const y={base_info:{task_type:u.k.Download,cover_url:e.coverImg,video_name:e.fileName,video_id:e.videoId}};w.A.success({...Tv,id:Pv(y),content:(0,n.jsx)(Rv,{task:y})}),(new Zo).report({assets:[null==e?void 0:e.asset],page_from:t})},Ov=e=>{var t;const{openType:o,EverCloud:a,platformsList:s,openModalType:d,backToEdit:u,backToResult:p,makeNewOne:h,showBackToResult:g,choosePageSlot:v,downloadReport:f,platformHandleClose:y,choosePlatformFn:w,page:b,isSmartTool:x,childState:k}=e,A=(0,i.useRef)(null),{shareService:S}=Zn(),C=(0,m.d)(S,(e=>e.context.reportExtra)),I=(0,m.d)(S,(e=>e.context.currentPage)),E=(0,m.d)(S,(e=>e.context.fileInfo)),T="image"===(null==(t=null==E?void 0:E.asset)?void 0:t.type),P=x&&T,N=(0,i.useMemo)((()=>(!x||!T)&&(d!==_.Gj.FromCloud&&!o||x)),[x,T,d,o]),j={borderRadius:12,padding:12,marginBottom:8},R=(0,i.useMemo)((()=>d===_.Gj.FromCloud?c.Ay.t("web_ttam_share_video"):P?c.Ay.t("web_smartcutout_toast_image_downloaded"):u||p?c.Ay.t("web_tool_Your_video_is_ready_to_share"):c.Ay.t("video_ready")),[d,P,u,p]);return(0,n.jsxs)("div",{className:"lv_share-choosePage",style:{padding:"0 32px"},ref:A,children:["tool"===b&&(0,n.jsx)("div",{className:"lv_share-choosePage-ready",children:R}),P&&(0,n.jsxs)("div",{className:"lv_share-choosePage-ready-desc",children:[(0,n.jsx)(r.eep,{size:24}),(0,n.jsx)("span",{children:c.Ay.t("web_smartcutout_toast_saved_tp_space")})]}),(0,n.jsxs)("div",{className:"lv_share-choosePage-header-special-platform",children:[(0,n.jsx)("div",{className:"title",children:c.Ay.t("web_sharereview_text_share_file_name",{placeholder0:null==E?void 0:E.fileName},`Share ${null==E?void 0:E.fileName}`)}),(0,n.jsx)("div",{className:"close",onClick:()=>{null==y||y()},children:(0,n.jsx)(r.En0,{className:"icon-close",size:20})})]}),s.map(((e,t)=>e.isShow?(0,n.jsxs)("div",{className:"lv_share-choosePage-platform",style:x?j:void 0,onClick:()=>w(e),children:[(0,n.jsxs)("div",{className:"lv_share-choosePage-platform-main",children:[(0,n.jsx)("div",{className:l()("lv_share-choosePage-platform-main-icon",e.platformKey),children:e.icon}),(0,n.jsxs)("div",{className:"lv_share-choosePage-platform-main-content",children:[(0,n.jsx)("div",{className:"lv_share-choosePage-platform-main-content-platformName",children:e.platformContent}),(0,n.jsx)("div",{className:"lv_share-choosePage-platform-main-content-userName",children:e.userName})]})]}),(0,n.jsx)("div",{className:"lv_share-choosePage-platform-rightIcon",children:(0,n.jsx)(r.cwL,{size:10,color:"var(--lvv-color-text-1)"})})]},`platform-${t}`):(0,n.jsx)(n.Fragment,{}))),(null==E?void 0:E.downloadUrl)&&N&&(0,n.jsx)("div",{className:"lv_share-choosePage-platform",style:x?j:void 0,onClick:()=>{Lv(E,I,null==C?void 0:C.enterFrom,a),null==f||f()},children:(0,n.jsxs)("div",{className:"lv_share-choosePage-platform-main",children:[(0,n.jsx)("div",{className:"lv_share-choosePage-platform-main-icon lv_share-choosePage-platform-main-downloadIcon",children:(0,n.jsx)(r.RtP,{size:x?32:24})}),(0,n.jsx)("div",{className:"lv_share-choosePage-platform-main-content",children:(0,n.jsx)("div",{className:"lv_share-choosePage-platform-main-content-platformName",children:c.Ay.t("download")})})]})}),x&&(0,n.jsx)("div",{style:{background:"var(--lvv-color-line-2)",height:1,marginTop:32}}),h&&(u||p)&&(0,n.jsx)("div",{style:{marginTop:32,marginBottom:16,color:"var(--lvv-color-text-primary)",fontSize:"var(--lvv-size-h2)",lineHeight:"var(--lvv-line-height-h2)",fontWeight:800,textAlign:"left"},children:c.Ay.t("web_tool_You_can_also",{},"You can also")}),u&&!g&&!k.matches("show")&&(0,n.jsx)("div",{className:"lv_share-choosePage-platform",style:{...j},onClick:u,children:(0,n.jsxs)("div",{className:"lv_share-choosePage-platform-main",children:[(0,n.jsx)("div",{className:"lv_share-choosePage-platform-main-icon main-back-edit",children:(0,n.jsx)(r.Mxq,{size:32})}),(0,n.jsx)("div",{className:"lv_share-choosePage-platform-main-content",children:(0,n.jsx)("div",{className:"lv_share-choosePage-platform-main-content-platformName",style:{fontWeight:500},children:c.Ay.t("web_tool_Back_to_edit",{},"Back to edit")})})]})}),p&&g&&!k.matches("show")&&(0,n.jsx)("div",{className:"lv_share-choosePage-platform",style:{...j},onClick:p,children:(0,n.jsxs)("div",{className:"lv_share-choosePage-platform-main",children:[(0,n.jsx)("div",{className:"lv_share-choosePage-platform-main-icon main-back-result",children:(0,n.jsx)(r.Mgv,{size:32})}),(0,n.jsx)("div",{className:"lv_share-choosePage-platform-main-content",children:(0,n.jsx)("div",{className:"lv_share-choosePage-platform-main-content-platformName",style:{fontWeight:500},children:c.Ay.t("smart_ad_url_web_back_to_result_list",{},"Go to generated video ads")})})]})}),h&&!k.matches("show")&&(0,n.jsx)("div",{className:"lv_share-choosePage-platform",style:{...j},onClick:h,children:(0,n.jsxs)("div",{className:"lv_share-choosePage-platform-main",children:[(0,n.jsx)("div",{className:"lv_share-choosePage-platform-main-icon main-make-new",children:(0,n.jsx)(r.ZYh,{size:32})}),(0,n.jsx)("div",{className:"lv_share-choosePage-platform-main-content",children:(0,n.jsx)("div",{className:"lv_share-choosePage-platform-main-content-platformName",style:{fontWeight:500},children:c.Ay.t("web_tool_Make_a_new_one",{},"Make a new one")})})]})}),v]})},Fv="_lv_share-choosePage_1xk24_1",Dv=e=>{const{openType:t,EverCloud:o,platformsList:a,openModalType:r,platformHandleClose:s,choosePlatformFn:l,isVisitant:c,reportExtra:d,currentPage:u,workspaceId:h,fileInfo:m,expandModalInstance:g,isShowVipEquityCard:v,eventParams:f,showVipCard:y,handleClickSchedule:w}=e,b=(0,i.useRef)(null),x=(0,i.useMemo)((()=>!(r===_.Gj.FromCloud||null==m||!m.downloadUrl||[p.O.workspace,p.O.detailPage].includes(t))),[r,m]);return(0,n.jsx)("div",{className:Fv,ref:b,children:(0,n.jsx)(rd,{showVipCard:y,expandModalInstance:g,isShowVipEquityCard:v,eventParams:f,fileID:(null==m?void 0:m.fileId)??"",workspaceID:h??"",isVisitant:c,openType:t,EverCloud:o,reportExtra:d,fileName:null==m?void 0:m.fileName,platformsItemList:a,downloadVisible:x,choosePlatformFn:l,fileInfo:m,currentPage:u,platformHandleClose:s,handleClickSchedule:w})})},Uv=({page:e,isShopify:t,openType:o,fileInfo:s,reportExtra:_,spaceInfo:v,everCloudInstance:f,backToEdit:y,backToResult:w,makeNewOne:b,showBackToResult:x,choosePageSlot:k,platformHandleClose:A,isVisitant:S,shareServiceProp:C,reqDomain:I,cookieConsent:E,isNewShareExport:T=!1,openModalType:P,extraData:N,isShowVipEquityCard:j,expandModalInstance:R,eventParams:L,showVipCard:O,selectItemID:F,scheduleTask:D,scheduleCb:U})=>{var M,z,G,W;const{exportState:V}=(0,i.useContext)(bv);I&&d.b.updateRequestDomain({domain:I}),En(E);const H=C,q=(0,m.d)(H,(e=>e.context.selectedPlatform)),Y=(0,m.d)(H,(e=>e.context.userInfo)),K=Xn(H),[J,$]=(0,i.useState)(!1),Q=(0,i.useRef)(null),[Z,X]=(0,g.B)(H),ee=Z.children.LvShareFacebook,te=Z.children.LvShareYt,[,oe]=(0,g.B)(Z.children.LvShareTtam),ae=(0,m.d)(Z.children.LvShareTt,(e=>e.context.userInfo)),ne=(0,m.d)(te,(e=>e.context.userInfo)),re=(0,m.d)(Z.children.LvShareTtam,(e=>e.context.userInfo)),ie=(0,m.d)(Z.children.LvShareTtam,(e=>e.context.switchAccount)),se=(0,m.d)(Z.children.LvShareTtam,(e=>{var t;return null==(t=e.context)?void 0:t.ageGate})),le=(0,m.d)(ee,(e=>e.context.userInfo)),[ce,de]=(0,i.useState)(),ue=(0,m.d)(ee,(e=>e.context.shareType)),pe=(0,m.d)(te,(e=>e.context.shareType)),[_e]=(0,g.B)(K),he=(0,h.g)(null==s?void 0:s.asset),me={tool_type:(null==N?void 0:N.toolType)||he.tool_type,enter_from:(null==N?void 0:N.enterFrom)||"first_page",from_page:null==N?void 0:N.fromPage,current_page:null==N?void 0:N.currentPage,resolution:null==s?void 0:s.resolution,size:"Calculating..."===(null==s?void 0:s.fileSize)?void 0:Math.round(Number(null==s?void 0:s.fileSize)/1024/1024*100)/100,format:null==s?void 0:s.format,video_duration:Math.round(Number(null==s?void 0:s.duration)/1e3),smart_ad_video_id:null==_?void 0:_.smartAdVideoId,url_to_video_request_id:null==_?void 0:_.urlToVideoRequestId},ge=(0,m.d)(H,(e=>e.context.uid))??"";let ve;Tn(" ");const fe="tool"===e,ye=fe&&"image"===(null==(M=null==s?void 0:s.asset)?void 0:M.type),we=(0,d.g)().getReflowFlag();let be;fe&&(ve=new u.S),be=ye?[]:fe&&we?[{isShow:!0,icon:(0,n.jsx)(r.Ktn,{size:32,name:"icon-thirdpart-tiktok"}),logo:(0,n.jsx)(r.Dp6,{size:44,name:"icon-thirdpart-tiktok"}),logoName:c.F2.t("web_embedcode_text_tiktok"),userName:null==ae?void 0:ae.creator_username,platformName:u.c.TikTok,platformKey:p.P.TT_USER_INFO,platformContent:c.F2.t("web_share_btn_share_tt_creator_center",{},"Sync and upload to TikTok Creator Center"),authUrl:Qr({uid:ge})}]:[{isShow:!!t,icon:(0,n.jsx)(cd,{size:32}),logo:(0,n.jsx)(cd,{size:36}),logoName:c.F2.t("// TODO",{},"Shopify"),platformName:u.c.Shopify,platformKey:u.c.Shopify,platformContent:c.F2.t("web_shopify_text_back_sp",{},"Export to Shopify"),authUrl:""},{isShow:!!t,icon:(0,n.jsx)(dd,{size:32}),logo:(0,n.jsx)(dd,{size:36}),logoName:c.F2.t("// TODO",{},"Shopify"),platformName:u.c.EmbedShopify,platformKey:u.c.EmbedShopify,platformContent:c.F2.t("web_shopify_text_copy_code",{},"Copy code"),authUrl:""},{isShow:!0,icon:(0,n.jsx)(r.Ktn,{size:32,name:"icon-thirdpart-tiktok"}),logo:(0,n.jsx)(r.Dp6,{size:44,name:"icon-thirdpart-tiktok"}),logoName:c.F2.t("web_embedcode_text_tiktok"),userName:null==ae?void 0:ae.creator_username,platformName:u.c.TikTok,platformKey:p.P.TT_USER_INFO,platformContent:c.F2.t("web_sharereview_text_share_to_tiktok"),authUrl:Qr({uid:ge})},{isShow:!0,icon:fe?(0,n.jsx)(r.Tl_,{size:32,name:"icon-thirdpart-tiktok"}):(0,n.jsx)(r._5D,{size:32,name:"icon-thirdpart-tiktok"}),logo:(0,n.jsx)(r.xT5,{size:44,name:"icon-thirdpart-tiktok"}),logoName:c.F2.t("web_embedcode_text_tiktok_ads_manager"),userName:(null==ie?void 0:ie.display_name)??(null==(z=null==re?void 0:re[0])?void 0:z.display_name),platformName:u.c.TTAM,platformKey:p.P.TT_USER_INFO,platformContent:c.F2.t("web_sharereview_text_tiktok_ads_manager"),authUrl:Zr({uid:ge})},{isShow:!0,icon:(0,n.jsx)(_d,{size:32}),logo:(0,n.jsx)(Wn,{size:44}),logoName:c.F2.t("web_embedcode_text_youtube"),userName:null==ne?void 0:ne.email,platformName:u.c.YouTube,youtubeShareType:u.f.YouTube,platformKey:p.P.YT_USER_INFO,platformContent:c.F2.t("web_shareYouTube_title_share_to_YouTube"),authUrl:Xr({uid:ge})},{isShow:!0,icon:(0,n.jsx)(hd,{size:32}),logo:(0,n.jsx)(Hn,{size:44}),logoName:c.F2.t("web_ytb_ins_text_ytb_cut",{},"YouTube Shorts"),userName:null==ne?void 0:ne.email,youtubeShareType:u.f.YouTubeShorts,platformName:u.c.YouTube,platformKey:p.P.YT_USER_INFO,platformContent:c.F2.t("web_ytb_ins_title_share",{},"Share to YouTube Shorts"),authUrl:Xr({uid:ge})},{isShow:!0,icon:(0,n.jsx)(ud,{size:32}),logo:(0,n.jsx)(Yn,{size:44}),logoName:c.F2.t("web_postfb_text_share_facebook_group",{},"Facebook Group"),userName:null==le?void 0:le.name,platformName:u.c.Facebook,facebookShareType:u.d.GROUP,platformKey:p.P.FACEBOOK_USER_INFO,platformContent:c.F2.t("web_postfb_text_post_facebook_group",{},"Share to Facebook Group"),authUrl:ei({uid:ge})},{isShow:!0,icon:(0,n.jsx)(ud,{size:32}),logo:(0,n.jsx)(Jn,{size:44}),logoName:c.F2.t("web_postfb_text_share_facebook_page",{},"Facebook Page"),userName:null==le?void 0:le.name,platformName:u.c.Facebook,facebookShareType:u.d.PAGE,platformKey:p.P.FACEBOOK_USER_INFO,platformContent:c.F2.t("web_postfb_text_post_facebook_page",{},"Share to Facebook Page"),authUrl:ei({uid:ge})},{isShow:!0,icon:(0,n.jsx)(pd,{size:32}),logo:(0,n.jsx)(pd,{size:44}),logoName:c.F2.t("web_ytb_ins_text_ins_reel",{},"Instagram Reels"),userName:null==le?void 0:le.name,platformName:u.c.Facebook,facebookShareType:u.d.INSTAGRAM,platformKey:p.P.FACEBOOK_USER_INFO,platformContent:c.F2.t("web_ytb_ins_title_upload_ins",{},"Share to Instagram Reels"),authUrl:ei({uid:ge})}];const xe=(0,m.d)(H,(e=>e.context.errorCode)),ke=["show"],Ae=["show.hasBind.shareSuccess","show.hasBind.uploadFailed","show.hasBind.uploading.auditing","show.hasBind.uploading.uploadSuccess","show.hasBind.uploadAuditFailed","show.hasBind.uploaded"],Se=(0,i.useMemo)((()=>(null==N?void 0:N.currentPage)||(null==_?void 0:_.currentPage)),[_]);(0,i.useEffect)((()=>{[{type:"SAVE_REPORT_EXTRA",currentPage:Se,reportExtra:_,openType:o},{type:"SAVE_SPACE_INFO",spaceInfo:v},{type:"SAVE_UNBIND_CALLBACK",unbindSuccessCallback:()=>{a.A.success(c.F2.t("sign_out_success"))},unbindFailedCallback:()=>{a.A.error(c.F2.t("failed_sign_out_try_later"))}}].forEach((e=>X(e))),T||X({type:"SAVE_FILE_INFO",fileInfo:s})}),[]),(0,i.useEffect)((()=>{T&&X({type:"SAVE_FILE_INFO",fileInfo:s})}),[s]);const Ce=()=>{var e,t;const a={[p.C.LV_SHARE_TT]:()=>({panelResult:u.P.share_tiktok_result,panelDetail:u.P.share_tiktok_detail}),[p.C.LV_SHARE_TTAM]:()=>({panelResult:u.P.share_ttam_result,panelDetail:u.P.share_ttam_detail}),[p.C.LV_SHARE_YT]:()=>pe===u.f.YouTubeShorts?{panelResult:u.P.share_shorts_result,panelDetail:u.P.share_shorts_detail}:{panelResult:u.P.share_youtube_result,panelDetail:u.P.share_youtube_detail},[p.C.LV_SHARE_FACEBOOK]:()=>ue===u.d.INSTAGRAM?{panelResult:u.P.share_reels_result,panelDetail:u.P.share_reels_detail}:{panelResult:u.P.share_fb_result,panelDetail:u.P.share_fb_detail}};return Ae.some(_e.matches)?(null==K?void 0:K.id)&&(null==(e=a[K.id])?void 0:e.call(a).panelResult):ke.some(_e.matches)?(null==K?void 0:K.id)&&(null==(t=a[K.id])?void 0:t.call(a).panelDetail):q===u.c.Schedule?u.P.schedule_detail:[p.O.workspace,p.O.detailPage].includes(o)?u.P.share:u.P.export_finish},Ie=(0,i.useMemo)((()=>{var e,t,a,n;return{...he,video_type_id:(0,h.p)(null==(t=null==(e=null==s?void 0:s.asset)?void 0:e.meta)?void 0:t.templateProducerAppId)??h.v[null==(n=null==(a=null==s?void 0:s.asset)?void 0:a.meta)?void 0:n.itemType],video_id:null==s?void 0:s.videoId,current_page:Se,resolution:null==s?void 0:s.resolution,size:Number(null==s?void 0:s.fileSize),format:null==s?void 0:s.format,video_duration:null==s?void 0:s.duration,enter_from:(null==_?void 0:_.enterFrom)||(null==N?void 0:N.enterFrom)||"first_page",is_same_video:+(o===p.O.taskList),panel_page:Ce()}}),[_,s,Se,he,K,o,_e,ke,Ae,N,pe,ue]);(0,i.useEffect)((()=>(0,u.n)().setParam(Ie)),[Ie]),(0,i.useEffect)((()=>{T?!(0,B.Ib)(o)||V||Sr.reportThirdPartyPublishAction({action:u.E.clickable,panel_page:Ce(),no_vip_used_material:(j||O)&&R?1:0}):(0,p.E)({action:u.E.show,openType:o})}),[V]),(0,i.useEffect)((()=>{xe===u.g.ACCOUNT_CHANGED&&(new p.b).report({action:"show",platform:q||"undefined"})}),[xe]);const Ee=((e,t,o)=>{var a,r,i,s,l,d,_,h,m,g;const v=[],f=null==(a=null==t?void 0:t.children)?void 0:a[p.C.LV_SHARE_TT],y=null==(r=null==t?void 0:t.children)?void 0:r[p.C.LV_SHARE_TTAM];return v[u.g.PERMISSION_ERROR]={title:c.Ay.t("failed_connect_tiktok"),content:c.Ay.t("allow_permission_publish_tiktok_reconnect",{strong:e=>(0,n.jsx)("strong",{children:e})}),confirmContext:c.Ay.t("web_got_it"),onOk:()=>{e("CLEAR_SHARE_VIDEO_ERROR_CODE")},onComponentRender:()=>{(new p.s).report({type:"insufficient_permissions"})}},v[u.g.YOUTUBE_INSUFFICIENT_PERMISSIONS]={title:c.Ay.t("web_upload_improve_text_not_sign_with_youtube",{},"Couldn\u2019t sign in with your YouTube account"),content:c.Ay.t("web_upload_improve_text_reauthorize",{},"Please re-authorize the full video management access to confirm you can publish the video successfully"),confirmContext:c.Ay.t("web_upload_improve_btn_reauthorize",{},"Re-authorize"),onOk:()=>{e("CLEAR_SHARE_VIDEO_ERROR_CODE"),e({type:"OPEN_AUTH_WINDOW",data:{authUrl:Xr({uid:o})}})},onComponentRender:()=>{(new p.s).report({type:"insufficient_permissions"})}},v[u.g.VIDEO_DURATION_TOO_SHORT]={content:c.Ay.t("video_short_minuets_tiktok"),confirmContext:c.Ay.t("web_got_it"),onOk:()=>{e("CLEAR_SHARE_VIDEO_ERROR_CODE")},onComponentRender:()=>{(new p.s).report({type:"too_short"})}},v[u.g.VIDEO_DURATION_TOO_SHORT_TTAM]={content:c.Ay.t("web_cannot_upload_shorter_than_3s"),confirmContext:c.Ay.t("web_got_it"),onOk:()=>{e("CLEAR_SHARE_VIDEO_ERROR_CODE")},onComponentRender:()=>{(new p.s).report({type:"too_short"})}},v[u.g.UPLOAD_AUTH_ERROR]={title:c.Ay.t("no_upload_tiktok"),content:c.Ay.t("authorization_error_status"),confirmContext:c.Ay.t("web_got_it"),onOk:()=>{e("CLEAR_SHARE_VIDEO_ERROR_CODE")},onComponentRender:()=>{(new p.s).report({type:"upload_auth_error"})}},v[u.g.AUTH_ERROR]={title:c.Ay.t("authorization_error"),content:c.Ay.t("failed_connect_tiktok"),confirmContext:c.Ay.t("web_got_it"),onOk:()=>{e("CLEAR_SHARE_VIDEO_ERROR_CODE")},onComponentRender:()=>{(new p.s).report({type:"user_auth_error"})}},v[u.g.TTAM_AUTH_ERROR]={title:c.Ay.t("web_ttam_another_trial1"),content:c.Ay.t("web_cannot_sign_in_to_tiktok"),confirmContext:c.Ay.t("web_got_it"),onOk:()=>{e("CLEAR_SHARE_VIDEO_ERROR_CODE"),(new ra).report({action:"ok",errorCode:u.g.TTAM_AUTH_ERROR,failReason:"none"})},onComponentRender:()=>{(new ra).report({action:"show",errorCode:u.g.TTAM_AUTH_ERROR,failReason:"none"})}},v[u.g.TTAM_AUTH_ERROR_611]={title:c.Ay.t("web_ttam_another_trial1"),content:c.Ay.t("web_ttam_allow_access_create_update2",{"color-strong":e=>(0,n.jsx)("strong",{children:e})}),confirmContext:c.Ay.t("web_got_it"),onOk:()=>{e("CLEAR_SHARE_VIDEO_ERROR_CODE"),(new ra).report({action:"ok",failReason:"Insufficient_power_Creative_Management",errorCode:u.g.TTAM_AUTH_ERROR_611})},onComponentRender:()=>{(new ra).report({action:"show",failReason:"Insufficient_power_Creative_Management",errorCode:u.g.TTAM_AUTH_ERROR_611})}},v[u.g.TTAM_AUTH_ERROR_10]={title:c.Ay.t("web_ttam_another_trial1"),content:c.Ay.t("web_ttam_allow_access_create_update3",{"color-strong":e=>(0,n.jsx)("strong",{children:e})}),confirmContext:c.Ay.t("web_got_it"),onOk:()=>{e("CLEAR_SHARE_VIDEO_ERROR_CODE"),(new ra).report({action:"ok",failReason:"Insufficient_power_Ad_Account_Management",errorCode:u.g.TTAM_AUTH_ERROR_10})},onComponentRender:()=>{(new ra).report({action:"show",failReason:"Insufficient_power_Ad_Account_Management",errorCode:u.g.TTAM_AUTH_ERROR_10})}},v[u.g.TTAM_AUTH_ERROR_611_10]={title:c.Ay.t("web_ttam_another_trial1"),content:c.Ay.t("web_ttam_allow_access_create_update1",{"color-strong":e=>(0,n.jsx)("strong",{children:e})}),confirmContext:c.Ay.t("web_got_it"),onOk:()=>{e("CLEAR_SHARE_VIDEO_ERROR_CODE"),(new ra).report({action:"ok",failReason:"Insufficient_power_Ad_Account_Management&Creative_Management",errorCode:u.g.TTAM_AUTH_ERROR_611_10})},onComponentRender:()=>{(new ra).report({action:"show",failReason:"Insufficient_power_Ad_Account_Management&Creative_Management",errorCode:u.g.TTAM_AUTH_ERROR_611_10})}},v[u.g.COUNTRY_NOT_SUPPORT]={title:c.Ay.t("authorization_error"),content:c.Ay.t("sharing_not_available_your_country",{"tiktok-website":e=>(0,n.jsx)("div",{className:"countryNotSupportTip",onClick:()=>{window.open("https://www.tiktok.com")},children:e})}),confirmContext:c.Ay.t("web_got_it"),onOk:()=>{e("CLEAR_SHARE_VIDEO_ERROR_CODE")},onComponentRender:()=>{(new p.s).report({type:"area_not_support"})}},v[u.g.FACEBOOK_AUTH_ERROR]={title:c.Ay.t("authorization_error"),content:c.Ay.t("web_postfb_toast_try_later"),confirmContext:c.Ay.t("web_got_it"),onOk:()=>{e("CLEAR_SHARE_VIDEO_ERROR_CODE")}},v[u.g.VIDEO_DURATION_TOO_LONG]={title:c.Ay.t("no_upload_tiktok"),content:c.Ay.t("video_max_minuets_tiktok",{placeholder0:Number((null==(s=null==(i=null==f?void 0:f.state)?void 0:i.context.userInfo)?void 0:s.max_video_post_duration_sec)??0)/60}),confirmContext:c.Ay.t("web_got_it"),onOk:()=>{e("CLEAR_SHARE_VIDEO_ERROR_CODE")},onComponentRender:()=>{(new p.s).report({type:"too_long"})}},v[u.g.UNKONWN_ERROR]={title:c.Ay.t("unknown_error"),content:c.Ay.t("failed_upload_try_again"),confirmContext:c.Ay.t("web_got_it"),onOk:()=>{e("CLEAR_SHARE_VIDEO_ERROR_CODE")},onComponentRender:()=>{(new p.s).report({type:"unknown_error"})}},v[u.g.NO_TIMES_TO_UPLOAD]={title:c.Ay.t("no_upload_tiktok"),content:c.Ay.t("max_number_upload_us"),confirmContext:c.Ay.t("web_got_it"),onOk:()=>{e("CLEAR_SHARE_VIDEO_ERROR_CODE")},onComponentRender:()=>{(new p.s).report({type:"no_times_to_upload"})}},v[u.g.PERMISSTION_NOT_VERIFIED]={title:c.Ay.t("failed_upload_toast"),content:c.Ay.t("interaction_permission_not_verified"),confirmContext:c.Ay.t("web_got_it"),onOk:()=>{e("CLEAR_SHARE_VIDEO_ERROR_CODE")},onComponentRender:()=>{(new p.s).report({type:"checkbox_auth_error"})}},v[u.g.PRIVACY_NOT_VERIFIED]={title:c.Ay.t("failed_upload_toast"),content:c.Ay.t("privacy_settings_not_verified"),confirmContext:c.Ay.t("web_got_it"),onOk:()=>{e("CLEAR_SHARE_VIDEO_ERROR_CODE")},onComponentRender:()=>{(new p.s).report({type:"privacy_not_verified"})}},v[u.g.ACCOUNT_CHANGED]={content:c.Ay.t("tiktok_account_changed",{placeholder0:(null==(_=null==(d=null==(l=null==f?void 0:f.state)?void 0:l.context)?void 0:d.userInfo)?void 0:_.creator_username)||""}),cancelContext:c.Ay.t("cancel_tiktok"),confirmContext:c.Ay.t("tiktok_web_upload"),onCancel:()=>{var o;(new p.b).report({action:"cancel",platform:null==(o=null==t?void 0:t.context)?void 0:o.selectedPlatform}),e("CLEAR_SHARE_VIDEO_ERROR_CODE")},onOk:()=>{var o;(new p.b).report({action:"confirm",platform:null==(o=null==t?void 0:t.context)?void 0:o.selectedPlatform}),null==f||f.send({type:"RETRY",isRetry:!0,distinguishAccount:!0}),e("CLEAR_SHARE_VIDEO_ERROR_CODE")},onComponentRender:()=>{(new p.s).report({type:"account_changed"})}},v[u.g.ACCOUNT_DISCONNECT]={title:c.Ay.t("no_upload_tiktok"),content:c.Ay.t("tiktok_account_disconnect"),confirmContext:c.Ay.t("cancel_tiktok"),onOk:()=>{e("CLEAR_SHARE_VIDEO_ERROR_CODE")},onComponentRender:()=>{(new p.s).report({type:"account_disconnect"})}},v[u.g.GET_TT4B_ACCOUNTS_FAILED]={title:c.Ay.t("web_ttam_another_trial1"),content:c.Ay.t("web_ttam_retry_failure2"),confirmContext:c.Ay.t("try_again_web"),cancelContext:c.Ay.t("cancel_tiktok"),onOk:()=>{e("RETRY_REFRESH_USER_INFO"),e("CLEAR_SHARE_VIDEO_ERROR_CODE")},onCancel:()=>{e("CLEAR_SHARE_VIDEO_ERROR_CODE")}},v[u.g.TT4B_RIGHT_FAILED]={title:c.Ay.t("web_ttam_another_trial1"),content:c.Ay.t("web_sign_in_to_upload_again"),confirmContext:c.Ay.t("web_got_it"),onOk:()=>{null==y||y.send("REFRESH_USER_INFO_TO_FILTER"),e("CLEAR_SHARE_VIDEO_ERROR_CODE")}},v[u.g.SHARE_TTAM_USER_DISAUTHORIZED]={title:c.Ay.t("web_ttam_another_trial1"),content:c.Ay.t("web_sign_in_to_upload_again"),confirmContext:c.Ay.t("web_got_it"),onOk:()=>{null==y||y.send("REFRESH_USER_INFO_TO_FILTER"),e("CLEAR_SHARE_VIDEO_ERROR_CODE")}},v[u.g.SHARE_TTAM_CHANGED_BIND]={content:c.Ay.t("web_ttam_changed",{placeholder0:(null==(g=null==(m=null==(h=null==y?void 0:y.state)?void 0:h.context)?void 0:m.switchAccount)?void 0:g.email)||""}),cancelContext:c.Ay.t("cancel_tiktok"),confirmContext:c.Ay.t("tiktok_web_upload"),onCancel:()=>{var o;(new p.b).report({action:"cancel",platform:null==(o=null==t?void 0:t.context)?void 0:o.selectedPlatform}),e("CLEAR_SHARE_VIDEO_ERROR_CODE")},onOk:()=>{var o,a,n;(new p.b).report({action:"confirm",platform:null==(o=null==t?void 0:t.context)?void 0:o.selectedPlatform}),null==(n=null==(a=null==t?void 0:t.children)?void 0:a[p.C.LV_SHARE_TTAM])||n.send({type:"RETRY",isRetry:!0,distinguishAccount:!0}),e("CLEAR_SHARE_VIDEO_ERROR_CODE")},onComponentRender:()=>{(new p.s).report({type:"account_changed"})}},v})(X,Z,ge),Te={[u.g.SHARE_TTAM_RETRY_FAILED]:{content:c.Ay.t("web_ttam_retry_failure1")},[u.g.FAILED_BY_RISK]:{content:c.Ay.t("web_request_failed_by_risk",{},"Request error.")},[u.g.FAILED_BY_FREQUENCY]:{content:c.Ay.t("web_request_failed_by_frequency",{},"The operation is too frequent, please try again later.")}},Pe=e=>{var t,a;const n={[u.c.TikTok]:()=>({action:u.E.share_tiktok}),[u.c.TTAM]:()=>({action:u.E.share_ttam}),[u.c.YouTube]:()=>({action:{[u.f.YouTube]:u.E.share_youtube,[u.f.YouTubeShorts]:u.E.share_youtube_shorts}[e.youtubeShareType]}),[u.c.Facebook]:()=>({action:{[u.d.INSTAGRAM]:u.E.share_instagram_reels,[u.d.PAGE]:u.E.share_facebook_page,[u.d.GROUP]:u.E.share_facebook_group}[e.facebookShareType]}),[u.c.Shopify]:()=>({action:u.E.save_shopify}),[u.c.EmbedShopify]:()=>({action:u.E.embed})},r=null==(t=n[e.platformName])?void 0:t.call(n);if(fe&&ve.report({...me,action:null==r?void 0:r.action}),(0,p.E)({openType:o,action:null==r?void 0:r.action}),e.platformName===u.c.TikTok&&fe&&we){const e=s;return e.title=s.fileName,e.size=+s.fileSize,e.type=s.format.includes("/")?s.format:`video/${s.format}`,e.workspaceId=v.workspaceId,(0,d.r)(e),void(0,p.F)({selectedPlatform:q,fileInfo:s,facebookShareType:ue,youtubeShareType:pe,currentPage:Se,enterFrom:T?"export":null==_?void 0:_.enterFrom,toolType:(null==_?void 0:_.toolType)||(null==(a=(0,h.g)(null==s?void 0:s.asset))?void 0:a.tool_type),isAuth:+!!ae,task_id:null==_?void 0:_.taskId,intelligent_request_id:null==_?void 0:_.intelligentRequestId,autocut_template_id:null==_?void 0:_.autocutTemplateId,smart_ad_video_id:null==_?void 0:_.smartAdVideoId,url_to_video_request_id:null==_?void 0:_.urlToVideoRequestId})}if(e.platformName===u.c.TTAM&&se&&(null!=se&&se.isShow||se.limitStatus!==p.c.NORMAL&&se.limitStatus!==p.c.UNBLOCK))return de(u.c.TTAM),$(!0);X({type:"CHOOSE_PLATFORM",data:{platform:e.platformName,authUrl:e.authUrl,facebookShareType:e.facebookShareType,youtubeShareType:e.youtubeShareType,businessType:u.F.FilmVideo}})};(0,i.useEffect)((()=>{Te[xe]&&a.A.error({content:Te[xe].content,onClose:()=>{X("CLEAR_SHARE_VIDEO_ERROR_CODE")}})}),[xe]);return(0,n.jsx)("div",{className:l()("lv_share-wrapper"),ref:Q,children:(0,n.jsxs)(Qn.Provider,{value:{shareService:H,isNewShareExport:T,selectItemID:F},children:[xe&&Ee[xe]&&(0,n.jsx)($n,{visible:!0,...Ee[xe]}),(0,n.jsx)(sd,{ttamAgeGate:se,visible:J,setVisible:$,confirmBirthday:e=>{var t,o;const a=(null==(o=null==(t=be.filter((e=>e.platformName===ce)))?void 0:t[0])?void 0:o.authUrl)??"";ce&&X({type:"CHOOSE_PLATFORM",data:{platform:ce,authUrl:a}}),oe({type:"CONFIRM_BIRTHDAY",birthday:e,authUrl:a})},updateBirthday:e=>{var t,o;oe({type:"UPDATE_BIRTHDAY",data:{authUrl:(null==(o=null==(t=be.filter((e=>e.platformName===ce)))?void 0:t[0])?void 0:o.authUrl)??"",birthday:e}})},backToEditAge:()=>{oe({type:"BACK_TO_EDIT_AGE"})}}),q===u.c.Schedule&&(0,n.jsx)(Zp,{fileInfo:s,spaceInfo:v,extraData:N,mediaRecord:{assetIdList:[s.fileId],shareType:u.F.FilmVideo},platformAccount:Y,disabled:V,scheduleTask:D,scheduleCb:U,openType:o,selectItemID:F,onSignIn:(e,t)=>{const o=(0,u.O)(e);o&&X({type:"BIND_BY_SCHEDULE",data:{platform:o,userInfo:t}})},onSignOut:(e,t)=>{const o=(0,u.O)(e);o&&X({type:"UNBIND_BY_SCHEDULE",data:{platform:o,unbindAccountId:t}})},handleBack:()=>{X({type:"CLEAR_SELECTED_PLATFORM"})}}),(0,n.jsxs)("div",{className:l()("lv_share",fe&&"from_tool_page"),style:{...fe&&{overflow:"visible"}},children:[(0,n.jsx)("div",{style:_e.matches("show")||q===u.c.Schedule?{display:"none"}:fe?{}:{height:"100%"},children:fe?(0,n.jsx)(Ov,{platformsList:be,openModalType:P,choosePlatformFn:Pe,EverCloud:f??(null==(G=null==Z?void 0:Z.context)?void 0:G.everCloudInstance),openType:o,backToEdit:y,backToResult:w,makeNewOne:b,showBackToResult:x,choosePageSlot:k,platformHandleClose:A,downloadReport:()=>{fe&&ve.report({...me,action:"download"})},page:e,isVisitant:S,isSmartTool:fe,childState:_e}):(0,n.jsx)(Dv,{showVipCard:O,expandModalInstance:R,isShowVipEquityCard:!!j,eventParams:L,platformsList:be,openModalType:P,EverCloud:f??(null==(W=null==Z?void 0:Z.context)?void 0:W.everCloudInstance),choosePlatformFn:Pe,openType:o,backToEdit:y,makeNewOne:b,platformHandleClose:A,downloadReport:()=>{fe&&ve.report({...me,action:"download"})},page:e,isVisitant:S,isSmartTool:fe,childState:_e,fileInfo:s,reportExtra:_,currentPage:Se,workspaceId:null==v?void 0:v.workspaceId,handleClickSchedule:()=>{X({type:"CHOOSE_PLATFORM",data:{platform:u.c.Schedule}}),(0,p.E)({openType:o,action:u.E.schedule})}})}),_e.matches("show")&&q===u.c.Shopify&&(0,n.jsx)(ev,{openType:o,platformList:be,fileInfo:s,loading:!1,fileType:u.F.FilmVideo}),_e.matches("show")&&q===u.c.EmbedShopify&&(0,n.jsx)(yv,{showHeader:o!==p.O.taskList,headTitle:c.F2.t("web_shopify_text_back_sp",{},"Export to Shopify"),fileId:s.fileId,workspaceId:null==v?void 0:v.workspaceId}),_e.matches("show")&&q===u.c.TikTok&&(0,n.jsx)(Cs,{openType:o,fileInfo:s,platformsList:be,popUpContainer:Q.current}),_e.matches("show")&&q===u.c.TTAM&&(0,n.jsx)(Rs,{openType:o,fileInfo:s,platformsList:be}),_e.matches("show")&&q===u.c.YouTube&&(0,n.jsx)(Fm,{openType:o,fileInfo:s,extraData:N,spaceInfo:v,platformsList:be}),_e.matches("show")&&q===u.c.Facebook&&(0,n.jsx)(yg,{openType:o,fileInfo:s,extraData:N,spaceInfo:v,platformList:be})]})]})})}}}]);
//# sourceMappingURL=4271.b77d4639.js.map