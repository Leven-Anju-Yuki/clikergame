/*! For license information please see 1180.737b2942.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).xss={})}(this,(function(e){"use strict";var t=function(){return t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},t.apply(this,arguments)};function r(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}var n=/[^a-zA-Z0-9\\_:.-]/gim,i=/</g,o=/>/g,a=/&#([a-zA-Z0-9]*);?/gim,s=/&quot;/g,c=/&colon;?/gim,u=/&newline;?/gim,l=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,f=/u\s*r\s*l\s*\(.*/gi,h=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,p=/"/g,d=function(e){return e.replace(i,"&lt;").replace(o,"&gt;")},g={indexOf:function(e,t){var r,n;for(r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1},forEach:function(e,t,r){var n,i;for(n=0,i=e.length;n<i;n++)t.call(r,e[n],n,e)},some:function(e,t,r){var n,i;for(n=0,i=e.length;n<i;n++)if(t.call(r,e[n],n,e))return!0;return!1},trim:function(e){return e.replace(/(^\s*)|(\s*$)/g,"")},isArray:function(e){return e instanceof Array},includes:function(e,t){if("string"==typeof e)return-1!==e.indexOf(t);for(var r=0;r<e.length;r++)if(e[r]===t)return!0;return!1},spaceIndex:function(e){var t=/\s|\n|\t/.exec(e);return t?t.index:-1},uniq:function(e){for(var t={},r=[],n=0;n<e.length;n++)t[e[n]]||(r.push(e[n]),t[e[n]]=!0);return r},from:function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r]);return t},keys:function(e){var t=[];for(var r in e)t.push(r);return t}};function y(e){return null==e}function m(e){var t,r=g.spaceIndex(e);return t=-1===r?e.slice(1,-1):e.slice(1,r+1),"/"===(t=g.trim(t).toLowerCase()).slice(0,1)&&(t=t.slice(1)),"/"===t.slice(-1)&&(t=t.slice(0,-1)),t}function v(e,t){for(;t<e.length;t++){var r=e[t];if(" "!==r)return"="===r?t:-1}return-1}function b(e,t){for(;t>0;t--){var r=e[t];if(" "!==r)return"="===r?t:-1}return-1}function _(e){return function(e){return'"'===e[0]&&'"'===e[e.length-1]||"'"===e[0]&&"'"===e[e.length-1]}(e)?e.substr(1,e.length-2):e}function w(e,t){for(;t<e.length;t++){var r=e[t];if(" "!==r)return"'"===r||'"'===r?t:-1}return-1}function S(e){var t,r,n,i,o,a,s,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",l=0;for(e=function(e){e=e.replace(/rn/g,"n");for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t}(e);l<e.length;)i=(t=e.charCodeAt(l++))>>2,o=(3&t)<<4|(r=e.charCodeAt(l++))>>4,a=(15&r)<<2|(n=e.charCodeAt(l++))>>6,s=63&n,isNaN(r)?a=s=64:isNaN(n)&&(s=64),u=u+c.charAt(i)+c.charAt(o)+c.charAt(a)+c.charAt(s);return u}function k(e){var t,r,n,i,o,a,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",u=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");u<e.length;)t=s.indexOf(e.charAt(u++))<<2|(i=s.indexOf(e.charAt(u++)))>>4,r=(15&i)<<4|(o=s.indexOf(e.charAt(u++)))>>2,n=(3&o)<<6|(a=s.indexOf(e.charAt(u++))),c+=String.fromCharCode(t),64!==o&&(c+=String.fromCharCode(r)),64!==a&&(c+=String.fromCharCode(n));return c=function(e){for(var t="",r=0,n=0,i=0,o=0;r<e.length;)(n=e.charCodeAt(r))<128?(t+=String.fromCharCode(n),r++):n>191&&n<224?(o=e.charCodeAt(r+1),t+=String.fromCharCode((31&n)<<6|63&o),r+=2):(o=e.charCodeAt(r+1),i=e.charCodeAt(r+2),t+=String.fromCharCode((15&n)<<12|(63&o)<<6|63&i),r+=3);return t}(c),c}function x(e){return"</"===e.slice(0,2)}function E(e,t,r){var n="",i=0,o=!1,a=!1,s=0,c=e.length,u="",l="";e:for(s=0;s<c;s++){var f=e.charAt(s);if(!1===o){if("<"===f){o=s;continue}}else if(!1===a){if("<"===f){n+=r(e.slice(i,s)),o=s,i=s;continue}if(">"===f||s===c-1){n+=r(e.slice(i,o)),u=m(l=e.slice(o,s+1)),n+=t(o,n.length,u,l,x(l)),i=s+1,o=!1;continue}if('"'===f||"'"===f)for(var h=1,p=e.charAt(s-h);""===p.trim()||"="===p;){if("="===p){a=f;continue e}p=e.charAt(s-++h)}}else if(f===a){a=!1;continue}}return i<c&&(n+=r(e.substr(i))),n}function O(e,t){var r=0,i=0,o=[],a=!1,s=e.length;function c(e,r){if(!((e=(e=g.trim(e)).replace(n,"").toLowerCase()).length<1)){var i=t(e,r||"");i&&o.push(i)}}for(var u=0;u<s;u++){var l=e.charAt(u),f=void 0;if(!1!==a||"="!==l)if(!1===a||u!==i){if(/\s|\n|\t/.test(l)){if(e=e.replace(/\s|\n|\t/g," "),!1===a){if(-1===(f=v(e,u))){c(g.trim(e.slice(r,u))),a=!1,r=u+1;continue}u=f-1;continue}if(-1===(f=b(e,u-1))){c(a,_(g.trim(e.slice(r,u)))),a=!1,r=u+1;continue}}}else{if(-1===(f=e.indexOf(l,u+1)))break;c(a,g.trim(e.slice(i+1,f))),a=!1,r=(u=f)+1}else a=e.slice(r,u),r=u+1,i='"'===e.charAt(r)||"'"===e.charAt(r)?r:w(e,u+1)}return r<e.length&&(!1===a?c(e.slice(r)):c(a,_(g.trim(e.slice(r))))),g.trim(o.join(" "))}function C(e,t,r){if(r=function(e){return function(e){for(var t="",r=0,n=e.length;r<n;r++)t+=e.charCodeAt(r)<32?" ":e.charAt(r);return g.trim(t)}(e=function(e){return e.replace(c,":").replace(u," ")}(e=function(e){return e.replace(a,(function(e,t){return"x"===t[0]||"X"===t[0]?String.fromCharCode(parseInt(t.substr(1),16)):String.fromCharCode(parseInt(t,10))}))}(e=function(e){return e.replace(s,'"')}(e))))}(r),"href"===t||"src"===t){if("#"===(r=g.trim(r)))return"#";if("http://"!==r.substr(0,7)&&"https://"!==r.substr(0,8)&&"mailto:"!==r.substr(0,7)&&"tel:"!==r.substr(0,4)&&"data:image/"!==r.substr(0,11)&&"ftp://"!==r.substr(0,6)&&"./"!==r.substr(0,2)&&"../"!==r.substr(0,3)&&"#"!==r[0]&&"/"!==r[0])return""}else if("background"===t){if(l.lastIndex=0,l.test(r))return""}else if("style"===t){if(h.lastIndex=0,h.test(r))return"";if(f.lastIndex=0,f.test(r)&&(l.lastIndex=0,l.test(r)))return""}return function(e){return e=function(e){return e.replace(p,"&quot;")}(e),d(e)}(r)}var T=function(e){return"string"==typeof e?e.replace(/'/g,'"').replace('=""',"").replace(/\s+/g,"").toLowerCase():""},D=function(){function e(e){var t=function(e){var t={};for(var r in e)t[r]=e[r];return t}(e||{});t.stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=function(){return""}),t.whiteList={},t.onTag=function(){},t.onTagAttr=function(){},t.onIgnoreTag=function(){},t.onIgnoreTagAttr=function(){},t.safeAttrValue=C,t.escapeHtml=d,this.options=Object.assign(t,e)}return e.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t=this.options,r=t.whiteList,n=t.onTag,i=t.onIgnoreTag,o=t.onTagAttr,a=t.onIgnoreTagAttr,s=t.safeAttrValue,c=t.escapeHtml;t.stripBlankChar&&(e=function(e){var t=e.split("");return(t=t.filter((function(e){var t=e.charCodeAt(0);return!(127===t||t<=31&&10!==t&&13!==t)}))).join("")}(e)),t.allowCommentTag||(e=function(e){for(var t="",r=0;r<e.length;){var n=e.indexOf("\x3c!--",r);if(-1===n){t+=e.slice(r);break}t+=e.slice(r,n);var i=e.indexOf("--\x3e",n);if(-1===i)break;r=i+3}return t}(e));var u=!1;t.stripIgnoreTagBody&&(u=function(e,t){"function"!=typeof t&&(t=function(){});var r=!Array.isArray(e),n=[],i=!1;return{onIgnoreTag:function(o,a,s){if(function(t){return!!r||-1!==g.indexOf(e,t)}(o)){if(s.isClosing){var c="[/removed]",u=s.position+10;return n.push([!1!==i?i:s.position,u]),i=!1,c}return i||(i=s.position),"[removed]"}return t(o,a,s)},remove:function(e){var t="",r=0;return g.forEach(n,(function(n){t+=e.slice(r,n[0]),r=n[1]})),t+=e.slice(r)}}}(t.stripIgnoreTagBody,i),i=u.onIgnoreTag);var l=E(e,(function(e,t,u,l,f){var h={sourcePosition:e,position:t,isClosing:f,isWhite:Object.prototype.hasOwnProperty.call(r,u)},p=n(u,l,h);if(!y(p))return p;if(h.isWhite){if(h.isClosing)return"</".concat(u,">");var d=function(e){var t=g.spaceIndex(e);if(-1===t)return{html:"",closing:"/"===e[e.length-2]};var r="/"===(e=g.trim(e.slice(t+1,-1)))[e.length-1];return r&&(e=g.trim(e.slice(0,-1))),{html:e,closing:r}}(l),m=r[u],v=O(d.html,(function(e,t){var r=-1!==g.indexOf(m,e),n=o(u,e,t,r);return y(n)?r?(t=s(u,e,t,null))?"".concat(e,'="').concat(t,'"'):e:y(n=a(u,e,t,r))?void 0:n:n}));return l="<".concat(u),v&&(l+=" ".concat(v)),d.closing&&(l+=" /"),l+">"}return y(p=i(u,l,h))?c(l):p}),c);return u&&(l=u.remove(l)),l},e}(),j=!0,A=function(e){return e&&e.Math==Math&&e},P=A("object"==typeof globalThis&&globalThis)||A("object"==typeof window&&window)||A("object"==typeof self&&self)||A("object"==typeof global&&global)||Function("return this")();try{!0!==(j=!!(j=String(j)).startsWith("<%=")||JSON.parse(j))&&"true"!==j||(P=new Function("\nvar _checkXSS = function (it) {\n  return it && it.Math == Math && it;\n};\nreturn _checkXSS(typeof globalThis === 'object' && globalThis) ||\n_checkXSS(typeof window === 'object' && window) ||\n_checkXSS(typeof self === 'object' && self) ||\n_checkXSS(typeof global === 'object' && global) ||\nFunction('return this')();\n")())}catch(e){console.log(e)}var I=new(function(){function e(){var e=this;this.batchData=[],this.uniqKeys=new Set,this.timeout=2e3,this.lock=!1,this.getSlardarBid=function(){var t,r,n="cc_web";if(!g.includes(n,"bid"))return n;if(e.config&&e.config.bid)return e.config.bid;var i=P;if(i&&i._xssBid)return i._xssBid;if(i&&i.slardar&&"function"==typeof i.slardar.config){var o=(i.slardar.config()||{}).bid;if(o)return o}if(i&&i.Slardar&&"function"==typeof i.Slardar.config){var a=(i.Slardar.config()||{}).bid;if(a)return a}return(null===(r=null===(t=null==i?void 0:i.Slardar)||void 0===t?void 0:t._baseParams)||void 0===r?void 0:r.bid)||"argus"},this.getConfigRegion=function(){var t;return g.includes("va","region")?e.config&&e.config.region?e.config.region:((null===(t=null==P?void 0:P.gfdatav1)||void 0===t?void 0:t.region)||"cn").toLowerCase():"va"},this.gerReportUrl=function(){var t={cn:k("aHR0cHM6Ly9tb24uemlqaWVhcGkuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),boe:k("aHR0cHM6Ly9tb24uemlqaWVhcGkuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),ttp:k("aHR0cHM6Ly9tb24udXMudGlrdG9rdi5jb20vbW9uaXRvcl9icm93c2VyL2NvbGxlY3QvYmF0Y2gvc2VjdXJpdHkvP2JpZD0="),va:k("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),maliva:k("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),sg:k("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),boei18n:k("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9")}[e.getConfigRegion()];if(t)return t+e.getSlardarBid()}}return e.prototype.setConfig=function(e){this.config=e},e.prototype.upload=function(){var e=this;if(!this.config||!this.config.isCloseReport){var t=!1;t=String(t);try{if(!0===(t=!t.startsWith("<%=")&&JSON.parse(t))||"true"===t)return}catch(e){console.log(e)}var r=this.gerReportUrl();!this.lock&&r&&0!==this.batchData.length&&(this.lock=!0,setTimeout((function(){var t=e.batchData.slice(0,100);e.batchData=e.batchData.slice(100),P.fetch(r,{method:"post",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).catch((function(e){console.warn("xss defense report error",e)})),e.lock=!1,e.upload()}),this.timeout))}},e.prototype.generateKey=function(e){return e.collectKey?[e.collectMode,e.collectKey].join("___"):""},e.prototype.push=function(e){this.batchData.push(e),this.upload()},e.prototype.report=function(e){var t,r=this.generateKey(e);if(P.fetch&&e.collectKey){var n=(null===(t=null===window||void 0===window?void 0:window.location)||void 0===t?void 0:t.href)||"SSR";e.documentUrl=n;var i={age:Math.floor(Date.now()),type:"xss",url:n,body:e,"user-agent":""};"enforce"===e.disposition&&"SSR"!==n||(i.url=r),"SSR"===n&&(i.url="SSR___".concat(i.url),i.body.ssr=!0),this.push(i)}},e}());function z(e,t){return I.setConfig(t),new D(t).process(e)}var R=function(e){return-1===(e=(e=(e=(e=e.replace(/&colon;/gi,":")).replace(/&tab;/gi,"")).replace(/&newline;/gi,"")).replace(/(\t|\n|\r)/g,"")).indexOf("&#")?e.trim().toLowerCase():e.trim().replace(/&#(?:(x)([0-9a-f]+)|([0-9]+));?/gi,(function(e,t,r,n){return String.fromCharCode(t?parseInt(r,16):parseInt(n))})).replace(/(\t|\n|\r)/g,"").toLowerCase()};function M(e,t){if(void 0===e&&(e=""),"string"!=typeof e)return!0;if(e=R(e),g.includes(e,"base64")&&!function(e){if(""===e||""===e.trim())return!0;try{return!g.includes(e,"data:text/html;base64")}catch(e){return!0}}(e))return t&&t("data:text/html;base64"),!1;var r=["expression(","behavior:","view-source:"];if(g.some(r,(function(t){return-1!==e.indexOf(t)})))return g.forEach(r,(function(r){-1!==e.indexOf(r)&&t&&t(r)})),!1;var n=["data:application","data:javascript","data:text/html","data:texthtml"];if(g.some(n,(function(t){return-1!==e.indexOf(t)})))return g.forEach(n,(function(r){-1!==e.indexOf(r)&&t&&t(r)})),!1;if(e.indexOf("javascript:")>0)return t&&t("javascript:"),!1;if(/^javascript:/i.test(e)){var i=e.slice(11).replace(/\s/g,"").trim();return!!g.some(["void","void(0)","void0","false","undefined",";"],(function(e){return e===i}))||(t&&t("javascript:"),!1)}return!0}var B=function(e,t){var r,n,i=!1;if(i=String(i),"string"!=typeof e)return e;if(r=e,n=Number(-1),"NaN"!==r.toString()&&-1!==n&&r.length>=n)return e;if(M(e,t))return e;try{if(!0===(i=!i.startsWith("<%=")&&JSON.parse(i))||"true"===i){var o=new URL(e);return o.origin+o.pathname}}catch(e){return console.log(e),"#"}return"#"};function U(e,t,n){if(void 0===e&&(e=""),void 0===t&&(t=[]),"string"!=typeof e)return!0;if(!M(e=R(e)))return!1;var i=function(e){var t=e.match(/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/)||[];return{url:t[0],scheme:t[1],slash:t[2],host:t[3],port:t[4],path:t[5],query:t[6],hash:t[7]}}(e),o=i.scheme,a=i.host;return n?Boolean(n(e)):!(!o||!a)&&(!g.includes(["http","https","file"],o)||("object"==typeof window&&window&&(t=r(r([],t,!0),[location.host],!1)),g.some(t,(function(e){return!!(e instanceof RegExp&&e.test(a))||e===a}))))}var N=U,G=U,F=function(e,t){for(var r={},n=0,i=g.keys(e);n<i.length;n++){var o=i[n];Array.isArray(e[o])?r[o]=g.from(e[o]):r[o]=F({},e[o])}for(var a=0,s=g.keys(t);a<s.length;a++)(o=s[a])in e?Array.isArray(e[o])?r[o]=e[o].concat(t[o]):r[o]=F(e[o],t[o]):Array.isArray(t[o])?r[o]=g.from(t[o]):r[o]=F({},t[o]);return r},L={blackList:{a:["folder"],meta:["content"],iframe:["srcdoc"],input:["pattern"],vmlframe:["xmlns"]},blackTags:["script","xml","embed","isindex","object","base","set","handler","animate","payload","import"],blackAttrs:["charset","ns","namespace","formaction","xlink:href","xmlns:xlink","handler","repeat","repeat-start","repeat-end"],blackAttrRegExps:[/^on/],filterList:{param:["value"],video:["poster"],form:["action"]},filterAttrs:["href","src","background","style","dynsrc","lowsrc","content"]};try{var H={};H.blackAttrRegExps&&(H.blackAttrRegExps=H.blackAttrRegExps.map((function(e){return new RegExp(e.toString().slice(1,e.toString().length-1))})));var K="merge";g.includes(K,"override")&&(L=H),g.includes(K,"merge")&&(L=F(L,H))}catch(e){console.log(e)}var q,W={mode:"black",whiteList:{},blackConfig:L,collect:null,initCollect:function(){W.collect={blackList:{},blackTags:[],blackAttrs:[],blackAttrRegExps:[],filterAttrs:[],filterList:{},filterProtocol:[]}},removeCollect:function(){var e=function(e){for(var t=0,r=function(r){Array.isArray(e[r])?0===e[r].length?delete e[r]:(e[r]=g.from(g.uniq(e[r])),t+=e[r].length):0===g.keys(e[r]).length?delete e[r]:g.keys(e[r]).forEach((function(n){e[r][n]=g.from(g.uniq(e[r][n])),t+=e[r][n].length}))},n=0,i=g.keys(e);n<i.length;n++)r(i[n]);return{count:t,ret:e}}(W.collect),t=e.count,r=e.ret;return W.collect=null,{collectKey:0===t?null:JSON.stringify(r),collectMode:"black"}},onIgnoreTag:function(e,t){var r;if(!g.includes(L.blackTags,e)){var n=E(t,(function(e,t,r,n,i){if(-1!==r.indexOf("/"))return d(n);if(i)return"</".concat(r,">");var o=function(e){var t,r=(t=/\s|\n|\t/.exec(e))?t.index:-1;if(-1===r)return{html:"",closing:"/"===e[e.length-2]};var n="/"===(e=e.slice(r+1,-1).trim())[e.length-1];return n&&(e=e.slice(0,-1).trim()),{html:e,closing:n}}(n),a=O(o.html,(function(e,t){var n,i=0;if(L.blackList[r]&&g.includes(L.blackList[r],e)&&(W.collect.blackList[r]=W.collect.blackList[r]||[],W.collect.blackList[r].push(e),i++),L.blackAttrRegExps.length&&L.blackAttrRegExps.some((function(t){return t.test(e)}))&&g.forEach(L.blackAttrRegExps,(function(t){t.test(e)&&(W.collect.blackAttrRegExps.push("".concat(t.toString(),"->").concat(e)),i++)})),L.blackAttrs.length&&g.includes(L.blackAttrs,e)&&(L.blackAttrs.push(e),i++),!i){if(L.filterList&&L.filterList[r]&&g.includes(L.filterList[r],e)){var o=B(t,(function(e){var t;null===(t=W.collect)||void 0===t||t.filterProtocol.push(e)}));return o!==t&&(W.collect.filterList[r]=W.collect.filterList[r]||[],W.collect.filterList[r].push(e)),t?"".concat(e,"='").concat(o,"'"):e}return L.filterAttrs&&g.includes(L.filterAttrs,e)?(o=B(t,(function(e){var t;null===(t=W.collect)||void 0===t||t.filterProtocol.push(e)})),o!==t&&(null===(n=W.collect)||void 0===n||n.filterAttrs.push(e)),t?"".concat(e,"='").concat(o,"'"):e):t?"".concat(e,"='").concat(t,"'"):e}}));return n="<".concat(r),a&&(n+=" ".concat(a)),o.closing&&(n+=" /"),n+">"}),d);return n}null===(r=W.collect)||void 0===r||r.blackTags.push(e)}},J=function(e){var t=e.reportOnly,r=void 0===t||t,n=e.block;return r&&"all"===r?"report":("string"==typeof r&&("true"===r&&(r=!0),"false"===r&&(r=!1)),n?"enforce":r?"report":"enforce")},V=function(e){return function(r,n,i){if(!r||"string"!=typeof r)return r;var o=n;e===z&&(o=W).initCollect();var a=e(r,o);if(T(a)===T(r))return r;if(!i)return a;var s=i.logType,c=J(i),u=o.removeCollect();return I.report(t(t({type:s,disposition:c},u),{sourceText:S(r.replace(/'/g,'"')),filterText:S(a.replace(/'/g,'"'))})),"enforce"===c?a:r}},X=V((function(e,t){return void 0===t&&(t={}),t&&t.whiteList||(t.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}),new D(t).process(e)})),$=V(z),Z=(q=B,function(e,t,r){var n=[],i=q(e,(function(e){n.push(e)}));if(i===e)return e;n=g.from(g.uniq(n));var o=t||r||{};if(!o)return i;var a=o.logType,s=J(r);return I.report({type:a,disposition:s,collectKey:n.join("___"),collectData:JSON.stringify(n),collectMode:"black",sourceText:S(e),filterText:S(i)}),"enforce"===s?i:e}),Y=P._xssProject||{},Q=P.xssNamespace||{},ee="3.0.30",te={FilterXSS:D,version:ee,webpackPluginVersion:"3.0.39",reportOnly:"all",filterXSS:X,_filterXSS:$,filterUrl:Z,BlackConfig:W,project:Y,setProjectName:function(e){Y[e]=this,P._xssProjectName=e}};Q.cc_web_editor_smart_toolbox=te,P.xssNamespace=Q,P.Math&&!P.Math.xssNamespace&&(P.Math.xssNamespace=Q),Y[ee]=te,P.globalThis=P,P.getFilterXss=function(){return void 0!==this._xssProjectName?this._xssProject[this._xssProjectName]:te},P.xss=te,P.isSafeUrl=N,P.isSafeDomain=G,P.isSafeProtocol=M,P._xssProject=Y,P._xssProjectName&&(Y[P._xssProjectName]=te);var re=te.setProjectName.bind(te);e.BlackConfig=W,e.FilterXSS=D,e._filterXSS=$,e.filterUrl=Z,e.filterXSS=X,e.isSafeDomain=G,e.isSafeProtocol=M,e.isSafeUrl=N,e.project=Y,e.setProjectName=re,e.setXssNamespace=function(e){var t=e.appId,r=e.bid,n=e.region,i=e.isCloseReport;Q[t]=te;var o=W;o.bid=r,o.region=n,o.enabled=!0,o.isCloseReport=i},e.xssNamespace=Q,Object.defineProperty(e,"__esModule",{value:!0})})),(window.webpackChunksmart_toolbox=window.webpackChunksmart_toolbox||[]).push([[1180],{5092:function(e){var t;"undefined"!=typeof self&&self,t=function(){return function(e){var t={};function r(n){var i;return(t[n]||(i=t[n]={i:n,l:!1,exports:{}},e[n].call(i.exports,i,i.exports,r),i.l=!0,i)).exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=9)}([function(e,t,r){"use strict";var n="object"==typeof Reflect?Reflect:null,i=n&&"function"==typeof n.apply?n.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)},o=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)},a=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}y(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&y(e,"error",t,r)}(e,i,{once:!0})}))},(s.EventEmitter=s).prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var c=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function f(e,t,r,n){var i,o;return u(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener||r),i=e._events),o=i[t]),void 0===o?(o=i[t]=r,++e._eventsCount):("function"==typeof o?o=i[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),0<(i=l(e))&&o.length>i&&!o.warned&&(o.warned=!0,(n=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",n.emitter=e,n.type=t,n.count=o.length,function(e){console&&console.warn&&console.warn(e)}(n))),e}function h(e,t,r){return t=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}.bind(e={fired:!1,wrapFn:void 0,target:e,type:t,listener:r}),t.listener=r,e.wrapFn=t}function p(e,t,r){return void 0===(e=e._events)||void 0===(e=e[t])?[]:"function"==typeof e?r?[e.listener||e]:[e]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(e):g(e,e.length)}function d(e){var t=this._events;if(void 0!==t){if("function"==typeof(t=t[e]))return 1;if(void 0!==t)return t.length}return 0}function g(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function y(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,o=this._events;if(void 0!==o)n=n&&void 0===o.error;else if(!n)return!1;if(n){if((a=0<t.length?t[0]:a)instanceof Error)throw a;throw(n=new Error("Unhandled error."+(a?" ("+a.message+")":""))).context=a,n}var a=o[e];if(void 0===a)return!1;if("function"==typeof a)i(a,this,t);else{var s=a.length,c=g(a,s);for(r=0;r<s;++r)i(c[r],this,t)}return!0},s.prototype.on=s.prototype.addListener=function(e,t){return f(this,e,t,!1)},s.prototype.prependListener=function(e,t){return f(this,e,t,!0)},s.prototype.once=function(e,t){return u(t),this.on(e,h(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,h(this,e,t)),this},s.prototype.off=s.prototype.removeListener=function(e,t){var r,n,i,o,a;if(u(t),void 0!==(n=this._events)&&void 0!==(r=n[e]))if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;0<=o;o--)if(r[o]===t||r[o].listener===t){a=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,a||t)}return this},s.prototype.removeAllListeners=function(e){var t,r=this._events;if(void 0!==r)if(void 0===r.removeListener)0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]);else if(0===arguments.length){for(var n,i=Object.keys(r),o=0;o<i.length;++o)"removeListener"!==(n=i[o])&&this.removeAllListeners(n);this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0}else if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(o=t.length-1;0<=o;o--)this.removeListener(e,t[o]);return this},s.prototype.listeners=function(e){return p(this,e,!0)},s.prototype.rawListeners=function(e){return p(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},s.prototype.listenerCount=d,s.prototype.eventNames=function(){return 0<this._eventsCount?o(this._events):[]}},function(e,t,r){(function(t){e.exports=function(){"use strict";function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&r.path)}},r.exports),r.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t||"undefined"!=typeof self&&self;var n=r((function(e,t){var r;e.exports=(r=r||function(e,t){var r=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),n={},i=n.lib={},o=i.Base={extend:function(e){var t=r(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=i.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,i=e.sigBytes;if(this.clamp(),n%4)for(var o=0;o<i;o++){var a=r[o>>>2]>>>24-o%4*8&255;t[n+o>>>2]|=a<<24-(n+o)%4*8}else for(o=0;o<i;o+=4)t[n+o>>>2]=r[o>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var r,n=[],i=function(t){var r=987654321,n=4294967295;return function(){var i=((r=36969*(65535&r)+(r>>16)&n)<<16)+(t=18e3*(65535&t)+(t>>16)&n)&n;return i/=4294967296,(i+=.5)*(e.random()>.5?1:-1)}},o=0;o<t;o+=4){var s=i(4294967296*(r||e.random()));r=987654071*s(),n.push(4294967296*s()|0)}return new a.init(n,t)}}),s=n.enc={},c=s.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new a.init(r,t/2)}},u=s.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new a.init(r,t)}},l=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},f=i.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r=this._data,n=r.words,i=r.sigBytes,o=this.blockSize,s=i/(4*o),c=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*o,u=e.min(4*c,i);if(c){for(var l=0;l<c;l+=o)this._doProcessBlock(n,l);var f=n.splice(0,c);r.sigBytes-=u}return new a.init(f,u)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),h=(i.Hasher=f.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new h.HMAC.init(e,r).finalize(t)}}}),n.algo={});return n}(Math),r)})),i=r((function(e,t){var r;e.exports=(r=n,function(e){var t=r,n=t.lib,i=n.WordArray,o=n.Hasher,a=t.algo,s=[],c=[];!function(){function t(t){for(var r=e.sqrt(t),n=2;n<=r;n++)if(!(t%n))return!1;return!0}function r(e){return 4294967296*(e-(0|e))|0}for(var n=2,i=0;i<64;)t(n)&&(i<8&&(s[i]=r(e.pow(n,.5))),c[i]=r(e.pow(n,1/3)),i++),n++}();var u=[],l=a.SHA256=o.extend({_doReset:function(){this._hash=new i.init(s.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],l=r[5],f=r[6],h=r[7],p=0;p<64;p++){if(p<16)u[p]=0|e[t+p];else{var d=u[p-15],g=(d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3,y=u[p-2],m=(y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10;u[p]=g+u[p-7]+m+u[p-16]}var v=n&i^n&o^i&o,b=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),_=h+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&l^~s&f)+c[p]+u[p];h=f,f=l,l=s,s=a+_|0,a=o,o=i,i=n,n=_+(b+v)|0}r[0]=r[0]+n|0,r[1]=r[1]+i|0,r[2]=r[2]+o|0,r[3]=r[3]+a|0,r[4]=r[4]+s|0,r[5]=r[5]+l|0,r[6]=r[6]+f|0,r[7]=r[7]+h|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return r[i>>>5]|=128<<24-i%32,r[14+(i+64>>>9<<4)]=e.floor(n/4294967296),r[15+(i+64>>>9<<4)]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=o._createHelper(l),t.HmacSHA256=o._createHmacHelper(l)}(Math),r.SHA256)})),o=(r((function(e,t){var r,i,o;e.exports=(i=(r=n).lib.Base,o=r.enc.Utf8,void(r.algo.HMAC=i.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=o.parse(t));var r=e.blockSize,n=4*r;t.sigBytes>n&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),a=this._iKey=t.clone(),s=i.words,c=a.words,u=0;u<r;u++)s[u]^=1549556828,c[u]^=909522486;i.sigBytes=a.sigBytes=n,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,r=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(r))}})))})),r((function(e,t){e.exports=n.HmacSHA256}))),a=function(e,t){return o(t,e)},s=function(e){return i(e)},c=["authorization","content-type","content-length","user-agent","presigned-expires","expect","x-amzn-trace-id"],u="aws4_request",l=function(e){try{return encodeURIComponent(e).replace(/[^A-Za-z0-9_.~\-%]+/g,escape).replace(/[*]/g,(function(e){return"%".concat(e.charCodeAt(0).toString(16).toUpperCase())}))}catch(e){return""}},f=function(e){return Object.keys(e).sort().map((function(t){var r=e[t];if(null!=r){var n=l(t);if(n)return Array.isArray(r)?"".concat(n,"=").concat(r.map(l).sort().join("&".concat(n,"="))):"".concat(n,"=").concat(l(r))}})).filter((function(e){return e})).join("&")};return function(){function t(e,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.request=e,this.request.headers=e.headers||{},this.serviceName=r,n=n||{},this.signatureCache="boolean"!=typeof n.signatureCache||n.signatureCache,this.operation=n.operation,this.signatureVersion=n.signatureVersion}var r,n;return r=t,(n=[{key:"addAuthorization",value:function(e,t){var r=this.iso8601(t).replace(/[:\-]|\.\d{3}/g,"");this.addHeaders(e,r),this.request.headers.Authorization=this.authorization(e,r)}},{key:"addHeaders",value:function(e,t){this.request.headers["X-Amz-Date"]=t,e.sessionToken&&(this.request.headers["x-amz-security-token"]=e.sessionToken),this.request.body&&(this.request.headers["X-Amz-Content-Sha256"]=s(JSON.stringify(this.request.body)).toString())}},{key:"authorization",value:function(e,t){var r=[],n=this.credentialString(t);return r.push("".concat("AWS4-HMAC-SHA256"," Credential=").concat(e.accessKeyId,"/").concat(n)),r.push("SignedHeaders=".concat(this.signedHeaders())),r.push("Signature=".concat(this.signature(e,t))),r.join(", ")}},{key:"signature",value:function(e,t){var r=this.getSigningKey(e,t.substr(0,8),this.request.region,this.serviceName,this.signatureCache);return a(r,this.stringToSign(t),"hex")}},{key:"stringToSign",value:function(e){var t=[];return t.push("AWS4-HMAC-SHA256"),t.push(e),t.push(this.credentialString(e)),t.push(this.hexEncodedHash(this.canonicalString())),t.join("\n")}},{key:"canonicalString",value:function(){var e=[],t=this.request.pathname||"/";return e.push(this.request.method.toUpperCase()),e.push(t),e.push(f(this.request.params)||""),e.push("".concat(this.canonicalHeaders(),"\n")),e.push(this.signedHeaders()),e.push(this.hexEncodedBodyHash()),e.join("\n")}},{key:"canonicalHeaders",value:function(){var e=this,t=[];Object.keys(this.request.headers).forEach((function(r){t.push([r,e.request.headers[r]])})),t.sort((function(e,t){return e[0].toLowerCase()<t[0].toLowerCase()?-1:1}));var r=[];return t.forEach((function(t){var n=t[0].toLowerCase();if(e.isSignableHeader(n)){var i=t[1];if(null==i||"function"!=typeof i.toString)throw new Error("Header ".concat(n," contains invalid value"));r.push("".concat(n,":").concat(e.canonicalHeaderValues(i.toString())))}})),r.join("\n")}},{key:"canonicalHeaderValues",value:function(e){return e.replace(/\s+/g," ").replace(/^\s+|\s+$/g,"")}},{key:"signedHeaders",value:function(){var e=this,t=[];return Object.keys(this.request.headers).forEach((function(r){r=r.toLowerCase(),e.isSignableHeader(r)&&t.push(r)})),t.sort().join(";")}},{key:"credentialString",value:function(e){return this.createScope(e.substr(0,8),this.request.region,this.serviceName)}},{key:"hexEncodedHash",value:function(e){return s(e)}},{key:"hexEncodedBodyHash",value:function(){return this.request.headers["X-Amz-Content-Sha256"]?this.request.headers["X-Amz-Content-Sha256"]:this.request.body?this.hexEncodedHash(f(this.request.body)):this.hexEncodedHash("")}},{key:"isSignableHeader",value:function(e){return 0===e.toLowerCase().indexOf("x-amz-")||c.indexOf(e)<0}},{key:"iso8601",value:function(e){return void 0===e&&(e=new Date),e.toISOString().replace(/\.\d{3}Z$/,"Z")}},{key:"getSigningKey",value:function(e,t,r,n){var i=a("AWS4".concat(e.secretAccessKey),t),o=a(i,r),s=a(o,n);return a(s,u)}},{key:"createScope",value:function(e,t,r){return[e.substr(0,8),t,r,u].join("/")}}])&&e(r.prototype,n),t}()}()}).call(this,r(7))},function(e,t,r){e.exports=function(){return r(8)('!function(t){var n={};function __webpack_require__(r){var e;return(n[r]||(e=n[r]={i:r,l:!1,exports:{}},t[r].call(e.exports,e,e.exports,__webpack_require__),e.l=!0,e)).exports}__webpack_require__.m=t,__webpack_require__.c=n,__webpack_require__.d=function(r,e,t){__webpack_require__.o(r,e)||Object.defineProperty(r,e,{enumerable:!0,get:t})},__webpack_require__.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},__webpack_require__.t=function(e,r){if(1&r&&(e=__webpack_require__(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(__webpack_require__.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var n in e)__webpack_require__.d(t,n,function(r){return e[r]}.bind(null,n));return t},__webpack_require__.n=function(r){var e=r&&r.__esModule?function getDefault(){return r.default}:function getModuleExports(){return r};return __webpack_require__.d(e,"a",e),e},__webpack_require__.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=9)}([function(r,e,t){r.exports=function(){var r=r||function(u,t){var n=Object.create||function(){function F(){}return function(r){var e;F.prototype=r;e=new F;F.prototype=null;return e}}();var r={};var e=r.lib={};var i=e.Base=function(){return{extend:function(r){var e=n(this);if(r)e.mixIn(r);if(!e.hasOwnProperty("init")||this.init===e.init)e.init=function(){e.$super.init.apply(this,arguments)};e.init.prototype=e;e.$super=this;return e},create:function(){var r=this.extend();r.init.apply(r,arguments);return r},init:function(){},mixIn:function(r){for(var e in r)if(r.hasOwnProperty(e))this[e]=r[e];if(r.hasOwnProperty("toString"))this.toString=r.toString},clone:function(){return this.init.prototype.extend(this)}}}();var h=e.WordArray=i.extend({init:function(r,e){r=this.words=r||[];if(e!=t)this.sigBytes=e;else this.sigBytes=r.length*4},toString:function(r){return(r||o).stringify(this)},concat:function(r){var e=this.words;var t=r.words;var n=this.sigBytes;var i=r.sigBytes;this.clamp();if(n%4)for(var a=0;a<i;a++){var o=t[a>>>2]>>>24-a%4*8&255;e[n+a>>>2]|=o<<24-(n+a)%4*8}else for(var a=0;a<i;a+=4)e[n+a>>>2]=t[a>>>2];this.sigBytes+=i;return this},clamp:function(){var r=this.words;var e=this.sigBytes;r[e>>>2]&=4294967295<<32-e%4*8;r.length=u.ceil(e/4)},clone:function(){var r=i.clone.call(this);r.words=this.words.slice(0);return r},random:function(r){var e=[];var t=function(e){var e=e;var t=987654321;var n=4294967295;return function(){t=36969*(t&65535)+(t>>16)&n;e=18e3*(e&65535)+(e>>16)&n;var r=(t<<16)+e&n;r/=4294967296;r+=.5;return r*(u.random()>.5?1:-1)}};for(var n=0,i;n<r;n+=4){var a=t((i||u.random())*4294967296);i=a()*987654071;e.push(a()*4294967296|0)}return new h.init(e,r)}});var a=r.enc={};var o=a.Hex={stringify:function(r){var e=r.words;var t=r.sigBytes;var n=[];for(var i=0;i<t;i++){var a=e[i>>>2]>>>24-i%4*8&255;n.push((a>>>4).toString(16));n.push((a&15).toString(16))}return n.join("")},parse:function(r){var e=r.length;var t=[];for(var n=0;n<e;n+=2)t[n>>>3]|=parseInt(r.substr(n,2),16)<<24-n%8*4;return new h.init(t,e/2)}};var s=a.Latin1={stringify:function(r){var e=r.words;var t=r.sigBytes;var n=[];for(var i=0;i<t;i++){var a=e[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(a))}return n.join("")},parse:function(r){var e=r.length;var t=[];for(var n=0;n<e;n++)t[n>>>2]|=(r.charCodeAt(n)&255)<<24-n%4*8;return new h.init(t,e)}};var c=a.Utf8={stringify:function(r){try{return decodeURIComponent(escape(s.stringify(r)))}catch(r){throw new Error("Malformed UTF-8 data")}},parse:function(r){return s.parse(unescape(encodeURIComponent(r)))}};var v=e.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new h.init;this._nDataBytes=0},_append:function(r){if(typeof r=="string")r=c.parse(r);this._data.concat(r);this._nDataBytes+=r.sigBytes},_process:function(r){var e=this._data;var t=e.words;var n=e.sigBytes;var i=this.blockSize;var a=i*4;var o=n/a;if(r)o=u.ceil(o);else o=u.max((o|0)-this._minBufferSize,0);var s=o*i;var c=u.min(s*4,n);if(s){for(var v=0;v<s;v+=i)this._doProcessBlock(t,v);var f=t.splice(0,s);e.sigBytes-=c}return new h.init(f,c)},clone:function(){var r=i.clone.call(this);r._data=this._data.clone();return r},_minBufferSize:0});var f=e.Hasher=v.extend({cfg:i.extend(),init:function(r){this.cfg=this.cfg.extend(r);this.reset()},reset:function(){v.reset.call(this);this._doReset()},update:function(r){this._append(r);this._process();return this},finalize:function(r){if(r)this._append(r);var e=this._doFinalize();return e},blockSize:512/32,_createHelper:function(t){return function(r,e){return new t.init(e).finalize(r)}},_createHmacHelper:function(t){return function(r,e){return new p.HMAC.init(t,e).finalize(r)}}});var p=r.algo={};return r}(Math);return r}()},function(r,e,t){r.exports=function(F){F.lib.Cipher||function(o){var r=F;var e=r.lib;var t=e.Base;var c=e.WordArray;var n=e.BufferedBlockAlgorithm;var i=r.enc;var a=i.Utf8;var s=i.Base64;var v=r.algo;var f=v.EvpKDF;var u=e.Cipher=n.extend({cfg:t.extend(),createEncryptor:function(r,e){return this.create(this._ENC_XFORM_MODE,r,e)},createDecryptor:function(r,e){return this.create(this._DEC_XFORM_MODE,r,e)},init:function(r,e,t){this.cfg=this.cfg.extend(t);this._xformMode=r;this._key=e;this.reset()},reset:function(){n.reset.call(this);this._doReset()},process:function(r){this._append(r);return this._process()},finalize:function(r){if(r)this._append(r);var e=this._doFinalize();return e},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function selectCipherStrategy(r){if(typeof r=="string")return S;else return m}return function(n){return{encrypt:function(r,e,t){return selectCipherStrategy(e).encrypt(n,r,e,t)},decrypt:function(r,e,t){return selectCipherStrategy(e).decrypt(n,r,e,t)}}}}()});var h=e.StreamCipher=u.extend({_doFinalize:function(){var r=this._process(!!"flush");return r},blockSize:1});var p=r.mode={};var l=e.BlockCipherMode=t.extend({createEncryptor:function(r,e){return this.Encryptor.create(r,e)},createDecryptor:function(r,e){return this.Decryptor.create(r,e)},init:function(r,e){this._cipher=r;this._iv=e}});var _=p.CBC=function(){var r=l.extend();r.Encryptor=r.extend({processBlock:function(r,e){var t=this._cipher;var n=t.blockSize;xorBlock.call(this,r,e,n);t.encryptBlock(r,e);this._prevBlock=r.slice(e,e+n)}});r.Decryptor=r.extend({processBlock:function(r,e){var t=this._cipher;var n=t.blockSize;var i=r.slice(e,e+n);t.decryptBlock(r,e);xorBlock.call(this,r,e,n);this._prevBlock=i}});function xorBlock(r,e,t){var n=this._iv;if(n){var i=n;this._iv=o}else var i=this._prevBlock;for(var a=0;a<t;a++)r[e+a]^=i[a]}return r}();var d=r.pad={};var y=d.Pkcs7={pad:function(r,e){var t=e*4;var n=t-r.sigBytes%t;var i=n<<24|n<<16|n<<8|n;var a=[];for(var o=0;o<n;o+=4)a.push(i);var s=c.create(a,n);r.concat(s)},unpad:function(r){var e=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=e}};var g=e.BlockCipher=u.extend({cfg:u.cfg.extend({mode:_,padding:y}),reset:function(){u.reset.call(this);var r=this.cfg;var e=r.iv;var t=r.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else{var n=t.createDecryptor;this._minBufferSize=1}if(this._mode&&this._mode.__creator==n)this._mode.init(this,e&&e.words);else{this._mode=n.call(t,this,e&&e.words);this._mode.__creator=n}},_doProcessBlock:function(r,e){this._mode.processBlock(r,e)},_doFinalize:function(){var r=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){r.pad(this._data,this.blockSize);var e=this._process(!!"flush")}else{var e=this._process(!!"flush");r.unpad(e)}return e},blockSize:128/32});var k=e.CipherParams=t.extend({init:function(r){this.mixIn(r)},toString:function(r){return(r||this.formatter).stringify(this)}});var x=r.format={};var B=x.OpenSSL={stringify:function(r){var e=r.ciphertext;var t=r.salt;if(t)var n=c.create([1398893684,1701076831]).concat(t).concat(e);else var n=e;return n.toString(s)},parse:function(r){var e=s.parse(r);var t=e.words;if(t[0]==1398893684&&t[1]==1701076831){var n=c.create(t.slice(2,4));t.splice(0,4);e.sigBytes-=16}return k.create({ciphertext:e,salt:n})}};var m=e.SerializableCipher=t.extend({cfg:t.extend({format:B}),encrypt:function(r,e,t,n){n=this.cfg.extend(n);var i=r.createEncryptor(t,n);var a=i.finalize(e);var o=i.cfg;return k.create({ciphertext:a,key:t,iv:o.iv,algorithm:r,mode:o.mode,padding:o.padding,blockSize:r.blockSize,formatter:n.format})},decrypt:function(r,e,t,n){n=this.cfg.extend(n);e=this._parse(e,n.format);var i=r.createDecryptor(t,n).finalize(e.ciphertext);return i},_parse:function(r,e){if(typeof r=="string")return e.parse(r,this);else return r}});var w=r.kdf={};var b=w.OpenSSL={execute:function(r,e,t,n){if(!n)n=c.random(64/8);var i=f.create({keySize:e+t}).compute(r,n);var a=c.create(i.words.slice(e),t*4);i.sigBytes=e*4;return k.create({key:i,iv:a,salt:n})}};var S=e.PasswordBasedCipher=m.extend({cfg:m.cfg.extend({kdf:b}),encrypt:function(r,e,t,n){n=this.cfg.extend(n);var i=n.kdf.execute(t,r.keySize,r.ivSize);n.iv=i.iv;var a=m.encrypt.call(this,r,e,i.key,n);a.mixIn(i);return a},decrypt:function(r,e,t,n){n=this.cfg.extend(n);e=this._parse(e,n.format);var i=n.kdf.execute(t,r.keySize,r.ivSize,e.salt);n.iv=i.iv;var a=m.decrypt.call(this,r,e,i.key,n);return a}})}()}(t(0),t(5))},function(r,e,t){r.exports=function(a){return function(){var r=a;var e=r.lib;var t=e.BlockCipher;var n=r.algo;var f=[];var v=[];var u=[];var h=[];var p=[];var l=[];var _=[];var d=[];var y=[];var g=[];(function(){var r=[];for(var e=0;e<256;e++)if(e<128)r[e]=e<<1;else r[e]=e<<1^283;var t=0;var n=0;for(var e=0;e<256;e++){var i=n^n<<1^n<<2^n<<3^n<<4;i=i>>>8^i&255^99;f[t]=i;v[i]=t;var a=r[t];var o=r[a];var s=r[o];var c=r[i]*257^i*16843008;u[t]=c<<24|c>>>8;h[t]=c<<16|c>>>16;p[t]=c<<8|c>>>24;l[t]=c;var c=s*16843009^o*65537^a*257^t*16843008;_[i]=c<<24|c>>>8;d[i]=c<<16|c>>>16;y[i]=c<<8|c>>>24;g[i]=c;if(!t)t=n=1;else{t=a^r[r[r[s^a]]];n^=r[r[n]]}}})();var k=[0,1,2,4,8,16,32,64,128,27,54];var i=n.AES=t.extend({_doReset:function(){if(this._nRounds&&this._keyPriorReset===this._key)return;var r=this._keyPriorReset=this._key;var e=r.words;var t=r.sigBytes/4;var n=this._nRounds=t+6;var i=(n+1)*4;var a=this._keySchedule=[];for(var o=0;o<i;o++)if(o<t)a[o]=e[o];else{var s=a[o-1];if(!(o%t)){s=s<<8|s>>>24;s=f[s>>>24]<<24|f[s>>>16&255]<<16|f[s>>>8&255]<<8|f[s&255];s^=k[o/t|0]<<24}else if(t>6&&o%t==4)s=f[s>>>24]<<24|f[s>>>16&255]<<16|f[s>>>8&255]<<8|f[s&255];a[o]=a[o-t]^s}var c=this._invKeySchedule=[];for(var v=0;v<i;v++){var o=i-v;if(v%4)var s=a[o];else var s=a[o-4];if(v<4||o<=4)c[v]=s;else c[v]=_[f[s>>>24]]^d[f[s>>>16&255]]^y[f[s>>>8&255]]^g[f[s&255]]}},encryptBlock:function(r,e){this._doCryptBlock(r,e,this._keySchedule,u,h,p,l,f)},decryptBlock:function(r,e){var t=r[e+1];r[e+1]=r[e+3];r[e+3]=t;this._doCryptBlock(r,e,this._invKeySchedule,_,d,y,g,v);var t=r[e+1];r[e+1]=r[e+3];r[e+3]=t},_doCryptBlock:function(r,e,t,n,i,a,o,s){var c=this._nRounds;var v=r[e]^t[0];var f=r[e+1]^t[1];var u=r[e+2]^t[2];var h=r[e+3]^t[3];var p=4;for(var l=1;l<c;l++){var _=n[v>>>24]^i[f>>>16&255]^a[u>>>8&255]^o[h&255]^t[p++];var d=n[f>>>24]^i[u>>>16&255]^a[h>>>8&255]^o[v&255]^t[p++];var y=n[u>>>24]^i[h>>>16&255]^a[v>>>8&255]^o[f&255]^t[p++];var g=n[h>>>24]^i[v>>>16&255]^a[f>>>8&255]^o[u&255]^t[p++];v=_;f=d;u=y;h=g}var _=(s[v>>>24]<<24|s[f>>>16&255]<<16|s[u>>>8&255]<<8|s[h&255])^t[p++];var d=(s[f>>>24]<<24|s[u>>>16&255]<<16|s[h>>>8&255]<<8|s[v&255])^t[p++];var y=(s[u>>>24]<<24|s[h>>>16&255]<<16|s[v>>>8&255]<<8|s[f&255])^t[p++];var g=(s[h>>>24]<<24|s[v>>>16&255]<<16|s[f>>>8&255]<<8|s[u&255])^t[p++];r[e]=_;r[e+1]=d;r[e+2]=y;r[e+3]=g},keySize:256/32});r.AES=t._createHelper(i)}(),a.AES}(t(0),(t(10),t(11),t(5),t(1)))},function(r,e,t){r.exports=function(e){return e.mode.ECB=function(){var r=e.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(r,e){this._cipher.encryptBlock(r,e)}});r.Decryptor=r.extend({processBlock:function(r,e){this._cipher.decryptBlock(r,e)}});return r}(),e.mode.ECB}(t(0),t(1))},function(r,e,t){r.exports=function(r){return r.enc.Utf8}(t(0))},function(r,e,t){r.exports=function(o){return function(){var r=o;var e=r.lib;var t=e.Base;var f=e.WordArray;var n=r.algo;var i=n.MD5;var a=n.EvpKDF=t.extend({cfg:t.extend({keySize:128/32,hasher:i,iterations:1}),init:function(r){this.cfg=this.cfg.extend(r)},compute:function(r,e){var t=this.cfg;var n=t.hasher.create();var i=f.create();var a=i.words;var o=t.keySize;var s=t.iterations;while(a.length<o){if(c)n.update(c);var c=n.update(r).finalize(e);n.reset();for(var v=1;v<s;v++){c=n.finalize(c);n.reset()}i.concat(c)}i.sigBytes=o*4;return i}});r.EvpKDF=function(r,e,t){return a.create(t).compute(r,e)}}(),o.EvpKDF}(t(0),(t(12),t(13)))},function(r,e,t){r.exports=function(r){return r.pad.Pkcs7}(t(0),t(1))},function(r,e,t){r.exports=function(r){return r.pad.NoPadding={pad:function(){},unpad:function(){}},r.pad.NoPadding}(t(0),t(1))},function(r,e,t){r.exports=function(a){return function(){if(typeof ArrayBuffer!="function")return;var r=a;var e=r.lib;var t=e.WordArray;var i=t.init;var n=t.init=function(r){if(r instanceof ArrayBuffer)r=new Uint8Array(r);if(r instanceof Int8Array||typeof Uint8ClampedArray!=="undefined"&&r instanceof Uint8ClampedArray||r instanceof Int16Array||r instanceof Uint16Array||r instanceof Int32Array||r instanceof Uint32Array||r instanceof Float32Array||r instanceof Float64Array)r=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);if(r instanceof Uint8Array){var e=r.byteLength;var t=[];for(var n=0;n<e;n++)t[n>>>2]|=r[n]<<24-n%4*8;i.call(this,t,e)}else i.apply(this,arguments)};n.prototype=t}(),a.lib.WordArray}(t(0))},function(r,e,t){"use strict";t.r(e);var e=t(2),o=t.n(e),e=t(3),s=t.n(e),e=t(6),c=t.n(e),e=t(7),v=t.n(e),e=t(8),f=t.n(e),e=t(4),u=t.n(e);function crc32(r,e){for(var t=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],n=("undefined"!=typeof Int32Array&&(t=new Int32Array(t)),-1^~~e),i=(r=new Uint8Array(r)).length,a=0;a<i;a++)n=t[255&(n^r[a])]^n>>>8;return(-1^n)>>>0}function dec2hex(r){if(void 0!==r)return function toEight(r){return r.length<8?toEight(r="0".concat(r)):r}(Number(r).toString(16))}self.onmessage=function(r){var r=r.data,e=r[0],t=r[1],n=r[2],i=r[3],a=r[4],r=r[5];i?(i=f.a.create(e),i=crc32(r=function wordArrayToUint8Array(r){for(var e=r.sigBytes,t=r.words,n=new Uint8Array(e),i=0,a=0;i!==e;){var o=t[a++];if(n[i++]=(4278190080&o)>>>24,i===e)break;if(n[i++]=(16711680&o)>>>16,i===e)break;if(n[i++]=(65280&o)>>>8,i===e)break;n[i++]=255&o}return n}((r&&e.byteLength%16!=0?o.a.encrypt(i,u.a.parse(a),{mode:s.a,padding:c.a}):o.a.encrypt(i,u.a.parse(a),{mode:s.a,padding:v.a})).ciphertext),0),postMessage([r.buffer,dec2hex(i),t,n],[r.buffer])):(a=crc32(e,0),postMessage([e,dec2hex(a),t,n],[e]))}},function(r,e,t){r.exports=function(i){return function(){var r=i;var e=r.lib;var c=e.WordArray;var t=r.enc;var n=t.Base64={stringify:function(r){var e=r.words;var t=r.sigBytes;var n=this._map;r.clamp();var i=[];for(var a=0;a<t;a+=3){var o=e[a>>>2]>>>24-a%4*8&255;var s=e[a+1>>>2]>>>24-(a+1)%4*8&255;var c=e[a+2>>>2]>>>24-(a+2)%4*8&255;var v=o<<16|s<<8|c;for(var f=0;f<4&&a+f*.75<t;f++)i.push(n.charAt(v>>>6*(3-f)&63))}var u=n.charAt(64);if(u)while(i.length%4)i.push(u);return i.join("")},parse:function(r){var e=r.length;var t=this._map;var n=this._reverseMap;if(!n){n=this._reverseMap=[];for(var i=0;i<t.length;i++)n[t.charCodeAt(i)]=i}var a=t.charAt(64);if(a){var o=r.indexOf(a);if(o!==-1)e=o}return parseLoop(r,e,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function parseLoop(r,e,t){var n=[];var i=0;for(var a=0;a<e;a++)if(a%4){var o=t[r.charCodeAt(a-1)]<<a%4*2;var s=t[r.charCodeAt(a)]>>>6-a%4*2;n[i>>>2]|=(o|s)<<24-i%4*8;i++}return c.create(n,i)}}(),i.enc.Base64}(t(0))},function(r,e,t){r.exports=function(o){return function(f){var r=o;var e=r.lib;var t=e.WordArray;var n=e.Hasher;var i=r.algo;var F=[];(function(){for(var r=0;r<64;r++)F[r]=f.abs(f.sin(r+1))*4294967296|0})();var a=i.MD5=n.extend({_doReset:function(){this._hash=new t.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(r,e){for(var t=0;t<16;t++){var n=e+t;var i=r[n];r[n]=(i<<8|i>>>24)&16711935|(i<<24|i>>>8)&4278255360}var a=this._hash.words;var o=r[e+0];var s=r[e+1];var c=r[e+2];var v=r[e+3];var f=r[e+4];var u=r[e+5];var h=r[e+6];var p=r[e+7];var l=r[e+8];var _=r[e+9];var d=r[e+10];var y=r[e+11];var g=r[e+12];var k=r[e+13];var x=r[e+14];var B=r[e+15];var m=a[0];var w=a[1];var b=a[2];var S=a[3];m=FF(m,w,b,S,o,7,F[0]);S=FF(S,m,w,b,s,12,F[1]);b=FF(b,S,m,w,c,17,F[2]);w=FF(w,b,S,m,v,22,F[3]);m=FF(m,w,b,S,f,7,F[4]);S=FF(S,m,w,b,u,12,F[5]);b=FF(b,S,m,w,h,17,F[6]);w=FF(w,b,S,m,p,22,F[7]);m=FF(m,w,b,S,l,7,F[8]);S=FF(S,m,w,b,_,12,F[9]);b=FF(b,S,m,w,d,17,F[10]);w=FF(w,b,S,m,y,22,F[11]);m=FF(m,w,b,S,g,7,F[12]);S=FF(S,m,w,b,k,12,F[13]);b=FF(b,S,m,w,x,17,F[14]);w=FF(w,b,S,m,B,22,F[15]);m=GG(m,w,b,S,s,5,F[16]);S=GG(S,m,w,b,h,9,F[17]);b=GG(b,S,m,w,y,14,F[18]);w=GG(w,b,S,m,o,20,F[19]);m=GG(m,w,b,S,u,5,F[20]);S=GG(S,m,w,b,d,9,F[21]);b=GG(b,S,m,w,B,14,F[22]);w=GG(w,b,S,m,f,20,F[23]);m=GG(m,w,b,S,_,5,F[24]);S=GG(S,m,w,b,x,9,F[25]);b=GG(b,S,m,w,v,14,F[26]);w=GG(w,b,S,m,l,20,F[27]);m=GG(m,w,b,S,k,5,F[28]);S=GG(S,m,w,b,c,9,F[29]);b=GG(b,S,m,w,p,14,F[30]);w=GG(w,b,S,m,g,20,F[31]);m=HH(m,w,b,S,u,4,F[32]);S=HH(S,m,w,b,l,11,F[33]);b=HH(b,S,m,w,y,16,F[34]);w=HH(w,b,S,m,x,23,F[35]);m=HH(m,w,b,S,s,4,F[36]);S=HH(S,m,w,b,f,11,F[37]);b=HH(b,S,m,w,p,16,F[38]);w=HH(w,b,S,m,d,23,F[39]);m=HH(m,w,b,S,k,4,F[40]);S=HH(S,m,w,b,o,11,F[41]);b=HH(b,S,m,w,v,16,F[42]);w=HH(w,b,S,m,h,23,F[43]);m=HH(m,w,b,S,_,4,F[44]);S=HH(S,m,w,b,g,11,F[45]);b=HH(b,S,m,w,B,16,F[46]);w=HH(w,b,S,m,c,23,F[47]);m=II(m,w,b,S,o,6,F[48]);S=II(S,m,w,b,p,10,F[49]);b=II(b,S,m,w,x,15,F[50]);w=II(w,b,S,m,u,21,F[51]);m=II(m,w,b,S,g,6,F[52]);S=II(S,m,w,b,v,10,F[53]);b=II(b,S,m,w,d,15,F[54]);w=II(w,b,S,m,s,21,F[55]);m=II(m,w,b,S,l,6,F[56]);S=II(S,m,w,b,B,10,F[57]);b=II(b,S,m,w,h,15,F[58]);w=II(w,b,S,m,k,21,F[59]);m=II(m,w,b,S,f,6,F[60]);S=II(S,m,w,b,y,10,F[61]);b=II(b,S,m,w,c,15,F[62]);w=II(w,b,S,m,_,21,F[63]);a[0]=a[0]+m|0;a[1]=a[1]+w|0;a[2]=a[2]+b|0;a[3]=a[3]+S|0},_doFinalize:function(){var r=this._data;var e=r.words;var t=this._nDataBytes*8;var n=r.sigBytes*8;e[n>>>5]|=128<<24-n%32;var i=f.floor(t/4294967296);var a=t;e[(n+64>>>9<<4)+15]=(i<<8|i>>>24)&16711935|(i<<24|i>>>8)&4278255360;e[(n+64>>>9<<4)+14]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;r.sigBytes=(e.length+1)*4;this._process();var o=this._hash;var s=o.words;for(var c=0;c<4;c++){var v=s[c];s[c]=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360}return o},clone:function(){var r=n.clone.call(this);r._hash=this._hash.clone();return r}});function FF(r,e,t,n,i,a,o){var s=r+(e&t|~e&n)+i+o;return(s<<a|s>>>32-a)+e}function GG(r,e,t,n,i,a,o){var s=r+(e&n|t&~n)+i+o;return(s<<a|s>>>32-a)+e}function HH(r,e,t,n,i,a,o){var s=r+(e^t^n)+i+o;return(s<<a|s>>>32-a)+e}function II(r,e,t,n,i,a,o){var s=r+(t^(e|~n))+i+o;return(s<<a|s>>>32-a)+e}r.MD5=n._createHelper(a);r.HmacMD5=n._createHmacHelper(a)}(Math),o.MD5}(t(0))},function(r,e,t){r.exports=function(o){return function(){var r=o;var e=r.lib;var t=e.WordArray;var n=e.Hasher;var i=r.algo;var u=[];var a=i.SHA1=n.extend({_doReset:function(){this._hash=new t.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(r,e){var t=this._hash.words;var n=t[0];var i=t[1];var a=t[2];var o=t[3];var s=t[4];for(var c=0;c<80;c++){if(c<16)u[c]=r[e+c]|0;else{var v=u[c-3]^u[c-8]^u[c-14]^u[c-16];u[c]=v<<1|v>>>31}var f=(n<<5|n>>>27)+s+u[c];if(c<20)f+=(i&a|~i&o)+1518500249;else if(c<40)f+=(i^a^o)+1859775393;else if(c<60)f+=(i&a|i&o|a&o)-1894007588;else f+=(i^a^o)-899497514;s=o;o=a;a=i<<30|i>>>2;i=n;n=f}t[0]=t[0]+n|0;t[1]=t[1]+i|0;t[2]=t[2]+a|0;t[3]=t[3]+o|0;t[4]=t[4]+s|0},_doFinalize:function(){var r=this._data;var e=r.words;var t=this._nDataBytes*8;var n=r.sigBytes*8;e[n>>>5]|=128<<24-n%32;e[(n+64>>>9<<4)+14]=Math.floor(t/4294967296);e[(n+64>>>9<<4)+15]=t;r.sigBytes=e.length*4;this._process();return this._hash},clone:function(){var r=n.clone.call(this);r._hash=this._hash.clone();return r}});r.SHA1=n._createHelper(a);r.HmacSHA1=n._createHmacHelper(a)}(),o.SHA1}(t(0))},function(r,e,t){r.exports=function(o){(function(){var r=o;var e=r.lib;var t=e.Base;var n=r.enc;var v=n.Utf8;var i=r.algo;var a=i.HMAC=t.extend({init:function(r,e){r=this._hasher=new r.init;if(typeof e=="string")e=v.parse(e);var t=r.blockSize;var n=t*4;if(e.sigBytes>n)e=r.finalize(e);e.clamp();var i=this._oKey=e.clone();var a=this._iKey=e.clone();var o=i.words;var s=a.words;for(var c=0;c<t;c++){o[c]^=1549556828;s[c]^=909522486}i.sigBytes=a.sigBytes=n;this.reset()},reset:function(){var r=this._hasher;r.reset();r.update(this._iKey)},update:function(r){this._hasher.update(r);return this},finalize:function(r){var e=this._hasher;var t=e.finalize(r);e.reset();var n=e.finalize(this._oKey.clone().concat(t));return n}})})()}(t(0))}]);',null)}},function(e,t,r){e.exports=function(){var e=e||function(e,t){var r=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),n={},i=n.lib={},o=i.Base={extend:function(e){var t=r(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=i.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,i=e.sigBytes;if(this.clamp(),n%4)for(var o=0;o<i;o++){var a=r[o>>>2]>>>24-o%4*8&255;t[n+o>>>2]|=a<<24-(n+o)%4*8}else for(o=0;o<i;o+=4)t[n+o>>>2]=r[o>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var r,n=[],i=function(t){var r=987654321,n=4294967295;return function(){var i=((r=36969*(65535&r)+(r>>16)&n)<<16)+(t=18e3*(65535&t)+(t>>16)&n)&n;return i/=4294967296,(i+=.5)*(e.random()>.5?1:-1)}},o=0;o<t;o+=4){var s=i(4294967296*(r||e.random()));r=987654071*s(),n.push(4294967296*s()|0)}return new a.init(n,t)}}),s=n.enc={},c=s.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new a.init(r,t/2)}},u=s.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new a.init(r,t)}},l=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},f=i.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r=this._data,n=r.words,i=r.sigBytes,o=this.blockSize,s=i/(4*o),c=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*o,u=e.min(4*c,i);if(c){for(var l=0;l<c;l+=o)this._doProcessBlock(n,l);var f=n.splice(0,c);r.sigBytes-=u}return new a.init(f,u)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),h=(i.Hasher=f.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new h.HMAC.init(e,r).finalize(t)}}}),n.algo={});return n}(Math);return e}()},function(e,t,r){var n;e.exports=(n=r(3),function(e){var t=n,r=t.lib,i=r.WordArray,o=r.Hasher,a=t.algo,s=[],c=[];!function(){function t(t){for(var r=e.sqrt(t),n=2;n<=r;n++)if(!(t%n))return!1;return!0}function r(e){return 4294967296*(e-(0|e))|0}for(var n=2,i=0;i<64;)t(n)&&(i<8&&(s[i]=r(e.pow(n,.5))),c[i]=r(e.pow(n,1/3)),i++),n++}();var u=[],l=a.SHA256=o.extend({_doReset:function(){this._hash=new i.init(s.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],l=r[5],f=r[6],h=r[7],p=0;p<64;p++){if(p<16)u[p]=0|e[t+p];else{var d=u[p-15],g=(d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3,y=u[p-2],m=(y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10;u[p]=g+u[p-7]+m+u[p-16]}var v=n&i^n&o^i&o,b=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),_=h+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&l^~s&f)+c[p]+u[p];h=f,f=l,l=s,s=a+_|0,a=o,o=i,i=n,n=_+(b+v)|0}r[0]=r[0]+n|0,r[1]=r[1]+i|0,r[2]=r[2]+o|0,r[3]=r[3]+a|0,r[4]=r[4]+s|0,r[5]=r[5]+l|0,r[6]=r[6]+f|0,r[7]=r[7]+h|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return r[i>>>5]|=128<<24-i%32,r[14+(i+64>>>9<<4)]=e.floor(n/4294967296),r[15+(i+64>>>9<<4)]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=o._createHelper(l),t.HmacSHA256=o._createHmacHelper(l)}(Math),n.SHA256)},function(e,t,r){e.exports=function(e){return e.HmacSHA256}(r(3),(r(4),r(6)))},function(e,t,r){var n;e.exports=(n=r(3),void function(){var e=n,t=e.lib.Base,r=e.enc.Utf8;e.algo.HMAC=t.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=r.parse(t));var n=e.blockSize,i=4*n;t.sigBytes>i&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),a=this._iKey=t.clone(),s=o.words,c=a.words,u=0;u<n;u++)s[u]^=1549556828,c[u]^=909522486;o.sigBytes=a.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,r=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(r))}})}())},function(e,t){var r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";var n=window.URL||window.webkitURL;e.exports=function(t,r){try{try{var i;try{(i=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(t),i=i.getBlob()}catch(e){i=new Blob([t])}return new Worker(n.createObjectURL(i))}catch(e){return new Worker("data:application/javascript,"+encodeURIComponent(t))}}catch(e){if(r)return new Worker(r);throw Error("Inline worker is not supported")}}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return jr})),t=r(0);var n=r.n(t),i="{tosDomain}/upload/v1/{oid}?uploadid={uploadId}&part_number={part_number}&phase=transfer",o="{tosDomain}/upload/v1/{oid}",a={debug:!1,region:"cn-north-1",external:{},getSliceFunc:null,uploadSliceCount:3,retryUploadTime:2,retryProcess:!0,retryProcessTime:3,retryTaskTime:2,progressMonitorTime:10,progressMonitorSpeed:50,schema:"https",replace:{}},s=function(){return(s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function c(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}(arguments[t]));return e}function u(e){return null!=e&&"[object Object]"==Object.prototype.toString.call(e)}function l(e){return function(e){if("string"==typeof e){for(var t=[],r=String.fromCharCode(122),n=e.split(r),i=0;i<n.length;i++){var o=64^+parseInt(n[i],25);o=String.fromCharCode(o),t.push(o)}return t.join("")}}(e)}function f(e){var t=document.createElement("a");return t.href=e,t}function h(e){var t={};try{f(e).search.slice(1).split("&").forEach((function(e){var r,n,i=e.split("=");i.length&&(r=i[0],n=i[1]);try{t[r]=decodeURIComponent(void 0===n?"":n)}catch(e){t[r]=n}}))}catch(e){}return t}function p(e){for(var t=0,r=0,n=(e+="").length,i=0;i<n;i++)(0x7fffffffffff<(t=31*t+e.charCodeAt(r++))||t<-0x800000000000)&&(t&=0xffffffffffff);return t<0&&(t+=0x7ffffffffffff),t}function d(e,t){try{return b.get(e,{domain:t||document.domain})}catch(e){return""}}function g(e,t,r,n){try{var i=n||document.domain,o=+new Date+(r||6048e5);b.set(e,t,{expires:new Date(o),path:"/",domain:i})}catch(e){}}var y,m,v=function(){function e(){this._hooks={},this._cache=[],this._hooksCache={}}return e.prototype.on=function(e,t){e&&t&&"function"==typeof t&&(this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t))},e.prototype.once=function(e,t){var r=this;e&&t&&"function"==typeof t&&this.on(e,(function n(i){t(i),r.off(e,n)}))},e.prototype.off=function(e,t){e&&this._hooks[e]&&this._hooks[e].length&&(t?-1!==(t=this._hooks[e].indexOf(t))&&this._hooks[e].splice(t,1):this._hooks[e]=[])},e.prototype.emit=function(e,t,r){r?e&&(-1!==this._cache.indexOf(r)?this._emit(e,t):(this._hooksCache.hasOwnProperty(r)||(this._hooksCache[r]={}),this._hooksCache[r].hasOwnProperty(e)||(this._hooksCache[r][e]=[]),this._hooksCache[r][e].push(t))):this._emit(e,t)},e.prototype._emit=function(e,t){e&&this._hooks[e]&&this._hooks[e].length&&c(this._hooks[e]).forEach((function(e){try{e(t)}catch(e){}}))},e.prototype.set=function(e){e&&-1===this._cache.indexOf(e)&&this._cache.push(e)},e}(),b=(y=+Date.now()+Number((""+Math.random()).slice(2,8)),(t={exports:{}}).exports=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var r,n=arguments[e];for(r in n)t[r]=n[r]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function r(n){function i(){}function o(t,r,o){if("undefined"!=typeof document){"number"==typeof(o=e({path:"/"},i.defaults,o)).expires&&(o.expires=new Date(+new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var a=JSON.stringify(r);/^[\{\[]/.test(a)&&(r=a)}catch(e){}r=n.write?n.write(r,t):encodeURIComponent(String(r)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s,c="";for(s in o)o[s]&&(c+="; "+s,!0!==o[s])&&(c+="="+o[s].split(";")[0]);return document.cookie=t+"="+r+c}}function a(e,r){if("undefined"!=typeof document){for(var i={},o=document.cookie?document.cookie.split("; "):[],a=0;a<o.length;a++){var s=o[a].split("="),c=s.slice(1).join("=");r||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=t(s[0]);if(c=(n.read||n)(c,u)||t(c),r)try{c=JSON.parse(c)}catch(e){}if(i[u]=c,e===u)break}catch(e){}}return e?i[e]:i}}return i.set=o,i.get=function(e){return a(e,!1)},i.getJSON=function(e){return a(e,!0)},i.remove=function(t,r){o(t,"",e(r,{expires:-1}))},i.defaults={},i.withConverter=r,i}((function(){}))}(),t.exports),_=function(){function e(){this.cache={}}return e.prototype.setItem=function(e,t){this.cache[e]=t},e.prototype.getItem=function(e){return this.cache[e]},e.prototype.removeItem=function(e){this.cache[e]=void 0},e.prototype.getCookie=function(e,t){return d(e,t)},e.prototype.setCookie=function(e,t,r,n){g(e,t,r,n)},e}(),w={getItem:function(e){try{var t=localStorage.getItem(e),r=t;try{t&&"string"==typeof t&&(r=JSON.parse(t))}catch(e){}return r||{}}catch(e){}return{}},setItem:function(e,t){try{var r="string"==typeof t?t:JSON.stringify(t);localStorage.setItem(e,r)}catch(e){}},removeItem:function(e){try{localStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){return d(e,t)},setCookie:function(e,t,r,n){g(e,t,r,n)},isSupportLS:function(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}()},S={getItem:function(e){try{var t=sessionStorage.getItem(e),r=t;try{t&&"string"==typeof t&&(r=JSON.parse(t))}catch(e){}return r||{}}catch(e){}return{}},setItem:function(e,t){try{var r="string"==typeof t?t:JSON.stringify(t);sessionStorage.setItem(e,r)}catch(e){}},removeItem:function(e){try{sessionStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){return d(e,t)},setCookie:function(e,t,r,n){g(e,t,r,n)},isSupportSession:function(){try{return sessionStorage.setItem("_ranger-test-key","hi"),sessionStorage.getItem("_ranger-test-key"),sessionStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}()},k=function(){function e(e,t){this._storage=t&&"session"===t?S:!e&&w.isSupportLS?w:new _}return e.prototype.getItem=function(e){return this._storage.getItem(e)},e.prototype.setItem=function(e,t){this._storage.setItem(e,t)},e.prototype.getCookie=function(e,t){return this._storage.getCookie(e,t)},e.prototype.setCookie=function(e,t,r,n){this._storage.setCookie(e,t,r,n)},e.prototype.removeItem=function(e){this._storage.removeItem(e)},e}(),x=function(){function e(e,t,r){this.appid=e,this.domain=t,this.userAgent=window.navigator.userAgent,this.appVersion=window.navigator.appVersion,this.cookie_expire=r}return e.prototype.init=function(){var e=window.navigator.userAgent,t=window.navigator.language,r=document.referrer,n=r?f(r).hostname:"",i=h(window.location.href),o=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(this.appVersion)?"wap":"web",a=(this.utm=function(e,t,r,n){var i=new k(!1),o=new k(!1,"session"),a=e?"_tea_utm_cache_"+e:"_tea_utm_cache",s=e?"_$utm_from_url_"+e:"_$utm_from_url",c={},u=["tr_shareuser","tr_admaster","tr_param1","tr_param2","tr_param3","tr_param4","$utm_from_url"],l={ad_id:Number(t.ad_id)||void 0,campaign_id:Number(t.campaign_id)||void 0,creative_id:Number(t.creative_id)||void 0,utm_source:t.utm_source,utm_medium:t.utm_medium,utm_campaign:t.utm_campaign,utm_term:t.utm_term,utm_content:t.utm_content,tr_shareuser:t.tr_shareuser,tr_admaster:t.tr_admaster,tr_param1:t.tr_param1,tr_param2:t.tr_param2,tr_param3:t.tr_param3,tr_param4:t.tr_param4};try{var f,h,p=!1;for(f in l)l[f]&&(-1!==u.indexOf(f)?(c.hasOwnProperty("tracer_data")||(c.tracer_data={}),c.tracer_data[f]=l[f]):c[f]=l[f],p=!0);p?(o.setItem(s,"1"),i.setCookie(a,JSON.stringify(c),n,r)):(h=i.getCookie(a,r))&&(c=JSON.parse(h)),o.getItem(s)&&(c.hasOwnProperty("tracer_data")||(c.tracer_data={}),c.tracer_data.$utm_from_url=1)}catch(e){return l}return c}(this.appid,i,this.domain,this.cookie_expire),i=this.browser(),this.os());return{browser:i.browser,browser_version:i.browser_version,platform:o,os_name:a.os_name,os_version:a.os_version,userAgent:e,screen_width:window.screen&&window.screen.width,screen_height:window.screen&&window.screen.height,device_model:this.getDeviceModel(a.os_name),language:t,referrer:r,referrer_host:n,utm:this.utm,latest_data:this.last(r,n)}},e.prototype.last=function(e,t){var r="",n="",i="",o=location.hostname,a=!1;return e&&t&&o!==t&&(n=t,a=!0,(o=h(r=e)).keyword)&&(i=o.keyword),{$latest_referrer:r,$latest_referrer_host:n,$latest_search_keyword:i,isLast:a}},e.prototype.browser=function(){var e,t="",r=""+parseFloat(this.appVersion),n=this.userAgent;return-1!==n.indexOf("Edge")||-1!==n.indexOf("Edg")?(t="Microsoft Edge",r=-1!==n.indexOf("Edge")?(e=n.indexOf("Edge"),n.substring(e+5)):(e=n.indexOf("Edg"),n.substring(e+4))):-1!==(e=n.indexOf("MSIE"))?(t="Microsoft Internet Explorer",r=n.substring(e+5)):-1!==(e=n.indexOf("Lark"))?(t="Lark",r=n.substring(e+5,e+11)):-1!==n.indexOf("Chrome")?-1!==(e=n.indexOf("TTWebView"))?(t="TTWebView",r=n.substring(e+10,e+23)):-1===(e=n.indexOf("Chrome"))&&-1===(e=n.indexOf("Chrome"))||(t="Chrome",r=n.substring(e+7)):-1!==n.indexOf("Safari")?-1!==(e=n.indexOf("Safari"))&&(t="Safari",r=n.substring(e+7),-1!==(e=n.indexOf("Version")))&&(r=n.substring(e+8)):-1!==(e=n.indexOf("Firefox"))&&(t="Firefox",r=n.substring(e+8)),{browser:t,browser_version:r=-1!==(n=(r=-1!==(n=(r=-1!==(n=r.indexOf(";"))?r.substring(0,n):r).indexOf(" "))?r.substring(0,n):r).indexOf(")"))?r.substring(0,n):r}},e.prototype.os=function(){for(var e="",t="",r=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0|Windows NT 10.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/}],n=0;n<r.length;n++){var i=r[n];if(i.r.test(this.userAgent)){"Mac OS X"===(e=i.s)&&this.isNewIpad()&&(e="iOS");break}}function o(e,t){return(e=e.exec(t))&&e[1]?e[1]:""}function a(e,t){return(e=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:"+e+")","i").exec(t))?e.slice(1)[0]:""}var s;switch(/Windows/.test(e)&&(t=o(/Windows (.*)/,e),e="windows"),e){case"Mac OS X":t=a("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent),e="mac";break;case"Android":t=o(/Android ([\.\_\d]+)/,s=this.userAgent)||o(/Android\/([\.\_\d]+)/,s),e="android";break;case"iOS":t=this.isNewIpad()?a("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent):(t=/OS (\d+)_(\d+)_?(\d+)?/.exec(this.appVersion))?t[1]+"."+t[2]+"."+(0|t[3]):"",e="ios"}return{os_name:e,os_version:t}},e.prototype.getDeviceModel=function(e){var t,r,n="";try{"android"===e?navigator.userAgent.split(";").forEach((function(e){-1<e.indexOf("Build/")&&(n=e.slice(0,e.indexOf("Build/")))})):"ios"!==e&&"mac"!==e&&"windows"!==e||(n=this.isNewIpad()?"iPad":(r=(t=navigator.userAgent.replace("Mozilla/5.0 (","")).indexOf(";"),t.slice(0,r)))}catch(e){}return n.trim()},e.prototype.isNewIpad=function(){return void 0!==this.userAgent&&"MacIntel"===navigator.platform&&"number"==typeof navigator.maxTouchPoints&&1<navigator.maxTouchPoints},e}(),E={sg:"1fz22z22z1nz21z4mz4bz4bz21z1ez18z1jz1gz49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz18z1jz1gz24z18z49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k"},O={va:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",in:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k"},C={sg:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z21z1ez4az22z1gz1iz22z1mz1iz24z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z24z18z4az22z1gz1iz22z1mz1iz24z4az1az1mz1k",in:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z24z18z49z23z21z1cz18z21z22z4ez18z4az22z1gz1iz22z1mz1iz24z4az1az1mz1k"},T={sg:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az23z21z4az22z1gz1iz22z1mz1iz24z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az23z21z4az22z1gz1iz22z1mz1iz4az1az1mz1k"},D="5.0.30_oversea",j=function(){function e(e,t){this.collector=e,this.config=t,this.eventNameWhiteList=["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure"],this.paramsNameWhiteList=["$inactive","$inline","$target_uuid_list","$source_uuid","$is_spider","$source_id","$is_first_time","_staging_flag"],this.regStr=new RegExp("^[a-zA-Z0-9][a-z0-9A-Z_.-]{1,255}$")}return e.prototype.checkVerify=function(e){var t,r,n,i=this;return!!(e&&e.length&&(e=e[0])&&(t=e.events,r=e.header,t)&&t.length)&&(n=!0,t.forEach((function(e){e?(i.checkEventName(e.event)||(n=!1,e.checkEvent="\u4e8b\u4ef6\u540d\u4e0d\u80fd\u4ee5 $ or __\u5f00\u5934"),i.checkEventParams(e.params)||(n=!1,e.checkParams="\u5c5e\u6027\u540d\u4e0d\u80fd\u4ee5 $ or __\u5f00\u5934")):(n=!1,e.checkEvent="\u4e8b\u4ef6\u5f02\u5e38")})),n=!!this.checkEventParams(r)&&n)},e.prototype.checkEventName=function(e){return!!e&&this.calculate(e,"event")},e.prototype.checkEventParams=function(e){var t=e;if("string"==typeof e&&(t=JSON.parse(t)),Object.keys(t).length)for(var r in t)return!(!this.calculate(r,"params")||"string"==typeof t[r]&&1024<t[r].length&&(console.warn("params: "+r+" can not over 1024 byte, please check;"),1));return!0},e.prototype.calculate=function(e,t){return-1!==("event"===t?this.eventNameWhiteList:this.paramsNameWhiteList).indexOf(e)||!new RegExp("^\\$").test(e)&&!new RegExp("^__").test(e)||(console.warn(("event"===t?"event":"params")+" name: "+e+" can not start with $ or __, pleace check;"),!1)},e}(),A=(function(e){e.Init="init",e.Config="config",e.Start="start",e.Ready="ready",e.TokenComplete="token-complete",e.TokenStorage="token-storage",e.TokenFetch="token-fetch",e.TokenError="token-error",e.ConfigUuid="config-uuid",e.ConfigWebId="config-webid",e.ConfigDomain="config-domain",e.CustomWebId="custom-webid",e.TokenChange="token-change",e.TokenReset="token-reset",e.ConfigTransform="config-transform",e.EnvTransform="env-transform",e.SessionReset="session-reset",e.SessionResetTime="session-reset-time",e.Event="event",e.Events="events",e.EventNow="event-now",e.CleanEvents="clean-events",e.BeconEvent="becon-event",e.SubmitBefore="submit-before",e.SubmitScuess="submit-scuess",e.SubmitAfter="submit-after",e.SubmitError="submit-error",e.SubmitVerify="submit-verify",e.Stay="stay",e.ResetStay="reset-stay",e.StayReady="stay-ready",e.SetStay="set-stay",e.RouteChange="route-change",e.RouteReady="route-ready",e.Ab="ab",e.AbVar="ab-var",e.AbAllVars="ab-all-vars",e.AbConfig="ab-config",e.AbExternalVersion="ab-external-version",e.AbVersionChangeOn="ab-version-change-on",e.AbVersionChangeOff="ab-version-change-off",e.AbOpenLayer="ab-open-layer",e.AbCloseLayer="ab-close-layer",e.AbReady="ab-ready",e.AbComplete="ab-complete",e.AbTimeout="ab-timeout",e.Profile="profile",e.ProfileSet="profile-set",e.ProfileSetOnce="profile-set-once",e.ProfileUnset="profile-unset",e.ProfileIncrement="profile-increment",e.ProfileAppend="profile-append",e.ProfileClear="profile-clear",e.Autotrack="autotrack",e.AutotrackReady="autotrack-ready",e.CepReady="cep-ready",e.TracerReady="tracer-ready",e.sessionRecord="session-record",e.SessionRecordStart="session-record-start",e.SessionRecordPause="session-record-pause",e.SessionRecordEnd="session-record-end",e.SessionRecordReport="session-record-report"}(Z=Z||{}),function(e){e.DEBUGGER_MESSAGE="debugger-message",e.DEBUGGER_MESSAGE_SDK="debugger-message-sdk",e.DEBUGGER_MESSAGE_FETCH="debugger-message-fetch",e.DEBUGGER_MESSAGE_FETCH_RESULT="debugger-message-fetch-result",e.DEBUGGER_MESSAGE_EVENT="debugger-message-event",e.DEVTOOL_WEB_READY="devtool-web-ready"}(m=m||{}),Z),P=void 0,I=(t=(new Date).getTimezoneOffset(),parseInt(""+-t/60,10)),z=60*t,R=function(){function e(e,t){this.is_first_time=!0,this.configPersist=!1,this.initConfig=t,this.collect=e;var r=new x(t.app_id,t.cookie_domain||"",t.cookie_expire||6048e5).init();this.eventCheck=new j(e,t),e="__tea_cache_first_"+t.app_id,this.configKey="__tea_cache_config_"+t.app_id,this.sessionStorage=new k(!1,"session"),this.localStorage=new k(!1,"local"),this.channelUrl="tcpy"===t.channel_type||"ttp"===t.channel_type?{WEBID_URL:"/v1/user/webid",TOB_URL:"",REPORT_URL:"/v1/list"}:{WEBID_URL:"/webid",TOB_URL:"/tobid",REPORT_URL:"/list"},t.configPersist&&(this.configPersist=!0,this.storage=1===t.configPersist?this.sessionStorage:this.localStorage),(t=this.localStorage.getItem(e))&&1==t?this.is_first_time=!1:(this.is_first_time=!0,this.localStorage.setItem(e,"1")),this.envInfo={user:{user_unique_id:P,user_type:P,user_id:P,user_is_auth:P,user_is_login:P,device_id:P,web_id:P,ip_addr_id:P,user_unique_id_type:P},header:{app_id:P,app_name:P,app_install_id:P,install_id:P,app_package:P,app_channel:P,app_version:P,ab_version:P,os_name:r.os_name,os_version:r.os_version,device_model:r.device_model,ab_client:P,traffic_type:P,client_ip:P,device_brand:P,os_api:P,access:P,language:r.language,region:P,app_language:P,app_region:P,creative_id:r.utm.creative_id,ad_id:r.utm.ad_id,campaign_id:r.utm.campaign_id,log_type:P,rnd:P,platform:r.platform,sdk_version:D,sdk_lib:"js",province:P,city:P,timezone:I,tz_offset:z,tz_name:P,sim_region:P,carrier:P,resolution:r.screen_width+"x"+r.screen_height,browser:r.browser,browser_version:r.browser_version,referrer:r.referrer,referrer_host:r.referrer_host,width:r.screen_width,height:r.screen_height,screen_width:r.screen_width,screen_height:r.screen_height,utm_term:r.utm.utm_term,utm_content:r.utm.utm_content,utm_source:r.utm.utm_source,utm_medium:r.utm.utm_medium,utm_campaign:r.utm.utm_campaign,tracer_data:JSON.stringify(r.utm.tracer_data),custom:{},wechat_unionid:P,wechat_openid:P}},this.ab_version="",this.evtParams={},this.reportErrorCallback=function(){},this.isLast=!1,this.setCustom(r),this.initDomain(),this.initABData()}return e.prototype.initDomain=function(e){var t=this.initConfig.channel_domain;t?this.domain=t:(t=e||this.initConfig.channel,e=(this.initConfig&&this.initConfig.channel_type?"tcpy"===this.initConfig.channel_type?C:T:E)[t],this.domain=l(e))},e.prototype.setDomain=function(e){this.customDomain=!0,this.domain=e},e.prototype.getDomain=function(e){return this.customDomain||e&&this.initDomain(e),this.domain},e.prototype.initABData=function(){var e,t,r="__tea_sdk_ab_version_"+this.initConfig.app_id;t=this.initConfig.ab_cross?(e=this.localStorage.getCookie(r,this.initConfig.ab_cookie_domain))?JSON.parse(e):null:this.localStorage.getItem(r),this.setAbCache(t)},e.prototype.setAbCache=function(e){this.ab_cache=e},e.prototype.getAbCache=function(){return this.ab_cache},e.prototype.setAbVersion=function(e){this.ab_version=e},e.prototype.getAbVersion=function(){return this.ab_version},e.prototype.getUrl=function(e){var t="";switch(e){case"event":t=this.initConfig.report_url||this.channelUrl.REPORT_URL;break;case"webid":t=this.channelUrl.WEBID_URL;break;case"tobid":t=this.channelUrl.TOB_URL}return e="",this.initConfig.caller&&(e="?sdk_version="+D+"&sdk_name=web&app_id="+this.initConfig.app_id+"&caller="+this.initConfig.caller),""+this.getDomain()+t+e},e.prototype.setCustom=function(e){if(e&&e.latest_data&&e.latest_data.isLast)for(var t in delete e.latest_data.isLast,this.isLast=!0,e.latest_data)this.envInfo.header.custom[t]=e.latest_data[t]},e.prototype.set=function(e){var t=this;Object.keys(e).forEach((function(r){void 0!==e[r]&&null!==e[r]||t.delete(r);try{t.eventCheck.calculate(r,"config")}catch(r){}var n,i,o;"traffic_type"===r&&t.isLast&&(t.envInfo.header.custom.$latest_traffic_source_type=e[r]),"evtParams"===r?t.evtParams=s({},t.evtParams||{},e.evtParams||{}):"_staging_flag"===r?t.evtParams=s({},t.evtParams||{},{_staging_flag:e._staging_flag}):"reportErrorCallback"===r&&"function"==typeof e[r]?t.reportErrorCallback=e[r]:(o=i="",-1<r.indexOf(".")&&(i=(n=r.split("."))[0],o=n[1]),i?"user"===i||"header"===i?t.envInfo[i][o]=e[r]:t.envInfo.header.custom[o]=e[r]:Object.hasOwnProperty.call(t.envInfo.user,r)?-1<["user_type","ip_addr_id"].indexOf(r)?t.envInfo.user[r]=e[r]&&Number(e[r]):-1<["user_id","web_id","user_unique_id","user_unique_id_type"].indexOf(r)?t.envInfo.user[r]=e[r]&&String(e[r]):-1<["user_is_auth","user_is_login"].indexOf(r)?t.envInfo.user[r]=Boolean(e[r]):"device_id"===r&&(t.envInfo.user[r]=e[r]):Object.hasOwnProperty.call(t.envInfo.header,r)?t.envInfo.header[r]=e[r]:t.envInfo.header.custom[r]=e[r])}))},e.prototype.get=function(e){try{return e?"evtParams"===e?this.evtParams:"reportErrorCallback"===e?this[e]:Object.hasOwnProperty.call(this.envInfo.user,e)?this.envInfo.user[e]:Object.hasOwnProperty.call(this.envInfo.header,e)?this.envInfo.header[e]:JSON.parse(JSON.stringify(this.envInfo[e])):JSON.parse(JSON.stringify(this.envInfo))}catch(e){console.log("get config stringify error "),this.collect.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.setStore=function(e){try{var t,r;this.configPersist&&(t=this.storage.getItem(this.configKey)||{})&&Object.keys(e).length&&(r=Object.assign(e,t),this.storage.setItem(this.configKey,r))}catch(e){console.log("setStore error"),this.collect.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.getStore=function(){try{var e;return this.configPersist&&(e=this.storage.getItem(this.configKey)||{})&&Object.keys(e).length?e:null}catch(e){return this.collect.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message}),null}},e.prototype.delete=function(e){try{var t;this.configPersist&&(t=this.storage.getItem(this.configKey)||{})&&Object.hasOwnProperty.call(t,e)&&(delete t[e],this.storage.setItem(this.configKey,t))}catch(e){this.collect.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message}),console.log("delete error")}},e}(),M=function(){function e(e,t){this.isLog=t||!1,this.name=e||""}return e.prototype.info=function(e){this.isLog&&console.log("%c %s","color: yellow; background-color: black;","[instance: "+this.name+"] "+e)},e.prototype.warn=function(e){this.isLog&&console.warn("[instance: "+this.name+"] "+e)},e.prototype.error=function(e){this.isLog&&console.error("[instance: "+this.name+"] "+e)},e.prototype.throw=function(e){throw this.error(this.name),new Error(e)},e}(),B=function(){function e(e,t){this.collect=e,this.native=t}var t=e.prototype;return t.bridgeInject=function(){try{return!!this.native&&(AppLogBridge?(console.log("AppLogBridge is injected"),!0):(console.log("AppLogBridge is not inject"),!1))}catch(e){return console.log("AppLogBridge is not inject"),!1}},t.bridgeReady=function(){var e=this;return new Promise((function(t,r){try{e.bridgeInject()?AppLogBridge.hasStarted((function(e){console.log("AppLogBridge is started? : "+e),e?t(!0):r(!1)})):r(!1)}catch(e){console.log("AppLogBridge, error:"+JSON.stringify(e.stack)),r(!1)}}))},t.setNativeAppId=function(e){try{AppLogBridge.setNativeAppId(JSON.stringify(e)),console.log("change bridge appid, event report with appid: "+e)}catch(e){console.error("setNativeAppId error")}},t.setConfig=function(e){var t=this;try{Object.keys(e).forEach((function(r){"user_unique_id"===r?t.setUserUniqueId(e[r]):e[r]?t.addHeaderInfo(r,e[r]):t.removeHeaderInfo(r)}))}catch(e){console.error("setConfig error")}},t.setUserUniqueId=function(e){try{AppLogBridge.setUserUniqueId(e)}catch(e){console.error("setUserUniqueId error")}},t.addHeaderInfo=function(e,t){try{AppLogBridge.addHeaderInfo(e,t)}catch(e){console.error("addHeaderInfo error")}},t.setHeaderInfo=function(e){try{AppLogBridge.setHeaderInfo(JSON.stringify(e))}catch(e){console.error("setHeaderInfo error")}},t.removeHeaderInfo=function(e){try{AppLogBridge.removeHeaderInfo(e)}catch(e){console.error("removeHeaderInfo error")}},t.reportPv=function(e){this.onEventV3("predefine_pageview",e)},t.onEventV3=function(e,t){try{AppLogBridge.onEventV3(e,t),this.collect.emit(DebuggerMesssge.DEBUGGER_MESSAGE,{type:DebuggerMesssge.DEBUGGER_MESSAGE_EVENT,info:"bridge\u57cb\u70b9\u4e0a\u62a5",time:Date.now(),data:[{events:[{event:e,params:t}]}],code:200,status:"success"})}catch(e){console.error("onEventV3 error")}},t.profileSet=function(e){try{AppLogBridge.profileSet(e)}catch(e){console.error("profileSet error")}},t.profileSetOnce=function(e){try{AppLogBridge.profileSetOnce(e)}catch(e){console.error("profileSetOnce error")}},t.profileIncrement=function(e){try{AppLogBridge.profileIncrement(e)}catch(e){console.error("profileIncrement error")}},t.profileUnset=function(e){try{AppLogBridge.profileUnset(e)}catch(e){console.error("profileUnset error")}},t.profileAppend=function(e){try{AppLogBridge.profileAppend(e)}catch(e){console.error("profileAppend error")}},e}(),U={NO_URL:4001,IMG_ON:4e3,IMG_CATCH:4002,BEACON_FALSE:4003,XHR_ON:500,RESPONSE:5001,TIMEOUT:5005};function N(e,t,r,n,i,o,a,s,c){try{var u=new XMLHttpRequest,l=s||"POST";u.open(l,""+e,!0),u.setRequestHeader("Content-Type","application/json; charset=utf-8"),a&&u.setRequestHeader("X-MCS-AppKey",""+a),n&&(u.withCredentials=!0),u.onload=function(){if(i){var r=null;if(u.responseText){try{r=JSON.parse(u.responseText)}catch(e){r={}}i(r,t)}}},r&&(u.timeout=r,u.ontimeout=function(){o&&o(t,U.TIMEOUT)}),u.onerror=function(){u.abort(),o&&o(t,U.XHR_ON)},c?u.send(t):u.send(JSON.stringify(t))}catch(e){}}function G(e,t,r,n){try{var i=e.match(/\/v\d\//),o=i?i[0]:-1!==e.indexOf("/v1/")?"/v1/":"/v2/",a=e.split(o)[0];a?t.forEach((function(i){i=function(e){var t,r="";for(t in e)e.hasOwnProperty(t)&&void 0!==e[t]&&(r+="&"+t+"="+encodeURIComponent(JSON.stringify(e[t])));return"&"===r[0]?r.slice(1):r}(i);var o=new Image(1,1);o.onload=function(){o=null,r&&r()},o.onerror=function(){o=null,n&&n(e,t,q)},o.src=a+"/gif?"+i})):n(e,t,K)}catch(r){n&&n(e,t,W,r.message)}}function F(e,t,r,n,i,o,a,s){var c=window.navigator.userAgent;if(-1===window.navigator.appName.indexOf("Microsoft Internet Explorer")||-1===c.indexOf("MSIE 8.0")&&-1===c.indexOf("MSIE 9.0")){if(a)return window.navigator&&window.navigator.sendBeacon?window.navigator.sendBeacon(e,JSON.stringify(t))?i():o(e,t,4003):G(e,t,i,o)}else G(e,t,i,o);N(e,t,r,n,i,o,"","",s)}function L(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(10):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)}().replace(/-/g,"").slice(0,19)}function H(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}var K=4001,q=4e3,W=4002,J=function(){function e(){this.eventLimit=50,this.enable_ttwebid=!1,this.eventCache=[],this.beconEventCache=[]}return e.prototype.apply=function(e,t){var r=this;this.collect=e,this.config=t,this.configManager=e.configManager,this.eventCheck=new j(e,t),this.cacheStorgae=new k(!0),this.localStorage=new k(!1),this.maxReport=t.max_report||10,this.reportTime=t.reportTime||30,this.timeout=t.timeout||1e5,this.enable_ttwebid=t.enable_ttwebid,this.reportUrl=this.configManager.getUrl("event"),this.eventKey="__tea_cache_events_"+this.configManager.get("app_id"),this.beconKey="__tea_cache_events_becon_"+this.configManager.get("app_id"),this.abKey="__tea_sdk_ab_version_"+this.configManager.get("app_id"),this.collect.on(A.Ready,(function(){r.reportAll(!1)})),this.collect.on(A.ConfigDomain,(function(){r.reportUrl=r.configManager.getUrl("event")})),this.collect.on(A.Event,(function(e){r.event(e)})),this.collect.on(A.BeconEvent,(function(e){r.beconEvent(e)})),this.collect.on(A.CleanEvents,(function(){r.reportAll(!1)})),this.linster()},e.prototype.linster=function(){var e=this;window.addEventListener("unload",(function(){e.reportAll(!0)}),!1),function(e){navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.addEventListener("pagehide",e,!1):window.addEventListener("beforeunload",e,!1)}((function(){e.reportAll(!0)})),document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&e.reportAll(!0)}),!1)},e.prototype.reportAll=function(e){this.report(e),this.reportBecon()},e.prototype.event=function(e){var t=this;try{var r,n=c(e,this.cacheStorgae.getItem(this.eventKey)||[]);this.cacheStorgae.setItem(this.eventKey,n),this.reportTimeout&&clearTimeout(this.reportTimeout),n.length>=this.maxReport?this.report(!1):(r=this.reportTime,this.reportTimeout=setTimeout((function(){t.report(!1),t.reportTimeout=null}),r))}catch(e){this.collect.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.beconEvent=function(e){e=c(e,this.cacheStorgae.getItem(this.beconKey)||[]),this.cacheStorgae.setItem(this.beconKey,e),this.collect.destroyInstance||this.collect.tokenManager.getReady()&&this.collect.sdkReady&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(e)),!0))},e.prototype.reportBecon=function(){var e;!this.collect.destroyInstance&&this.collect.tokenManager.getReady()&&this.collect.sdkReady&&(e=this.cacheStorgae.getItem(this.beconKey)||[])&&e.length&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(e)),!0))},e.prototype.report=function(e){var t;!this.collect.destroyInstance&&this.collect.tokenManager.getReady()&&this.collect.sdkReady&&(t=this.cacheStorgae.getItem(this.eventKey)||[]).length&&(this.cacheStorgae.removeItem(this.eventKey),this.sliceEvent(t,e))},e.prototype.sliceEvent=function(e,t){if(e.length>this.eventLimit)for(var r=0;r<e.length;r+=this.eventLimit){var n=e.slice(r,r+this.eventLimit),i=this.split(this.merge(n));this.send(i,t)}else i=this.split(this.merge(e)),this.send(i,t)},e.prototype.merge=function(e,t){var r=this,n=(c=this.configManager.get()).header,i=c.user,o=(n.custom=JSON.stringify(n.custom),this.configManager.get("evtParams")),a=this.configManager.get("user_unique_id_type"),c=e.map((function(e){try{Object.keys(o).length&&!t&&(e.params=s({},o,e.params)),a&&(e.params.$user_unique_id_type=a);var n=r.configManager.getAbCache();return n&&n.uuid&&n.uuid===i.user_unique_id&&r.configManager.getAbVersion()&&(e.ab_sdk_version=r.configManager.getAbVersion()),e.session_id=r.collect.sessionManager.getSessionId(),e.params=JSON.stringify(e.params),e}catch(n){return r.collect.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:n.message}),e}}));return((e=JSON.parse(JSON.stringify({events:c,user:i,header:n}))).local_time=Math.floor(Date.now()/1e3),e.user_unique_type=this.config.enable_ttwebid?this.config.user_unique_type:void 0,e.verbose=1,c=[]).push(e),c},e.prototype.split=function(e){return e.map((function(e){var t=[];return t.push(e),t}))},e.prototype.send=function(e,t){var r=this;e.length&&!this.config.disable_track_event&&e.forEach((function(e){try{var n=JSON.parse(JSON.stringify(e)),i=(r.config.filter&&!(n=r.config.filter(n))&&console.warn("filter must return data !!"),r.collect.eventFilter&&n&&((n=r.collect.eventFilter(n))||console.warn("filterEvent api must return data !!")),n||e),o=JSON.parse(JSON.stringify(i));r.eventCheck.checkVerify(o),i.length&&(r.collect.emit(A.SubmitBefore,i),r.collect.emit(A.SubmitVerify,i),F(r.reportUrl,i,r.timeout,r.enable_ttwebid,(function(e,t){e&&0!==e.e?(r.collect.emit(A.SubmitError,{type:"f_data",eventData:t,errorCode:e.e,response:e}),r.collect.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_EVENT,info:"\u57cb\u70b9\u4e0a\u62a5\u5931\u8d25",time:Date.now(),data:o,code:e.e,failType:"\u6570\u636e\u5f02\u5e38",status:"fail"})):(r.collect.emit(A.SubmitScuess,{eventData:t,res:e}),r.collect.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_EVENT,info:"\u57cb\u70b9\u4e0a\u62a5\u6210\u529f",time:Date.now(),data:o,code:200,status:"success"}))}),(function(e,t){r.configManager.get("reportErrorCallback")(e,t),r.collect.emit(A.SubmitError,{type:"f_net",eventData:e,errorCode:t}),r.collect.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_EVENT,info:"\u57cb\u70b9\u4e0a\u62a5\u7f51\u7edc\u5f02\u5e38",time:Date.now(),data:o,code:t,failType:"\u7f51\u7edc\u5f02\u5e38",status:"fail"})}),t,!1),r.collect.emit(A.SubmitAfter,i))}catch(e){console.warn("something error, "+JSON.stringify(e.stack)),r.collect.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}}))},e}(),V=function(){function e(){this.cacheToken={},this.enableCookie=!1,this.enable_ttwebid=!1,this.enableCustomWebid=!1}return e.prototype.apply=function(e,t){var r=this;this.collect=e,this.config=t,this.configManager=this.collect.configManager,this.storage=new k(!1),this.tokenKey="__tea_cache_tokens_"+t.app_id,this.enable_ttwebid=t.enable_ttwebid,this.enableCustomWebid=t.enable_custom_webid,this.collect.on(A.ConfigUuid,(function(e){r.setUuid(e)})),this.collect.on(A.ConfigWebId,(function(e){r.setWebId(e)})),this.enableCookie=t.cross_subdomain,this.expiresTime=t.cookie_expire||6048e5,this.cookieDomain=t.cookie_domain||"",this.checkStorage()},e.prototype.checkStorage=function(){var e,t=this;this.enableCookie?(e=this.storage.getCookie(this.tokenKey,this.cookieDomain),this.cacheToken=e&&"string"==typeof e?JSON.parse(e):{}):this.cacheToken=this.storage.getItem(this.tokenKey)||{},this.tokenType=this.cacheToken&&this.cacheToken._type_?this.cacheToken._type_:"default","custom"!==this.tokenType||this.enableCustomWebid?this.enableCustomWebid?this.collect.on(A.CustomWebId,(function(){t.tokenReady=!0,t.collect.emit(A.TokenComplete)})):this.checkEnv()||(this.enable_ttwebid?this.completeTtWid(this.cacheToken):this.check()):this.remoteWebid()},e.prototype.check=function(){this.cacheToken&&this.cacheToken.web_id?this.complete(this.cacheToken):this.config.disable_webid?this.complete({web_id:L(),user_unique_id:this.configManager.get("user_unique_id")||L()}):this.remoteWebid()},e.prototype.checkEnv=function(){var e=window.navigator.userAgent;return(-1!==e.indexOf("miniProgram")||-1!==e.indexOf("MiniProgram"))&&!(!(e=h(window.location.href))||!e.Web_ID||(this.complete({web_id:""+e.Web_ID,user_unique_id:this.configManager.get("user_unique_id")||""+e.Web_ID}),0))},e.prototype.remoteWebid=function(){var e=this,t=this.configManager.getUrl("webid"),r={app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer,user_unique_id:""};this.collect.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"SDK \u53d1\u8d77WEBID\u8bf7\u6c42",logType:"fetch",level:"info",time:Date.now(),data:r}),N(t,r,3e3,!1,(function(t){t&&0===t.e?e.complete({web_id:e.configManager.get("web_id")||t.web_id,user_unique_id:e.configManager.get("user_unique_id")||t.web_id}):(e.collect.emit(A.TokenError),console.warn("[]appid: "+e.config.app_id+" webid error, init error~")),e.collect.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8bf7\u6c42\u6210\u529f",logType:"fetch",level:"info",time:Date.now(),data:t})}),(function(){e.collect.emit(A.TokenError),e.collect.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8bf7\u6c42\u7f51\u7edc\u5f02\u5e38",logType:"fetch",level:"error",time:Date.now(),data:null}),console.warn("[]appid: "+e.config.app_id+", get webid error, init error~")}))},e.prototype.complete=function(e){var t=e.web_id,r=e.user_unique_id;e.timestamp=Date.now(),this.collect.configManager.set({web_id:t,user_unique_id:r}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(A.TokenComplete)},e.prototype.completeTtWid=function(e){var t=e.user_unique_id||"",r=this.configManager.get("user_unique_id");(r||t)&&this.configManager.set({user_unique_id:r||t}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(A.TokenComplete)},e.prototype.setUuid=function(e){var t,r;e&&-1===["null","undefined","Null","None"].indexOf(e)?(e=String(e),t=this.configManager.get("user_unique_id"),r=this.cacheToken&&this.cacheToken.user_unique_id,e===t&&e===r||(this.configManager.set({user_unique_id:e}),this.cacheToken||(this.cacheToken={}),this.cacheToken.user_unique_id=e,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken),this.collect.emit(A.TokenChange,"uuid"),this.collect.emit(A.SessionReset))):this.clearUuid()},e.prototype.clearUuid=function(){this.config.enable_ttwebid||this.configManager.get("web_id")&&(this.configManager.set({user_unique_id:this.configManager.get("web_id")}),this.cacheToken&&this.cacheToken.web_id&&(this.cacheToken.user_unique_id=this.cacheToken.web_id,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken)),this.collect.emit(A.TokenReset))},e.prototype.setWebId=function(e){var t,r;e&&!this.config.enable_ttwebid&&(this.cacheToken&&this.cacheToken.web_id?this.cacheToken.web_id!==e&&(this.cacheToken.user_unique_id=this.cacheToken.web_id===this.cacheToken.user_unique_id?e:this.cacheToken.user_unique_id,this.cacheToken.web_id=e):(this.cacheToken={},this.cacheToken.web_id=e,this.cacheToken.user_unique_id=e),this.cacheToken.timestamp=Date.now(),t=this.configManager.get("web_id"),(r=this.configManager.get("user_unique_id"))&&r!==t||(this.configManager.set({user_unique_id:e}),this.collect.emit(A.TokenChange,"uuid")),t!==e&&(this.configManager.set({web_id:e}),this.collect.emit(A.TokenChange,"webid")),this.setStorage(this.cacheToken))},e.prototype.setStorage=function(e){e._type_=this.enableCustomWebid?"custom":"default",delete e["diss".split("").reverse().join("")],this.enableCookie||this.enable_ttwebid?(this.storage.setCookie(this.tokenKey,e,this.expiresTime,this.cookieDomain),this.enable_ttwebid&&(delete e.web_id,this.storage.setItem(this.tokenKey,e))):this.storage.setItem(this.tokenKey,e),this.cacheToken=e},e.prototype.getReady=function(){return this.tokenReady},e.prototype.getTobId=function(){var e=this,t=this.configManager.getUrl("tobid");return new Promise((function(r){N(t,{app_id:e.config.app_id,user_unique_id:e.configManager.get("user_unique_id"),web_id:e.configManager.get("web_id"),user_unique_id_type:e.configManager.get("user_unique_id_type")},3e4,e.enable_ttwebid,(function(e){e&&0===e.e?r(e.tobid):r("")}),(function(){r("")}))}))},e}(),X=function(){function e(){}return e.prototype.apply=function(e,t){var r=this;this.collect=e,this.storage=new k(!1,"session"),this.sessionKey="__tea_session_id_"+t.app_id,this.expireTime=t.expireTime||18e5,this.disableSession=t.disable_session,this.disableSession||(this.setSessionId(),this.collect.on(A.SessionReset,(function(){r.resetSessionId()})),this.collect.on(A.SessionResetTime,(function(){r.updateSessionIdTime()})))},e.prototype.updateSessionIdTime=function(){var e,t=this.storage.getItem(this.sessionKey);t&&t.sessionId&&(e=t.timestamp,Date.now()-e>this.expireTime?t={sessionId:H(),timestamp:Date.now()}:t.timestamp=Date.now(),this.storage.setItem(this.sessionKey,t),this.resetExpTime())},e.prototype.setSessionId=function(){var e=this,t=this.storage.getItem(this.sessionKey);t&&t.sessionId?t.timestamp=Date.now():t={sessionId:H(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,t),this.sessionExp=setInterval((function(){e.checkEXp()}),this.expireTime)},e.prototype.getSessionId=function(){var e=this.storage.getItem(this.sessionKey);return!this.disableSession&&e&&e.sessionId?e.sessionId:""},e.prototype.resetExpTime=function(){var e=this;this.sessionExp&&(clearInterval(this.sessionExp),this.sessionExp=setInterval((function(){e.checkEXp()}),this.expireTime))},e.prototype.resetSessionId=function(){var e={sessionId:H(),timestamp:Date.now()};this.storage.setItem(this.sessionKey,e)},e.prototype.checkEXp=function(){var e=this.storage.getItem(this.sessionKey);e&&e.sessionId&&Date.now()-e.timestamp+30>=this.expireTime&&(e={sessionId:H(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,e))},e}(),$=function(){function e(e,t){this.devToolReady=!1,this.devToolOrigin="*",this.sendAlready=!1,this.collect=e,this.config=t,this.app_id=t.app_id,this.filterEvent=["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure","bav2b_page","bav2b_beat","bav2b_page_statistics","bav2b_click","bav2b_page_exposure","_be_active","predefine_pageview","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append","predefine_page_alive","predefine_page_close","abtest_exposure"],this.load()}return e.prototype.loadScript=function(e){try{var t=document.createElement("script");t.src=e,t.onerror=function(){console.log("load DevTool render fail")},t.onload=function(){console.log("load DevTool render success")},document.getElementsByTagName("body")[0].appendChild(t)}catch(e){console.log("devTool load fail, "+e.message)}},e.prototype.load=function(){try{this.loadBaseInfo(),this.loadHook();var e=h(window.location.href);e.open_devtool_web&&parseInt(e.app_id)===this.app_id&&(this.addLintener(),this.loadDebuggerModule(),this.loadDevTool())}catch(e){console.log("debug fail, "+e.message)}},e.prototype.loadDevTool=function(){this.loadScript("https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/devtool/debug-web.js")},e.prototype.loadBaseInfo=function(){var e=this;this.info=[{title:"\u57fa\u672c\u4fe1\u606f",type:1,infoName:{app_id:this.config.app_id,channel:this.config.channel,"\u4e0a\u62a5\u57df\u540d":this.collect.configManager.getDomain(),"SDK\u7248\u672c":D,"SDK\u5f15\u5165\u65b9\u5f0f":"npm"}},{title:"\u7528\u6237\u4fe1\u606f",type:2,infoName:{uuid:this.collect.configManager.get("user").user_unique_id||"",web_id:this.collect.configManager.get("user").web_id||"",ssid:"\u70b9\u51fb\u83b7\u53d6SSID"}},{title:"\u516c\u5171\u53c2\u6570\u4fe1\u606f",type:2,infoName:{"\u6d4f\u89c8\u5668":this.collect.configManager.get("browser"),"\u6d4f\u89c8\u5668\u7248\u672c":this.collect.configManager.get("browser_version"),"\u5e73\u53f0":this.collect.configManager.get("platform"),"\u8bbe\u5907\u578b\u53f7":this.collect.configManager.get("device_model"),"\u64cd\u4f5c\u7cfb\u7edf":this.collect.configManager.get("os_name"),"\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c":this.collect.configManager.get("os_version"),"\u5c4f\u5e55\u5206\u8fa8\u7387":this.collect.configManager.get("os_version"),"\u6765\u6e90":this.collect.configManager.get("referrer"),"\u81ea\u5b9a\u4e49\u4fe1\u606f":""}},{title:"\u914d\u7f6e\u4fe1\u606f",type:3,infoName:{"\u5168\u57cb\u70b9":!!this.config.autotrack,"\u505c\u7559\u65f6\u957f":!!this.config.enable_stay_duration}},{title:"A/B\u914d\u7f6e\u4fe1\u606f",type:4,infoName:{"A/B\u5b9e\u9a8c":!!this.config.enable_ab_test}},{title:"\u5ba2\u6237\u7aef\u4fe1\u606f",type:3,infoName:{"\u6253\u901a\u5f00\u5173":!!this.config.Native}}],this.log=[],this.event=[],this.collect.on(A.Ready,(function(){e.info[1].infoName.uuid=e.collect.configManager.get("user").user_unique_id,e.info[1].infoName.web_id=e.collect.configManager.get("user").web_id,e.info[2].infoName["\u81ea\u5b9a\u4e49\u4fe1\u606f"]=JSON.stringify(e.collect.configManager.get("custom")),e.config.enable_ab_test&&(e.info[4].infoName["\u5df2\u66dd\u5149VID"]=e.collect.configManager.getAbVersion(),e.info[4].infoName["A/B\u57df\u540d"]=e.config.ab_channel_domain||l(O[e.config.channel]),e.info[4].infoName["\u5168\u90e8\u914d\u7f6e"]=e.collect.configManager.getAbData()),e.config.Native&&(e.info[5].infoName["\u662f\u5426\u6253\u901a"]=!!e.collect.bridgeReport)}))},e.prototype.loadHook=function(){var e=this;this.collect.on(m.DEBUGGER_MESSAGE,(function(t){switch(t.type){case m.DEBUGGER_MESSAGE_SDK:var r={time:t.time,type:t.logType||"sdk",level:t.level,name:t.info,show:!0,levelShow:!0,needDesc:!!t.data};return t.data&&(r.desc={content:JSON.stringify(t.data)}),e.updateLog(r),t.secType&&"AB"===t.secType?(e.info[4].infoName["\u5df2\u66dd\u5149VID"]=e.collect.configManager.getAbVersion(),e.info[4].infoName["\u5168\u90e8\u914d\u7f6e"]=e.collect.configManager.getAbData()):"USER"===t.secType&&(e.info[1].infoName.uuid=e.collect.configManager.get("user").user_unique_id,e.info[1].infoName.web_id=e.collect.configManager.get("user").web_id),void e.updateInfo();case m.DEBUGGER_MESSAGE_EVENT:if(t.data&&t.data.length){var n=(r=t.data[0]).events;if(!n.length)return;n.forEach((function(r){r.checkShow=!0,r.searchShow=!0,r.success=t.status,r.type=-1!==e.filterEvent.indexOf(r.event)?"sdk":"cus",r.type=e.collect.bridgeReport?"bridge":r.type,r.info="","fail"===t.status&&(r.info={message:"code: "+t.code+"\uff0c msg: "+t.failType})})),e.updateEvent(r)}return}}))},e.prototype.addLintener=function(){var e=this;window.addEventListener("message",(function(t){if(t&&t.data&&"devtool:web:ready"===t.data.type){if(e.devToolOrigin=t.origin,e.devToolReady=!0,e.sendAlready)return;console.log("inittttt"),e.sendData("devtool:web:init",{info:e.info,log:e.log,event:e.event}),e.sendAlready=!0}t&&t.data&&"devtool:web:ssid"===t.data.type&&e.collect.getToken((function(t){e.info[1].infoName.ssid=t.tobid,e.updateInfo()}))}))},e.prototype.sendData=function(e,t){try{var r={type:e,payload:t};(window.opener||window.parent).postMessage(r,this.devToolOrigin)}catch(e){}},e.prototype.updateInfo=function(){this.devToolReady&&this.sendData("devtool:web:info",this.info)},e.prototype.updateLog=function(e){this.devToolReady?this.sendData("devtool:web:log",e):this.log.push(e)},e.prototype.updateEvent=function(e){this.devToolReady?this.sendData("devtool:web:event",e):this.event.push(e)},e.prototype.loadDebuggerModule=function(){var e,t=document.head||document.getElementsByTagName("head")[0];(e=document.createElement("style")).appendChild(document.createTextNode("#debugger-applog-web {\n      position: absolute;\n      width: 90px;\n      height: 30px;\n      background: #23c243;\n      border-radius: 6px;\n      color: #fff;\n      font-size: 12px;\n      bottom: 5%;\n      right: 10%;\n      text-align: center;\n      line-height: 30px;\n      cursor: pointer;\n      z-index:100;\n    }")),t.appendChild(e),((t=document.createElement("div")).innerHTML='<div id="debugger-applog-web" class="debugger-applog-web">AppLog\u8c03\u8bd5</div>',e=document.createElement("div")).innerHTML='<div id="debugger-container" class="debugger-container"></div>',document.getElementsByTagName("body")[0].appendChild(t),document.getElementsByTagName("body")[0].appendChild(e),document.getElementById("debugger-applog-web").addEventListener("click",(function(){(window.opener||window.parent).postMessage({type:"devtool:web:open-draw"},location.origin)}))},e}(),Z=function(){function e(e){this.disableAutoPageView=!1,this.bridgeReport=!1,this.staging=!1,this.pluginInstances=[],this.sended=!1,this.started=!1,this.destroyInstance=!1,this.sdkReady=!1,this.adapters={},this.name=e,this.hook=new v,this.remotePlugin=new Map,this.Types=A,this.adapters.fetch=N,this.adapters.storage=k}return e.usePlugin=function(t,r,n){if(r){for(var i=!1,o=0,a=e.plugins.length;o<a;o++)if(e.plugins[o].name===r){e.plugins[o].plugin=t,e.plugins[o].options=n||{},i=!0;break}i||e.plugins.push({name:r,plugin:t,options:n})}else e.plugins.push({plugin:t})},e.prototype.usePlugin=function(e,t,r){e&&(t?"string"==typeof t?this.remotePlugin.get(e)||this.remotePlugin.set(e,{src:t,call:r}):this.remotePlugin.get(e)||this.remotePlugin.set(e,{instance:t}):this.remotePlugin.get(e)||this.remotePlugin.set(e,"sdk"))},e.prototype.init=function(t){var r,n=this;this.inited?console.warn("[instance: "+this.name+"], every instance's api: init,  can be call only one time!"):t&&u(t)?t.app_id&&"number"==typeof(r=t.app_id)&&!isNaN(r)?t.app_key&&"string"!=typeof t.app_key?console.warn("app_key param is error, must be string, please check!"):(r=t.channel_type&&"tcpy"===t.channel_type?["sg","va","in"]:["sg","va"],t.channel_domain||-1!==r.indexOf(t.channel)||(console.warn("channel must "+r.join(" ,")+"!!!"),t.channel="sg"),this.inited=!0,this.logger=new M(this.name,t.log),this.appBridge=new B(this,t.enable_native),this.bridgeReport=this.appBridge.bridgeInject(),this.configManager=new R(this,t),this.debugger=new $(this,t),this.initConfig=t,this.emit(A.Init),this.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cINIT",data:t,level:"info",time:Date.now()}),t.disable_auto_pv&&(this.disableAutoPageView=!0),this.bridgeReport||(this.configManager.set({app_id:t.app_id}),this.eventManager=new J,this.tokenManager=new V,this.sessionManager=new X,Promise.all([new Promise((function(e){n.once(A.TokenComplete,(function(){e(!0)}))})),new Promise((function(e){n.once(A.Start,(function(){e(!0)}))}))]).then((function(){try{e.plugins.reduce((function(e,t){var r=t.plugin;return t=t.options,t=Object.assign(n.initConfig,t),(r=new r).apply(n,t),e.push(r),e}),n.pluginInstances)}catch(r){console.log("load plugin error, "+r.message),n.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:r.message})}n.sdkReady=!0,n.emit(A.Ready),n.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"SDK \u521d\u59cb\u5316\u5b8c\u6210",time:Date.now(),level:"info",data:n.configManager.get("user")}),n.logger.info("appid: "+t.app_id+", userInfo:"+JSON.stringify(n.configManager.get("user"))),n.logger.info("appid: "+t.app_id+", sdk is ready, version is "+D+", you can report now !!!"),t.disable_auto_pv&&(n.disableAutoPageView=!0);try{(t.enable_ab_test||t.autotrack)&&(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(r){n.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:r.message})}n.pageView(),n.on(A.TokenChange,(function(e){"webid"===e&&n.pageView(),n.logger.info("appid: "+t.app_id+" token change, new userInfo:"+JSON.stringify(n.configManager.get("user"))),n.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"SDK \u8bbe\u7f6e\u4e86\u7528\u6237\u4fe1\u606f",time:Date.now(),secType:"USER",level:"info",data:n.configManager.get("user")})})),n.on(A.TokenReset,(function(){n.logger.info("appid: "+t.app_id+" token reset, new userInfo:"+JSON.stringify(n.configManager.get("user"))),n.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"SDK \u91cd\u7f6e\u4e86\u7528\u6237\u4fe1\u606f",time:Date.now(),secType:"USER",level:"info",data:n.configManager.get("user")})})),n.on(A.RouteChange,(function(e){e.init||t.disable_route_report||n.pageView()}));try{(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(r){}})),this.tokenManager.apply(this,t),this.eventManager.apply(this,t),this.sessionManager.apply(this,t)),this.inited=!0):console.warn("app_id param is error, must be number, please check!"):console.warn("init params error,please check")},e.prototype.config=function(e){var t,r;this.inited?e&&u(e)?this.bridgeReport?this.appBridge.setConfig(e):(e._staging_flag&&1===e._staging_flag&&(this.staging=!0),e.disable_auto_pv&&(this.disableAutoPageView=!0,delete e.disable_auto_pv),t=s({},e),this.initConfig&&this.initConfig.configPersist&&((r=this.configManager.getStore())&&(t=Object.assign(r,e)),this.configManager.setStore(e)),t.web_id,t.user_unique_id,r=function(e,t){var r={};for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&(r[i[n]]=e[i[n]]);return r}(t,["web_id","user_unique_id"]),t.hasOwnProperty("web_id")&&this.emit(A.ConfigWebId,t.web_id),t.hasOwnProperty("user_unique_id")&&this.emit(A.ConfigUuid,t.user_unique_id),this.configManager.set(r),this.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cCONFIG",level:"info",time:Date.now(),data:t})):console.warn("config params is error, please check"):console.warn("config must be use after function init")},e.prototype.setDomain=function(e){this.configManager&&this.configManager.setDomain(e),this.emit(A.ConfigDomain)},e.prototype.getConfig=function(e){return this.configManager.get(e)},e.prototype.send=function(){this.start()},e.prototype.start=function(){this.inited&&!this.sended&&(this.sended=!0,this.emit(A.Start),this.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cSTART",level:"info",time:Date.now()}),this.bridgeReport)&&(this.pageView(),this.emit(A.Ready))},e.prototype.event=function(e,t){var r=this;try{var n=[];if(Array.isArray(e))e.forEach((function(e){(e=r.processEvent(e[0],e[1]||{}))&&n.push(e)}));else{var i=this.processEvent(e,t);if(!i)return;n.push(i)}this.bridgeReport?n.forEach((function(e){var t=e.event;e=e.params,r.appBridge.onEventV3(t,JSON.stringify(e))})):n.length&&(this.emit(A.Event,n),this.emit(A.SessionResetTime))}catch(e){console.warn("something error, please check"),this.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.beconEvent=function(e,t){var r;Array.isArray(e)?console.warn("beconEvent not support batch report, please check"):(r=[],(e=this.processEvent(e,t||{}))&&(r.push(e),r.length)&&(this.emit(A.BeconEvent,r),this.emit(A.SessionResetTime)))},e.prototype.processEvent=function(e,t){void 0===t&&(t={});try{var r,n,i;return e?(/^event\./.test(r=e)&&(r=e.slice(6)),i=void((n="object"!=typeof(n=t)?{}:n).profile?delete n.profile:n.event_index=y+=1),n.local_ms?(i=n.local_ms,delete n.local_ms):i=+new Date,{event:r,params:n,local_time_ms:i,is_bav:this.initConfig&&this.initConfig.autotrack?1:0}):(this.logger.warn("eventName is null\uff0c please check"),null)}catch(r){return this.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:r.message}),{event:e,params:t}}},e.prototype.filterEvent=function(e){this.eventFilter=e},e.prototype.on=function(e,t){this.hook.on(e,t)},e.prototype.once=function(e,t){this.hook.once(e,t)},e.prototype.off=function(e,t){this.hook.off(e,t)},e.prototype.emit=function(e,t,r){this.hook.emit(e,t,r)},e.prototype.set=function(e){this.hook.set(e)},e.prototype.pageView=function(){this.disableAutoPageView||this.predefinePageView()},e.prototype.predefinePageView=function(e){void 0===e&&(e={});var t={title:document.title||location.pathname,url:location.href,url_path:location.pathname,time:Date.now(),referrer:window.document.referrer,$is_first_time:""+this.configManager.is_first_time};t=s({},t,e),this.event("predefine_pageview",t)},e.prototype.clearEventCache=function(){this.emit(A.CleanEvents)},e.prototype.setWebIDviaUnionID=function(e){var t;e&&(t=p(e),this.config({web_id:""+t,wechat_unionid:e}),this.emit(A.CustomWebId))},e.prototype.setWebId=function(e){this.config({web_id:""+e})},e.prototype.setWebIDviaOpenID=function(e){var t;e&&(t=p(e),this.config({web_id:""+t,wechat_openid:e}),this.emit(A.CustomWebId))},e.prototype.setNativeAppId=function(e){this.bridgeReport&&this.appBridge.setNativeAppId(e)},e.prototype.resetStayDuration=function(e,t,r){this.emit(A.ResetStay,{url_path:e,title:t,url:r},A.Stay)},e.prototype.resetStayParams=function(e,t,r){this.emit(A.SetStay,{url_path:e=void 0===e?"":e,title:t=void 0===t?"":t,url:r=void 0===r?"":r},A.Stay)},e.prototype.getToken=function(e,t){function r(t){var r;o||(o=!0,r=i.configManager.get().user,t&&(r.tobid=t,r["diss".split("").reverse().join("")]=t),e(s({},r)))}function n(){i.tokenManager.getTobId().then((function(e){r(e)}))}var i=this,o=!1;this.sdkReady?n():(t&&setTimeout((function(){r()}),t),this.on(A.Ready,(function(){n()})))},e.prototype.profileSet=function(e){this.bridgeReport?this.appBridge.profileSet(JSON.stringify(e)):this.emit(A.ProfileSet,e,A.Profile),this.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileSet",level:"info",time:Date.now(),data:e})},e.prototype.profileSetOnce=function(e){this.bridgeReport?this.appBridge.profileSetOnce(JSON.stringify(e)):this.emit(A.ProfileSetOnce,e,A.Profile),this.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileSetOnce",level:"info",time:Date.now(),data:e})},e.prototype.profileIncrement=function(e){this.bridgeReport?this.appBridge.profileIncrement(JSON.stringify(e)):this.emit(A.ProfileIncrement,e,A.Profile),this.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileIncrement",level:"info",time:Date.now(),data:e})},e.prototype.profileUnset=function(e){this.bridgeReport?this.appBridge.profileUnset(e):this.emit(A.ProfileUnset,e,A.Profile),this.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileUnset",level:"info",time:Date.now(),data:e})},e.prototype.profileAppend=function(e){this.bridgeReport?this.appBridge.profileAppend(JSON.stringify(e)):this.emit(A.ProfileAppend,e,A.Profile),this.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileAppend",level:"info",time:Date.now(),data:e})},e.prototype.setExternalAbVersion=function(e){this.emit(A.AbExternalVersion,"string"==typeof e&&e?(""+e).trim():null,A.Ab)},e.prototype.getVar=function(e,t,r){this.emit(A.AbVar,{name:e,defaultValue:t,callback:r},A.Ab)},e.prototype.getABconfig=function(e,t){this.emit(A.AbConfig,{params:e,callback:t},A.Ab)},e.prototype.getAbSdkVersion=function(){return this.configManager.getAbVersion()},e.prototype.onAbSdkVersionChange=function(e){var t=this;return this.emit(A.AbVersionChangeOn,e,A.Ab),function(){t.emit(A.AbVersionChangeOff,e,A.Ab)}},e.prototype.offAbSdkVersionChange=function(e){this.emit(A.AbVersionChangeOff,e,A.Ab)},e.prototype.openOverlayer=function(){this.emit(A.AbOpenLayer,"",A.Ab)},e.prototype.closeOverlayer=function(){this.emit(A.AbCloseLayer,"",A.Ab)},e.prototype.getAllVars=function(e){this.emit(A.AbAllVars,e,A.Ab)},e.prototype.sessionRecordStart=function(){this.emit(A.SessionRecordStart,A.sessionRecord)},e.prototype.sessionRecordPause=function(){this.emit(A.SessionRecordPause,A.sessionRecord)},e.prototype.sessionRecordEnd=function(){this.emit(A.SessionRecordEnd,A.sessionRecord)},e.prototype.sessionRecordReport=function(e){this.emit(A.SessionRecordReport,{callback:e},A.sessionRecord)},e.prototype.autoInitializationRangers=function(e){var t=e.app_id,r=e.channel,n=e.onTokenReady,i=(e=E[r]+"/webid",new k(!1)),o="__tea_cache_tokens_"+t;(r=i.getItem(o))&&r.web_id?n(r.web_id):F(e,{app_key:"",app_id:t,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer},3e3,!1,(function(e){e&&0===e.e?(n(e.web_id),e={web_id:e.web_id,user_unique_id:e.web_id,timestamp:Date.now()},i.setItem(o,e)):n("")}),(function(){n("")}),!0)},e.prototype.destoryInstace=function(){this.destroyInstance||(this.destroyInstance=!0,this.off(A.TokenComplete))},e.plugins=[],e}(),Y=(t=function(){function e(){}return e.prototype.apply=function(e,t){var r=this,n=e.adapters.fetch;t.event_verify_url&&("string"==typeof t.event_verify_url?(this.url=t.event_verify_url+"/v1/list_test",this.url&&(t=e.Types,e.on(t.SubmitBefore,(function(e){n(r.url,e,3e4)})))):console.log("please use correct et_test url"))},e}(),function(){function e(){}return e.prototype.apply=function(e,t){var r=this,n=(this.collect=e,this.config=t,this.duration=6e4,this.reportUrl=e.configManager.getDomain()+"/profile/list",e.Types),i=e.adapters.fetch;this.eventCheck=new j(e,t),this.fetch=i,this.cache={},this.collect.on(n.ProfileSet,(function(e){r.setProfile(e)})),this.collect.on(n.ProfileSetOnce,(function(e){r.setOnceProfile(e)})),this.collect.on(n.ProfileUnset,(function(e){r.unsetProfile(e)})),this.collect.on(n.ProfileIncrement,(function(e){r.incrementProfile(e)})),this.collect.on(n.ProfileAppend,(function(e){r.appendProfile(e)})),this.collect.on(n.ProfileClear,(function(){r.cache={}})),this.ready(n.Profile)},e.prototype.ready=function(e){var t=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var r=this.collect.hook._hooksCache[e];if(Object.keys(r).length)for(var n in r)!function(e){r[e].length&&r[e].forEach((function(r){t.collect.hook.emit(e,r)}))}(n)}},e.prototype.report=function(e,t){void 0===t&&(t={});try{var r,n;this.config.disable_track_event||((r=[]).push(this.collect.processEvent(e,t)),n=this.collect.eventManager.merge(r),this.fetch(this.reportUrl,n),this.collect.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_EVENT,info:"\u57cb\u70b9\u4e0a\u62a5\u6210\u529f",time:Date.now(),data:n,code:200,status:"success"}))}catch(e){this.collect.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.setProfile=function(e){(e=this.formatParams(e))&&Object.keys(e).length&&(this.pushCache(e),this.report("__profile_set",s({},e,{profile:!0})))},e.prototype.setOnceProfile=function(e){(e=this.formatParams(e,!0))&&Object.keys(e).length&&(this.pushCache(e),this.report("__profile_set_once",s({},e,{profile:!0})))},e.prototype.incrementProfile=function(e){e?this.report("__profile_increment",s({},e,{profile:!0})):console.warn("please check the params, must be object!!!")},e.prototype.unsetProfile=function(e){var t;e?((t={})[e]="1",this.report("__profile_unset",s({},t,{profile:!0}))):console.warn("please check the key, must be string!!!")},e.prototype.appendProfile=function(e){if(e){var t,r={};for(t in e)"string"==typeof e[t]||"Array"===Object.prototype.toString.call(e[t]).slice(8,-1)?r[t]=e[t]:console.warn("please check the value of param: "+t+", must be string or array !!!");Object.keys(r).length&&this.report("__profile_append",s({},r,{profile:!0}))}else console.warn("please check the params, must be object!!!")},e.prototype.pushCache=function(e){var t=this;Object.keys(e).forEach((function(r){t.cache[r]={val:t.clone(e[r]),timestamp:Date.now()}}))},e.prototype.formatParams=function(e,t){var r=this;void 0===t&&(t=!1);try{if(e&&"[object Object]"===Object.prototype.toString.call(e)){var n,i={};for(n in e)"string"==typeof e[n]||"number"==typeof e[n]||"Array"===Object.prototype.toString.call(e[n]).slice(8,-1)?i[n]=e[n]:console.warn("please check the value of params:"+n+", must be string,number,Array !!!");var o,a=Object.keys(i);if(a.length&&this.eventCheck.checkEventParams(i))return o=Date.now(),a.filter((function(n){var i=r.cache[n];return t?!i:!(i&&r.compare(i.val,e[n])&&o-i.timestamp<r.duration)})).reduce((function(e,t){return e[t]=i[t],e}),{})}else console.warn("please check the params type, must be object !!!")}catch(e){this.collect.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message}),console.log("error")}},e.prototype.compare=function(e,t){try{return JSON.stringify(e)===JSON.stringify(t)}catch(e){return this.collect.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message}),!1}},e.prototype.clone=function(e){try{return JSON.parse(JSON.stringify(e))}catch(t){return this.collect.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:t.message}),e}},e.prototype.unReady=function(){console.warn("sdk is not ready, please use this api after start")},e}()),Q=function(){function e(){var e=this;this.setInterval=function(){e.clearIntervalFunc=function(e,t){void 0===e&&(e=function(){}),void 0===t&&(t=1e3);var r=Date.now()+t,n=window.setTimeout((function i(){var o=Date.now()-r;e(),r+=t,n=window.setTimeout(i,Math.max(0,t-o))}),t);return function(){window.clearTimeout(n)}}((function(){e.isSessionhasEvent&&e.endCurrentSession()}),e.sessionInterval)},this.clearInterval=function(){e.clearIntervalFunc&&e.clearIntervalFunc()}}return e.prototype.apply=function(e,t){var r=this;this.collect=e,t.disable_heartbeat||(this.sessionInterval=6e4,this.startTime=0,this.lastTime=0,this.setInterval(),e=this.collect.Types,this.collect.on(e.SessionReset,(function(){r.process()})))},e.prototype.endCurrentSession=function(){this.collect.event("_be_active",{start_time:this.startTime,end_time:this.lastTime,url:window.location.href,referrer:window.document.referrer,title:document.title||location.pathname}),this.isSessionhasEvent=!1,this.startTime=0},e.prototype.process=function(){this.isSessionhasEvent||(this.isSessionhasEvent=!0,this.startTime=+new Date);var e=this.lastTime||+new Date;this.lastTime=+new Date,this.lastTime-e>this.sessionInterval&&(this.clearInterval(),this.endCurrentSession(),this.setInterval())},e}(),ee=function(){function e(){}return e.prototype.apply=function(e,t){var r=this;this.collect=e,this.config=t,this.config.channel_domain||t.disable_track_event||t.disable_sdk_monitor||(t=e.adapters.fetch,this.fetch=t,this.url=e.configManager.getUrl("event"),t=this.collect.Types,this.collect.on(t.Ready,(function(){r.sdkOnload()})),this.collect.on(t.SubmitError,(function(e){var t=e.type,n=e.eventData;e=e.errorCode,"f_data"===t&&r.sdkError(n,e)})))},e.prototype.sdkOnload=function(){var e=this;try{var t=this.collect.configManager.get(),r=t.header,n=t.user,i=r.app_id,o=r.app_name,a=r.sdk_version,s=n.web_id,c={events:[{event:"onload",params:JSON.stringify({app_id:i,app_name:o||"",sdk_version:a,sdk_type:"npm",sdk_config:this.config,sdk_desc:"TOC_OVERSEA"}),local_time_ms:Date.now()}],user:{user_unique_id:s},header:{}};setTimeout((function(){e.fetch(e.url,[c],3e4,!1,(function(){}),(function(){}),"566f58151b0ed37e")}),16)}catch(e){}},e.prototype.sdkError=function(e,t){var r=this;try{var n=e[0],i=n.user,o=n.header,a=[],s=(e.forEach((function(e){e.events.forEach((function(e){a.push(e)}))})),{events:a.map((function(e){return{event:"on_error",params:JSON.stringify({error_code:t,app_id:o.app_id,app_name:o.app_name||"",error_event:e.event,sdk_version:o.sdk_version,local_time_ms:e.local_time_ms,tea_event_index:Date.now(),params:e.params,header:JSON.stringify(o),user:JSON.stringify(i)}),local_time_ms:Date.now()}})),user:{user_unique_id:i.user_unique_id},header:{}});setTimeout((function(){r.fetch(r.url,[s],3e4,!1,(function(){}),(function(){}),"566f58151b0ed37e")}),16)}catch(e){}},e}(),te=function(){function e(){this.verifyReady=!1,this.waitTime=5e3,this.cleanStatus=!1}return e.prototype.apply=function(e,t){var r=this;this.collector=e,this.config=t,t=e.adapters.storage,this.cacheStorgae=new t(!1,"session"),this.eventStorage=[],this.collector.on("submit-verify",(function(e){e&&e.length&&r.eventStore(e[0])})),this.checkCache()},e.prototype.checkCache=function(){var e=this,t=(this.verifyCookieKey="__applog_verify_set_"+this.config.app_id,this.cacheStorgae.getCookie(this.verifyCookieKey),this.cacheStorgae.getItem(this.verifyCookieKey)),r=(this.sign=t&&t.sign||"",this.origin=t&&t.origin||"*",setTimeout((function(){e.cleanVerify(),clearTimeout(r),e.collector.off("submit-verify")}),this.waitTime));window.addEventListener("message",(function(t){t&&t.data&&"simulator:verify"===t.data.type&&(clearTimeout(r),e.receMessage(t))}),!0)},e.prototype.receMessage=function(e){var t;this.cleanStatus||(t=e.data,this.verifyReady=!0,this.sign=t.sign,this.origin=e.origin,this.cacheStorgae.setItem(this.verifyCookieKey,JSON.stringify({sign:t.sign,origin:e.origin})),this.eventStorage.length&&this.postVerify(this.eventStorage,t.sign,e.origin))},e.prototype.eventStore=function(e){this.cleanStatus||(this.verifyReady?this.postVerify(e,this.sign,this.origin):this.eventStorage.push(e))},e.prototype.cleanVerify=function(){this.cleanStatus=!0,this.eventStorage=[]},e.prototype.postVerify=function(e,t,r){try{var n=[],i=(Array.isArray(e)?e.forEach((function(e){n.push(e)})):n.push(e),{type:"simulator:verify:event",sign:t,pageUrl:window.location.href,events:n});(window.opener||window.parent).postMessage(i,r)}catch(e){console.log("web verify post message error ~")}},e}(),re={autotrack:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/autotrack.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/autotrack.js"},object:"LogAutoTrack"},ab:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/ab.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/ab.js"},object:"LogAb"},stay:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/stay.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/stay.js"},object:"LogStay"},route:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/route.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/route.js"},object:"LogRoute"},cep:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/cep.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/cep.js"},object:"LogCep"},tracer:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/tracer.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/tracer.js"},object:"LogTracer"},visual:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/visual.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/visual.js"},object:"LogVisual"}},ne="undefined"!=typeof window?(window.LogPluginObject||(window.LogPluginObject={}),window.LogPluginObject):null,ie=function(){function e(){}return e.prototype.apply=function(e,t){this._plugin={},this.config=t,this.collect=e,this.channel=t.channel||"cn",this.loadExtend()},e.prototype.loadExtend=function(){var e=this;try{this.collect.remotePlugin.forEach((function(t,r){var n,i;"sdk"===t?re.hasOwnProperty(r)?(n=re[r].object,i=""+re[r].src[e.channel],e.exist(r,n,i)):console.warn("your "+r+" is not exist\uff0cplease check plugin name"):"object"==typeof t&&(t.src?e.exist(r,t.call,t.src):e.process(r,t.instance,"INSTANCE"))}))}catch(e){this.collect.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message}),console.log("load extend error")}},e.prototype.exist=function(e,t,r){var n=this;ne[t]?(this.process(e,ne[t]),console.log("\u5df2\u6709"+e+"\u63d2\u4ef6\uff0c\u907f\u514d\u91cd\u590d\u52a0\u8f7d~")):this.loadPlugin(e,r,(function(){n.process(e,ne[t]),console.log(" %c %s %s %s","color: yellow; background-color: black;","\u2013","load plugin:"+e+" success","-")}),(function(){console.log(" %c %s %s %s","color: red; background-color: yellow;","\u2013","load plugin:"+e+" error","-")}))},e.prototype.process=function(e,t,r){try{var n;r?((n=new t).apply&&n.apply(this.collect,this.config),console.log("excude "+e+" success")):t&&t(this.collect,this.config)}catch(t){this.collect.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:t.message}),console.log("excude "+e+" error, message:"+t.message)}},e.prototype.loadPlugin=function(e,t,r,n){var i=this;try{var o=document.createElement("script");o.src=t,this._plugin[e]||(this._plugin[e]=[]),this._plugin[e].push(r),o.onerror=function(){n(t)},o.onload=function(){i._plugin[e].forEach((function(e){e()}))},document.getElementsByTagName("head")[0].appendChild(o)}catch(e){this.collect.emit(m.DEBUGGER_MESSAGE,{type:m.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e}(),oe=(Z.usePlugin(ie,"extend"),Z.usePlugin(te,"verify"),Z.usePlugin(t,"et"),Z.usePlugin(Y,"profile"),Z.usePlugin(Q,"heartbeat"),Z.usePlugin(ee,"monitor"),ie=new Z("default")),ae={selectRoute:900,browserError:1e3,crc32:1e3,preUpload:1001,initUploadID:1002,process:1003,fileMerge:1004,complete:1005},se="video",ce="image",ue="object",le={video:"video_upload",image:"image_upload",object:"object_upload"},fe="vod",he="imagex";function pe(e){return(pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function de(){return(de=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ge(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!==pe(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);if("object"!==pe(r=r.call(e,t||"default")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"===pe(e)?e:String(e)}(n.key),n)}}var ye=function(){function e(t,r){switch(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.context=r,this.teaLog=oe,this.tea_app_id=2562,this.tea_channel="cn",this.options.region){case"us-east-1":case"us-east-2":case"us-east-5":case"us-east-red":case"gcp":case"US-TTP":default:this.tea_app_id=2643,this.tea_channel="va";break;case"boei18n":case"ap-singapore-1":this.tea_app_id=2643,this.tea_channel="sg"}this.teaLog.init({app_id:this.tea_app_id,channel:this.tea_channel,log:!1,disable_sdk_monitor:!0,disable_auto_pv:!0}),this.teaLog.config({evtParams:{sdk_version:"2.0.1",line_app_id:this.options.appId},user_unique_id:this.options.userId}),this.teaLog.start()}return function(e,t,r){t&&ge(e.prototype,t),r&&ge(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"send",value:function(e){var t=this.context,r=e.key,n=(t=t.tasks[r],ae[e.stage]||999),i=(t=e.fileType||t&&t.fileType,e.fileSize||0),o={log_type:le[t],stage:n,fk:r,fs:i,req:e.req,res:e.res,ts:Math.round(Date.now()/1e3),sst:e.stageStartTime,set:e.stageEndTime,dur:e.duration,tdur:e.totalDuration,durs:e.duration/1e3,tdurs:e.totalDuration/1e3,eslr:e.enableSelectRoute,ucsrr:e.useClientSelectRouteResult,skipCommit:!!e.skipCommit},a=(r="error"===(r=e.type)||"retry"===r?r:n,"".concat("image"===t?"image":"video","_")+r);switch(n){case 1e3:this.teaLog.event(a,de({},o,{type:e.type,errc:e.extra&&e.extra.errorCode,ex:JSON.stringify({errc:e.extra&&e.extra.errorCode,msg:e.extra&&e.extra.message,crc32Array:e.crc32Array,isDirect:e.isDirect})}));break;case 1001:this.teaLog.event(a,de({},o,{type:e.type,oid:e.oid,upload_host:e.tosDomain,errc:e.extra&&e.extra.errorCode,ex:JSON.stringify({errc:e.extra&&e.extra.errorCode,err:e.extra&&e.extra.error,msg:e.extra&&e.extra.message,sig:e.signature,stk:e.proxyStsToken})}));break;case 1002:this.teaLog.event(a,de({},o,{type:e.type,oid:e.oid,upload_host:e.tosDomain,errc:e.extra&&e.extra.errorCode,ex:JSON.stringify({errc:e.extra&&e.extra.errorCode,msg:e.extra&&e.extra.message,upid:e.uploadID})}));break;case 1003:e.isAllFinish||e.isDirect||(delete o.sst,delete o.set,delete o.dur),this.teaLog.event(a,de({},o,{type:e.type,oid:e.oid,errc:e.extra&&e.extra.errorCode,upload_host:e.tosDomain,af:e.isAllFinish,cst:e.crc32StartTime,cet:e.crc32EndTime,cdur:e.crc32Duration,slst:e.sliceStartTime,slet:e.sliceEndTime,sldurs:e.sliceDuration&&e.sliceDuration/1e3,ex:JSON.stringify({errc:e.extra&&e.extra.errorCode,msg:e.extra&&e.extra.message,si:e.sliceIndex,af:e.isAllFinish})}));break;case 1004:default:this.teaLog.event(a,de({},o,{type:e.type,oid:e.oid,upload_host:e.tosDomain,errc:e.extra&&e.extra.errorCode,ex:JSON.stringify({errc:e.extra&&e.extra.errorCode,msg:e.extra&&e.extra.message})}));break;case 1005:this.teaLog.event(a,de({},o,{type:e.type,oid:e.oid,upload_host:e.tosDomain,errc:e.extra&&e.extra.errorCode,speed:Math.round(i/(e.totalDuration/1e3)/1024),ex:JSON.stringify({errc:e.extra&&e.extra.errorCode,err:e.extra&&e.extra.error,msg:e.extra&&e.extra.message,vid:e.uploadResult&&e.uploadResult.Vid})}));break;case 900:this.teaLog.event(a,de({},o,{type:e.type,errc:e.extra&&e.extra.errorCode,race_info:e.raceInfo,client_ip:e.lastClientIp,uc:e.useCache,ex:JSON.stringify({errc:e.extra&&e.extra.errorCode,err:e.extra&&e.extra.error,msg:e.extra&&e.extra.message})}))}}},{key:"console",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){this.options.debug&&console.log(e)}))}]),e}(),me=(te=r(5),r.n(te)),ve=(t=r(4),r.n(t)),be={urlTemplate:function(e,t){var r;return t=t||{},Object.keys(t).forEach((function(n){r=new RegExp("{".concat(n,"}"),"g"),e=e.replace(r,t[n])})),e},toQueryString:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).map((function(t){return"".concat(t,"=").concat(encodeURIComponent(e[t]))})).join("&")},supportChunked:function(){var e=window.Blob||window.WebKitBlob;try{var t=e.prototype;return!(!FormData||!(t.slice||t.webkitSlice||t.mozSlice))}catch(e){return!1}},supportXhr:function(){return!!window.FormData||window.ProgressEvent&&window.FileReader},supportCrc32:function(){var e=window.FileReader&&window.FileReader.prototype.readAsBinaryString;return"undefined"!=typeof Int32Array&&e&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice)},storage:function(e){var t=e;e={removeItem:function(e){delete t.cache[e]},setItem:function(e,r){t.cache[e]=r},getItem:function(e){return t.cache[e]},clear:function(){delete t.cache,t.cache={}}};try{if(window.localStorage)return window.localStorage.setItem("",""),window.localStorage}catch(e){}return e},noop:function(){},getUnique:function(e){return"".concat(e,"_").concat((new Date).getTime(),"_").concat(parseInt(1e6*Math.random()))},getFileSliceLength:function(e,t){var r=e.size,n=1048576;return t&&"function"==typeof t?t(r)<2097152?2097152:t(r)||r:200*n<r?10*n:r<=200*n&&2*n<=r?5*n:e.size},getFileSuffix:function(e){if(e&&"[object String]"===Object.prototype.toString.call(e)){var t=e.lastIndexOf(".");if(0<t&&(e="."+e.substring(t+1)).length<=8)return e}},fileSlice:function(e,t,r){return(e.slice||e.webkitSlice||e.mozSlice).call(e,t,r)},getPathByURL:function(e){return/^(?:(https?\:)\/\/)?(([^:\/?#]*)(?:\:([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/.exec(e)[5]||"/"},crypto:{hmac:function(e,t){return me()(t,e)},sha256:function(e){return ve()(e)}},date:{iso8601:function(e){return(e=void 0===e?be.date.getDate():e).toISOString().replace(/\.\d{3}Z$/,"Z")}},Buffer:Uint8Array,generateKey:function(e){for(var t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<e;n++)t+=r.charAt(Math.floor(62*Math.random()));return t}},_e=be;function we(e){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Se(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!==we(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);if("object"!==we(r=r.call(e,t||"default")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"===we(e)?e:String(e)}(n.key),n)}}function ke(e,t){return(ke=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function xe(e){return(xe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ee=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ke(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=xe(e);return function(e,t){if(t&&("object"===we(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=xe(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=e.call(this)).xhr=new XMLHttpRequest,r._data=null,r}return function(e,t,r){t&&Se(e.prototype,t),r&&Se(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"_ajax",value:function(e){var t=this,r=this.xhr;r.upload.onprogress=function(e){t.emit("progress",e)},r.onreadystatechange=function(n){4===r.readyState&&(r.upload.onprogress=_e.noop,r.onreadystatechange=_e.noop,r.params=e,t._data&&t._data.url&&(r.currentUrl=t._data.url),200<=r.status&&r.status<300?t.emit("complete",r):400<=r.status&&t.emit("error",r))},r.onerror=function(){r.errText="unknow net error",t.emit("error",r)},r.ontimeout=function(){r.errText="timeout",t.emit("error",r)},r.onabort=function(){r.errText="abort",t.emit("error",r)},r.send(e)}},{key:"send",value:function(e){var t=this;return this._data=e,this.xhr.open(e.method||"POST",e.url||"",!0),e.headers&&Object.keys(e.headers).forEach((function(r){t.xhr.setRequestHeader(r,e.headers[r])})),this.xhr.timeout=e.timeout||0,e.ontimeout&&(this.xhr.ontimeout=e.ontimeout),e.binary?this.sendAsBinary(e):e.custom?"object"===we(e.custom)?this.sendAsCustom(JSON.stringify(e.custom)):"none"===e.custom?(delete e.custom,this.sendAsCustom()):this.sendAsCustom(e.custom):this.sendAsFormData(e)}},{key:"sendAsBinary",value:function(e){return this.xhr.setRequestHeader("Content-Type","application/octet-stream"),this.xhr.setRequestHeader("Content-Disposition",'attachment; filename="'.concat(encodeURI(e.filename),'"')),this._ajax(e.file)}},{key:"sendAsFormData",value:function(e){t=(t=e.formData?"function"==typeof e.formData?e.formData():e.formData:t)||[];for(var t,r=new FormData,n=0,i=t.length;n<i;n++){var o=r[n];r.append(o.name,o.value)}return e.file&&r.append(e.field,e.file,e.name),this._ajax(r)}},{key:"sendAsCustom",value:function(e){return this._ajax(e)}},{key:"abort",value:function(){this.xhr.onreadystatechange=_e.noop,this.xhr.abort()}},{key:"getResponse",value:function(){return this.xhr.response}},{key:"getText",value:function(){return this.xhr.responseText}},{key:"getJson",value:function(){return JSON.parse(this.xhr.responseText)}}]),t}(),Oe=(Y=r(1),r.n(Y));function Ce(e){return(Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Te(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function De(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(r),!0).forEach((function(t){!function(e,t,r){(t=Pe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Te(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function je(){return(je=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ae(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pe(n.key),n)}}function Pe(e){return e=function(e,t){if("object"!==Ce(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);if("object"!==Ce(r=r.call(e,t||"default")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"===Ce(e)?e:String(e)}function Ie(e,t){return(Ie=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ze(e){return(ze=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Re=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ie(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ze(e);return function(e,t){if(t&&("object"===Ce(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=ze(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(r,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=e.call(this)).options=r,i.config=n,i.uploaderCtx=r.context,i.file=r.file,i.cacheKey="__bd_uploader_cache",i}return function(e,t,r){t&&Ae(e.prototype,t),r&&Ae(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"start",value:function(e,t){this._st=Date.now(),this.uploaderCtx._broadcast("startSelectRoute",null,!0),this.clientIp=e.clientIp,this.selectRouteTimeout=e.selectRouteTimeout||5e3,this.selectRouteCacheTime=e.selectRouteCacheTime||36e5,this.selectRouteFileSize=e.selectRouteFileSize||2097152,this.completeCallback=t,(e=this.checkSelect({clientIp:this.clientIp}))?this.success(e,null,!0):this.startSelectRoute()}},{key:"checkSelect",value:function(e){e=e.clientIp;var t=null;try{t=JSON.parse(this.uploaderCtx.storage.getItem(this.cacheKey))}catch(e){return null}if(t){var r=t.lastClientIp,n=t.lastSelectRouteTime;if(e&&e!==r)return null;if((new Date).getTime()-n<this.selectRouteCacheTime)return t}return null}},{key:"startSelectRoute",value:function(){var e=this,t=this.config.region,r=new Ee,n=(r.on("complete",(function(t){if(t.response)try{var r,n=JSON.parse(t.response);n.ResponseMetadata.Error?e.fail({xhr:t,errorCode:n.ResponseMetadata.Error.CodeN,error:n.ResponseMetadata.Error.Code,message:n.ResponseMetadata.Error.Message}):(r=n.Result.Domains,e.race(r,t))}catch(r){e.fail({error:"catch error: ".concat(r.toString()),xhr:t})}else e.fail({error:"request fail: ".concat(t.statusText||t.errText||"UNKNOWN"),xhr:t})})),r.on("error",(function(t){var r={error:"request fail: ".concat(t.statusText||t.errText||"UNKNOWN"),xhr:t};t.response&&(t=JSON.parse(t.response)).ResponseMetadata&&t.ResponseMetadata.Error&&(r.errorCode=t.ResponseMetadata.Error.CodeN,r.error=t.ResponseMetadata.Error.Code,r.message=t.ResponseMetadata.Error.Message),e.fail(r)})),this.config.videoHost),i=fe,o=this.config.videoConfig&&this.config.videoConfig.spaceName,a=(o={Action:"GetUploadCandidates",Version:"2020-11-19",SpaceName:o=this.options.type===ue&&this.config.objectConfig&&this.config.objectConfig.spaceName?this.config.objectConfig.spaceName:o},this.options.stsToken),s=_e.toQueryString(o),c=a.AccessKeyID,u=a.AccessKeyId,l=a.SecretAccessKey,f=a.SessionToken;a=a.CurrentTime,n={method:"GET",url:"".concat(n,"?").concat(s),timeout:3e4,region:t,params:o},s=new Oe.a(n,i),this.config.useServerCurrentTime&&6e4<Math.abs(new Date(a)-new Date)&&(this.systemTimeGap=new Date(a)-new Date),t=this.systemTimeGap?new Date((new Date).getTime()+this.systemTimeGap):new Date,s.addAuthorization({accessKeyId:u||c,secretAccessKey:l,sessionToken:f},t),r.send(n)}},{key:"race",value:function(e,t){var r=this,n=this.file,i=(n.slice||n.webkitSlice||n.mozSlice).call(n,0,Math.min(this.selectRouteFileSize,n.size)),a=e.map((function(e){return{domainName:e.Name,domainInfo:e,percent:0,startTime:(new Date).getTime(),endTime:(new Date).getTime(),complete:!1}})),s=0,c=a.length;a.forEach((function(e,n){var i=new Ee;i.on("complete",(function(){a[n].endTime=(new Date).getTime(),a[n].complete=!0,a.forEach((function(e,t){n!==t&&e.transport&&e.transport.abort()})),r.formatRaceInfo(a,t)})),i.on("error",(function(e){a[n].endTime=(new Date).getTime(),a[n].complete=!0,a[n].error=e.errText,c<=++s&&r.formatRaceInfo(a,t)})),i.on("progress",(function(e){e=e.loaded/e.total,a[n].percent=e})),a[n].transport=i})),a.forEach((function(e){var t={oid:(n=e.domainInfo).StoreID,tosDomain:"".concat(r.config.schema,"://").concat(n.Name)},n=(t=_e.urlTemplate(o,t)+"?speedtest",n.Sign);e.transport.send({method:"post",url:t,headers:{Authorization:n,"Content-CRC32":"ignore"},file:i,binary:1,timeout:r.selectRouteTimeout})}))}},{key:"formatRaceInfo",value:function(e,t){e.sort((function(e,t){return e.percent<t.percent?1:e.percent>t.percent?-1:e.error?1:t.error?-1:0})),e.forEach((function(e){delete e.transport})),e={lastClientIp:this.clientIp,lastSelectRouteTime:(new Date).getTime(),raceInfo:e,type:"success"},this.uploaderCtx.storage.setItem(this.cacheKey,JSON.stringify(e)),this.success(e,t)}},{key:"success",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];t=t&&this.formatXhr(t),this.uploaderCtx.logger.send(je(De(De({stage:"selectRoute",stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,fileSize:this.file&&this.file.size},t),{},{useCache:r}),e)),this.uploaderCtx._broadcast("completeSelectRoute",De(De({},e),{},{useCache:r}),!0),this.completeCallback({selectRouteResult:e.raceInfo})}},{key:"fail",value:function(e){var t={error:e.error,errorCode:e.errorCode,message:e.message};this.uploaderCtx.logger.send(je(De({stage:"selectRoute",stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,fileSize:this.file&&this.file.size,extra:t,type:"warn"},this.formatXhr(e.xhr)))),this.uploaderCtx._broadcast("completeSelectRoute",De({type:"warn"},t),!0),this.completeCallback()}},{key:"formatXhr",value:function(e){return{req:{url:e.currentUrl,param:e.params},res:{status:e.status,header:e.getAllResponseHeaders(),body:e.responseText}}}}]),t}(),Me=function(e,t){for(var r=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],n=("undefined"!=typeof Int32Array&&(r=new Int32Array(r)),-1^~~t),i=(e=new Uint8Array(e)).length,o=0;o<i;o++)n=r[255&(n^e[o])]^n>>>8;return(-1^n)>>>0},Be=function(e){if(void 0!==e)return function e(t){return t.length<8?e(t="0".concat(t)):t}(Number(e).toString(16))};function Ue(e){return(Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ne(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!==Ue(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);if("object"!==Ue(r=r.call(e,t||"default")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"===Ue(e)?e:String(e)}(n.key),n)}}var Ge=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.file=t,this.successProcess=n,this.failProcess=i,this.sliceLength=r,this.retryTime=0,this.fileSize=t.size,this.crc32Array=[]}return function(e,t,r){t&&Ne(e.prototype,t),r&&Ne(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"start",value:function(){this.readFileCrc32(this.file)}},{key:"readFileCrc32",value:function(e){var t=this,r=this.sliceLength,n=e.slice||e.webkitSlice||e.mozSlice,i=new FileReader,o=0,a=0,s=0;!function c(){a<e.size&&(a=Math.min(o+r,e.size),104857600<e.size)&&e.size-a<=5242880&&(a=e.size),i.readAsArrayBuffer(n.call(e,o,a)),i.onload=function(r){r=r.target.result,s=Me(r,0),t.crc32Array.push({start:o,end:a,crc32:Be(s),buffer:r}),(o=a)<e.size?c():t.success(t.crc32Array)}}()}},{key:"success",value:function(e){this.successProcess(e)}},{key:"fail",value:function(e,t,r,n){3<=this.retryTime?this.failProcess():(this.readFileCrc32(e,t,r,n),this.retryTime++)}}]),e}(),Fe=1000002,Le=1000003,He=1003e3,Ke="The format of stsToken is incorrect.";function qe(e){return(qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function We(){return(We=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Je(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ve(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!==qe(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);if("object"!==qe(r=r.call(e,t||"default")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"===qe(e)?e:String(e)}(n.key),n)}}var Xe=function(){function e(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.context=t.context,this.key=t.key,this.isDirect=t.isDirect,this.isImageBatchUpload=t.isImageBatchUpload,this.file=t.file,this.type=(this.isImageBatchUpload?null==(t=this.file[0])?void 0:t.type:null==(t=this.file)?void 0:t.type)||"",this.sliceLength=_e.getFileSliceLength(this.file,r.getSliceFunc),this.config=r}return function(e,t,r){t&&Ve(e.prototype,t),r&&Ve(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"start",value:function(e,t,r){this.successProcess=t,this.failProcess=r,this._st=Date.now(),this.crc32(this.file,this.sliceLength)}},{key:"crc32",value:function(e,t){var r=this;if(this.isImageBatchUpload)for(var n=e.length,i=[],o=function(t){new Ge(e[t],e[t].size,(function(e){i[t]=e[0],i.filter((function(e){return!!e})).length===n&&r.success(i)}),(function(e){r.fail(e)})).start()},a=0;a<n;a++)o(a);else!e||!e.size||e.size<=0?this.fail({errorCode:Le,message:"There is a problem with the input file or fileSize."}):this.isDirect?new Ge(e,e.size,(function(e){r.success(e)}),(function(e){r.fail({errorCode:Le,message:"get crc32 error: ".concat(e&&e.message)})})).start():this.sliceFile(e,t,(function(e){r.success(e)}),(function(e){r.fail(e)}))}},{key:"sliceFile",value:function(e,t,r,n){for(var i=[],o=t,a=e.size,s=e.slice||e.webkitSlice||e.mozSlice,c=0,u=0,l=0;u<a;)u=Math.min(c+o,a),i.push({start:c,end:u=104857600<a&&a-u<=5242880?a:u,crc32:0}),c=u;try{!function t(o){var c=new FileReader,u=i[o].start,f=i[o].end;c.readAsArrayBuffer(s.call(e,u,f)),c.onload=function(e){e=e.target.result,l=Be(Me(e,0)),i[o].crc32=l,f===a?r(i):t(i.length-1)},c.onerror=function(e){var t=e.target.error.name;e=e.target.error.message,n({crc32Array:i,errorCode:1000003,message:t+": "+e})}}(0)}catch(t){n({message:t&&t.toString()})}}},{key:"getCrc32Key",value:function(e,t){return t="[object Array]"===Object.prototype.toString.call(t)?function(e){return function(e){if(Array.isArray(e))return Je(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){var r;if(e)return"string"==typeof e?Je(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Je(e,t):void 0}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t):[t],t.push(e[0].crc32,e[e.length-1].crc32),this.config.instanceId&&t.push(this.config.instanceId),t.join("_")}},{key:"success",value:function(e){var t=this.context,r=this.key,n=[],i=[];if(this.isImageBatchUpload)for(var o=0;o<this.file.length;o++)n.push(this.file[o].size),i.push(this.file[o].name);else n=this.file.size,i=this.file.name;var a=this.getCrc32Key(e,n);(t=t.tasks[r])&&this.successProcess(We(t,{key:r,crc32Array:e,crc32Key:a,sdkVersion:"2.0.1",sliceLength:this.sliceLength,extra:{message:"get crc32 success"},stage:"crc32",type:"success",fileSize:n,fileName:i,stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._st,isDirect:this.isDirect,isImageBatchUpload:this.isImageBatchUpload}))}},{key:"fail",value:function(e){var t=this.context,r=this.key,n=e&&e.message?e.message:"get crc32 error",i=e&&e.errorCode;e=e&&e.crc32Array,t=We(t.tasks[r],{crc32Array:e,extra:{message:n,errorCode:i},type:"error",stage:"crc32",stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._st}),this.failProcess(t)}}]),e}(),$e=function(e){return!e||e.SessionToken&&e.SecretAccessKey&&(e.AccessKeyId||e.AccessKeyID)},Ze=function(e,t,r){if(r===fe||r===he)return r;if(e!==se){if(e===ce)return he;if(e===ue){if(t.objectConfig&&t.objectConfig.spaceName)return fe;if(t.objectConfig&&t.objectConfig.serviceId)return he;if(t.videoConfig&&t.videoConfig.spaceName)return fe;if(t.imageConfig&&t.imageConfig.serviceId)return he}}return fe};function Ye(e){return(Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qe(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function et(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(r),!0).forEach((function(t){!function(e,t,r){(t=nt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function tt(){return(tt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function rt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nt(n.key),n)}}function nt(e){return e=function(e,t){if("object"!==Ye(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);if("object"!==Ye(r=r.call(e,t||"default")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"===Ye(e)?e:String(e)}function it(e,t){return(it=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ot(e){return(ot=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var at=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&it(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ot(e);return function(e,t){if(t&&("object"===Ye(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=ot(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(r,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=e.call(this)).options=r,i.config=n,i.uploaderCtx=r.context,i.currFileCtx=r.context.tasks[r.key],i.systemTimeGap=0,i.retryTime=n.retryTaskTime||2,i.hasRetryTime=0,i.isImageBatchUpload=!!i.options.isImageBatchUpload,i.isDirect=i.options.isDirect,i}return function(e,t,r){t&&rt(e.prototype,t),r&&rt(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"start",value:function(e,t,r){this.startOptions=e,this.failProcess=r,this.successProcess=t,this._st=Date.now(),r=(e=this.uploaderCtx._getCache(this.currFileCtx.crc32Key))?JSON.parse(e):{},!this.isDirect&&r.oid&&r.UploadID?this.resumeFromCache(r):this.startPreUpload()}},{key:"startPreUpload",value:function(){var e=this,t=this.config.region,r=new Ee,n=(r.on("complete",(function(t){if(t.response){var r=null;try{var n=JSON.parse(t.response);if(n.ResponseMetadata.Error)return e.fail({xhr:t,errorCode:n.ResponseMetadata.Error.CodeN,error:n.ResponseMetadata.Error.Code,message:n.ResponseMetadata.Error.Message});var i,o,a,s,c,u,l,f=Ze(e.options.type,e.config,e.options.serviceType),h=n.Result,p=f===he?h.UploadAddress:h.InnerUploadAddress.UploadNodes[0],d=p.StoreInfos,g=p.UploadHosts,y=p.SessionKey,m=p.UploadHeader,v=void 0===m?{}:m,b=f===he?g[0]:p.UploadHost,_=null==(i=d[0])?void 0:i.UploadID,w=[],S=[];e.isImageBatchUpload&&1<d.length?d.forEach((function(e){w.push(e.Auth),S.push(e.StoreUri)})):(w=d[0].Auth,S=d[0].StoreUri),f===fe&&(o=h.InnerUploadAddress.UploadNodes).length&&1<o.length&&(s={SessionKey:(a=o[1]).SessionKey,UploadHeader:a.UploadHeader,StoreInfo:a.StoreInfos[0],UploadHost:a.UploadHost}),e.startOptions&&e.startOptions.enableSelectRoute&&(l=!0,e.startOptions.selectRouteResult)&&(u=!(((c=e.startOptions.selectRouteResult)[0]&&c[0].domainName)!==b)),r=tt(e.currFileCtx,{key:e.options.key,useBackupDomain:e.uploaderCtx.useBackupDomain,signature:w,type:"success",extra:{message:"prepare upload success"},stage:"preUpload",oid:S,systemTimeGap:e.systemTimeGap,tosDomain:"".concat(e.config.schema,"://").concat(b),xhr:t,UploadHeader:v,SessionKey:y,UploadID:_,fallbackStoreInfo:s,stageStartTime:e._st,stageEndTime:Date.now(),duration:Date.now()-e._st,totalDuration:Date.now()-e._st+e.currFileCtx.totalDuration,useClientSelectRouteResult:u,enableSelectRoute:l})}catch(r){return e.fail({error:"catch error: ".concat(r.message||r.toString()),xhr:t})}return e.successProcess(r)}return e.fail({error:"request fail: ".concat(t.statusText||t.errText||"UNKNOWN"),xhr:t})})),r.on("error",(function(t){var r;(e.options.type===ce&&e.config.imageFallbackHost||e.options.type===se&&e.config.videoFallbackHost)&&!e.uploaderCtx.useBackupDomain?(e.hasRetryTime<e.retryTime-1?e.hasRetryTime++:e.uploaderCtx.useBackupDomain=!0,e.startPreUpload()):(r={error:"request fail: ".concat(t.statusText||t.errText||"UNKNOWN"),xhr:t},t.response&&(t=JSON.parse(t.response)).ResponseMetadata&&t.ResponseMetadata.Error&&(r.errorCode=t.ResponseMetadata.Error.CodeN,r.error=t.ResponseMetadata.Error.Code,r.message=t.ResponseMetadata.Error.Message),e.fail(r))})),""),i={},o=this.uploaderCtx.useBackupDomain,a=Ze(this.options.type,this.config,this.options.serviceType),s=(a===he&&(n=o?this.config.imageFallbackHost:this.config.imageHost,i={Action:"ApplyImageUpload",Version:"2018-08-01"},this.options.type===ce&&(this.config.imageConfig&&this.config.imageConfig.serviceId?i.ServiceId=this.config.imageConfig.serviceId:i.SpaceName=this.config.videoConfig&&this.config.videoConfig.spaceName),this.options.type===ue&&(i.ServiceId=this.config.objectConfig&&this.config.objectConfig.serviceId||this.config.imageConfig&&this.config.imageConfig.serviceId),this.currFileCtx.fileSize&&1<this.currFileCtx.fileSize.length&&(i.UploadNum=this.currFileCtx.fileSize.length),this.options.storeKey)&&(s=this.options.storeKey,"[object Array]"===Object.prototype.toString.call(s)?i.StoreKeys=s:"[object String]"===Object.prototype.toString.call(s)&&(i.StoreKeys=[s])),a===fe&&(s=this.config.videoConfig&&this.config.videoConfig.spaceName,this.options.type===ue&&this.config.objectConfig&&this.config.objectConfig.spaceName&&(s=this.config.objectConfig.spaceName),n=o?this.config.videoFallbackHost:this.config.videoHost,i={Action:"ApplyUploadInner",Version:"2020-11-19",SpaceName:s,FileType:this.options.type,IsInner:1},this.currFileCtx.fileSize&&(i.FileSize=this.currFileCtx.fileSize),this.config.enOID&&(i.EnOID=1),(this.options.testHost||this.config.testHost)&&(i.TestHost=this.options.testHost||this.config.testHost),this.startOptions)&&this.startOptions.selectRouteResult&&(o=this.startOptions.selectRouteResult,i.ClientBestHosts=o.map((function(e){return e.domainName})).join(",")),this.config.useFileExtension&&this.currFileCtx.fileName&&(this.options.type===ue||this.options.type===ce)&&(s=this.currFileCtx.fileName,o=_e.getFileSuffix(s))&&(i.FileExtension=o),this.config.accountId&&(i["X-Account-Id"]=this.config.accountId),this.options.type!==ce&&this.options.type!==ue||!this.config.bizType||(i.BizType=this.config.bizType,i.AppID=this.config.appId,i.UserID=this.config.userId),this.config.openExperiment&&(i.app_id=this.config.appId,i.user_id=this.config.userId),i.s=Math.random().toString(36).substr(2),this.options.fileSize&&(i.FileSize=this.options.fileSize),this.currFileCtx.proxyStsToken||this.config.stsToken),c=(o=_e.toQueryString(i),s.AccessKeyID),u=s.AccessKeyId,l=s.SecretAccessKey,f=s.SessionToken;s=s.CurrentTime,o={method:"GET",url:"".concat(n,"?").concat(o),timeout:this.config.gatewayTimeout||3e4,region:t,params:i,pathname:_e.getPathByURL(n)},t=new Oe.a(o,a),this.config.useServerCurrentTime&&6e4<Math.abs(new Date(s)-new Date)&&(this.systemTimeGap=new Date(s)-new Date),i=this.systemTimeGap?new Date((new Date).getTime()+this.systemTimeGap):new Date,t.addAuthorization({accessKeyId:u||c,secretAccessKey:l,sessionToken:f},i),r.send(o)}},{key:"resumeFromCache",value:function(e){var t=this,r=this.options.key,n=new Ee,i=(n.on("complete",(function(n){var i=null;try{var o=JSON.parse(n.response);if(!(2e3===o.code&&0<o.data.partlist.length))return t.startPreUpload();var a=t.confirmCache(o.data.partlist),s=e.hasMerge?5:a.isAllFinished?4:3;i=tt(t.currFileCtx,e,{key:r,xhr:n,extra:{message:"prepare upload from cache success"},stage:"preUpload",type:"success",percent:0,cacheTask:s,proxyStsToken:t.options.stsToken,currentTask:1,status:1,isBreak:1,crc32Array:a.crc32Array,stageStartTime:t._st,stageEndTime:Date.now(),duration:Date.now()-t._st,totalDuration:Date.now()-t._st+t.currFileCtx.totalDuration})}catch(n){return t.startPreUpload()}t.successProcess(i)})),n.on("error",(function(e){400<=e.status?t.startPreUpload():t.fail({error:"request error",xhr:e})})),this.config.userId);n.send({method:"get",url:_e.urlTemplate("{tosDomain}/upload/v1/{oid}?uploadid={uploadId}&action=part_list",{tosDomain:e.tosDomain,oid:e.oid,uploadId:e.UploadID}),headers:et({Authorization:e.signature,"X-Storage-U":encodeURIComponent(i)},e.UploadHeader),timeout:3e4})}},{key:"confirmCache",value:function(e){var t=this.currFileCtx.crc32Array,r={},n=(e.forEach((function(e){void 0===r[e.num-1]&&(r[e.num-1]={tag:!0,crc32:e.crc32})})),!0);return e=t.map((function(e,t){return r[t]&&r[t].tag&&r[t].crc32?(e.crc32=r[t].crc32,e.finished=!0,e.loaded=e.end-e.start):n=!1,e})),{isAllFinished:n,crc32Array:e}}},{key:"fail",value:function(e){var t=this,r=e.xhr,n=e.errorCode||1001e3,i="prepare upload error: UNKNOWN";r&&(i=0===r.status?"prepare upload error: NETERROR":e.message||"prepare upload error: ".concat(r.status)),i=tt(this.currFileCtx,{extra:{message:i,error:e.error,errorCode:n},type:"error",stage:"preUpload",xhr:r,stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._st+this.currFileCtx.totalDuration}),this.isImageBatchUpload&&(i.successImage=[],i.failImage=null==(e=this.currFileCtx)?void 0:e.crc32Array.map((function(e,r){return{crc32:e.crc32,fileSize:null==(e=t.currFileCtx)?void 0:e.fileSize[r],fileName:null==(e=t.currFileCtx)?void 0:e.fileName[r],finishSize:0,success:!1}}))),this.uploaderCtx._removeTaskCache(this.options.key),this.failProcess(i)}}]),t}();function st(e){return(st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ct(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function ut(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(r),!0).forEach((function(t){!function(e,t,r){(t=ht(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ct(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function lt(){return(lt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ft(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ht(n.key),n)}}function ht(e){return e=function(e,t){if("object"!==st(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);if("object"!==st(r=r.call(e,t||"default")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"===st(e)?e:String(e)}function pt(e,t){return(pt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function dt(e){return(dt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var gt=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pt(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=dt(e);return function(e,t){if(t&&("object"===st(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=dt(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(r,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=e.call(this)).options=r,i.config=n,i.transport=new Ee,i.uploaderCtx=r.context,i.currFileCtx=r.context.tasks[r.key],i.eventInit(),i}return function(e,t,r){t&&ft(e.prototype,t),r&&ft(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"initUpload",value:function(e){e&&(e=this.currFileCtx.fallbackStoreInfo,lt(this.currFileCtx,{oid:e.StoreInfo.StoreUri,tosDomain:"".concat(this.config.schema,"://").concat(e.UploadHost),signature:e.StoreInfo.Auth,UploadHeader:e.UploadHeader,SessionKey:e.SessionKey}),this.uploaderCtx._saveTask(this.options.key)),e={oid:this.currFileCtx.oid,tosDomain:this.currFileCtx.tosDomain},e=_e.urlTemplate("{tosDomain}/upload/v1/{oid}?uploadmode=part&phase=init",e);var t=this.config.userId;this.transport.send({method:"post",url:e,headers:ut({Authorization:this.currFileCtx.signature,"X-Storage-U":encodeURIComponent(t)},this.currFileCtx.UploadHeader),timeout:this.config.initUploadTimeout||3e4})}},{key:"start",value:function(e,t,r){this.successProcess=t,this.failProcess=r,this._st=Date.now(),this.initUpload(e&&e.changeNodeRetry)}},{key:"eventInit",value:function(){var e=this;this.transport.on("complete",(function(t){var r=null;try{var n,i=JSON.parse(t.response),o=null==(n=i.data)?void 0:n.uploadid;if(2e3!==i.code||!o)return e.fail({error:"fail! response.code: ".concat(i.code,", fail message: ").concat(i.message),xhr:t});r=lt(e.currFileCtx,{UploadID:o,percent:0,type:"success",extra:{message:"init upload id success"},stage:"initUploadID",xhr:t,stageStartTime:e._st,stageEndTime:Date.now(),duration:Date.now()-e._st,totalDuration:Date.now()-e._st+e.currFileCtx.totalDuration})}catch(r){return e.fail({error:"catch error: ".concat(r.message||JSON.stringify(r)),xhr:t})}return e.successProcess(r)})),this.transport.on("error",(function(t){e.fail({error:"request fail: ".concat(t.statusText||t.errText||"UNKNOWN"),xhr:t})}))}},{key:"fail",value:function(e){var t=this.options.context,r=this.options.key;t=lt(t.tasks[r],{extra:{message:"init upload id error, ".concat(e.error),errorCode:1002e3},type:"error",stage:"initUploadID",xhr:e.xhr,stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._st+this.currFileCtx.totalDuration}),this.uploaderCtx._removeTaskCache(this.options.key),this.failProcess(t)}}]),t}();function yt(e){return(yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mt(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function vt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(r),!0).forEach((function(t){!function(e,t,r){(t=_t(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function bt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_t(n.key),n)}}function _t(e){return e=function(e,t){if("object"!==yt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);if("object"!==yt(r=r.call(e,t||"default")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"===yt(e)?e:String(e)}function wt(e,t){return(wt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function St(e){return(St=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var kt=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wt(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=St(e);return function(e,t){if(t&&("object"===yt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=St(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(r){var n,i=r.sliceItem,o=r.crc32,a=r.url,s=r.signature,c=r.uploadHeader,u=r.userId,l=r.retryTime,f=r.timeout;return r=void 0===(r=r.method)?"POST":r,function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=e.call(this)).fileSlice=i,n.crc32=o,n.uploadUrl=a,n.uploadHeader=c,n.signature=s,n.userId=u,n.retryTime=l||0,n.method=r,n.retryCount=0,n.timeout=f||18e5,n.ready=!1,n.cancel=!1,n.transport=new Ee,n.eventInit(),n}return function(e,t,r){t&&bt(e.prototype,t),r&&bt(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"upload",value:function(e,t){this.isParamsValid()&&(this._st=Date.now(),this.transport&&this.transport.send({method:this.method,url:this.uploadUrl,headers:vt({Authorization:this.signature,"Content-CRC32":this.crc32,"X-Storage-U":encodeURIComponent(this.userId)},this.uploadHeader),file:this.fileSlice,binary:1,timeout:this.timeout}),e)&&this.emit("retry",t)}},{key:"isParamsValid",value:function(){return this.fileSlice&&(this.fileSlice.size||this.fileSlice.byteLength)?this.crc32?!!this.uploadUrl||(this.emit("error",{message:"slice upload failed: NOURL",crc32:this.crc32,size:this.fileSlice.size||this.fileSlice.byteLength}),!1):(this.emit("error",{message:"slice upload failed: NOCRC32",crc32:this.crc32,size:this.fileSlice.size||this.fileSlice.byteLength}),!1):(this.emit("error",{message:"slice upload failed: NOCONTENT",crc32:this.crc32}),!1)}},{key:"eventInit",value:function(){var e=this;this.transport.on("complete",(function(t){try{var r=JSON.parse(t.response);2e3===r.code?e.success(t):e.fail(t,r)}catch(r){e.fail(t)}})),this.transport.on("error",(function(t){e.fail(t)})),this.transport.on("progress",(function(t){e.process(t)}))}},{key:"success",value:function(e){this.ready=!0;var t=Date.now()-this._st,r=this.fileSlice.size||this.fileSlice.byteLength;this.emit("complete",{crc32:this.crc32,size:r,speed:r/t,xhr:e,sliceStartTime:this._st,sliceEndTime:Date.now(),sliceDuration:Date.now()-this._st})}},{key:"fail",value:function(e){var t=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(!this.cancel){var n,i={crc32:this.crc32,size:this.fileSlice.size||this.fileSlice.byteLength,xhr:e,sliceStartTime:this._st,sliceEndTime:Date.now(),sliceDuration:Date.now()-this._st};if(r)return this.emit("error",vt({message:r.message},i));e&&401===e.status?this.emit("error",vt({message:"slice upload failed: UNAUTHORIZED"},i)):(n="slice upload failed: UNKNOWN",e&&(n=e.status?"slice upload failed: ".concat(e.status):"slice upload failed: NETERROR"),this.retryCount<this.retryTime?(setTimeout((function(){t.upload(!0,vt({message:n},i))}),1e3),this.retryCount++):this.emit("error",vt({message:n},i)))}}},{key:"process",value:function(e){this.cancel||this.emit("progress",{crc32:this.crc32,loaded:e.loaded||0,total:e.total||0})}},{key:"abort",value:function(){this.transport&&(this.cancel=!0,this.transport.abort())}},{key:"destroy",value:function(){this.transport=null}}]),t}(),xt=(Q=r(2),r.n(Q));function Et(e){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ot(){return(Ot=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Tt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!==Et(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);if("object"!==Et(r=r.call(e,t||"default")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"===Et(e)?e:String(e)}(n.key),n)}}function Dt(e,t){return(Dt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function jt(e){return(jt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var At=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dt(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=jt(e);return function(e,t){if(t&&("object"===Et(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=jt(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(r){var n,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=e.call(this)).file=r.file,n.context=r.context,n.key=r.key,n.config=i,n.finishArr=[],n.errorLength=0,n.finishSize=0,n.retryUploadTime=Number(i.retryUploadTime)||2,n.progressMonitorTime=Number(i.progressMonitorTime)||10,n.progressMonitorSpeed=Number(i.progressMonitorSpeed)||50,n.uploadSliceCount=Number(i.uploadSliceCount)||3,n.realtimeSpeedInterval=Number(i.realtimeSpeedInterval)||5,n.processRetry=0,n.lastFinishSize=-1,n.lastProcessPercent=-1,n.lastIntervalSize=-1,n.lastCalculateSpeedTime=-1,n.lastCalculateSpeedSize=0,n.uploadHandlers={},n}return function(e,t,r){t&&Tt(e.prototype,t),r&&Tt(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"start",value:function(e,t,r){this.failProcess=r,this.successProcess=t,this.errorLength=0,this.currentCtx=this.context.tasks[this.key],this.crc32Array=this.context.tasks[this.key].crc32Array,this.uploadSliceCount=this.uploadSliceCount>this.crc32Array.length?this.crc32Array.length:this.uploadSliceCount,this.lastIndex=0,this.uploading=[],this._uploadSize=this.crc32Array.reduce((function(e,t){return e+(t.finished?0:t.end-t.start)}),0),this._st=Date.now(),this._lastSaveTime=Date.now(),this.lastCalculateSpeedTime=this._st,this.initWorker(),this.setProgressMonitor(),this.threadUpload()}},{key:"initWorker",value:function(){var e,t=this;this.worker||(e=this.crc32Array,this.worker=new xt.a,this.worker.onmessage=function(r){r=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],c=!0,u=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||function(e,t){var r;if(e)return"string"==typeof e?Ct(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ct(e,t):void 0}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(r.data,4);var n=r[0],i=r[1],o=r[2],a=(r=r[3],(new Date).getTime()),s=e[o];s.crc32=i,s.crc32StartTime=r,s.crc32EndTime=a,s.crc32Duration=a-r,t.upload(s,n,o)})}},{key:"read",value:function(e,t){var r=this,n=this.file,i=n.slice||n.webkitSlice||n.mozSlice,o=new FileReader;o.onload=function(e){var n=(new Date).getTime();r.worker.postMessage([e.target.result,t,n,!!r.config.clientEncrypt,r.currentCtx.clientEncryptKey,r.crc32Array.length-1===t],[e.target.result])},o.onerror=function(){r.stop(),r.fail({extra:{message:"An error occurred reading the file",errorCode:1003003}})},o.readAsArrayBuffer(i.call(n,e.start,e.end))}},{key:"threadUpload",value:function(){if(this.uploading.length<this.uploadSliceCount){var e=this.lastIndex,t=this.crc32Array[e];if(t){if(t.finished){if(-1===this.finishArr.indexOf(t.start)&&(this.finishArr.push(t.start),this.finishArr.length>=this.crc32Array.length))return this.stop(),void this.success()}else t.loaded=0,this.uploading.push(e),this.read(t,e);this.lastIndex++,this.threadUpload()}}}},{key:"stop",value:function(){var e=this;Object.keys(this.uploadHandlers).forEach((function(t){e.uploadHandlers[t].abort(),e.uploadHandlers[t].destroy()})),this.uploadHandlers={},this.worker&&this.worker.terminate(),this.worker=null,this.clearMonitor()}},{key:"setProgressMonitor",value:function(){var e=this;this.progressMonitorInterval=setInterval((function(){var t,r=e.finishSize;r-e.lastIntervalSize<e.progressMonitorTime*e.progressMonitorSpeed*1024?(t=Ot(e.currentCtx,{stage:"process",type:"warn",extra:{message:"percent are not updated in ".concat(e.progressMonitorTime," seconds")}}),e.context.logger.send(t),e.context._broadcast("slowProgress",t),e.clearMonitor()):e.lastIntervalSize=r}),1e3*this.progressMonitorTime)}},{key:"clearMonitor",value:function(){this.progressMonitorInterval&&clearInterval(this.progressMonitorInterval)}},{key:"upload",value:function(e,t,r){var n=this,o=e.crc32,a=(this.context._saveTask(this.key,{crc32Array:this.crc32Array}),{part_number:r+1,uploadId:this.currentCtx.UploadID,oid:this.currentCtx.oid,tosDomain:this.currentCtx.tosDomain}),s=(a=_e.urlTemplate(i,a),this.config.userId),c=this.config.uploadTimeout;(this.config.clientEncrypt||(t=_e.fileSlice(this.file,e.start,e.end)),t=new kt({sliceItem:t,crc32:o,url:a,signature:this.currentCtx.signature,uploadHeader:this.currentCtx.UploadHeader,userId:s,method:"POST",retryTime:this.retryUploadTime,timeout:c})).on("complete",(function(t){1===n.currentCtx.status&&(t.start=e.start,t.crc32StartTime=e.crc32StartTime,t.crc32EndTime=e.crc32EndTime,t.crc32Duration=e.crc32Duration,t.index=r,n.fileSliceSuccess(t))})),t.on("error",(function(t){1===n.currentCtx.status&&(t.start=e.start,t.crc32StartTime=e.crc32StartTime,t.crc32EndTime=e.crc32EndTime,t.crc32Duration=e.crc32Duration,t.index=r,n.fail(t))})),t.on("progress",(function(t){1===n.currentCtx.status&&(t.start=e.start,t.index=r,n.process(t))})),t.on("retry",(function(t){1===n.currentCtx.status&&(t.start=e.start,t.index=r,n.retry(t))})),t.upload(),this.uploadHandlers[r]=t}},{key:"success",value:function(e){this.finishArr=[];var t=Date.now()-this._st;t=this._uploadSize/t,t=Ot(this.currentCtx,{type:"success",stage:"process",percent:100,extra:{message:"upload all success"},speed:t,xhr:e,stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._lastSaveTime+this.currentCtx.totalDuration,isAllFinish:!0}),this.worker&&this.worker.terminate(),this.successProcess(t)}},{key:"fail",value:function(e){var t=this.errorFormat(e);t.type="error",void 0!==e.statusCode&&Ot(this.currentCtx,{statusCode:e.statusCode}),this.errorLength||(this.context.logger.send(Ot({},t)),this.stop(),this.context._broadcast("error",t),this.currentCtx.isBreak?this.context._cancel(this.key):this.context._pause(this.key),this.errorLength++)}},{key:"retry",value:function(e){e=this.errorFormat(e),this.context.logger.send(Ot({},e,{type:"retry"}))}},{key:"fileSliceSuccess",value:function(e){var t,r=e.index,n=Date.now(),i=(-1===this.finishArr.indexOf(e.start)&&this.finishArr.push(e.start),this.crc32Array[r].finished=!0,this.crc32Array[r].speed=e.speed,{message:"slice upload success"});e.xhr&&(t=e.xhr,i.currentUrl=t.currentUrl||"",Ot(this.currentCtx,{req:{url:t.currentUrl,param:t.params},res:{status:t.status,body:t.responseText,header:t.getAllResponseHeaders()}}),delete e.xhr),this.context.logger.send(Ot(this.currentCtx,{stage:"process",type:"success",sliceIndex:r,extra:i,totalDuration:n-this._lastSaveTime+this.currentCtx.totalDuration,sliceStartTime:e.sliceStartTime,sliceEndTime:e.sliceEndTime,sliceDuration:e.sliceDuration,crc32StartTime:e.crc32StartTime,crc32EndTime:e.crc32EndTime,crc32Duration:e.crc32Duration})),this._lastSaveTime=n,this.context._saveTask(this.key),this.uploading.splice(this.uploading.indexOf(r),1),this.uploadHandlers[r]&&delete this.uploadHandlers[r],this.finishArr.length>=this.crc32Array.length?(this.stop(),this.success(e.xhr)):this.threadUpload()}},{key:"getFinishSize",value:function(e,t){var r=t.crc32,n=0;return e.forEach((function(e){e.crc32===r?(e.loaded=t.loaded,n+=t.loaded):(e.loaded||(e.loaded=0),n+=e.loaded)})),n}},{key:"process",value:function(e){var t=this.currentCtx.realtimeSpeed||0,r=this.currentCtx.fileSize,n=(this.finishSize=this.getFinishSize(this.crc32Array,e),this.finishSize>this.lastFinishSize&&((e=new Date).getTime()-this.lastCalculateSpeedTime>1e3*this.realtimeSpeedInterval&&(i=e.getTime()-this.lastCalculateSpeedTime,n=this.finishSize-this.lastCalculateSpeedSize,t=Math.floor(n/i),this.lastCalculateSpeedTime=e.getTime(),this.lastCalculateSpeedSize=this.finishSize),this.lastFinishSize=this.finishSize),Math.floor(this.finishSize/r*100*100)/100||0),i=Ot(this.currentCtx,{stage:"process",percent:n,realtimeSpeed:t});n>this.lastProcessPercent&&100!==n&&(this.lastProcessPercent=n,this.context._broadcast("progress",i))}},{key:"errorFormat",value:function(e){var t=this.currentCtx.totalDuration,r=Date.now()-this._st,n=e.index,i=((i=e.crc32?{message:e.message,data:e.crc32,size:e.size}:e.extra).errorCode=i.errorCode||He,Ot(this.currentCtx,{extra:i,sliceIndex:n,stage:"process",req:{},res:{},totalDuration:r+t,sliceStartTime:e.sliceStartTime,sliceEndTime:e.sliceEndTime,sliceDuration:e.sliceDuration,crc32StartTime:e.crc32StartTime,crc32EndTime:e.crc32EndTime,crc32Duration:e.crc32Duration}));return e.xhr&&(n=e.xhr,i.req={url:e.xhr.currentUrl},i.res={status:n.status,body:n.responseText,header:n.getAllResponseHeaders()},delete e.xhr),i}}]),t}();function Pt(e){return(Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function It(){return(It=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function zt(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function Rt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mt(n.key),n)}}function Mt(e){return e=function(e,t){if("object"!==Pt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);if("object"!==Pt(r=r.call(e,t||"default")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"===Pt(e)?e:String(e)}function Bt(e,t){return(Bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Ut(e){return(Ut=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Nt=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Bt(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Ut(e);return function(e,t){if(t&&("object"===Pt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=Ut(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(r,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=e.call(this)).options=r,i.config=n,i.transport=new Ee,i.eventInit(),i.errorCount=0,i.uploaderCtx=r.context,i.currFileCtx=r.context.tasks[r.key],i}return function(e,t,r){t&&Rt(e.prototype,t),r&&Rt(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"mergeFile",value:function(){for(var e={oid:this.currFileCtx.oid,uploadId:this.currFileCtx.UploadID,tosDomain:this.currFileCtx.tosDomain},t=this.currFileCtx.crc32Array,r="",n=0;n<t.length;n++)r=(r?"".concat(r,","):"").concat(n+1,":").concat(t[n].crc32);e=_e.urlTemplate("{tosDomain}/upload/v1/{oid}?uploadmode=part&phase=finish&uploadid={uploadId}",e);var i=this.config.userId;i=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?zt(Object(r),!0).forEach((function(t){!function(e,t,r){(t=Mt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({Authorization:this.currFileCtx.signature,"X-Storage-U":encodeURIComponent(i)},this.currFileCtx.UploadHeader),this.config.clientEncrypt&&(i["x-upload-encryption-mode"]=2,i["x-upload-encryption-key"]=btoa(this.currFileCtx.clientEncryptKey)),this.transport.send({method:"post",url:e,headers:i,custom:r})}},{key:"start",value:function(e,t,r){this.successProcess=t,this.failProcess=r,this._st=Date.now(),this.mergeFile()}},{key:"eventInit",value:function(){var e=this,t=this.options.stage;this.transport.on("complete",(function(r){var n=null;try{var i,o=JSON.parse(r.response);if(2e3!==o.code||null==(i=o.data)||!i.key)return e.fail({error:"fail! response.code: ".concat(o.code,", fail message: ").concat(o.message),xhr:r});n=It(e.currFileCtx,{stage:t,type:"success",hasMerge:!0,extra:{message:"merge file success"},xhr:r,stageStartTime:e._st,stageEndTime:Date.now(),duration:Date.now()-e._st,totalDuration:Date.now()-e._st+e.currFileCtx.totalDuration})}catch(n){return e.fail({error:"response parse error: ".concat(n.message||JSON.stringify(n)),xhr:r})}return e.successProcess(n)})),this.transport.on("error",(function(t){e.fail({error:"request fail: ".concat(t.statusText||t.errText),xhr:t})}))}},{key:"getProcessIndex",value:function(e){var t=0;return e.forEach((function(e,r){"process"===e.stage&&(t=r)})),t}},{key:"fail",value:function(e){e=It(this.currFileCtx,{extra:{message:"merge file error, ".concat(e.error),errorCode:1004e3},type:"error",stage:this.options.stage,xhr:e.xhr,stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._st+this.currFileCtx.totalDuration}),this.failProcess(e)}}]),t}();function Gt(e){return(Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ft(){return(Ft=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Lt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!==Gt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);if("object"!==Gt(r=r.call(e,t||"default")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"===Gt(e)?e:String(e)}(n.key),n)}}function Ht(e,t){return(Ht=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Kt(e){return(Kt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qt=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ht(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Kt(e);return function(e,t){if(t&&("object"===Gt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=Kt(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(r){var n,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=e.call(this)).options=r,n.file=r.file,n.context=r.context,n.key=r.key,n.isImageBatchUpload=r.isImageBatchUpload,n.config=i,n.finishArr=[],n.errorLength=0,n.finishSize=0,n.retryUploadTime=n.config.retryUploadTime||0,n.processRetry=0,n.lastFinishSize=-1,n.lastProcessPercent=-1,n.lastIntervalSize=-1,n.uploader={},n._uploadProcessMap={},n}return function(e,t,r){t&&Lt(e.prototype,t),r&&Lt(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"start",value:function(e,t,r){this.failProcess=r,this.successProcess=t,this.currentCtx=this.context.tasks[this.key],this.crc32Array=this.context.tasks[this.key].crc32Array,this._uploadSize=this.isImageBatchUpload?this.currentCtx.fileSize.reduce((function(e,t){return e+t})):this.file.size,this._st=Date.now(),this.upload()}},{key:"stop",value:function(){var e=this;this.uploader&&Object.keys(this.uploader).forEach((function(t){e.uploader[t]&&(e.uploader[t].abort(),e.uploader[t].destroy())}))}},{key:"upload",value:function(){for(var e=this,t=this.crc32Array.length,r=0,n=0,i=0;i<t;i++){var a=(s=this.crc32Array[i]).buffer,s=s.crc32,c=this.currentCtx.signature,u=(c="[object Array]"===Object.prototype.toString.call(c)?c[i]:c,this.currentCtx.oid),l={oid:u="[object Array]"===Object.prototype.toString.call(u)?u[i]:u,tosDomain:this.currentCtx.tosDomain},f=(l=_e.urlTemplate(o,l),this.config.userId),h=this.config.uploadTimeout,p=void 0,d=this.isImageBatchUpload?(p=this.currentCtx.fileSize[i],this.currentCtx.fileName[i]):(p=this.file.size,this.file.name);this._uploadProcessMap[s]&&this._uploadProcessMap[s].success?r+=1:(this._uploadProcessMap[s]={crc32:s,fileSize:p,fileName:d,oid:u,finishSize:0,success:!1},(p=new kt({sliceItem:a,crc32:s,url:l,signature:c,uploadHeader:this.currentCtx.UploadHeader,userId:f,retryTime:this.retryUploadTime,method:"POST",timeout:h})).on("complete",(function(i){r++,e._uploadProcessMap[i.crc32].finishSize=i.size,e._uploadProcessMap[i.crc32].success=!0,n+r===t&&e.success(i.xhr)})),p.on("error",(function(r){++n===t&&e.fail(r)})),p.on("progress",(function(t){e.process(t)})),p.upload(),this.uploader[s]=p)}}},{key:"success",value:function(e){this.finishArr=[];var t=Date.now()-this._st,r=(t=this._uploadSize/t,Ft(this.currentCtx,{type:"success",stage:"process",percent:100,extra:{message:"direct upload success"},speed:t,xhr:e,stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._st+this.currentCtx.totalDuration}));this.isImageBatchUpload&&(r.successImage=[],r.failImage=[],Object.values(this._uploadProcessMap).forEach((function(e){(e.success?r.successImage:r.failImage).push(e)}))),this.uploader=null,this._uploadProcessMap=null,this.successProcess(r)}},{key:"fail",value:function(e){e=Ft(this.currentCtx,{extra:{message:"direct upload error: ".concat(e.message||e.xhr.errText),errorCode:He},type:"error",stage:"process",xhr:e.xhr,stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._st+this.currentCtx.totalDuration}),this.isImageBatchUpload&&(e.failImage=Object.values(this._uploadProcessMap)),this.uploader=null,this._uploadProcessMap=null,this.failProcess(e)}},{key:"process",value:function(e){var t=this._uploadSize;this._uploadProcessMap[e.crc32].finishSize=Math.max(this._uploadProcessMap[e.crc32].finishSize,e.loaded),this.finishSize=Object.values(this._uploadProcessMap).reduce((function(e,t){return e+t.finishSize}),0),this.finishSize>this.lastFinishSize&&(this.lastFinishSize=this.finishSize),e=Math.floor(this.finishSize/t*100*100)/100||0,t=Ft(this.currentCtx,{stage:"process",percent:e}),e>this.lastProcessPercent&&100!==e&&(this.lastProcessPercent=e,this.context._broadcast("progress",t))}}]),t}();function Wt(e){return(Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jt(){return(Jt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Vt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!==Wt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);if("object"!==Wt(r=r.call(e,t||"default")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"===Wt(e)?e:String(e)}(n.key),n)}}function Xt(e,t){return(Xt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function $t(e){return($t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Zt=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xt(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=$t(e);return function(e,t){if(t&&("object"===Wt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=$t(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(r){var n,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=e.call(this)).options=r,n.file=r.file,n.context=r.context,n.key=r.key,n.config=i,n.errorLength=0,n.retryUploadTime=Number(i.retryUploadTime)||2,n.maxUploadSliceCount=Number(i.uploadSliceCount)||5,n.uploadQueue=[],n.crc32Array=[],n.uploadSliceCount=0,n.isCalcCrc32=!1,n.isFileReading=!1,n.hasStarted=!1,n.hasCompleteUpload=!1,n}return function(e,t,r){t&&Vt(e.prototype,t),r&&Vt(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"start",value:function(e,t,r){this.failProcess=r,this.successProcess=t,this.currentCtx=this.context.tasks[this.key],this.hasStarted=!0,this._st=Date.now(),this.initWorker()}},{key:"initWorker",value:function(){var e=this;this.worker||(this.worker=new xt.a,this.worker.onmessage=function(t){e.isCalcCrc32=!1;var r=t.data[0],n=t.data[2],i=t.data[1];e.uploadQueue.forEach((function(t,o){t.index===n&&(e.uploadQueue[o].crc32=i,e.uploadQueue[o].fileSliceBuffer=r,e.crc32Array[n]={crc32:i})})),e.startUploadQueue()},this.startUploadQueue())}},{key:"addStreamSlice",value:function(e){var t=this,r=e.fileSlice,n=e.index;(this.isFileReading=!0,e=new FileReader).readAsArrayBuffer(r),e.onload=function(e){t.isFileReading=!1,e=e.target.result,t.uploadQueue.push({fileSliceBuffer:e,index:n}),t.hasStarted&&t.startUploadQueue()}}},{key:"completeStreamUpload",value:function(){this.hasCompleteUpload=!0,0!==this.uploadQueue.length||this.isFileReading||this.success()}},{key:"startUploadQueue",value:function(){var e;this.uploadSliceCount<=this.maxUploadSliceCount&&0<this.uploadQueue.length&&this.uploadQueue[0].crc32?(e=this.uploadQueue.shift(),this.uploadSliceCount++,this.upload({sliceItem:e.fileSliceBuffer,index:e.index,crc32:e.crc32})):0<this.uploadQueue.length&&!this.uploadQueue[0].crc32&&this.startCrc32Queue()}},{key:"startCrc32Queue",value:function(){if(!this.isCalcCrc32)for(var e=0;e<this.uploadQueue.length;e++){var t=this.uploadQueue[e];if(!t.crc32){this.isCalcCrc32=!0,this.worker.postMessage([t.fileSliceBuffer,t.index],[t.fileSliceBuffer]);break}}}},{key:"upload",value:function(e){var t=this,r=e.sliceItem,n=e.index,o=(e=e.crc32,this.currentCtx.signature),a={part_number:n+1,uploadId:this.currentCtx.UploadID,oid:this.currentCtx.oid,tosDomain:this.currentCtx.tosDomain},s=(a=_e.urlTemplate(i,a),this.config.userId);(r=new kt({sliceItem:r,crc32:e,url:a,signature:o,uploadHeader:this.currentCtx.UploadHeader,userId:s,retryTime:this.retryUploadTime,method:"POST",timeout:this.config.uploadTimeout})).on("complete",(function(e){1===t.currentCtx.status&&(e.index=n,t.fileSliceSuccess(e))})),r.on("error",(function(e){1===t.currentCtx.status&&(e.index=n,t.fail(e))})),r.upload()}},{key:"fileSliceSuccess",value:function(e){var t=e.index,r=Date.now(),n={message:"stream slice upload success"},i=(e.xhr&&(i=e.xhr,n.currentUrl=i.currentUrl||"",Jt(this.currentCtx,{req:{url:i.currentUrl,param:i.params},res:{status:i.status,body:i.responseText,header:i.getAllResponseHeaders()}}),delete e.xhr),this.context.logger.send(Jt(this.currentCtx,{stage:"process",type:"success",sliceIndex:t,extra:n,totalDuration:r-this._lastSaveTime+this.currentCtx.totalDuration})),Jt(this.currentCtx,{uploadQueueLength:this.uploadQueue.length,sliceIndex:t}));this.context._broadcast("stream-progress",i),this.uploadSliceCount--,this.hasCompleteUpload&&0===this.uploadQueue.length?this.success(e.xhr):this.startUploadQueue()}},{key:"success",value:function(e){this.isAllSuccess||(e=Jt(this.currentCtx,{type:"success",stage:"process",percent:100,extra:{message:"all slice upload success"},crc32Array:this.crc32Array,xhr:e,stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._st+this.currentCtx.totalDuration}),this.successProcess(e))}},{key:"fail",value:function(e){var t=e.index;e=Jt(this.currentCtx,{extra:{message:"stream slice upload error"},type:"error",stage:"process",xhr:e.xhr,stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._st+this.currentCtx.totalDuration,sliceIndex:t}),this.context.logger.send(Jt({},e)),this.context._broadcast("error",e)}}]),t}();function Yt(e){return(Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qt(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function er(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qt(Object(r),!0).forEach((function(t){!function(e,t,r){(t=nr(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function tr(){return(tr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function rr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nr(n.key),n)}}function nr(e){return e=function(e,t){if("object"!==Yt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);if("object"!==Yt(r=r.call(e,t||"default")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"===Yt(e)?e:String(e)}function ir(e,t){return(ir=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function or(e){return(or=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ar=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ir(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=or(e);return function(e,t){if(t&&("object"===Yt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=or(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(r,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=e.call(this)).options=r,i.config=n,i.uploaderCtx=r.context,i.currFileCtx=r.context.tasks[r.key],i.isImageBatchUpload=!!i.options.isImageBatchUpload,i.skipCommit=r.skipCommit,i.transport=new Ee,i.eventInit(),i}return function(e,t,r){t&&rr(e.prototype,t),r&&rr(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"commitUpload",value:function(){var e,t,r=this.options.key,n=(r=this.options.context.tasks[r],this.config.region),i="",o={},a=this.uploaderCtx.useBackupDomain,s=Ze(this.options.type,this.config,this.options.serviceType),c=(s===he&&(i=a?this.config.imageFallbackHost:this.config.imageHost,o={Action:"CommitImageUpload",Version:"2018-08-01"},t={SessionKey:r.SessionKey},this.options.type===ce&&(this.config.imageConfig&&this.config.imageConfig.serviceId?o.ServiceId=this.config.imageConfig.serviceId:o.SpaceName=this.config.videoConfig&&this.config.videoConfig.spaceName,e=this.config.imageConfig&&this.config.imageConfig.processAction,Array.isArray(e)&&0<e.length&&(t.Functions=e),this.config.skipMeta)&&(o.SkipMeta=!0),this.options.type===ue&&(o.ServiceId=this.config.objectConfig&&this.config.objectConfig.serviceId||this.config.imageConfig&&this.config.imageConfig.serviceId),e=JSON.stringify(t)),s===fe&&(c=this.config.videoConfig&&this.config.videoConfig.spaceName,this.options.type===ue&&this.config.objectConfig&&this.config.objectConfig.spaceName&&(c=this.config.objectConfig.spaceName),i=a?this.config.videoFallbackHost:this.config.videoHost,o={Action:"CommitUploadInner",Version:"2020-11-19",SpaceName:c},t={SessionKey:r.SessionKey,Functions:[]},a=this.config.videoConfig&&this.config.videoConfig.processAction,this.options.type===ue&&this.config.objectConfig&&this.config.objectConfig.processAction&&(a=this.config.objectConfig.processAction),Array.isArray(a)&&0<a.length&&(t.Functions=a),(this.config.videoConfig&&this.config.videoConfig.callbackArgs||this.options.callbackArgs)&&(t.CallbackArgs=this.options.callbackArgs||this.config.videoConfig.callbackArgs),this.options.type===se&&this.config.skipDownload&&(o.SkipDownload=!0),this.options.type===ue&&this.options.objectSync&&(t.ObjectSync=this.options.objectSync),this.options.type===se&&this.options.needExactFormat&&(t.needExactFormat=this.options.needExactFormat),e=JSON.stringify(t)),this.config.accountId&&(o["X-Account-Id"]=this.config.accountId),this.config.openExperiment&&(o.app_id=this.config.appId,o.user_id=this.config.userId),_e.toQueryString(o)),u=(a=this.currFileCtx.proxyStsToken||this.config.stsToken).AccessKeyID,l=a.AccessKeyId,f=a.SecretAccessKey;a=a.SessionToken,(c={method:"POST",url:"".concat(i,"?").concat(c),timeout:this.config.gatewayTimeout||3e4,region:n,params:o,headers:{},pathname:_e.getPathByURL(i)}).custom=e,c.body=t,s===he&&(c.headers["Content-Type"]="application/json"),n=new Oe.a(c,s),i=(o=r.systemTimeGap)?new Date((new Date).getTime()+o):new Date,n.addAuthorization({accessKeyId:l||u,secretAccessKey:f,sessionToken:a},i),this.transport.send(c)}},{key:"start",value:function(e,t,r){if(this.successProcess=t,this.failProcess=r,this._st=Date.now(),this.skipCommit)return this.successProcess(tr(this.currFileCtx,{stage:"complete",type:"success",percent:100,extra:{message:"upload successful, skip commit"},stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._st+this.currFileCtx.totalDuration,skipCommit:this.skipCommit}));try{this.commitUpload()}catch(e){this.fail({error:"catch error: ".concat(e.toString())})}}},{key:"eventInit",value:function(){var e=this;this.transport.on("complete",(function(t){var r=null;try{var n=JSON.parse(t.response);if(n.ResponseMetadata.Error)return e.fail({xhr:t,errorCode:n.ResponseMetadata.Error.CodeN,error:n.ResponseMetadata.Error.Code,message:n.ResponseMetadata.Error.Message});var i,o,a=Ze(e.options.type,e.config,e.options.serviceType),s=n.Result,c={};a===he?e.isImageBatchUpload?(i=s.Results,o=s.PluginResult||[],i.forEach((function(e,t){i[t]=er(er({},i[t]),o[t])})),c=i):tr(c=s.Results[0],s.PluginResult&&s.PluginResult[0]):c=s.Results[0],r=tr(e.currFileCtx,{stage:"complete",type:"success",percent:100,extra:{message:"upload successful"},uploadResult:c,xhr:t,stageStartTime:e._st,stageEndTime:Date.now(),duration:Date.now()-e._st,totalDuration:Date.now()-e._st+e.currFileCtx.totalDuration,skipCommit:e.skipCommit})}catch(r){return e.fail({error:"catch error: ".concat(r.message||r.toString()),xhr:t})}return e.successProcess(r)})),this.transport.on("error",(function(t){var r={error:"request fail: ".concat(t.statusText||t.errText||"UNKNOWN"),xhr:t};t.response&&(t=JSON.parse(t.response)).ResponseMetadata&&t.ResponseMetadata.Error&&(r.errorCode=t.ResponseMetadata.Error.CodeN,r.error=t.ResponseMetadata.Error.Code,r.message=t.ResponseMetadata.Error.Message),e.fail(r)}))}},{key:"fail",value:function(e){var t=this.options.context,r=this.options.key,n=e.xhr,i=e.errorCode||1005e3,o="commit upload error: UNKNOWN";n&&(o=0===n.status?"commit upload error: NETERROR":e.message||"commit upload error: ".concat(n.status)),t=tr(t.tasks[r],{extra:{message:o,error:e.error,errorCode:i},type:"error",stage:"complete",xhr:n,stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._st+this.currFileCtx.totalDuration,skipCommit:this.skipCommit}),this.failProcess(t)}}]),t}();function sr(e){return(sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cr(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function ur(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?cr(Object(r),!0).forEach((function(t){!function(e,t,r){(t=hr(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function lr(){return(lr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function fr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hr(n.key),n)}}function hr(e){return e=function(e,t){if("object"!==sr(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);if("object"!==sr(r=r.call(e,t||"default")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"===sr(e)?e:String(e)}function pr(e,t){return(pr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function dr(e){return(dr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var gr=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pr(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=dr(e);return function(e,t){if(t&&("object"===sr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=dr(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(r){var n,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=2<arguments.length?arguments[2]:void 0,a=3<arguments.length?arguments[3]:void 0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=e.call(this,r)).tasks=r,n.config=i,n.key=a,n.uploaderCtx=o,n.current=0,n.length=n.tasks.length,n.taskError={},n.uploadList=[],n.retryTaskTime=i.retryTaskTime||2,n}return function(e,t,r){t&&fr(e.prototype,t),r&&fr(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"start",value:function(e){var t=this.tasks.shift();t&&(this.current=t.index,this.execTask(t,e))}},{key:"execTask",value:function(e,t){var r,n,i=this,o=e.key,a=this.uploaderCtx,s=a.tasks[o];s&&(r=s.cacheTask,n=a.taskList[o].length,r&&0<e.index&&e.index<r?this.start():(s.currentTask=e.index,1===s.status&&(1!==e.index&&"initUploadID"!==e.stage||(e.arg=lr(e.arg,t)),e)&&e.func.call(e.context,e.arg,(function(r){var c;a.taskList[o]&&((c=a.taskList[o][e.index+1])&&0!==e.index&&!s.isDirect?a._saveTask(o,{currentTask:c.index,stage:c.stage}):e.index===n-1&&a._removeTaskCache(o),i.success(r),0<i.tasks.length?i.start(t):a._queueSuccess(o))}),(function(r){var n;r.xhr&&400<=r.xhr.status||3===e.index&&r.isDirect?i.fail(r):!i.taskError[o]||i.taskError[o]<i.retryTaskTime?(i.taskError[o]?i.taskError[o]++:i.taskError[o]=1,n=i.errorFormat(r,!0),i.uploaderCtx.logger.send(n),"initUploadID"===e.stage?i.execTask(e,ur(ur({},t),{},{changeNodeRetry:!0})):i.execTask(e,t)):(r.key=o,i.fail(r))}))))}},{key:"addTask",value:function(e){this.tasks.push(e)}},{key:"success",value:function(e){var t;e.xhr&&(t=e.xhr,e.req={url:t.currentUrl,param:t.params},e.res={status:t.status,header:t.getAllResponseHeaders(),body:t.responseText},delete e.xhr),lr(e,{type:"success"});try{this.uploaderCtx._broadcast(e.stage,e)}catch(e){console.error(e)}this.uploaderCtx.logger.send(e)}},{key:"fail",value:function(e){var t=this.uploaderCtx,r=e.key;e=this.errorFormat(e);try{t._broadcast("error",e)}catch(e){}t.tasks[r].isBreak?t._cancel(r):t._pause(r),t.logger.send(e)}},{key:"cancel",value:function(e){var t,r=this.key,n=this.uploaderCtx.tasks[r].currentTask;this.uploaderCtx.taskList[r].forEach((function(e){n===e.index&&(t=e)})),e?3===n&&this.uploaderCtx.tasks[r].isDirect&&t&&null!=(e=t)&&null!=(e=e.context)&&e.stop():(this.tasks=[],t&&3===t.index&&t.context.stop(),this.uploaderCtx._removeTaskCache(r))}},{key:"restart",value:function(){this.uploadList.forEach((function(e){e.cancel=!1})),this.start()}},{key:"errorFormat",value:function(e,t){var r;return t={type:t?"retry":"error"},e.xhr&&(r=e.xhr,e.req={url:r.currentUrl,param:r.params},e.res={status:r.status,header:r.getAllResponseHeaders(),body:r.responseText},e.extra&&(e.extra.req=e.req,e.extra.res=e.res),delete e.xhr),lr(e,t)}}]),t}();function yr(e){return(yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mr(){return(mr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function vr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!==yr(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);if("object"!==yr(r=r.call(e,t||"default")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"===yr(e)?e:String(e)}(n.key),n)}}function br(e,t){return(br=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wr(e){return(wr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sr=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&br(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=wr(e);return function(e,t){if(t&&("object"===yr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _r(e)}(this,t?(r=wr(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=e.call(this,r)).config=mr({},a),n._mergeOptions(n.config,r),n.tasks={},n.taskList={},n.cache={},n.storage=_e.storage(_r(n)),n.logger=n.config.noLog?{send:function(){}}:new ye(n.config,_r(n)),n}return function(e,t,r){t&&vr(e.prototype,t),r&&vr(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"_mergeOptions",value:function(e,t){t&&"object"===yr(t)&&(mr(e,t),Object.keys(t).forEach((function(r){"vodDomain"===r&&(e.replace[r]=t[r])})))}},{key:"_setCache",value:function(e,t){this.storage.setItem(e,t)}},{key:"_getCache",value:function(e){return this.storage.getItem(e)}},{key:"_removeCache",value:function(e){e?this.storage.removeItem(e):this.storage.clear()}},{key:"_addTask",value:function(e,t){var r=this.tasks,n=this.taskList;r[e]&&r[e].task?n[e].push(t):(n[e]=[],n[e].push(t),r[e]=r[e]||{},r[e].task=new gr([],this.config,this,e)),r[e].task.addTask(t)}},{key:"_broadcast",value:function(e,t,r){if(r)this.emit(e,t);else if(1===(r=this.tasks[t.key].status)||0===r)try{this.emit(e,t)}catch(e){if(!(r=!("[object Error]"!==Object.prototype.toString.call(e)))||"Error"===e.name)throw e}}},{key:"_addCrc32ProcessTask",value:function(e,t){var r=(n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).isDirect,n=n.isImageBatchUpload;r={context:e=new Xe({file:e.file,context:this,key:t,isDirect:r,isImageBatchUpload:void 0!==n&&n},this.config),func:e.start,arg:{},key:t,index:0,stage:"crc32"},this._addTask(t,r)}},{key:"_addPreUploadTask",value:function(e,t){var r=(n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).isDirect,n=n.isImageBatchUpload;r={file:e.file,stsToken:e.stsToken,context:this,type:e.type||se,preUploadUriParams:e.preUploadUriParams||{},storeKey:e.storeKey,testHost:e.testHost,key:t,isDirect:r,isImageBatchUpload:void 0!==n&&n,fileSize:e.fileSize,serviceType:e.serviceType||null},e={context:n=new at(r,this.config),func:n.start,arg:{},key:t,index:1,stage:"preUpload"},this._addTask(t,e)}},{key:"_addDirectUploadTask",value:function(e,t){var r=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).isImageBatchUpload;r={context:e=new qt({file:e.file,context:this,key:t,isImageBatchUpload:void 0!==r&&r},this.config),func:e.start,arg:{},key:t,index:3,stage:"process"},this._addTask(t,r)}},{key:"_addInitUploadIDTask",value:function(e,t){e={context:e=new gt({file:e.file,context:this,key:t},this.config),func:e.start,arg:{},key:t,index:2,stage:"initUploadID"},this._addTask(t,e)}},{key:"_addUploadProcessTask",value:function(e,t){e={context:e=new At({file:e.file,context:this,key:t},this.config),func:e.start,arg:{},key:t,index:3,stage:"process"},this._addTask(t,e)}},{key:"_addStreamUploadTask",value:function(e,t){this.streamUploadTask=new Zt({context:this,key:t},this.config);var r={context:this.streamUploadTask,func:this.streamUploadTask.start,arg:{},key:t,index:3,stage:"process"};this._addTask(t,r)}},{key:"_mergeFileTask",value:function(e,t){e={context:e=new Nt({file:e.file,context:this,stage:"fileMerge",key:t},this.config),func:e.start,arg:{},key:t,index:4,stage:"fileMerge"},this._addTask(t,e)}},{key:"_getMetaInfoTask",value:function(e,t){var r=(n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).isImageBatchUpload,n=n.skipCommit;r={file:e.file,context:this,data:e.data,type:e.type||se,callbackArgs:e.callbackArgs,objectSync:e.objectSync,needExactFormat:e.needExactFormat,key:t,isImageBatchUpload:void 0!==r&&r,skipCommit:void 0!==n&&n,serviceType:e.serviceType||null},e={context:n=new ar(r,this.config),func:n.start,arg:{},key:t,index:5,stage:"complete"},this._addTask(t,e)}},{key:"_addAllUploadProcess",value:function(e,t){var r=e.type===ce&&"[object Array]"===Object.prototype.toString.call(e.file),n=(this.tasks[t]=this.tasks[t]||{},this.tasks[t].fileType=e.type||se,this.tasks[t].fileSize=e.file&&e.file.size,this.tasks[t].proxyStsToken=e.stsToken,this.lastStsToken=e.stsToken,this.lastFile=e.file,e.file.size<=_e.getFileSliceLength(e.file)||r);e.useDirectUpload&&(n=!0),this._addCrc32ProcessTask(e,t,{isDirect:n,isImageBatchUpload:r}),this._addPreUploadTask(e,t,{isDirect:n,isImageBatchUpload:r}),n?this._addDirectUploadTask(e,t,{isImageBatchUpload:r}):(this._addInitUploadIDTask(e,t),this._addUploadProcessTask(e,t),this._mergeFileTask(e,t)),n=!(!this.config.skipCommit||Ze(e.type,this.config)!==he),this._getMetaInfoTask(e,t,{isImageBatchUpload:r,skipCommit:n})}},{key:"_addAllUploadProcessClientEncrypt",value:function(e){var t,r=this;return e.type===ce&&Array.isArray(e.file)?(t=[],e.file.forEach((function(n){t.push(r._createClientEncryptTask({stsToken:e.stsToken,type:e.type,file:n}))})),t):this._createClientEncryptTask(e)}},{key:"_createClientEncryptTask",value:function(e){var t=_e.getUnique("file"),r=(this.tasks[t]=this.tasks[t]||{},this.tasks[t].fileType=e.type||se,this.tasks[t].fileSize=e.file&&e.file.size,this.tasks[t].proxyStsToken=e.stsToken,this.tasks[t].clientEncryptKey=_e.generateKey(16),this._addCrc32ProcessTask(e,t,{isDirect:!1,isImageBatchUpload:!1}),this._addPreUploadTask(e,t,{isDirect:!1,isImageBatchUpload:!1}),this._addInitUploadIDTask(e,t),this._addUploadProcessTask(e,t),this._mergeFileTask(e,t),!(!this.config.skipCommit||Ze(e.type,this.config)!==he));return this._getMetaInfoTask(e,t,{isImageBatchUpload:!1,skipCommit:r}),t}},{key:"_addAllStreamUploadProcess",value:function(e,t){this.tasks[t]=this.tasks[t]||{},this.tasks[t].fileType=e.type||se,this.tasks[t].proxyStsToken=e.stsToken,this._addPreUploadTask(e,t),this._addInitUploadIDTask(e,t),this._addStreamUploadTask(e,t),this._mergeFileTask(e,t),this._getMetaInfoTask(e,t)}},{key:"_addStreamSlice",value:function(e){var t=e.fileSlice;e=e.index,this.streamUploadTask.addStreamSlice({fileSlice:t,index:e})}},{key:"_completeStreamUpload",value:function(){this.streamUploadTask.completeStreamUpload()}},{key:"_run",value:function(e,t){var r=this.tasks,n=navigator.userAgent.toLowerCase().match(/msie ([\d.]+)/);n&&n[1]&&Number(n[1])<=9?(this._broadcast("error",mr(r[e],{key:e,status:0,stage:"browserError",extra:{message:"cannot support the browser below ie10"},type:"error"})),this.logger.send(r[e]),this._cancel(e)):r[e]?3===r[e].status?this._restart(e):(r[e].startTime=(new Date).getTime(),r[e].task&&1!==r[e].status&&r[e].task.tasks.length&&(r[e].status=1,this.logger.send(mr({},r[e],{extra:{message:"start upload"},type:"start",key:e})),r[e].task.start(t))):console.warn("".concat(e," is not exit in object tasks, stop running..."))}},{key:"_selectRoute",value:function(e,t){new Re({stsToken:this.lastStsToken,context:this,type:se,file:this.lastFile},this.config).start(e,t)}},{key:"_restart",value:function(e){var t,r,n=this,i=this.tasks;i[e]?(t=i[e].task,r=i[e].currentTask||0,this.taskList[e].forEach((function(i,o){i.index===r&&(t.tasks=n.taskList[e].slice(o))})),t&&1!==i[e].status&&t.tasks.length&&(i[e].status=1,t.restart())):console.warn("".concat(e," is not exit in object tasks"))}},{key:"_cancel",value:function(e){var t=this.tasks;t[e]?(t[e].status=2,t[e].task.cancel(),delete this.taskList[e]):console.warn("".concat(e," is not exit in object tasks"))}},{key:"_pause",value:function(e){var t=this.tasks;t[e]?(t[e].status=3,t[e].task.cancel(!0),t[e].isDirect||this._saveTask(e)):console.warn("".concat(e," is not exit in object tasks"))}},{key:"_removeTaskCache",value:function(e){var t=this.tasks;t[e]?(t=t[e].crc32Key)&&this._removeCache(t):console.warn("".concat(e," is not exit in object tasks"))}},{key:"_saveTask",value:function(e,t){(t=(e=mr({},this.tasks[e],t||{})).crc32Key)&&this._setCache(t,this.serializeCacheInfo(e))}},{key:"serializeCacheInfo",value:function(e){var t="";delete e.task,delete e.xhr,delete e.crc32Array;try{t=JSON.stringify(e)}catch(n){var r={};Object.keys(e).forEach((function(t){"task"!==t&&"xhr"!==t&&"crc32Array"!==t&&(r[t]=e[t])})),t=JSON.stringify(r)}return t}},{key:"_queueSuccess",value:function(e){var t,r=this.tasks;r[e]?(t=new Date,r[e].endTime=t.getTime(),r[e].time=r[e].endTime-r[e].startTime,r[e].status=0,delete this.taskList[e],delete r[e]):console.warn("".concat(e," is not exit in object tasks"))}},{key:"_removeFile",value:function(e){delete this.tasks[e]}},{key:"_batchAction",value:function(e,t){var r=this.tasks;Object.keys(r).forEach((function(r){e&&e(r,t)}))}},{key:"_refreshSTSToken",value:function(e){var t=this,r=this.tasks;Object.keys(r).forEach((function(n){var i=mr({},n=r[n],{proxyStsToken:e}),o=(n.proxyStsToken=e,i.crc32Key);o&&(n.proxyStsToken=e,t._setCache(o,t.serializeCacheInfo(i)))}))}},{key:"_setOption",value:function(e){this._mergeOptions(this.config,e)}},{key:"_getOption",value:function(e){var t=mr({},this.config);return Object.keys(t).forEach((function(e){(-1<e.indexOf("Url")||"replace"===e||"log"===e)&&delete t[e]})),e?t[e]:t}},{key:"_userCancel",value:function(e){var t=this,r=this.tasks;e?(this._cancel(e),this.logger.send(mr({},r[e],{type:"cancel"})),delete this.tasks[e]):Object.keys(r).forEach((function(e){t._cancel(e),t.logger.send(mr({},r[e],{type:"cancel"})),delete t.tasks[e]}))}},{key:"_userPause",value:function(e){var t=this,r=this.tasks;e?(this._pause(e),this.logger.send(mr({},r[e],{type:"pause"}))):Object.keys(r).forEach((function(e){t._pause(e),t.logger.send(mr({},r[e],{type:"pause"}))}))}}]),t}();function kr(e){return(kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xr(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function Er(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xr(Object(r),!0).forEach((function(t){!function(e,t,r){(t=Cr(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Or(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cr(n.key),n)}}function Cr(e){return e=function(e,t){if("object"!==kr(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);if("object"!==kr(r=r.call(e,t||"default")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"===kr(e)?e:String(e)}function Tr(e,t){return(Tr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Dr(e){return(Dr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var jr=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tr(e,t)}(t,Sr);var e=function(t){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var e,n=Dr(t);return function(e,t){if(t&&("object"===kr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,r?(e=Dr(this).constructor,Reflect.construct(n,arguments,e)):n.apply(this,arguments))}}(t);function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.apply(this,arguments)}return function(e,t,r){t&&Or(e.prototype,t),r&&Or(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"start",value:function(e){var t=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.abort=!1,r.selectRoute?this._selectRoute(r,(function(r){r=Er(Er({},r),{},{enableSelectRoute:!0}),e?t._run(e,r):t._batchAction(t._run.bind(t),r)})):e?this._run(e):this._batchAction(this._run.bind(this))}},{key:"addFile",value:function(e){var t;return e&&$e(e.stsToken)?e.file&&this.config.clientEncrypt?this._addAllUploadProcessClientEncrypt(e):e.file?(t=_e.getUnique("file"),this._addAllUploadProcess(e,t),t):null:(this.emit("error",{extra:{message:Ke,errorCode:Fe}}),null)}},{key:"addImageFile",value:function(e){var t;return e&&$e(e.stsToken)?e.file?(e.type=e.type||ce,t=_e.getUnique("file"),this._addAllUploadProcess(e,t),t):null:(this.emit("error",{extra:{message:Ke,errorCode:Fe}}),null)}},{key:"addStreamUploadTask",value:function(e){var t;return e&&$e(e.stsToken)?(t=_e.getUnique("file"),this._addAllStreamUploadProcess(e,t),t):(this.emit("error",{extra:{message:Ke,errorCode:Fe}}),null)}},{key:"addStreamSlice",value:function(e){var t=e.fileSlice;e=e.index,this._addStreamSlice({fileSlice:t,index:e})}},{key:"completeStreamUpload",value:function(){this._completeStreamUpload()}},{key:"removeFile",value:function(e){e&&this._removeFile(e)}},{key:"cancel",value:function(e){e?this._userCancel(e):this._batchAction(this._userCancel.bind(this))}},{key:"pause",value:function(e){this._userPause(e)}},{key:"restart",value:function(e){e?this._restart(e):this._batchAction(this._restart.bind(this))}},{key:"refreshSTSToken",value:function(e){this._refreshSTSToken(e)}},{key:"setOption",value:function(e){this._setOption(e)}},{key:"getOption",value:function(e){return this._getOption(e)}}]),t}()}]).default},e.exports=t()},82506:function(e,t,r){"use strict";r.d(t,{ju:function(){return j}});var n=function(){return"undefined"==typeof window},i=n()||!document.documentElement.classList.contains("Android")&&!Boolean(/(?:Android);?[\s/]+([\d.]+)?/.exec(navigator.userAgent))?"iOS":"Android";var o=r(78470),a=r.n(o),s=r(8407),c=r.n(s),u=r(82724),l=r.n(u),f=r(71757),h=r.n(f),p=r(70952),d=r.n(p),g=r(26211),y=r.n(g),m=r(48911),v=r.n(m),b=r(6834),_=r(57223),w=r(32595),S=r(67308),k=r(48546),x=function(){if(!n())return function(){if(n())return!1;var e=navigator.userAgent.match(/isDarkMode\/([01])/);return e?"1"===e[1]:Boolean(window.matchMedia)&&window.matchMedia("(prefers-color-scheme: dark)").matches}()?"dark":"light"}(),E=["children"],O=["children"];function C(e,t){var r=a()(e);if(c()){var n=c()(e);t&&(n=l()(n).call(n,(function(t){return h()(e,t).enumerable}))),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):d()?y()(e,d()(r)):C(Object(r)).forEach((function(t){v()(e,t,h()(r,t))}))}return e}var D=(0,S.createContext)({platform:void 0,uniform:"default",theme:void 0,dir:"ltr",hasStatusBar:void 0,androidStatusBarHeight:24,navBarHeight:void 0});D.displayName="TUXContext";var j=function(e){var t=(0,S.useContext)(D),r=(0,S.useState)(t),o=(0,w.A)(r,2),a=o[0],s=o[1],c=e.children;return(0,S.useEffect)((function(){var r=T({},t);void 0===r.theme&&(r.theme=x),void 0===r.platform&&(r.platform=i),void 0===r.hasStatusBar&&(r.hasStatusBar=function(){if(!n())return 1===(0,k.D)(window.location.search).should_full_screen}()),e.children;var o=(0,b.A)(e,E);r=T(T({},r),o),s(r)}),[t,e]),(0,S.useEffect)((function(){s((function(t){var r=T({},t);void 0===r.navBarHeight&&(r.navBarHeight="iOS"===r.platform?44:52),e.children;var n=(0,b.A)(e,O);return r=T(T({},r),n)}))}),[e]),S.createElement(D.Provider,{value:a},S.createElement("div",{"data-theme":a.theme,dir:a.dir},c))};n()||"iOS"!==i||document.addEventListener("touchstart",(function(){}),!1)},16640:function(e,t,r){"use strict";var n=r(10433),i=r(80684),o=i(n("String.prototype.indexOf"));e.exports=function(e,t){var r=n(e,!!t);return"function"==typeof r&&o(e,".prototype.")>-1?i(r):r}},80684:function(e,t,r){"use strict";var n=r(79524),i=r(10433),o=r(73068),a=r(71102),s=i("%Function.prototype.apply%"),c=i("%Function.prototype.call%"),u=i("%Reflect.apply%",!0)||n.call(c,s),l=r(8821),f=i("%Math.max%");e.exports=function(e){if("function"!=typeof e)throw new a("a function is required");var t=u(n,c,arguments);return o(t,1+f(0,e.length-(arguments.length-1)),!0)};var h=function(){return u(n,s,arguments)};l?l(e.exports,"apply",{value:h}):e.exports.apply=h},35284:function(e,t,r){"use strict";function n(e){var t,r,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=n(e[t]))&&(i&&(i+=" "),i+=r);else for(t in e)e[t]&&(i&&(i+=" "),i+=t);return i}t.A=function(){for(var e,t,r=0,i="";r<arguments.length;)(e=arguments[r++])&&(t=n(e))&&(i&&(i+=" "),i+=t);return i}},49051:function(e){e.exports=function(){"use strict";for(var e=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=1),e<t?t:e>r?r:e},t=e,r=function(e){e._clipped=!1,e._unclipped=e.slice(0);for(var r=0;r<=3;r++)r<3?((e[r]<0||e[r]>255)&&(e._clipped=!0),e[r]=t(e[r],0,255)):3===r&&(e[r]=t(e[r],0,1));return e},n={},i=0,o=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];i<o.length;i+=1){var a=o[i];n["[object "+a+"]"]=a.toLowerCase()}var s=function(e){return n[Object.prototype.toString.call(e)]||"object"},c=s,u=function(e,t){return void 0===t&&(t=null),e.length>=3?Array.prototype.slice.call(e):"object"==c(e[0])&&t?t.split("").filter((function(t){return void 0!==e[0][t]})).map((function(t){return e[0][t]})):e[0]},l=s,f=function(e){if(e.length<2)return null;var t=e.length-1;return"string"==l(e[t])?e[t].toLowerCase():null},h=Math.PI,p={clip_rgb:r,limit:e,type:s,unpack:u,last:f,PI:h,TWOPI:2*h,PITHIRD:h/3,DEG2RAD:h/180,RAD2DEG:180/h},d={format:{},autodetect:[]},g=p.last,y=p.clip_rgb,m=p.type,v=d,b=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=this;if("object"===m(e[0])&&e[0].constructor&&e[0].constructor===this.constructor)return e[0];var n=g(e),i=!1;if(!n){i=!0,v.sorted||(v.autodetect=v.autodetect.sort((function(e,t){return t.p-e.p})),v.sorted=!0);for(var o=0,a=v.autodetect;o<a.length;o+=1){var s=a[o];if(n=s.test.apply(s,e))break}}if(!v.format[n])throw new Error("unknown format: "+e);var c=v.format[n].apply(null,i?e:e.slice(0,-1));r._rgb=y(c),3===r._rgb.length&&r._rgb.push(1)};b.prototype.toString=function(){return"function"==m(this.hex)?this.hex():"["+this._rgb.join(",")+"]"};var _=b,w=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(w.Color,[null].concat(e)))};w.Color=_,w.version="2.4.2";var S=w,k=p.unpack,x=Math.max,E=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=k(e,"rgb"),n=r[0],i=r[1],o=r[2],a=1-x(n/=255,x(i/=255,o/=255)),s=a<1?1/(1-a):0;return[(1-n-a)*s,(1-i-a)*s,(1-o-a)*s,a]},O=E,C=p.unpack,T=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=(e=C(e,"cmyk"))[0],n=e[1],i=e[2],o=e[3],a=e.length>4?e[4]:1;return 1===o?[0,0,0,a]:[r>=1?0:255*(1-r)*(1-o),n>=1?0:255*(1-n)*(1-o),i>=1?0:255*(1-i)*(1-o),a]},D=T,j=S,A=_,P=d,I=p.unpack,z=p.type,R=O;A.prototype.cmyk=function(){return R(this._rgb)},j.cmyk=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(A,[null].concat(e,["cmyk"])))},P.format.cmyk=D,P.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=I(e,"cmyk"),"array"===z(e)&&4===e.length)return"cmyk"}});var M=p.unpack,B=p.last,U=function(e){return Math.round(100*e)/100},N=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=M(e,"hsla"),n=B(e)||"lsa";return r[0]=U(r[0]||0),r[1]=U(100*r[1])+"%",r[2]=U(100*r[2])+"%","hsla"===n||r.length>3&&r[3]<1?(r[3]=r.length>3?r[3]:1,n="hsla"):r.length=3,n+"("+r.join(",")+")"},G=N,F=p.unpack,L=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=(e=F(e,"rgba"))[0],n=e[1],i=e[2];r/=255,n/=255,i/=255;var o,a,s=Math.min(r,n,i),c=Math.max(r,n,i),u=(c+s)/2;return c===s?(o=0,a=Number.NaN):o=u<.5?(c-s)/(c+s):(c-s)/(2-c-s),r==c?a=(n-i)/(c-s):n==c?a=2+(i-r)/(c-s):i==c&&(a=4+(r-n)/(c-s)),(a*=60)<0&&(a+=360),e.length>3&&void 0!==e[3]?[a,o,u,e[3]]:[a,o,u]},H=L,K=p.unpack,q=p.last,W=G,J=H,V=Math.round,X=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=K(e,"rgba"),n=q(e)||"rgb";return"hsl"==n.substr(0,3)?W(J(r),n):(r[0]=V(r[0]),r[1]=V(r[1]),r[2]=V(r[2]),("rgba"===n||r.length>3&&r[3]<1)&&(r[3]=r.length>3?r[3]:1,n="rgba"),n+"("+r.slice(0,"rgb"===n?3:4).join(",")+")")},$=X,Z=p.unpack,Y=Math.round,Q=function(){for(var e,t=[],r=arguments.length;r--;)t[r]=arguments[r];var n,i,o,a=(t=Z(t,"hsl"))[0],s=t[1],c=t[2];if(0===s)n=i=o=255*c;else{var u=[0,0,0],l=[0,0,0],f=c<.5?c*(1+s):c+s-c*s,h=2*c-f,p=a/360;u[0]=p+1/3,u[1]=p,u[2]=p-1/3;for(var d=0;d<3;d++)u[d]<0&&(u[d]+=1),u[d]>1&&(u[d]-=1),6*u[d]<1?l[d]=h+6*(f-h)*u[d]:2*u[d]<1?l[d]=f:3*u[d]<2?l[d]=h+(f-h)*(2/3-u[d])*6:l[d]=h;n=(e=[Y(255*l[0]),Y(255*l[1]),Y(255*l[2])])[0],i=e[1],o=e[2]}return t.length>3?[n,i,o,t[3]]:[n,i,o,1]},ee=Q,te=ee,re=d,ne=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,ie=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,oe=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,ae=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,se=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,ce=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,ue=Math.round,le=function(e){var t;if(e=e.toLowerCase().trim(),re.format.named)try{return re.format.named(e)}catch(d){}if(t=e.match(ne)){for(var r=t.slice(1,4),n=0;n<3;n++)r[n]=+r[n];return r[3]=1,r}if(t=e.match(ie)){for(var i=t.slice(1,5),o=0;o<4;o++)i[o]=+i[o];return i}if(t=e.match(oe)){for(var a=t.slice(1,4),s=0;s<3;s++)a[s]=ue(2.55*a[s]);return a[3]=1,a}if(t=e.match(ae)){for(var c=t.slice(1,5),u=0;u<3;u++)c[u]=ue(2.55*c[u]);return c[3]=+c[3],c}if(t=e.match(se)){var l=t.slice(1,4);l[1]*=.01,l[2]*=.01;var f=te(l);return f[3]=1,f}if(t=e.match(ce)){var h=t.slice(1,4);h[1]*=.01,h[2]*=.01;var p=te(h);return p[3]=+t[4],p}};le.test=function(e){return ne.test(e)||ie.test(e)||oe.test(e)||ae.test(e)||se.test(e)||ce.test(e)};var fe=le,he=S,pe=_,de=d,ge=p.type,ye=$,me=fe;pe.prototype.css=function(e){return ye(this._rgb,e)},he.css=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(pe,[null].concat(e,["css"])))},de.format.css=me,de.autodetect.push({p:5,test:function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];if(!t.length&&"string"===ge(e)&&me.test(e))return"css"}});var ve=_,be=S,_e=d,we=p.unpack;_e.format.gl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=we(e,"rgba");return r[0]*=255,r[1]*=255,r[2]*=255,r},be.gl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(ve,[null].concat(e,["gl"])))},ve.prototype.gl=function(){var e=this._rgb;return[e[0]/255,e[1]/255,e[2]/255,e[3]]};var Se=p.unpack,ke=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r,n=Se(e,"rgb"),i=n[0],o=n[1],a=n[2],s=Math.min(i,o,a),c=Math.max(i,o,a),u=c-s,l=100*u/255,f=s/(255-u)*100;return 0===u?r=Number.NaN:(i===c&&(r=(o-a)/u),o===c&&(r=2+(a-i)/u),a===c&&(r=4+(i-o)/u),(r*=60)<0&&(r+=360)),[r,l,f]},xe=ke,Ee=p.unpack,Oe=Math.floor,Ce=function(){for(var e,t,r,n,i,o,a=[],s=arguments.length;s--;)a[s]=arguments[s];var c,u,l,f=(a=Ee(a,"hcg"))[0],h=a[1],p=a[2];p*=255;var d=255*h;if(0===h)c=u=l=p;else{360===f&&(f=0),f>360&&(f-=360),f<0&&(f+=360);var g=Oe(f/=60),y=f-g,m=p*(1-h),v=m+d*(1-y),b=m+d*y,_=m+d;switch(g){case 0:c=(e=[_,b,m])[0],u=e[1],l=e[2];break;case 1:c=(t=[v,_,m])[0],u=t[1],l=t[2];break;case 2:c=(r=[m,_,b])[0],u=r[1],l=r[2];break;case 3:c=(n=[m,v,_])[0],u=n[1],l=n[2];break;case 4:c=(i=[b,m,_])[0],u=i[1],l=i[2];break;case 5:c=(o=[_,m,v])[0],u=o[1],l=o[2]}}return[c,u,l,a.length>3?a[3]:1]},Te=Ce,De=p.unpack,je=p.type,Ae=S,Pe=_,Ie=d,ze=xe;Pe.prototype.hcg=function(){return ze(this._rgb)},Ae.hcg=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(Pe,[null].concat(e,["hcg"])))},Ie.format.hcg=Te,Ie.autodetect.push({p:1,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=De(e,"hcg"),"array"===je(e)&&3===e.length)return"hcg"}});var Re=p.unpack,Me=p.last,Be=Math.round,Ue=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=Re(e,"rgba"),n=r[0],i=r[1],o=r[2],a=r[3],s=Me(e)||"auto";void 0===a&&(a=1),"auto"===s&&(s=a<1?"rgba":"rgb");var c="000000"+((n=Be(n))<<16|(i=Be(i))<<8|(o=Be(o))).toString(16);c=c.substr(c.length-6);var u="0"+Be(255*a).toString(16);switch(u=u.substr(u.length-2),s.toLowerCase()){case"rgba":return"#"+c+u;case"argb":return"#"+u+c;default:return"#"+c}},Ne=Ue,Ge=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,Fe=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,Le=function(e){if(e.match(Ge)){4!==e.length&&7!==e.length||(e=e.substr(1)),3===e.length&&(e=(e=e.split(""))[0]+e[0]+e[1]+e[1]+e[2]+e[2]);var t=parseInt(e,16);return[t>>16,t>>8&255,255&t,1]}if(e.match(Fe)){5!==e.length&&9!==e.length||(e=e.substr(1)),4===e.length&&(e=(e=e.split(""))[0]+e[0]+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]);var r=parseInt(e,16);return[r>>24&255,r>>16&255,r>>8&255,Math.round((255&r)/255*100)/100]}throw new Error("unknown hex color: "+e)},He=S,Ke=_,qe=p.type,We=d,Je=Ne;Ke.prototype.hex=function(e){return Je(this._rgb,e)},He.hex=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(Ke,[null].concat(e,["hex"])))},We.format.hex=Le,We.autodetect.push({p:4,test:function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];if(!t.length&&"string"===qe(e)&&[3,4,5,6,7,8,9].indexOf(e.length)>=0)return"hex"}});var Ve=p.unpack,Xe=p.TWOPI,$e=Math.min,Ze=Math.sqrt,Ye=Math.acos,Qe=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r,n=Ve(e,"rgb"),i=n[0],o=n[1],a=n[2],s=$e(i/=255,o/=255,a/=255),c=(i+o+a)/3,u=c>0?1-s/c:0;return 0===u?r=NaN:(r=(i-o+(i-a))/2,r/=Ze((i-o)*(i-o)+(i-a)*(o-a)),r=Ye(r),a>o&&(r=Xe-r),r/=Xe),[360*r,u,c]},et=Qe,tt=p.unpack,rt=p.limit,nt=p.TWOPI,it=p.PITHIRD,ot=Math.cos,at=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r,n,i,o=(e=tt(e,"hsi"))[0],a=e[1],s=e[2];return isNaN(o)&&(o=0),isNaN(a)&&(a=0),o>360&&(o-=360),o<0&&(o+=360),(o/=360)<1/3?n=1-((i=(1-a)/3)+(r=(1+a*ot(nt*o)/ot(it-nt*o))/3)):o<2/3?i=1-((r=(1-a)/3)+(n=(1+a*ot(nt*(o-=1/3))/ot(it-nt*o))/3)):r=1-((n=(1-a)/3)+(i=(1+a*ot(nt*(o-=2/3))/ot(it-nt*o))/3)),[255*(r=rt(s*r*3)),255*(n=rt(s*n*3)),255*(i=rt(s*i*3)),e.length>3?e[3]:1]},st=at,ct=p.unpack,ut=p.type,lt=S,ft=_,ht=d,pt=et;ft.prototype.hsi=function(){return pt(this._rgb)},lt.hsi=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(ft,[null].concat(e,["hsi"])))},ht.format.hsi=st,ht.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=ct(e,"hsi"),"array"===ut(e)&&3===e.length)return"hsi"}});var dt=p.unpack,gt=p.type,yt=S,mt=_,vt=d,bt=H;mt.prototype.hsl=function(){return bt(this._rgb)},yt.hsl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(mt,[null].concat(e,["hsl"])))},vt.format.hsl=ee,vt.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=dt(e,"hsl"),"array"===gt(e)&&3===e.length)return"hsl"}});var _t=p.unpack,wt=Math.min,St=Math.max,kt=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r,n,i,o=(e=_t(e,"rgb"))[0],a=e[1],s=e[2],c=wt(o,a,s),u=St(o,a,s),l=u-c;return i=u/255,0===u?(r=Number.NaN,n=0):(n=l/u,o===u&&(r=(a-s)/l),a===u&&(r=2+(s-o)/l),s===u&&(r=4+(o-a)/l),(r*=60)<0&&(r+=360)),[r,n,i]},xt=kt,Et=p.unpack,Ot=Math.floor,Ct=function(){for(var e,t,r,n,i,o,a=[],s=arguments.length;s--;)a[s]=arguments[s];var c,u,l,f=(a=Et(a,"hsv"))[0],h=a[1],p=a[2];if(p*=255,0===h)c=u=l=p;else{360===f&&(f=0),f>360&&(f-=360),f<0&&(f+=360);var d=Ot(f/=60),g=f-d,y=p*(1-h),m=p*(1-h*g),v=p*(1-h*(1-g));switch(d){case 0:c=(e=[p,v,y])[0],u=e[1],l=e[2];break;case 1:c=(t=[m,p,y])[0],u=t[1],l=t[2];break;case 2:c=(r=[y,p,v])[0],u=r[1],l=r[2];break;case 3:c=(n=[y,m,p])[0],u=n[1],l=n[2];break;case 4:c=(i=[v,y,p])[0],u=i[1],l=i[2];break;case 5:c=(o=[p,y,m])[0],u=o[1],l=o[2]}}return[c,u,l,a.length>3?a[3]:1]},Tt=Ct,Dt=p.unpack,jt=p.type,At=S,Pt=_,It=d,zt=xt;Pt.prototype.hsv=function(){return zt(this._rgb)},At.hsv=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(Pt,[null].concat(e,["hsv"])))},It.format.hsv=Tt,It.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=Dt(e,"hsv"),"array"===jt(e)&&3===e.length)return"hsv"}});var Rt={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},Mt=Rt,Bt=p.unpack,Ut=Math.pow,Nt=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=Bt(e,"rgb"),n=r[0],i=r[1],o=r[2],a=Lt(n,i,o),s=a[0],c=a[1],u=116*c-16;return[u<0?0:u,500*(s-c),200*(c-a[2])]},Gt=function(e){return(e/=255)<=.04045?e/12.92:Ut((e+.055)/1.055,2.4)},Ft=function(e){return e>Mt.t3?Ut(e,1/3):e/Mt.t2+Mt.t0},Lt=function(e,t,r){return e=Gt(e),t=Gt(t),r=Gt(r),[Ft((.4124564*e+.3575761*t+.1804375*r)/Mt.Xn),Ft((.2126729*e+.7151522*t+.072175*r)/Mt.Yn),Ft((.0193339*e+.119192*t+.9503041*r)/Mt.Zn)]},Ht=Nt,Kt=Rt,qt=p.unpack,Wt=Math.pow,Jt=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r,n,i,o=(e=qt(e,"lab"))[0],a=e[1],s=e[2];return n=(o+16)/116,r=isNaN(a)?n:n+a/500,i=isNaN(s)?n:n-s/200,n=Kt.Yn*Xt(n),r=Kt.Xn*Xt(r),i=Kt.Zn*Xt(i),[Vt(3.2404542*r-1.5371385*n-.4985314*i),Vt(-.969266*r+1.8760108*n+.041556*i),Vt(.0556434*r-.2040259*n+1.0572252*i),e.length>3?e[3]:1]},Vt=function(e){return 255*(e<=.00304?12.92*e:1.055*Wt(e,1/2.4)-.055)},Xt=function(e){return e>Kt.t1?e*e*e:Kt.t2*(e-Kt.t0)},$t=Jt,Zt=p.unpack,Yt=p.type,Qt=S,er=_,tr=d,rr=Ht;er.prototype.lab=function(){return rr(this._rgb)},Qt.lab=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(er,[null].concat(e,["lab"])))},tr.format.lab=$t,tr.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=Zt(e,"lab"),"array"===Yt(e)&&3===e.length)return"lab"}});var nr=p.unpack,ir=p.RAD2DEG,or=Math.sqrt,ar=Math.atan2,sr=Math.round,cr=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=nr(e,"lab"),n=r[0],i=r[1],o=r[2],a=or(i*i+o*o),s=(ar(o,i)*ir+360)%360;return 0===sr(1e4*a)&&(s=Number.NaN),[n,a,s]},ur=cr,lr=p.unpack,fr=Ht,hr=ur,pr=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=lr(e,"rgb"),n=r[0],i=r[1],o=r[2],a=fr(n,i,o),s=a[0],c=a[1],u=a[2];return hr(s,c,u)},dr=pr,gr=p.unpack,yr=p.DEG2RAD,mr=Math.sin,vr=Math.cos,br=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=gr(e,"lch"),n=r[0],i=r[1],o=r[2];return isNaN(o)&&(o=0),[n,vr(o*=yr)*i,mr(o)*i]},_r=br,wr=p.unpack,Sr=_r,kr=$t,xr=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=(e=wr(e,"lch"))[0],n=e[1],i=e[2],o=Sr(r,n,i),a=o[0],s=o[1],c=o[2],u=kr(a,s,c);return[u[0],u[1],u[2],e.length>3?e[3]:1]},Er=xr,Or=p.unpack,Cr=Er,Tr=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=Or(e,"hcl").reverse();return Cr.apply(void 0,r)},Dr=Tr,jr=p.unpack,Ar=p.type,Pr=S,Ir=_,zr=d,Rr=dr;Ir.prototype.lch=function(){return Rr(this._rgb)},Ir.prototype.hcl=function(){return Rr(this._rgb).reverse()},Pr.lch=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(Ir,[null].concat(e,["lch"])))},Pr.hcl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(Ir,[null].concat(e,["hcl"])))},zr.format.lch=Er,zr.format.hcl=Dr,["lch","hcl"].forEach((function(e){return zr.autodetect.push({p:2,test:function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];if(t=jr(t,e),"array"===Ar(t)&&3===t.length)return e}})}));var Mr={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},Br=_,Ur=d,Nr=p.type,Gr=Mr,Fr=Le,Lr=Ne;Br.prototype.name=function(){for(var e=Lr(this._rgb,"rgb"),t=0,r=Object.keys(Gr);t<r.length;t+=1){var n=r[t];if(Gr[n]===e)return n.toLowerCase()}return e},Ur.format.named=function(e){if(e=e.toLowerCase(),Gr[e])return Fr(Gr[e]);throw new Error("unknown color name: "+e)},Ur.autodetect.push({p:5,test:function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];if(!t.length&&"string"===Nr(e)&&Gr[e.toLowerCase()])return"named"}});var Hr=p.unpack,Kr=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=Hr(e,"rgb");return(r[0]<<16)+(r[1]<<8)+r[2]},qr=Kr,Wr=p.type,Jr=function(e){if("number"==Wr(e)&&e>=0&&e<=16777215)return[e>>16,e>>8&255,255&e,1];throw new Error("unknown num color: "+e)},Vr=S,Xr=_,$r=d,Zr=p.type,Yr=qr;Xr.prototype.num=function(){return Yr(this._rgb)},Vr.num=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(Xr,[null].concat(e,["num"])))},$r.format.num=Jr,$r.autodetect.push({p:5,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(1===e.length&&"number"===Zr(e[0])&&e[0]>=0&&e[0]<=16777215)return"num"}});var Qr=S,en=_,tn=d,rn=p.unpack,nn=p.type,on=Math.round;en.prototype.rgb=function(e){return void 0===e&&(e=!0),!1===e?this._rgb.slice(0,3):this._rgb.slice(0,3).map(on)},en.prototype.rgba=function(e){return void 0===e&&(e=!0),this._rgb.slice(0,4).map((function(t,r){return r<3?!1===e?t:on(t):t}))},Qr.rgb=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(en,[null].concat(e,["rgb"])))},tn.format.rgb=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=rn(e,"rgba");return void 0===r[3]&&(r[3]=1),r},tn.autodetect.push({p:3,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=rn(e,"rgba"),"array"===nn(e)&&(3===e.length||4===e.length&&"number"==nn(e[3])&&e[3]>=0&&e[3]<=1))return"rgb"}});var an=Math.log,sn=function(e){var t,r,n,i=e/100;return i<66?(t=255,r=i<6?0:-155.25485562709179-.44596950469579133*(r=i-2)+104.49216199393888*an(r),n=i<20?0:.8274096064007395*(n=i-10)-254.76935184120902+115.67994401066147*an(n)):(t=351.97690566805693+.114206453784165*(t=i-55)-40.25366309332127*an(t),r=325.4494125711974+.07943456536662342*(r=i-50)-28.0852963507957*an(r),n=255),[t,r,n,1]},cn=sn,un=p.unpack,ln=Math.round,fn=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];for(var r,n=un(e,"rgb"),i=n[0],o=n[2],a=1e3,s=4e4,c=.4;s-a>c;){var u=cn(r=.5*(s+a));u[2]/u[0]>=o/i?s=r:a=r}return ln(r)},hn=S,pn=_,dn=d,gn=fn;pn.prototype.temp=pn.prototype.kelvin=pn.prototype.temperature=function(){return gn(this._rgb)},hn.temp=hn.kelvin=hn.temperature=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(pn,[null].concat(e,["temp"])))},dn.format.temp=dn.format.kelvin=dn.format.temperature=sn;var yn=p.unpack,mn=Math.cbrt,vn=Math.pow,bn=Math.sign,_n=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=yn(e,"rgb"),n=r[0],i=r[1],o=r[2],a=[Sn(n/255),Sn(i/255),Sn(o/255)],s=a[0],c=a[1],u=a[2],l=mn(.4122214708*s+.5363325363*c+.0514459929*u),f=mn(.2119034982*s+.6806995451*c+.1073969566*u),h=mn(.0883024619*s+.2817188376*c+.6299787005*u);return[.2104542553*l+.793617785*f-.0040720468*h,1.9779984951*l-2.428592205*f+.4505937099*h,.0259040371*l+.7827717662*f-.808675766*h]},wn=_n;function Sn(e){var t=Math.abs(e);return t<.04045?e/12.92:(bn(e)||1)*vn((t+.055)/1.055,2.4)}var kn=p.unpack,xn=Math.pow,En=Math.sign,On=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=(e=kn(e,"lab"))[0],n=e[1],i=e[2],o=xn(r+.3963377774*n+.2158037573*i,3),a=xn(r-.1055613458*n-.0638541728*i,3),s=xn(r-.0894841775*n-1.291485548*i,3);return[255*Tn(4.0767416621*o-3.3077115913*a+.2309699292*s),255*Tn(-1.2684380046*o+2.6097574011*a-.3413193965*s),255*Tn(-.0041960863*o-.7034186147*a+1.707614701*s),e.length>3?e[3]:1]},Cn=On;function Tn(e){var t=Math.abs(e);return t>.0031308?(En(e)||1)*(1.055*xn(t,1/2.4)-.055):12.92*e}var Dn=p.unpack,jn=p.type,An=S,Pn=_,In=d,zn=wn;Pn.prototype.oklab=function(){return zn(this._rgb)},An.oklab=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(Pn,[null].concat(e,["oklab"])))},In.format.oklab=Cn,In.autodetect.push({p:3,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=Dn(e,"oklab"),"array"===jn(e)&&3===e.length)return"oklab"}});var Rn=p.unpack,Mn=wn,Bn=ur,Un=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=Rn(e,"rgb"),n=r[0],i=r[1],o=r[2],a=Mn(n,i,o),s=a[0],c=a[1],u=a[2];return Bn(s,c,u)},Nn=Un,Gn=p.unpack,Fn=_r,Ln=Cn,Hn=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=(e=Gn(e,"lch"))[0],n=e[1],i=e[2],o=Fn(r,n,i),a=o[0],s=o[1],c=o[2],u=Ln(a,s,c);return[u[0],u[1],u[2],e.length>3?e[3]:1]},Kn=Hn,qn=p.unpack,Wn=p.type,Jn=S,Vn=_,Xn=d,$n=Nn;Vn.prototype.oklch=function(){return $n(this._rgb)},Jn.oklch=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(Vn,[null].concat(e,["oklch"])))},Xn.format.oklch=Kn,Xn.autodetect.push({p:3,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=qn(e,"oklch"),"array"===Wn(e)&&3===e.length)return"oklch"}});var Zn=_,Yn=p.type;Zn.prototype.alpha=function(e,t){return void 0===t&&(t=!1),void 0!==e&&"number"===Yn(e)?t?(this._rgb[3]=e,this):new Zn([this._rgb[0],this._rgb[1],this._rgb[2],e],"rgb"):this._rgb[3]},_.prototype.clipped=function(){return this._rgb._clipped||!1};var Qn=_,ei=Rt;Qn.prototype.darken=function(e){void 0===e&&(e=1);var t=this,r=t.lab();return r[0]-=ei.Kn*e,new Qn(r,"lab").alpha(t.alpha(),!0)},Qn.prototype.brighten=function(e){return void 0===e&&(e=1),this.darken(-e)},Qn.prototype.darker=Qn.prototype.darken,Qn.prototype.brighter=Qn.prototype.brighten,_.prototype.get=function(e){var t=e.split("."),r=t[0],n=t[1],i=this[r]();if(n){var o=r.indexOf(n)-("ok"===r.substr(0,2)?2:0);if(o>-1)return i[o];throw new Error("unknown channel "+n+" in mode "+r)}return i};var ti=_,ri=p.type,ni=Math.pow,ii=1e-7,oi=20;ti.prototype.luminance=function(e){if(void 0!==e&&"number"===ri(e)){if(0===e)return new ti([0,0,0,this._rgb[3]],"rgb");if(1===e)return new ti([255,255,255,this._rgb[3]],"rgb");var t=this.luminance(),r="rgb",n=oi,i=function(t,o){var a=t.interpolate(o,.5,r),s=a.luminance();return Math.abs(e-s)<ii||!n--?a:s>e?i(t,a):i(a,o)},o=(t>e?i(new ti([0,0,0]),this):i(this,new ti([255,255,255]))).rgb();return new ti(o.concat([this._rgb[3]]))}return ai.apply(void 0,this._rgb.slice(0,3))};var ai=function(e,t,r){return.2126*(e=si(e))+.7152*(t=si(t))+.0722*(r=si(r))},si=function(e){return(e/=255)<=.03928?e/12.92:ni((e+.055)/1.055,2.4)},ci={},ui=_,li=p.type,fi=ci,hi=function(e,t,r){void 0===r&&(r=.5);for(var n=[],i=arguments.length-3;i-- >0;)n[i]=arguments[i+3];var o=n[0]||"lrgb";if(fi[o]||n.length||(o=Object.keys(fi)[0]),!fi[o])throw new Error("interpolation mode "+o+" is not defined");return"object"!==li(e)&&(e=new ui(e)),"object"!==li(t)&&(t=new ui(t)),fi[o](e,t,r).alpha(e.alpha()+r*(t.alpha()-e.alpha()))},pi=_,di=hi;pi.prototype.mix=pi.prototype.interpolate=function(e,t){void 0===t&&(t=.5);for(var r=[],n=arguments.length-2;n-- >0;)r[n]=arguments[n+2];return di.apply(void 0,[this,e,t].concat(r))};var gi=_;gi.prototype.premultiply=function(e){void 0===e&&(e=!1);var t=this._rgb,r=t[3];return e?(this._rgb=[t[0]*r,t[1]*r,t[2]*r,r],this):new gi([t[0]*r,t[1]*r,t[2]*r,r],"rgb")};var yi=_,mi=Rt;yi.prototype.saturate=function(e){void 0===e&&(e=1);var t=this,r=t.lch();return r[1]+=mi.Kn*e,r[1]<0&&(r[1]=0),new yi(r,"lch").alpha(t.alpha(),!0)},yi.prototype.desaturate=function(e){return void 0===e&&(e=1),this.saturate(-e)};var vi=_,bi=p.type;vi.prototype.set=function(e,t,r){void 0===r&&(r=!1);var n=e.split("."),i=n[0],o=n[1],a=this[i]();if(o){var s=i.indexOf(o)-("ok"===i.substr(0,2)?2:0);if(s>-1){if("string"==bi(t))switch(t.charAt(0)){case"+":case"-":a[s]+=+t;break;case"*":a[s]*=+t.substr(1);break;case"/":a[s]/=+t.substr(1);break;default:a[s]=+t}else{if("number"!==bi(t))throw new Error("unsupported value for Color.set");a[s]=t}var c=new vi(a,i);return r?(this._rgb=c._rgb,this):c}throw new Error("unknown channel "+o+" in mode "+i)}return a};var _i=_,wi=function(e,t,r){var n=e._rgb,i=t._rgb;return new _i(n[0]+r*(i[0]-n[0]),n[1]+r*(i[1]-n[1]),n[2]+r*(i[2]-n[2]),"rgb")};ci.rgb=wi;var Si=_,ki=Math.sqrt,xi=Math.pow,Ei=function(e,t,r){var n=e._rgb,i=n[0],o=n[1],a=n[2],s=t._rgb,c=s[0],u=s[1],l=s[2];return new Si(ki(xi(i,2)*(1-r)+xi(c,2)*r),ki(xi(o,2)*(1-r)+xi(u,2)*r),ki(xi(a,2)*(1-r)+xi(l,2)*r),"rgb")};ci.lrgb=Ei;var Oi=_,Ci=function(e,t,r){var n=e.lab(),i=t.lab();return new Oi(n[0]+r*(i[0]-n[0]),n[1]+r*(i[1]-n[1]),n[2]+r*(i[2]-n[2]),"lab")};ci.lab=Ci;var Ti=_,Di=function(e,t,r,n){var i,o,a,s,c,u,l,f,h,p,d,g,y;return"hsl"===n?(a=e.hsl(),s=t.hsl()):"hsv"===n?(a=e.hsv(),s=t.hsv()):"hcg"===n?(a=e.hcg(),s=t.hcg()):"hsi"===n?(a=e.hsi(),s=t.hsi()):"lch"===n||"hcl"===n?(n="hcl",a=e.hcl(),s=t.hcl()):"oklch"===n&&(a=e.oklch().reverse(),s=t.oklch().reverse()),"h"!==n.substr(0,1)&&"oklch"!==n||(c=(i=a)[0],l=i[1],h=i[2],u=(o=s)[0],f=o[1],p=o[2]),isNaN(c)||isNaN(u)?isNaN(c)?isNaN(u)?g=Number.NaN:(g=u,1!=h&&0!=h||"hsv"==n||(d=f)):(g=c,1!=p&&0!=p||"hsv"==n||(d=l)):g=c+r*(u>c&&u-c>180?u-(c+360):u<c&&c-u>180?u+360-c:u-c),void 0===d&&(d=l+r*(f-l)),y=h+r*(p-h),new Ti("oklch"===n?[y,d,g]:[g,d,y],n)},ji=Di,Ai=function(e,t,r){return ji(e,t,r,"lch")};ci.lch=Ai,ci.hcl=Ai;var Pi=_,Ii=function(e,t,r){var n=e.num(),i=t.num();return new Pi(n+r*(i-n),"num")};ci.num=Ii;var zi=Di,Ri=function(e,t,r){return zi(e,t,r,"hcg")};ci.hcg=Ri;var Mi=Di,Bi=function(e,t,r){return Mi(e,t,r,"hsi")};ci.hsi=Bi;var Ui=Di,Ni=function(e,t,r){return Ui(e,t,r,"hsl")};ci.hsl=Ni;var Gi=Di,Fi=function(e,t,r){return Gi(e,t,r,"hsv")};ci.hsv=Fi;var Li=_,Hi=function(e,t,r){var n=e.oklab(),i=t.oklab();return new Li(n[0]+r*(i[0]-n[0]),n[1]+r*(i[1]-n[1]),n[2]+r*(i[2]-n[2]),"oklab")};ci.oklab=Hi;var Ki=Di,qi=function(e,t,r){return Ki(e,t,r,"oklch")};ci.oklch=qi;var Wi=_,Ji=p.clip_rgb,Vi=Math.pow,Xi=Math.sqrt,$i=Math.PI,Zi=Math.cos,Yi=Math.sin,Qi=Math.atan2,eo=function(e,t,r){void 0===t&&(t="lrgb"),void 0===r&&(r=null);var n=e.length;r||(r=Array.from(new Array(n)).map((function(){return 1})));var i=n/r.reduce((function(e,t){return e+t}));if(r.forEach((function(e,t){r[t]*=i})),e=e.map((function(e){return new Wi(e)})),"lrgb"===t)return to(e,r);for(var o=e.shift(),a=o.get(t),s=[],c=0,u=0,l=0;l<a.length;l++)if(a[l]=(a[l]||0)*r[0],s.push(isNaN(a[l])?0:r[0]),"h"===t.charAt(l)&&!isNaN(a[l])){var f=a[l]/180*$i;c+=Zi(f)*r[0],u+=Yi(f)*r[0]}var h=o.alpha()*r[0];e.forEach((function(e,n){var i=e.get(t);h+=e.alpha()*r[n+1];for(var o=0;o<a.length;o++)if(!isNaN(i[o]))if(s[o]+=r[n+1],"h"===t.charAt(o)){var l=i[o]/180*$i;c+=Zi(l)*r[n+1],u+=Yi(l)*r[n+1]}else a[o]+=i[o]*r[n+1]}));for(var p=0;p<a.length;p++)if("h"===t.charAt(p)){for(var d=Qi(u/s[p],c/s[p])/$i*180;d<0;)d+=360;for(;d>=360;)d-=360;a[p]=d}else a[p]=a[p]/s[p];return h/=n,new Wi(a,t).alpha(h>.99999?1:h,!0)},to=function(e,t){for(var r=e.length,n=[0,0,0,0],i=0;i<e.length;i++){var o=e[i],a=t[i]/r,s=o._rgb;n[0]+=Vi(s[0],2)*a,n[1]+=Vi(s[1],2)*a,n[2]+=Vi(s[2],2)*a,n[3]+=s[3]*a}return n[0]=Xi(n[0]),n[1]=Xi(n[1]),n[2]=Xi(n[2]),n[3]>.9999999&&(n[3]=1),new Wi(Ji(n))},ro=S,no=p.type,io=Math.pow,oo=function(e){var t="rgb",r=ro("#ccc"),n=0,i=[0,1],o=[],a=[0,0],s=!1,c=[],u=!1,l=0,f=1,h=!1,p={},d=!0,g=1,y=function(e){if((e=e||["#fff","#000"])&&"string"===no(e)&&ro.brewer&&ro.brewer[e.toLowerCase()]&&(e=ro.brewer[e.toLowerCase()]),"array"===no(e)){1===e.length&&(e=[e[0],e[0]]),e=e.slice(0);for(var t=0;t<e.length;t++)e[t]=ro(e[t]);o.length=0;for(var r=0;r<e.length;r++)o.push(r/(e.length-1))}return w(),c=e},m=function(e){if(null!=s){for(var t=s.length-1,r=0;r<t&&e>=s[r];)r++;return r-1}return 0},v=function(e){return e},b=function(e){return e},_=function(e,n){var i,u;if(null==n&&(n=!1),isNaN(e)||null===e)return r;u=n?e:s&&s.length>2?m(e)/(s.length-2):f!==l?(e-l)/(f-l):1,u=b(u),n||(u=v(u)),1!==g&&(u=io(u,g)),u=a[0]+u*(1-a[0]-a[1]),u=Math.min(1,Math.max(0,u));var h=Math.floor(1e4*u);if(d&&p[h])i=p[h];else{if("array"===no(c))for(var y=0;y<o.length;y++){var _=o[y];if(u<=_){i=c[y];break}if(u>=_&&y===o.length-1){i=c[y];break}if(u>_&&u<o[y+1]){u=(u-_)/(o[y+1]-_),i=ro.interpolate(c[y],c[y+1],u,t);break}}else"function"===no(c)&&(i=c(u));d&&(p[h]=i)}return i},w=function(){return p={}};y(e);var S=function(e){var t=ro(_(e));return u&&t[u]?t[u]():t};return S.classes=function(e){if(null!=e){if("array"===no(e))s=e,i=[e[0],e[e.length-1]];else{var t=ro.analyze(i);s=0===e?[t.min,t.max]:ro.limits(t,"e",e)}return S}return s},S.domain=function(e){if(!arguments.length)return i;l=e[0],f=e[e.length-1],o=[];var t=c.length;if(e.length===t&&l!==f)for(var r=0,n=Array.from(e);r<n.length;r+=1){var a=n[r];o.push((a-l)/(f-l))}else{for(var s=0;s<t;s++)o.push(s/(t-1));if(e.length>2){var u=e.map((function(t,r){return r/(e.length-1)})),h=e.map((function(e){return(e-l)/(f-l)}));h.every((function(e,t){return u[t]===e}))||(b=function(e){if(e<=0||e>=1)return e;for(var t=0;e>=h[t+1];)t++;var r=(e-h[t])/(h[t+1]-h[t]);return u[t]+r*(u[t+1]-u[t])})}}return i=[l,f],S},S.mode=function(e){return arguments.length?(t=e,w(),S):t},S.range=function(e,t){return y(e),S},S.out=function(e){return u=e,S},S.spread=function(e){return arguments.length?(n=e,S):n},S.correctLightness=function(e){return null==e&&(e=!0),h=e,w(),v=h?function(e){for(var t=_(0,!0).lab()[0],r=_(1,!0).lab()[0],n=t>r,i=_(e,!0).lab()[0],o=t+(r-t)*e,a=i-o,s=0,c=1,u=20;Math.abs(a)>.01&&u-- >0;)n&&(a*=-1),a<0?(s=e,e+=.5*(c-e)):(c=e,e+=.5*(s-e)),i=_(e,!0).lab()[0],a=i-o;return e}:function(e){return e},S},S.padding=function(e){return null!=e?("number"===no(e)&&(e=[e,e]),a=e,S):a},S.colors=function(t,r){arguments.length<2&&(r="hex");var n=[];if(0===arguments.length)n=c.slice(0);else if(1===t)n=[S(.5)];else if(t>1){var o=i[0],a=i[1]-o;n=ao(0,t,!1).map((function(e){return S(o+e/(t-1)*a)}))}else{e=[];var u=[];if(s&&s.length>2)for(var l=1,f=s.length,h=1<=f;h?l<f:l>f;h?l++:l--)u.push(.5*(s[l-1]+s[l]));else u=i;n=u.map((function(e){return S(e)}))}return ro[r]&&(n=n.map((function(e){return e[r]()}))),n},S.cache=function(e){return null!=e?(d=e,S):d},S.gamma=function(e){return null!=e?(g=e,S):g},S.nodata=function(e){return null!=e?(r=ro(e),S):r},S};function ao(e,t,r){for(var n=[],i=e<t,o=r?i?t+1:t-1:t,a=e;i?a<o:a>o;i?a++:a--)n.push(a);return n}var so=_,co=oo,uo=function(e){for(var t=[1,1],r=1;r<e;r++){for(var n=[1],i=1;i<=t.length;i++)n[i]=(t[i]||0)+t[i-1];t=n}return t},lo=function(e){var t,r,n,i,o,a,s;if(2===(e=e.map((function(e){return new so(e)}))).length)t=e.map((function(e){return e.lab()})),o=t[0],a=t[1],i=function(e){var t=[0,1,2].map((function(t){return o[t]+e*(a[t]-o[t])}));return new so(t,"lab")};else if(3===e.length)r=e.map((function(e){return e.lab()})),o=r[0],a=r[1],s=r[2],i=function(e){var t=[0,1,2].map((function(t){return(1-e)*(1-e)*o[t]+2*(1-e)*e*a[t]+e*e*s[t]}));return new so(t,"lab")};else if(4===e.length){var c;n=e.map((function(e){return e.lab()})),o=n[0],a=n[1],s=n[2],c=n[3],i=function(e){var t=[0,1,2].map((function(t){return(1-e)*(1-e)*(1-e)*o[t]+3*(1-e)*(1-e)*e*a[t]+3*(1-e)*e*e*s[t]+e*e*e*c[t]}));return new so(t,"lab")}}else{if(!(e.length>=5))throw new RangeError("No point in running bezier with only one color.");var u,l,f;u=e.map((function(e){return e.lab()})),f=e.length-1,l=uo(f),i=function(e){var t=1-e,r=[0,1,2].map((function(r){return u.reduce((function(n,i,o){return n+l[o]*Math.pow(t,f-o)*Math.pow(e,o)*i[r]}),0)}));return new so(r,"lab")}}return i},fo=function(e){var t=lo(e);return t.scale=function(){return co(t)},t},ho=S,po=function(e,t,r){if(!po[r])throw new Error("unknown blend mode "+r);return po[r](e,t)},go=function(e){return function(t,r){var n=ho(r).rgb(),i=ho(t).rgb();return ho.rgb(e(n,i))}},yo=function(e){return function(t,r){var n=[];return n[0]=e(t[0],r[0]),n[1]=e(t[1],r[1]),n[2]=e(t[2],r[2]),n}},mo=function(e){return e},vo=function(e,t){return e*t/255},bo=function(e,t){return e>t?t:e},_o=function(e,t){return e>t?e:t},wo=function(e,t){return 255*(1-(1-e/255)*(1-t/255))},So=function(e,t){return t<128?2*e*t/255:255*(1-2*(1-e/255)*(1-t/255))},ko=function(e,t){return 255*(1-(1-t/255)/(e/255))},xo=function(e,t){return 255===e||(e=t/255*255/(1-e/255))>255?255:e};po.normal=go(yo(mo)),po.multiply=go(yo(vo)),po.screen=go(yo(wo)),po.overlay=go(yo(So)),po.darken=go(yo(bo)),po.lighten=go(yo(_o)),po.dodge=go(yo(xo)),po.burn=go(yo(ko));for(var Eo=po,Oo=p.type,Co=p.clip_rgb,To=p.TWOPI,Do=Math.pow,jo=Math.sin,Ao=Math.cos,Po=S,Io=function(e,t,r,n,i){void 0===e&&(e=300),void 0===t&&(t=-1.5),void 0===r&&(r=1),void 0===n&&(n=1),void 0===i&&(i=[0,1]);var o,a=0;"array"===Oo(i)?o=i[1]-i[0]:(o=0,i=[i,i]);var s=function(s){var c=To*((e+120)/360+t*s),u=Do(i[0]+o*s,n),l=(0!==a?r[0]+s*a:r)*u*(1-u)/2,f=Ao(c),h=jo(c);return Po(Co([255*(u+l*(-.14861*f+1.78277*h)),255*(u+l*(-.29227*f-.90649*h)),255*(u+l*(1.97294*f)),1]))};return s.start=function(t){return null==t?e:(e=t,s)},s.rotations=function(e){return null==e?t:(t=e,s)},s.gamma=function(e){return null==e?n:(n=e,s)},s.hue=function(e){return null==e?r:("array"===Oo(r=e)?0==(a=r[1]-r[0])&&(r=r[1]):a=0,s)},s.lightness=function(e){return null==e?i:("array"===Oo(e)?(i=e,o=e[1]-e[0]):(i=[e,e],o=0),s)},s.scale=function(){return Po.scale(s)},s.hue(r),s},zo=_,Ro="0123456789abcdef",Mo=Math.floor,Bo=Math.random,Uo=function(){for(var e="#",t=0;t<6;t++)e+=Ro.charAt(Mo(16*Bo()));return new zo(e,"hex")},No=s,Go=Math.log,Fo=Math.pow,Lo=Math.floor,Ho=Math.abs,Ko=function(e,t){void 0===t&&(t=null);var r={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0};return"object"===No(e)&&(e=Object.values(e)),e.forEach((function(e){t&&"object"===No(e)&&(e=e[t]),null==e||isNaN(e)||(r.values.push(e),r.sum+=e,e<r.min&&(r.min=e),e>r.max&&(r.max=e),r.count+=1)})),r.domain=[r.min,r.max],r.limits=function(e,t){return qo(r,e,t)},r},qo=function(e,t,r){void 0===t&&(t="equal"),void 0===r&&(r=7),"array"==No(e)&&(e=Ko(e));var n=e.min,i=e.max,o=e.values.sort((function(e,t){return e-t}));if(1===r)return[n,i];var a=[];if("c"===t.substr(0,1)&&(a.push(n),a.push(i)),"e"===t.substr(0,1)){a.push(n);for(var s=1;s<r;s++)a.push(n+s/r*(i-n));a.push(i)}else if("l"===t.substr(0,1)){if(n<=0)throw new Error("Logarithmic scales are only possible for values > 0");var c=Math.LOG10E*Go(n),u=Math.LOG10E*Go(i);a.push(n);for(var l=1;l<r;l++)a.push(Fo(10,c+l/r*(u-c)));a.push(i)}else if("q"===t.substr(0,1)){a.push(n);for(var f=1;f<r;f++){var h=(o.length-1)*f/r,p=Lo(h);if(p===h)a.push(o[p]);else{var d=h-p;a.push(o[p]*(1-d)+o[p+1]*d)}}a.push(i)}else if("k"===t.substr(0,1)){var g,y=o.length,m=new Array(y),v=new Array(r),b=!0,_=0,w=null;(w=[]).push(n);for(var S=1;S<r;S++)w.push(n+S/r*(i-n));for(w.push(i);b;){for(var k=0;k<r;k++)v[k]=0;for(var x=0;x<y;x++)for(var E=o[x],O=Number.MAX_VALUE,C=void 0,T=0;T<r;T++){var D=Ho(w[T]-E);D<O&&(O=D,C=T),v[C]++,m[x]=C}for(var j=new Array(r),A=0;A<r;A++)j[A]=null;for(var P=0;P<y;P++)null===j[g=m[P]]?j[g]=o[P]:j[g]+=o[P];for(var I=0;I<r;I++)j[I]*=1/v[I];b=!1;for(var z=0;z<r;z++)if(j[z]!==w[z]){b=!0;break}w=j,++_>200&&(b=!1)}for(var R={},M=0;M<r;M++)R[M]=[];for(var B=0;B<y;B++)R[g=m[B]].push(o[B]);for(var U=[],N=0;N<r;N++)U.push(R[N][0]),U.push(R[N][R[N].length-1]);U=U.sort((function(e,t){return e-t})),a.push(U[0]);for(var G=1;G<U.length;G+=2){var F=U[G];isNaN(F)||-1!==a.indexOf(F)||a.push(F)}}return a},Wo={analyze:Ko,limits:qo},Jo=_,Vo=function(e,t){e=new Jo(e),t=new Jo(t);var r=e.luminance(),n=t.luminance();return r>n?(r+.05)/(n+.05):(n+.05)/(r+.05)},Xo=_,$o=Math.sqrt,Zo=Math.pow,Yo=Math.min,Qo=Math.max,ea=Math.atan2,ta=Math.abs,ra=Math.cos,na=Math.sin,ia=Math.exp,oa=Math.PI,aa=function(e,t,r,n,i){void 0===r&&(r=1),void 0===n&&(n=1),void 0===i&&(i=1);var o=function(e){return 360*e/(2*oa)},a=function(e){return 2*oa*e/360};e=new Xo(e),t=new Xo(t);var s=Array.from(e.lab()),c=s[0],u=s[1],l=s[2],f=Array.from(t.lab()),h=f[0],p=f[1],d=f[2],g=(c+h)/2,y=($o(Zo(u,2)+Zo(l,2))+$o(Zo(p,2)+Zo(d,2)))/2,m=.5*(1-$o(Zo(y,7)/(Zo(y,7)+Zo(25,7)))),v=u*(1+m),b=p*(1+m),_=$o(Zo(v,2)+Zo(l,2)),w=$o(Zo(b,2)+Zo(d,2)),S=(_+w)/2,k=o(ea(l,v)),x=o(ea(d,b)),E=k>=0?k:k+360,O=x>=0?x:x+360,C=ta(E-O)>180?(E+O+360)/2:(E+O)/2,T=1-.17*ra(a(C-30))+.24*ra(a(2*C))+.32*ra(a(3*C+6))-.2*ra(a(4*C-63)),D=O-E;D=ta(D)<=180?D:O<=E?D+360:D-360,D=2*$o(_*w)*na(a(D)/2);var j=h-c,A=w-_,P=1+.015*Zo(g-50,2)/$o(20+Zo(g-50,2)),I=1+.045*S,z=1+.015*S*T,R=30*ia(-Zo((C-275)/25,2)),M=-2*$o(Zo(S,7)/(Zo(S,7)+Zo(25,7)))*na(2*a(R)),B=$o(Zo(j/(r*P),2)+Zo(A/(n*I),2)+Zo(D/(i*z),2)+M*(A/(n*I))*(D/(i*z)));return Qo(0,Yo(100,B))},sa=_,ca=function(e,t,r){void 0===r&&(r="lab"),e=new sa(e),t=new sa(t);var n=e.get(r),i=t.get(r),o=0;for(var a in n){var s=(n[a]||0)-(i[a]||0);o+=s*s}return Math.sqrt(o)},ua=_,la=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];try{return new(Function.prototype.bind.apply(ua,[null].concat(e))),!0}catch(r){return!1}},fa=S,ha=oo,pa={cool:function(){return ha([fa.hsl(180,1,.9),fa.hsl(250,.7,.4)])},hot:function(){return ha(["#000","#f00","#ff0","#fff"]).mode("rgb")}},da={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},ga=0,ya=Object.keys(da);ga<ya.length;ga+=1){var ma=ya[ga];da[ma.toLowerCase()]=da[ma]}var va=da,ba=S;return ba.average=eo,ba.bezier=fo,ba.blend=Eo,ba.cubehelix=Io,ba.mix=ba.interpolate=hi,ba.random=Uo,ba.scale=oo,ba.analyze=Wo.analyze,ba.contrast=Vo,ba.deltaE=aa,ba.distance=ca,ba.limits=Wo.limits,ba.valid=la,ba.scales=pa,ba.colors=Mr,ba.brewer=va,ba}()},30395:function(e,t){var r;!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e="",t=0;t<arguments.length;t++){var r=arguments[t];r&&(e=a(e,o(r)))}return e}function o(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return i.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var r in e)n.call(e,r)&&e[r]&&(t=a(t,r));return t}function a(e,t){return t?e?e+" "+t:e+t:e}e.exports?(i.default=i,e.exports=i):void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r)}()},75830:function(e){"use strict";e.exports=JSON.parse('{"wasm_url":"https://lf16-web-buz.capcut.com/obj/unpkg-va/byted/ever_cloud_sdk/1.950.3-cc/dist/667251b0ccbcd99ea5fb_wasm.gz"}')}}]);
//# sourceMappingURL=1180.737b2942.js.map